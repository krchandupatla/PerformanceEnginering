<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="223">
  <HTTPTask id="1110" hostname="aa-pt6245.dev.accela.com:5443" path="https://aa-pt6245.dev.accela.com:5443/portlets/framework/includes/javascript/ac360ScrollBar.js" url="https://aa-pt6245.dev.accela.com:5443/portlets/framework/includes/javascript/ac360ScrollBar.js" ip="13.93.163.237" port="5443" connectionId="225" origin="Primary" frame="1" startDateTime="2017-08-28T11:36:12.823-07:00" startTime="1030891968" endTime="1030891968">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdCwgKi8qO3E9MC44</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9mcmFtZXdvcmsvaW5jbHVkZXMvZXJyb3IvYmxhbmsuanNwP21vZHVsZT1CdWlsZGluZw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SlNFU1NJT05JRD1xMERSRlRiOXRJZTdKR2oteEQrUFdBbkM7IF9fY2ZkdWlkPWRiNjBkNWU3ODRkYmRlN2NhNTlkZGVjNmUzYWNkYzk2MjE1MDI0MzA3NzM7IF9wZW5kb19hY2NvdW50SWQuNTY3YTE0NmUtNjVhYy00NmE1LTdhMTMtYjMyNDc0YTRmNjdiPUZMQUdTVEFGRjsgX3BlbmRvX3Zpc2l0b3JJZC41NjdhMTQ2ZS02NWFjLTQ2YTUtN2ExMy1iMzI0NzRhNGY2N2I9ZTlhZjFmYTUxNzFhZWQwYWRiZWUwMDI4NGE0NTUwODY0NjVhYTMxZmMzNjU2M2VkYWJmNjQ2ZTExZDU1YTYwODgwOTVhMjNlZmVlZTBjYTU2NzAzZDEwOTY5ZDNhYzU0ZTk3OWFiMjExODkyZWU1NmRlZmM5MWM0Njg0NzZhMDg7IF9wZW5kb19tZXRhLjU2N2ExNDZlLTY1YWMtNDZhNS03YTEzLWIzMjQ3NGE0ZjY3Yj0zMzk5OTk2NjE3OyBKU0VTU0lPTklEPSoqKioqKioqKioqKioqKioqKioqKioqKioqKjsgMDEtSmFuLTE5NzAgMDA6MDA6MTAgR01UOyBMQVNURVNUX1JFUVVFU1RfVElNRT0xNTAzOTQ1MDkyMjY5OyBob3N0U2lnbk9uPXRydWU7IGdfY3VycmVudF9sYW5ndWFnZV9leHQ9ZW5fVVM7IExBVEVTVF9XRUJfU0VSVkVSPTEwLjEuMC42OyBMQVRFU1RfU0VTU0lPTl9JRD1xMERSRlRiOXRJZTdKR2oteEQrUFdBbkM7IEFDQXV0aD04ODUxMTg5MzIwNjIzNTY2MDkwODU2Mzg4MDg0NzY5NjU2NzkxNDI5MTQwNTc2ODY1NzY4MzM2Nzg0MDUyMTA3Mzk4MzYzMjgyMzEwOTAxMTAxNjQwOTUzMzg0NTIxNDI1MjA0NDYzOTI5OTE0NDc3MjQ1MDc1MjYyMzMxNjc5ODsgQUNTaWduT25Nb2R1bGU9U1NPU3RhbmRhcmQ7IEFBUGVyc2lzdExvZ2luU2VydlByb3ZDb2RlPUZMQUdTVEFGRjsgTG9naW5TZXJ2UHJvdkNvZGU0TXVsdGlBZ2VuY3k9RkxBR1NUQUZGOyBMb2dpblVzZXJuYW1lNE11bHRpQWdlbmN5PTE3OUREMTNBMTg2MDI4RjQ7IEFDU2lnbm9mZj0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9zZWN1cml0eS9zaWdub3V0LmRvIjsgQUNTd2l0Y2hBZ2VuY3k9Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Q2xvc2U=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIGh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvZnJhbWV3b3JrL2luY2x1ZGVzL2phdmFzY3JpcHQvYWMzNjBTY3JvbGxCYXIuanMgSFRUUC8xLjENCkFjY2VwdDogYXBwbGljYXRpb24vamF2YXNjcmlwdCwgKi8qO3E9MC44DQpSZWZlcmVyOiBodHRwczovL2FhLXB0NjI0NS5kZXYuYWNjZWxhLmNvbTo1NDQzL3BvcnRsZXRzL2ZyYW1ld29yay9pbmNsdWRlcy9lcnJvci9ibGFuay5qc3A/bW9kdWxlPUJ1aWxkaW5nDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTDQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXT1c2NDsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28NCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KQ29va2llOiBKU0VTU0lPTklEPXEwRFJGVGI5dEllN0pHai14RCtQV0FuQzsgX19jZmR1aWQ9ZGI2MGQ1ZTc4NGRiZGU3Y2E1OWRkZWM2ZTNhY2RjOTYyMTUwMjQzMDc3MzsgX3BlbmRvX2FjY291bnRJZC41NjdhMTQ2ZS02NWFjLTQ2YTUtN2ExMy1iMzI0NzRhNGY2N2I9RkxBR1NUQUZGOyBfcGVuZG9fdmlzaXRvcklkLjU2N2ExNDZlLTY1YWMtNDZhNS03YTEzLWIzMjQ3NGE0ZjY3Yj1lOWFmMWZhNTE3MWFlZDBhZGJlZTAwMjg0YTQ1NTA4NjQ2NWFhMzFmYzM2NTYzZWRhYmY2NDZlMTFkNTVhNjA4ODA5NWEyM2VmZWVlMGNhNTY3MDNkMTA5NjlkM2FjNTRlOTc5YWIyMTE4OTJlZTU2ZGVmYzkxYzQ2ODQ3NmEwODsgX3BlbmRvX21ldGEuNTY3YTE0NmUtNjVhYy00NmE1LTdhMTMtYjMyNDc0YTRmNjdiPTMzOTk5OTY2MTc7IEpTRVNTSU9OSUQ9KioqKioqKioqKioqKioqKioqKioqKioqKioqOyAwMS1KYW4tMTk3MCAwMDowMDoxMCBHTVQ7IExBU1RFU1RfUkVRVUVTVF9USU1FPTE1MDM5NDUwOTIyNjk7IGhvc3RTaWduT249dHJ1ZTsgZ19jdXJyZW50X2xhbmd1YWdlX2V4dD1lbl9VUzsgTEFURVNUX1dFQl9TRVJWRVI9MTAuMS4wLjY7IExBVEVTVF9TRVNTSU9OX0lEPXEwRFJGVGI5dEllN0pHai14RCtQV0FuQzsgQUNBdXRoPTg4NTExODkzMjA2MjM1NjYwOTA4NTYzODgwODQ3Njk2NTY3OTE0MjkxNDA1NzY4NjU3NjgzMzY3ODQwNTIxMDczOTgzNjMyODIzMTA5MDExMDE2NDA5NTMzODQ1MjE0MjUyMDQ0NjM5Mjk5MTQ0NzcyNDUwNzUyNjIzMzE2Nzk4OyBBQ1NpZ25Pbk1vZHVsZT1TU09TdGFuZGFyZDsgQUFQZXJzaXN0TG9naW5TZXJ2UHJvdkNvZGU9RkxBR1NUQUZGOyBMb2dpblNlcnZQcm92Q29kZTRNdWx0aUFnZW5jeT1GTEFHU1RBRkY7IExvZ2luVXNlcm5hbWU0TXVsdGlBZ2VuY3k9MTc5REQxM0ExODYwMjhGNDsgQUNTaWdub2ZmPSJodHRwczovL2FhLXB0NjI0NS5kZXYuYWNjZWxhLmNvbTo1NDQzL3BvcnRsZXRzL3NlY3VyaXR5L3NpZ25vdXQuZG8iOyBBQ1N3aXRjaEFnZW5jeT0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9jb21tb25zL3Nzby9ibGFuay5qc3AiDQpIb3N0OiBhYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0Mw0KQ29ubmVjdGlvbjogQ2xvc2UNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="JSESSIONID" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>cTBEUkZUYjl0SWU3SkdqLXhEK1BXQW5D</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="__cfduid" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZGI2MGQ1ZTc4NGRiZGU3Y2E1OWRkZWM2ZTNhY2RjOTYyMTUwMjQzMDc3Mw==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_pendo_accountId.567a146e-65ac-46a5-7a13-b32474a4f67b" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_pendo_visitorId.567a146e-65ac-46a5-7a13-b32474a4f67b" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZTlhZjFmYTUxNzFhZWQwYWRiZWUwMDI4NGE0NTUwODY0NjVhYTMxZmMzNjU2M2VkYWJmNjQ2ZTExZDU1YTYwODgwOTVhMjNlZmVlZTBjYTU2NzAzZDEwOTY5ZDNhYzU0ZTk3OWFiMjExODkyZWU1NmRlZmM5MWM0Njg0NzZhMDg=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_pendo_meta.567a146e-65ac-46a5-7a13-b32474a4f67b" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MzM5OTk5NjYxNw==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="JSESSIONID" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>KioqKioqKioqKioqKioqKioqKioqKioqKioq</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="01-Jan-1970 00:00:10 GMT; LASTEST_REQUEST_TIME" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTUwMzk0NTA5MjI2OQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="hostSignOn" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dHJ1ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="g_current_language_ext" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW5fVVM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_WEB_SERVER" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTAuMS4wLjY=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_SESSION_ID" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>cTBEUkZUYjl0SWU3SkdqLXhEK1BXQW5D</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACAuth" index="11">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ODg1MTE4OTMyMDYyMzU2NjA5MDg1NjM4ODA4NDc2OTY1Njc5MTQyOTE0MDU3Njg2NTc2ODMzNjc4NDA1MjEwNzM5ODM2MzI4MjMxMDkwMTEwMTY0MDk1MzM4NDUyMTQyNTIwNDQ2MzkyOTkxNDQ3NzI0NTA3NTI2MjMzMTY3OTg=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignOnModule" index="12">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>U1NPU3RhbmRhcmQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="AAPersistLoginServProvCode" index="13">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginServProvCode4MultiAgency" index="14">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginUsername4MultiAgency" index="15">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTc5REQxM0ExODYwMjhGNA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignoff" index="16">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvc2VjdXJpdHkvc2lnbm91dC5kbyI=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSwitchAgency" index="17">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QXBhY2hlLUNveW90ZS8xLjE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHJpdmF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBVVEM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-XSS-Protection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFTVEVTVF9SRVFVRVNUX1RJTUU9MTUwMzk0NTA5MjY0NDsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZSxMQVRFU1RfV0VCX1NFUlZFUj0xMC4xLjAuNjsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZSxMQVRFU1RfU0VTU0lPTl9JRD1xMERSRlRiOXRJZTdKR2oteEQrUFdBbkM7IERvbWFpbj1kZXYuYWNjZWxhLmNvbTsgUGF0aD0vOyBTZWN1cmU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Vy8iNTI0ODMtMTUwMTYxNzAxNjAwMCI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAwMSBBdWcgMjAxNyAxOTo1MDoxNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9qYXZhc2NyaXB0</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOCBBdWcgMjAxNyAxODozMTozMiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2xvc2U=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IEFwYWNoZS1Db3lvdGUvMS4xDQpDYWNoZS1Db250cm9sOiBwcml2YXRlDQpFeHBpcmVzOiBUaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIFVUQw0KWC1YU1MtUHJvdGVjdGlvbjogMA0KU2V0LUNvb2tpZTogTEFTVEVTVF9SRVFVRVNUX1RJTUU9MTUwMzk0NTA5MjY0NDsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZSxMQVRFU1RfV0VCX1NFUlZFUj0xMC4xLjAuNjsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZSxMQVRFU1RfU0VTU0lPTl9JRD1xMERSRlRiOXRJZTdKR2oteEQrUFdBbkM7IERvbWFpbj1kZXYuYWNjZWxhLmNvbTsgUGF0aD0vOyBTZWN1cmUNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpFVGFnOiBXLyI1MjQ4My0xNTAxNjE3MDE2MDAwIg0KTGFzdC1Nb2RpZmllZDogVHVlLCAwMSBBdWcgMjAxNyAxOTo1MDoxNiBHTVQNCkNvbnRlbnQtVHlwZTogdGV4dC9qYXZhc2NyaXB0DQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkRhdGU6IE1vbiwgMjggQXVnIDIwMTcgMTg6MzE6MzIgR01UDQpDb25uZWN0aW9uOiBjbG9zZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>Ly9BY2NlbGEgQXV0b21hdGlvbg0KLy9GaWxlOiBhYzM2MFNjcm9sbEJhci5qcw0KLy9BY2NlbGEsIEluYy4NCi8vQ29weXJpZ2h0IChDKTogMjAxMi0yMDE0DQoNCi8qDQogKiBEZXRlcm1pbmUgaWYgd2UncmUgaW5zaWRlIHRoZSBuZXcgQXV0b21hdGlvbiBmcmFtZXdvcmsuDQogKi8NCg0KZnVuY3Rpb24gQWNjZWxhRmluZGVyKCkgew0KICAgIHZhciBtYXhEZXB0aCA9IDEwOw0KICAgIHZhciBjb3VudGVyID0gMDsNCg0KICAgIGZ1bmN0aW9uIGZpbmQobWUpIHsNCiAgICAgICAgY291bnRlciA9IDA7DQogICAgICAgIHJldHVybiBmaW5kQWNjZWxhKG1lKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBmaW5kQWNjZWxhKG1lKSB7DQogICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMTsNCg0KICAgICAgICBpZiAoY291bnRlciA+PSBtYXhEZXB0aCkgew0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgYWNjZWxhID0gbWUuQWNjZWxhOw0KDQogICAgICAgIGlmIChhY2NlbGEpIHsNCiAgICAgICAgICAgIHJldHVybiBhY2NlbGE7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gIW1lLnBhcmVudCA/IG51bGwgOiBmaW5kQWNjZWxhKG1lLnBhcmVudCk7DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgZmluZDogZmluZA0KICAgIH07DQp9DQoNCnZhciBpc0F1dG9tYXRpb25OZXdVWCA9IGZhbHNlOw0KDQp2YXIgbmV3QWNjZWxhSW50ZXJmYWNlID0gbmV3IEFjY2VsYUZpbmRlcigpLmZpbmQocGFyZW50KTsNCg0KdHJ5IHsNCiAgICBpZiAodHlwZW9mIGlzTmV3VVggIT09ICd1bmRlZmluZWQnKSB7DQogICAgICAgIGlzQXV0b21hdGlvbk5ld1VYID0gaXNOZXdVWDsNCiAgICB9IGVsc2Ugew0KICAgICAgICBpc0F1dG9tYXRpb25OZXdVWCA9IChuZXdBY2NlbGFJbnRlcmZhY2UgPyB0cnVlIDogZmFsc2UpOw0KICAgIH0NCn0gY2F0Y2ggKGlnbm9yZSkge30NCg0KZnVuY3Rpb24gY29ycHNlQ29kZShvYmosIHZhbHVlKQ0Kew0KCWlmICghc2Nyb2xsQmFySXNzdWUuaXNPbGRVSSgpICYmIG9iaiAmJiB2YWx1ZSA+IDApIA0KCXsNCgkJdmFyIGNzc1ZhbHVlU3RyOw0KCSAgICB2YXIgYWxsb3dlZCA9IHRydWU7DQoJICAgIHZhciBpZCA9IG9iai5pZCB8fCBvYmoubmFtZTsNCgkgICAgaWYgKGlkID09PSAnaWZyYW1lLXBhZ2UtY29udGFpbmVyJykgDQoJICAgIHsNCgkgICAgICBhbGxvd2VkID0gZmFsc2U7DQoJICAgIH0gDQoJICAgIGVsc2UgaWYgKGlkID09PSAndGFza01hbmFnZW1lbnRMaXN0JykgDQoJICAgIHsgDQoJICAgIAlhbGxvd2VkID0gZmFsc2U7Ly8gQUFUSEVUQS0xMzQ3DQoJICAgIH0gDQoJICAgIGVsc2UgaWYgKGlkID09PSAnbmV3TWVldGluZ0NhbGVuZGVyRnJhbWUnKSANCgkgICAgeyANCgkgICAgCWFsbG93ZWQgPSBmYWxzZTsNCgkgICAgCW9iai5zdHlsZS5oZWlnaHQgPSAob2JqLmNvbnRlbnREb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCArIDUwKSArICdweCc7DQoJICAgIH0NCgkgICAgZWxzZSBpZiAoKC9JbnNwZWN0aW9uRGV0YWlsfGluc3BlY3Rpb25MaXN0fGNhcENvbmRpdGlvbkxpc3R8Y2FwQ29uZGl0aW9uRm9ybS9pKS50ZXN0KGlkKSkgDQoJICAgIHsgDQoJICAgIAkvLyBBQVRIRVRBLTEwMTANCgkgICAgICAgaWYgKHdpbmRvdy5mcmFtZXMubGVuZ3RoID09PSAxKSANCgkgICAgICAgeyANCgkgICAgICAgICAgIGFsbG93ZWQgPSBmYWxzZTsgLy8gQUFUSEVUQS0xNDc1OiBpZiB0aGlzIGlzIHRoZSBvbmx5IElGUkFNRSwgZG9uJ3QgcmVzaXplDQoJICAgICAgIH0gDQoJICAgICAgIGVsc2UgDQoJICAgICAgIHsNCgkgICAgICAgCWNzc1ZhbHVlU3RyID0gJ2hlaWdodDogJyArIChvYmouY29udGVudERvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0ICsgNTApICsgJ3B4JzsNCgkgICAgICAgfSANCgkgICAgfSANCgkgICAgZWxzZSBpZiAoKC9hc3NpZ25MaXN0fGFzc2lnbkRldGFpbC9pKS50ZXN0KGlkKSkgDQoJICAgIHsgDQoJICAgICAgLy8gQUFUSEVUQS0xMjUxDQoJICAgICAgdmFyIGVsID0gb2JqLmNvbnRlbnREb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLW5vLXV0aWxpdHktbWVudSA+IHRhYmxlJyk7DQoJICAgICAgaWYoZWwpDQoJICAgICAgew0KCQkgICAgICBjc3NWYWx1ZVN0ciA9ICdoZWlnaHQ6ICcgKyAoZWwuc2Nyb2xsSGVpZ2h0ICsgNTApICsgJ3B4Jzs7DQoJCSAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7aWYgKGlkID09PSAnYXNzaWduRGV0YWlsJykgeyBvYmouY29udGVudFdpbmRvdy5zY3JvbGxUbygwLDApO30gfSwgMTAwMCk7DQoJICAgICAgfQ0KCSAgICB9DQoJICAgIGlmIChhbGxvd2VkICYmIGNzc1ZhbHVlU3RyKSANCgkgICAgew0KCSAgICAgIG9iai5zdHlsZS5jc3NUZXh0ID0gb2JqLnN0eWxlLmNzc1RleHQucmVwbGFjZShjc3NWYWx1ZVN0ciwgY3NzVmFsdWVTdHIgKyAnICFpbXBvcnRhbnQ7Jyk7DQoJICAgIH0NCgl9DQoJZWxzZSB7IC8vRml4IGZvciBBQUVUQS0xMzkzDQoJCWlmKG9iaikgew0KCQkJdmFyIGlkID0gb2JqLmlkIHx8IG9iai5uYW1lOw0KCQkJaWYgKGlkID09PSAnbmV3TWVldGluZ0NhbGVuZGVyRnJhbWUnKSB7DQoJCQkJb2JqLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsNCgkJCX0NCgkJfQ0KCX0NCn0NCg0KLyogDQogKiBUaGlzIGlzIGEgc29sdXRpb24gd2hpY2ggc29sdmUgdjM2MCBzY3JvbGxiYXIgaXNzdWUuDQogKiBJdCBpcyB3b3JraW5nIHdoZW4gZmlsZSBpcyBwYXNzaW5nIGxheW91dFRhYi5qc3Agb3IgbGF5b3V0Tm9Gb3JtLmpzcC4NCiAqIEJlY2F1c2UgYm9keSBoYWQgYmVlbiBhZGRlZCBvbmxvYWQgZXZlbnQgaW4gdGhlc2UgZmlsZXMsIGRvUGFnZUluaXQgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgd2hlbiBkb2N1bWVudCBpcyBsb2FkZWQgZmluaXNoLg0KICogQW5kIGRvUGFnZUluaXQgZnVuY3Rpb24gd2lsbCBjYWxsIHBhZ2VBZGp1c3QgZnVuY3Rpb24gb2Ygc2Nyb2xsQmFySXNzdWUgb2JqZWN0Lg0KICogDQogKi8NCg0KLyoNCiAqIA0KICphZGQgdHJ5Li4uY2F0Y2ggaXMgb3JkZXIgdG8gYXZvaWQgY3Jvc3MtZG9tYWluIGlzc3VlLiANCiAqIA0KICovDQpzY3JvbGxCYXJJc3N1ZSA9IHsNCgkJDQoJU0NST0xMX0JBUl9TSVpFIDogMTgsLy9UaGlzIGNvbnN0YW50IHJlcHJlc2VudHMgdGhlIHNpemUgb2YgdGhlIHNjcm9sbCBiYXIgaW4gc3lzdGVtDQoJDQoJSkVUU1BFRURfQ09OVEVOVF9DT05UQUlORVJfSUQgOiAiamV0c3BlZWRfY29udGVudF9jb250YWluZXJfMDAwMDAwMSIsDQoNCgkvKg0KCSAqIGlmcmFtZXNfIGFycmF5IG9iamVjdCB3aGljaCBzdG9yZSBzdWIgaWZyYW1lcyBvZiBjdXJyZW50IGNvbnRhaW5lci4NCgkgKiBUaGlzIGlzIHRvIGNvbnNpZGVyIHRoYXQgaW4gb3JkZXIgdG8gYXZvaWQgbWVtb3J5IG92ZXJmbG93LHNvIHN0b3JlIGFsbCBzdWIgaWZyYW1lcyBhdCByZWN1cnNpdmUgdHJhdmVyc2Ugc2VhcmNoLg0KCSAqLw0KCWlmcmFtZXNfIDogbmV3IEFycmF5KCksDQoJDQoJdHJlZURpdiA6IG5ldyBBcnJheSgpLA0KCQ0KCXJlZ0V4ZWMgOiAvXlxkKyhcLlxkKyk/KHB4KT8kL2ksLy9qdWRnZSBwYXJhbWV0ZXIgaXMgbnVtYmVyIHR5cGUgb3Igbm90KGluY2x1ZGUgbnVtYmVyIHR5cGUgd2l0Y2ggaGF2ZSBkZWNpbWFsIHBvaW50KS4NCgkNCgljdXJyZW50RG9jIDogZG9jdW1lbnQsDQoJDQoJY2FsbEJhY2tGbiA6IG51bGwsDQoJDQoJYnJvd3NlclR5cGUgOiBudWxsLA0KCQ0KCWRpYWxvZ1NpbXVsYXRpb25JZnJhbWUgOiBudWxsLA0KCQ0KCWluaXQgOiBmdW5jdGlvbigpew0KCQkvL3N0YXJ0IHRvIGFkanVzdCBwYWdlIHdoZW4gcGFnZSBoYXMgZmluaXNoZWQgbG9hZGluZy4NCgkJQWMzNjAuYXR0YWNoRXZlbnQod2luZG93LCJvbmxvYWQiLGZ1bmN0aW9uKCkNCgkJew0KCQkJc2Nyb2xsQmFySXNzdWUucGFnZUFkanVzdCgpOw0KCQl9KTsNCgl9LA0KCQ0KCXBhZ2VBZGp1c3QgOiBmdW5jdGlvbigpew0KCQl0cnl7DQoJCQkvL2NoZWNrIGRvY3VtZW50IHJlYWR5IHN0YXRlDQoJCQlpZih0aGlzLnN0YXJ0V29ya2luZyh0aGlzLmN1cnJlbnREb2MpKQ0KCQkJew0KCQkJCXRoaXMuaW5pdEhvcml6b250YWxTY3JvbGxCYXJQb3NpdGlvbih0aGlzLmN1cnJlbnREb2MsIHRoaXMuY3VycmVudERvYy5ib2R5LCAwKTsNCgkJCQkvKg0KCQkJCSAqIFdlIHJlc2l6ZSBhbGwgc3ViLWNvbnRhaW5lcnMgb2YgdGhlIG1vc3Qgb3V0ZXIgY29udGFpbmVyLGxldCB0aGVtIGhhdmUgbm90IHNjcm9sbCBiYXIuIA0KCQkJCSAqIEl0IHdpbGwgYmUgb2NjdXIgb3V0IG9mIG1lbW9yeSBleGNlcHRpb24gaWYgd2UgcHJvY2VzcyBhbGwgc3ViLWNvbnRhaW5lciBvZiBpZnJhbWVzJyBhdCB0aGlzIHRpbWUuDQoJCQkJICogU28sIHdlIGRvbid0IHByb2Nlc3MgaWZyYW1lIGVsZW1lbnRzIG5vdywganVzdCBwdXQgdGhlbSBpbiBhIGFycmF5IG9iamVjdC4gDQoJCQkJICovDQoJCQkJLy8gUGVmb3JtYW5jZSBSaXNrDQoJCQkJdGhpcy5yZWN1cnNpdmVDYWxjdWxhdGUodGhpcy5jdXJyZW50RG9jLmJvZHkpOw0KCQkJCS8qIHRoZW4sIHdlIHJlc2l6ZSBmcmFtZXNldCdzIGNvbHMgb3Igcm93cy4NCgkJCQkgKiBXZSBnZXQgYWxsIHN1Yi1mcmFtZXMgb2YgdGhlIGZyYW1lc2V0LCBhbmQgY2FsY3VsYXRlIHRoZSBzdW0gb2YgZnJhbWVzJyBoZWlnaHQsIHRha2UgY3VycmVudCBmcmFtZSdzIHNjcm9sbEhlaWdodCAvIHRvdGFsSGVpZ2h0Lg0KCQkJCSAqIGNoYW5nZSByb3dzIHByb3BlcnR5IG9mIGZyYW1lc2V0Lg0KCQkJCSAqLw0KCQkJCXRoaXMuYXV0b1Jlc2l6ZUZyYW1lU2V0KHRoaXMuY3VycmVudERvYyk7DQoJCQkJLy9tYWtlIGhvcml6b250YWwgYXJyYW5nZSBmcmFtZSBpbnNlcGFyYWJsZSBhcnJhbmdlIHRvZ2V0aGVyLg0KCQkJCXRoaXMuYXV0b0FycmFuZ2VGcmFtZXModGhpcy5jdXJyZW50RG9jKTsNCgkJCQkvL3Jlc2l6ZSBpZnJhbWUgYWZ0ZXIgcmVzaXplIGZyYW1lc2V0LldlIGFjY29yZGluZyBib2R5IGNvbnRhaW5lcidzIHNjcm9sbEhlaWdodCB0byByZXNpemUgaWZyYW1lLg0KCQkJCXRoaXMuYXV0b1Jlc2l6ZUlmcmFtZSgpOw0KCQkJCS8vZmluYWxseSwgd2UgcmVzaXplIHRvcCBjb250YWluZXIgYW5kIGN1cnJlbnQgY29udGFpbmVyLg0KCQkJCXRoaXMuYXV0b0FkanVzdE91dGVyQ29udGFpbmVyKHRoaXMuY3VycmVudERvYyk7DQoJCQl9DQoJCX1jYXRjaChlKXt9DQoJfSwNCgkNCglhdXRvQWRqdXN0Rm9yRXJyb3JNc2dEaXNwbGF5IDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJdGhpcy5hdXRvQWRqdXN0Rm9yVGFibGVBZGRPclJlbW92ZVJvd3MoZG9jdW1lbnRfKTsNCgl9LA0KCQ0KCS8vdGhpcyBmdW5jdGlvbiB1c2UgZm9yIHRhYmxlIGFkZC9taW51cyByb3dzIG9jY3VyIHNjcm9sbCBiYXIuDQoJYXV0b0FkanVzdEZvclRhYmxlQWRkT3JSZW1vdmVSb3dzIDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJdHJ5ew0KCQkJLy91c2UgY3VycmVudCBkb2N1bWVudCBpZiBkb2N1bWVudF8gcGFyYW1ldGVyIGlzIG51bGwuDQoJCQlpZighdGhpcy5qdWRnZUlzT2JqKGRvY3VtZW50XykpDQoJCQl7DQoJCQkJZG9jdW1lbnRfID0gdGhpcy5jdXJyZW50RG9jOw0KCQkJfQ0KCQkJLy9yZXNpemUgZnJhbWUNCgkJCXRoaXMuYXV0b1Jlc2l6ZUZyYW1lU2V0KGRvY3VtZW50Xyk7DQoJCQl0aGlzLmF1dG9BcnJhbmdlRnJhbWVzKGRvY3VtZW50Xyk7DQoJCQl0aGlzLmF1dG9BZGp1c3RPdXRlckNvbnRhaW5lcihkb2N1bWVudF8pOw0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJYXV0b0FkanVzdE91dGVyQ29udGFpbmVyIDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJdHJ5ew0KCQkJLy91c2UgY3VycmVudCBkb2N1bWVudCBpZiBkb2N1bWVudF8gcGFyYW1ldGVyIGlzIG51bGwuDQoJCQlpZighdGhpcy5qdWRnZUlzT2JqKGRvY3VtZW50XykpDQoJCQl7DQoJCQkJZG9jdW1lbnRfID0gdGhpcy5jdXJyZW50RG9jOw0KCQkJfQ0KCQkJdGhpcy5hdXRvUmVzaXplQ3VycmVudENvbnRhaW5lcihkb2N1bWVudF8pOw0KCQkJdGhpcy5yZXNpemVJZnJhbWVzQmV0d2VlblRvcEFuZEN1cnJlbnRDb250YWluZXIoZG9jdW1lbnRfKTsNCgkJCXRoaXMuYXV0b1Jlc2l6ZVRvcENvbnRhaW5lcihkb2N1bWVudF8pOw0KCQkJdGhpcy5hdXRvUmVzaXplVHJlZShkb2N1bWVudF8pOw0KCQkJdGhpcy5wb3BVcFdpbmRvd1Byb2Nlc3MoZG9jdW1lbnRfKTsNCgkJCXRoaXMuY2hlY2tSZXN1bHQoZG9jdW1lbnRfKTsNCgkJCXRoaXMuc2ltdWxhdGVEaWFsb2dXaW5kb3coZG9jdW1lbnRfKTsNCgkJCXRoaXMuZXhwYW5zaW9uRnVuKGRvY3VtZW50Xyk7DQoJCQl0aGlzLmV4ZWN1dGVDYWxsQmFjaygpOw0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJLy9yZXNpemUgb3V0ZXIgY29udGFpbmVyIHdoZW4gZG9qbyB0cmVlIGV4cGVuZC9wYWNrIHVwLg0KCWRvam9UcmVlUmVzaXplIDogZnVuY3Rpb24oKXsNCgkJdHJ5ew0KCQkJaWYodGhpcy5zdGFydFdvcmtpbmcodGhpcy5jdXJyZW50RG9jKSkNCgkJCXsNCgkJCQl2YXIgY3VycmVudEZyYW1lID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQodGhpcy5jdXJyZW50RG9jKTsNCgkJCQlpZih0aGlzLmp1ZGdlSXNJZ25vcmVBbGxPclNlbGYoY3VycmVudEZyYW1lKSkNCgkJCQl7DQoJCQkJCXJldHVybjsNCgkJCQl9DQoJCQkJaWYodGhpcy5pc1RhcmdldE9ialR5cGUoY3VycmVudEZyYW1lLCAiRlJBTUUiKSkNCgkJCQl7DQoJCQkJCXZhciBmcmFtZXNldF8gPSBjdXJyZW50RnJhbWUucGFyZW50Tm9kZTsNCgkJCQkJLy93aGVuIHRoZSB0cmVlJ3MgZnJhbWUgd2FzIHZlcnRpY2FsIGFycmFuZ2VtZW50LCB3ZSBuZWVkbid0IGFueSByZXNpemUuIEJlY2F1c2UgcG9ydGxlIGhhcyBkZWZhdWx0IGhlaWdodC4NCgkJCQkJaWYoZnJhbWVzZXRfLnJvd3MgIT0gIiIpDQoJCQkJCXsNCgkJCQkJCWN1cnJlbnRGcmFtZS5pc0hvcml6b250YWxUcmVlID0gdHJ1ZTsNCgkJCQkJfQ0KCQkJCQllbHNlIGlmKGZyYW1lc2V0Xy5jb2xzICE9ICIiKQ0KCQkJCQl7DQoJCQkJCQljdXJyZW50RnJhbWUuaXNMZWZ0VHJlZSA9IHRydWU7DQoJCQkJCX0NCgkJCQkJdGhpcy5hdXRvUmVzaXplRnJhbWVTZXQodGhpcy5jdXJyZW50RG9jKTsNCgkJCQkJdGhpcy5hdXRvQXJyYW5nZUZyYW1lcyh0aGlzLmN1cnJlbnREb2MpOw0KCQkJCQl0aGlzLnJlc2l6ZUlmcmFtZXNCZXR3ZWVuVG9wQW5kQ3VycmVudENvbnRhaW5lcih0aGlzLmN1cnJlbnREb2MpOw0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQl0aGlzLmF1dG9BZGp1c3RPdXRlckNvbnRhaW5lcih0aGlzLmN1cnJlbnREb2MpOw0KCQkJCX0NCgkJCX0NCgkJfWNhdGNoKGUpe30NCgl9LA0KCQ0KCS8vIHJlc2l6ZSBjdXJyZW50IGNvbnRhaW5lcg0KCWF1dG9SZXNpemVDdXJyZW50Q29udGFpbmVyIDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJdHJ5ew0KCQkJdGhpcy5yZXNpemVJZnJhbWUodGhpcy5nZXRGcmFtZUVsZW1lbnQoZG9jdW1lbnRfKSk7DQoJCX1jYXRjaChlKXt9DQoJfSwNCgkNCgkvLyByZXNpemUgdG9wIGNvbnRhaW5lcg0KCWF1dG9SZXNpemVUb3BDb250YWluZXIgOiBmdW5jdGlvbihkb2N1bWVudF8pew0KCQl2YXIgdG9wSWZyYW1lID0gdGhpcy5maW5kVG9wSWZyYW1lKGRvY3VtZW50Xyk7DQoJCXRoaXMucmVzaXplSWZyYW1lKHRvcElmcmFtZSk7DQoJfSwNCgkNCglkZWZhdWx0VG9wSWZyYW1lU2l6ZSA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCXZhciBoZWlnaHQ7DQoJCS8vQmVjYXVzZSB0aGUgc3RydWN0dXJlIGlzIGRpZmZlcmVudCBpbiBuZXcgYW5kIG9sZCBmZWF0dXJlLg0KCQlpZih0aGlzLmlzQUFfQ2xhc3NpYygpKQ0KCQl7DQoJCQloZWlnaHQgPSB0aGlzLmRlZmF1bHRUb3BJZnJhbWVIZWlnaHRfQUFfQ2xhc3NpYygpOw0KCQl9DQoJCWVsc2UNCgkJew0KCQkJaGVpZ2h0ID0gdGhpcy5kZWZhdWx0VG9wSWZyYW1lSGVpZ2h0KGRvY3VtZW50Xyk7DQoJCX0NCgkJcmV0dXJuIHRoaXMuanVkZ2VJc051bGwoaGVpZ2h0KSA/IDgwMCA6IGhlaWdodDsNCgl9LA0KCQ0KCWRlZmF1bHRUb3BJZnJhbWVIZWlnaHRfQUFfQ2xhc3NpYyA6IGZ1bmN0aW9uKCl7DQoJCXZhciBzY3JlZW5faGVpZ2h0ID0gdG9wLmRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0Oy8vdG9wIHdpbmRvdydzIGhlaWdodA0KCQl2YXIgYWFfY2xhc3NpY19zcGFjZXJfZGl2ID0gdG9wLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJTcGFjZXIiKTsNCgkJaWYodGhpcy5pc1RhcmdldE9ialR5cGUoYWFfY2xhc3NpY19zcGFjZXJfZGl2LCAiRElWIikpDQoJCXsNCgkJCXZhciB0YWJsZXMgPSBuZXcgQXJyYXkoKTsNCgkJCXZhciBuZXh0U2libGluZ19vYmogPSBhYV9jbGFzc2ljX3NwYWNlcl9kaXYubmV4dEVsZW1lbnRTaWJsaW5nOw0KCQkJd2hpbGUoIXRoaXMuanVkZ2VJc051bGwobmV4dFNpYmxpbmdfb2JqKSkNCgkJCXsNCgkJCQlpZih0aGlzLmp1ZGdlSXNPYmoobmV4dFNpYmxpbmdfb2JqKSAmJiBuZXh0U2libGluZ19vYmoubm9kZU5hbWUgPT0gIlRBQkxFIikNCgkJCQl7DQoJCQkJCXRhYmxlc1t0YWJsZXMubGVuZ3RoXSA9IG5leHRTaWJsaW5nX29iajsNCgkJCQl9DQoJCQkJbmV4dFNpYmxpbmdfb2JqID0gbmV4dFNpYmxpbmdfb2JqLm5leHRFbGVtZW50U2libGluZzsNCgkJCX0NCgkJCWZvcih2YXIgaW5kZXggPSAwIDsgaW5kZXggPCB0YWJsZXMubGVuZ3RoIC0xIDsgaW5kZXgrKykNCgkJCXsNCgkJCQlzY3JlZW5faGVpZ2h0IC09IHRhYmxlc1tpbmRleF0uc2Nyb2xsSGVpZ2h0Ow0KCQkJfQ0KCQl9DQoJCXJldHVybiBzY3JlZW5faGVpZ2h0ICogOSAvIDEwOw0KCX0sDQoJDQoJZGVmYXVsdFRvcElmcmFtZUhlaWdodCA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCXZhciB0b3BJZnJhbWUgPSB0aGlzLmZpbmRUb3BJZnJhbWUoZG9jdW1lbnRfKTsNCgkJaWYodGhpcy5qdWRnZUlzT2JqKHRvcElmcmFtZSkpDQoJCXsNCgkJCXZhciBiZF9kaXYgPSB0b3BJZnJhbWU7DQoJCQkvL1dlIGhhZCBjb25zaWRlcmVkIHBlcmZvcm1hbmNlIHByb2JsZW0gYW5kIHRoZSBzdHJ1Y3R1cmUgd2FzIGZpeGVkLCBzbyBkZWZpbmUgaW5kZXggbGVzcyB0aGFuIDUuIA0KCQkJZm9yKHZhciBpbmRleCA9IDA7IGluZGV4IDwgNSA7IGluZGV4KyspDQoJCQl7DQoJCQkJYmRfZGl2ID0gYmRfZGl2LnBhcmVudE5vZGU7DQoJCQl9DQoJCQl2YXIgaGRfZGl2ID0gYmRfZGl2LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7DQoJCQl2YXIgZnRfZGl2ID0gYmRfZGl2Lm5leHRFbGVtZW50U2libGluZzsNCgkJCXZhciB0b3BfdGFibGUgPSBiZF9kaXY7DQoJCQkvL1dlIGhhZCBjb25zaWRlcmVkIHBlcmZvcm1hbmNlIHByb2JsZW0gYW5kIHRoZSBzdHJ1Y3R1cmUgd2FzIGZpeGVkLCBzbyBkZWZpbmUgaW5kZXggbGVzcyB0aGFuIDE3LiANCgkJCWZvcih2YXIgaW5kZXggPSAwO2luZGV4IDwgMTcgOyBpbmRleCsrKQ0KCQkJew0KCQkJCS8vdG9wX3RhYmxlIHdpbGwgYmUgbnVsbCB3aGVuIHRoZSBwb3J0bGV0IG1heC1zaXplLg0KCQkJCWlmKHRvcF90YWJsZSkNCgkJCQl7CQkJCQkJDQoJCQkJCXRvcF90YWJsZSA9IHRvcF90YWJsZS5wYXJlbnROb2RlOw0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlyZXR1cm47DQoJCQkJfQ0KCQkJfQ0KCQkJdmFyIHRycyA9IHRvcF90YWJsZS5jaGlsZHJlblswXS5jaGlsZHJlbjsNCgkJCXZhciBzdW1faGVpZ2h0ID0gMDsNCgkJCWZvcih2YXIgaW5kZXggPSB0cnMubGVuZ3RoIC0yOyBpbmRleCA+PSAwIDtpbmRleC0tKQ0KCQkJew0KCQkJCXN1bV9oZWlnaHQgKz0gdHJzW2luZGV4XS5zY3JvbGxIZWlnaHQ7DQoJCQl9DQoJCQkvL1RoZSByZWFzb24gd2h5IHdlIHJlZHVjZSAxOCBpcyB0aGF0IHNvbWUgY29udGFpbmVyIGhhZCBzZXQgcGFkZGluZyBzdHlsZSBhbmQgYm9yZGVyIHN0eWxlLg0KCQkJdmFyIGRlZmF1bHRIZWlnaHQgID0gdG9wLnNjcmVlbi5hdmFpbEhlaWdodCAtIHN1bV9oZWlnaHQgLSBoZF9kaXYuc2Nyb2xsSGVpZ2h0IC0gZnRfZGl2LnNjcm9sbEhlaWdodDsNCgkJCXJldHVybiBkZWZhdWx0SGVpZ2h0Ow0KCQl9DQoJfSwNCg0KCS8vdGhpcyBmdW5jdGlvbiBvbmx5IHByb3ZpZGUgc2VydmljZSBmb3IgcG9wLXVwIHdpbmRvdy4NCglhdXRvUmVzaXplUG9wVXBGcmFtZSA6IGZ1bmN0aW9uKGZyYW1lc2V0TmFtZSl7DQoJCXRyeQ0KCQl7DQoJCQl2YXIgZnJhbWVMYXlvdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZXNldE5hbWUpOw0KCQkJdmFyIGNfbiA9IGZyYW1lTGF5b3V0LmNoaWxkTm9kZXM7DQoJCQlpZihjX24gJiYgY19uLmxlbmd0aCA+IDApDQoJCQl7DQoJCQkJZm9yKHZhciBpbmRleCA9IDA7IGluZGV4IDwgY19uLmxlbmd0aCA7IGluZGV4KyspDQoJCQkJew0KCQkJCQl2YXIgY19vYmogPSBjX25baW5kZXhdOw0KCQkJCQlpZihjX29iaiAmJiBjX29iai5ub2RlTmFtZSA9PSAiRlJBTUUiKQ0KCQkJCQl7DQoJCQkJCQl2YXIgZG9jdW1lbnRfID0gdGhpcy5nZXREb2N1bWVudEZyb21GcmFtZShjX29iaik7DQoJCQkJCQl0aGlzLmF1dG9SZXNpemVGcmFtZVNldChkb2N1bWVudF8pOw0KCQkJCQkJdGhpcy5hdXRvQXJyYW5nZUZyYW1lcyhkb2N1bWVudF8pOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJYXV0b1Jlc2l6ZVBvcFVwQ29udGFpbmVyIDogZnVuY3Rpb24oZG9jdW1lbnRfLHRhcmdldElkLCBrZXkpew0KCQl0cnl7DQoJCQkvL3VzZSBjdXJyZW50IGRvY3VtZW50IGlmIGRvY3VtZW50XyBwYXJhbWV0ZXIgaXMgbnVsbC4NCgkJCWlmKCF0aGlzLmp1ZGdlSXNPYmooZG9jdW1lbnRfKSkNCgkJCXsNCgkJCQlkb2N1bWVudF8gPSB0aGlzLmN1cnJlbnREb2M7DQoJCQl9DQoJCQl2YXIgZmUgPSB0aGlzLmdldEZyYW1lRWxlbWVudChkb2N1bWVudF8pOwkNCgkJCXZhciB0YXJnZXRPYmogPSBkb2N1bWVudF8uZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpOw0KCQkJaWYodGhpcy5pc0Zsb2F0RWxlbWVudChkb2N1bWVudF8sIHRhcmdldE9iaikgJiYgdGhpcy52YWxpZGF0ZUxvY2tlZEtleShmZSwga2V5KSkNCgkJCXsNCgkJCQlpZighdGhpcy5qdWRnZUlzSGlkZGVuKHRhcmdldE9iaikgJiYgIXRoaXMuanVkZ2VJc0lnbm9yZUFsbE9yU2VsZihmZSkpDQoJCQkJew0KCQkJCQl2YXIgbWF4X3ZhbHVlID0gdGhpcy5maW5kU3ViTm9kZXNNYXhWYWx1ZShkb2N1bWVudF8uYm9keSk7DQoJCQkJCXZhciB0YXJnZXRPYmpfaGVpZ2h0ID0gdGhpcy5nZXRPZmZzZXRIZWlnaHQoZG9jdW1lbnRfLCB0YXJnZXRPYmopOw0KCQkJCQlpZih0YXJnZXRPYmpfaGVpZ2h0IDwgKG1heF92YWx1ZS5vdmVyZmxvd194ID8gZmUuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5TQ1JPTExfQkFSX1NJWkUgOiAgZmUuc2Nyb2xsSGVpZ2h0KSkNCgkJCQkJew0KCQkJCQkJcmV0dXJuOw0KCQkJCQl9DQoJCQkJCWlmKHRoaXMuanVkZ2VJc05vdE51bGwobWF4X3ZhbHVlKSkNCgkJCQkJew0KCQkJCQkJdmFyIGN1cnJlbnRfYm9keV9oZWlnaHQgPSBtYXhfdmFsdWUub3ZlcmZsb3dfeCA/IGZlLnNjcm9sbEhlaWdodCAtIHRoaXMuU0NST0xMX0JBUl9TSVpFIDogZmUuc2Nyb2xsSGVpZ2h0OwkNCgkJCQkJCQ0KCQkJCQkJaWYodGFyZ2V0T2JqX2hlaWdodCA+IGN1cnJlbnRfYm9keV9oZWlnaHQpDQoJCQkJCQl7DQoJCQkJCQkJaWYoZmUubm9kZU5hbWUgPT0gIkZSQU1FIikNCgkJCQkJCQl7DQoJCQkJCQkJCW1heF92YWx1ZS5tYXhfaGVpZ2h0ID0gdGFyZ2V0T2JqX2hlaWdodDsNCgkJCQkJCQkJdmFyIGZyYW1lc2V0XyA9IGZlLnBhcmVudE5vZGU7DQoJCQkJCQkJCXRoaXMucmVzaXplRnJhbWVzZXQoZnJhbWVzZXRfLCBmZSwgbWF4X3ZhbHVlKTsNCgkJCQkJCQkJaWYoZnJhbWVzZXRfLmNvbHMgIT0gIiIpDQoJCQkJCQkJCXsNCgkJCQkJCQkJCXZhciBmaXJzdFBhcmVudElmcmFtZSA9IHRoaXMuZmluZEZpcnN0UGFyZW50SWZyYW1lKGRvY3VtZW50Xyk7DQoJCQkJCQkJCQl2YXIgaGVpZ2h0VmFsdWUgPSBtYXhfdmFsdWUub3ZlcmZsb3dfeCA/IHRhcmdldE9ial9oZWlnaHQgKyB0aGlzLlNDUk9MTF9CQVJfU0laRSA6IHRhcmdldE9ial9oZWlnaHQ7DQoJCQkJCQkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KGZpcnN0UGFyZW50SWZyYW1lLCBoZWlnaHRWYWx1ZSk7DQoJCQkJCQkJCQlkb2N1bWVudF8gPSB0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKGZpcnN0UGFyZW50SWZyYW1lKTsNCgkJCQkJCQkJCWZlID0gZmlyc3RQYXJlbnRJZnJhbWU7DQoJCQkJCQkJCX0NCgkJCQkJCQl9DQoJCQkJCQkJZWxzZSBpZihmZS5ub2RlTmFtZSA9PSAiSUZSQU1FIikNCgkJCQkJCQl7DQoJCQkJCQkJCWlmKCF0aGlzLmp1ZGdlSXNOdWxsKG1heF92YWx1ZSkgJiYgbWF4X3ZhbHVlLm92ZXJmbG93X3gpDQoJCQkJCQkJCXsNCgkJCQkJCQkJCXRhcmdldE9ial9oZWlnaHQgKz0gdGhpcy5TQ1JPTExfQkFSX1NJWkU7DQoJCQkJCQkJCX0NCgkJCQkJCQkJdGhpcy5zZXRTdHlsZUhlaWdodChmZSwgdGFyZ2V0T2JqX2hlaWdodCk7DQoJCQkJCQkJfQ0KCQkJCQkJCXRoaXMuc2V0SWdub3JlU2VsZihmZSk7DQoJCQkJCQkJLyoNCgkJCQkJCQkgKiBhZGQgdGhpcyBhdHRyaWJ1dGUgaXMgb3JkZXIgdG8gYXZvaWQgd3JvbmcgdG8gcmVtb3ZlIGluaGVyZW50IGlnbm9yZSBhdHRyaWJ1dGUuDQoJCQkJCQkJICovDQoJCQkJCQkJZmUucG9wVXBBZGRJZ25vcmUgPSB0cnVlOw0KCQkJCQkJCWZlLmxvY2tlZEtleSA9IHRoaXMuZ2V0UmFuZG9tU3RyaW5nKCk7DQoJCQkJCQkJaWYoIXRoaXMuaXNUb3BJZnJhbWUoZmUpKQ0KCQkJCQkJCXsNCgkJCQkJCQkJdGhpcy5yZXNpemVJZnJhbWVzQmV0d2VlblRvcEFuZEN1cnJlbnRDb250YWluZXIoZG9jdW1lbnRfKTsNCgkJCQkJCQkJdGhpcy5hdXRvUmVzaXplVG9wQ29udGFpbmVyKGRvY3VtZW50Xyk7DQoJCQkJCQkJfQ0KCQkJCQkJCS8vcmVzb2x2ZSBtdWx0aXBsZSBpbnZvY2F0aW9uIGlzc3VlDQoJCQkJCQkJcmV0dXJuIGZlLmxvY2tlZEtleTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJCQllbHNlIGlmKHRoaXMuanVkZ2VJc0hpZGRlbih0YXJnZXRPYmopICYmIHRoaXMuanVkZ2VJc1BvcFVwSWdub3JlKGZlKSkNCgkJCQl7DQoJCQkJCWlmKGZlLnBhcmVudE5vZGUuY29scyAhPSAiIikNCgkJCQkJew0KCQkJCQkJZmUgPSB0aGlzLmZpbmRGaXJzdFBhcmVudElmcmFtZShkb2N1bWVudF8pOw0KCQkJCQl9DQoJCQkJCXRoaXMucmVtb3ZlSWdub3JlKGZlKTsNCgkJCQkJdGhpcy5yZW1vdmVMb2NrZWRLZXkoZmUpOw0KCQkJCQlpZihmZS5ub2RlTmFtZSA9PSAiRlJBTUUiKQ0KCQkJCQl7DQoJCQkJCQl0aGlzLmF1dG9SZXNpemVGcmFtZVNldChkb2N1bWVudF8pOw0KCQkJCQkJdGhpcy5hdXRvQXJyYW5nZUZyYW1lcyhkb2N1bWVudF8pOw0KCQkJCQl9DQoJCQkJCXRoaXMuYXV0b0FkanVzdE91dGVyQ29udGFpbmVyKGRvY3VtZW50Xyk7DQoJCQkJfQ0KCQkJfQ0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJLy9yZXNpemUgZnJhbWUgZWxlbWVudHMNCglhdXRvUmVzaXplRnJhbWVTZXQgOiBmdW5jdGlvbihkb2N1bWVudF8pew0KCQl0cnl7DQoJCQl2YXIgZnJhbWVfZWxlID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQoZG9jdW1lbnRfKTsvL2dldCBjdXJyZW50IHdpbmRvdydzIGZyYW1lIGVsZW1lbnQNCgkJCWlmKHRoaXMuaXNUYXJnZXRPYmpUeXBlKGZyYW1lX2VsZSwgIkZSQU1FIikpDQoJCQl7DQoJCQkJLy9JZiBhdHRyaWJ1dGUgaWdub3JlIGV4aXN0LCBkb24ndCByZXNpemUgYW5kIHJldHVybi4NCgkJCQl2YXIgaWdub3JlQXR0ciA9IHRoaXMuZ2V0QXR0cmlidXRlKGZyYW1lX2VsZSAsICJpZ25vcmUiKTsNCgkJCQlpZih0aGlzLmp1ZGdlSXNOb3ROdWxsKGlnbm9yZUF0dHIpKQ0KCQkJCXsNCgkJCQkJcmV0dXJuOw0KCQkJCX0NCgkJCQl2YXIgZnJhbWVzZXRfID0gZnJhbWVfZWxlLnBhcmVudE5vZGU7Ly9maW5kIGN1cnJlbnQgZnJhbWUncyBmcmFtZXNldCBlbGVtZW50DQoJCQkJdGhpcy5yZXNpemVGcmFtZXNldChmcmFtZXNldF8sZnJhbWVfZWxlKTsNCgkJCQl2YXIgcGFyZW50XyA9ICB0aGlzLnJlc2l6ZVBhcmVudEZyYW1lc2V0KGZyYW1lc2V0Xy5wYXJlbnROb2RlKTsNCgkJCQlpZih0aGlzLmp1ZGdlSXNPYmoocGFyZW50XykpDQoJCQkJew0KCQkJCQlpZ25vcmVBdHRyID0gdGhpcy5nZXRBdHRyaWJ1dGUoZnJhbWVfZWxlICwgImlnbm9yZSIpOw0KCQkJCQlpZih0aGlzLmp1ZGdlSXNOdWxsKGlnbm9yZUF0dHIpKQ0KCQkJCQl7DQoJCQkJCQl2YXIgdG90YWxIZWlnaHQgPSB0aGlzLmZyYW1lc1RvdGFsSGVpZ2h0KGZyYW1lc2V0XyxmcmFtZV9lbGUpOw0KCQkJCQkJaWYodG90YWxIZWlnaHQgIT0gMCkNCgkJCQkJCXsNCgkJCQkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KHBhcmVudF8sdG90YWxIZWlnaHQpOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJLy9yZXNpemUgcGFyZW50IGZyYW1lc2V0IGFuZCByZXR1cm4gZmlyc3QgaWZyYW1lIGVsZW1lbnQNCglyZXNpemVQYXJlbnRGcmFtZXNldDogZnVuY3Rpb24ocGFyZW50Xyl7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihwYXJlbnRfKSkNCgkJew0KCQkJd2hpbGUocGFyZW50Xy5ub2RlTmFtZSAhPSAiSUZSQU1FIikNCgkJCXsNCgkJCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShwYXJlbnRfLCAiRlJBTUUiKSkNCgkJCQl7DQoJCQkJCXRoaXMucmVzaXplRnJhbWVzZXQocGFyZW50Xy5wYXJlbnROb2RlLHBhcmVudF8pOw0KCQkJCX0NCgkJCQlpZighdGhpcy5qdWRnZUlzTnVsbChwYXJlbnRfLnBhcmVudFdpbmRvdykgJiYgIXRoaXMuanVkZ2VJc051bGwocGFyZW50Xy5wYXJlbnRXaW5kb3cuZnJhbWVFbGVtZW50KSAmJiBwYXJlbnRfLm5vZGVOYW1lID09ICIjZG9jdW1lbnQiKQ0KCQkJCXsNCgkJCQkJcGFyZW50XyA9IHBhcmVudF8ucGFyZW50V2luZG93LmZyYW1lRWxlbWVudDsNCgkJCQl9DQoJCQkJZWxzZSBpZih0aGlzLmp1ZGdlSXNOb3ROdWxsKHBhcmVudF8ucGFyZW50Tm9kZSkpDQoJCQkJewkJCQkJDQoJCQkJCXBhcmVudF8gPSBwYXJlbnRfLnBhcmVudE5vZGU7CQkJCQkJCQ0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlyZXR1cm4gbnVsbDsNCgkJCQl9DQoJCQl9DQoJCQlyZXR1cm4gcGFyZW50XzsNCgkJfQ0KCQlyZXR1cm4gbnVsbDsNCgl9LA0KCQ0KCS8vcmVzaXplIGZyYW1lc2V0IGVsZW1lbnQNCglyZXNpemVGcmFtZXNldCA6IGZ1bmN0aW9uKGZyYW1lc2V0XyxmcmFtZV9lbGUsbWF4X3ZhbHVlXyl7DQoJCXZhciBtYXhWYWx1ZSA9IHRoaXMuanVkZ2VJc051bGwobWF4X3ZhbHVlXykgPyB0aGlzLmZpbmRTdWJOb2Rlc01heFZhbHVlKHRoaXMuZ2V0RG9jdW1lbnRGcm9tRnJhbWUoZnJhbWVfZWxlKS5ib2R5KSA6IG1heF92YWx1ZV87DQoJCWlmKHRoaXMuanVkZ2VJc05vdE51bGwobWF4VmFsdWUpKQ0KCQl7DQoJCQltYXhWYWx1ZS5tYXhfaGVpZ2h0ID0gbWF4VmFsdWUub3ZlcmZsb3dfeCA/IG1heFZhbHVlLm1heF9oZWlnaHQgKyB0aGlzLlNDUk9MTF9CQVJfU0laRSA6IG1heFZhbHVlLm1heF9oZWlnaHQ7DQoJCQl2YXIgcm93c19zdHIgPSBmcmFtZXNldF8ucm93czsNCgkJCS8vcmVzaXplIGZyYW1lc2V0IGhlaWdodA0KCQkJaWYocm93c19zdHIgIT0gIiIpDQoJCQl7DQoJCQkJdmFyIHJvd3NfYXJyYXkgPSByb3dzX3N0ci5zcGxpdCgiLCIpOw0KCQkJCXZhciBmcmFtZUxldmVsXyA9IHRoaXMuZnJhbWVMZXZlbChmcmFtZV9lbGUpOw0KCQkJCXJvd3NfYXJyYXlbZnJhbWVMZXZlbF8ubGV2ZWxdID0gbWF4VmFsdWUubWF4X2hlaWdodDsJCQkJCQkNCgkJCQlyb3dzX3N0ciA9ICIiOw0KCQkJCWZvcih2YXIgaW5kZXggPSAwOyBpbmRleCA8IHJvd3NfYXJyYXkubGVuZ3RoIDsgaW5kZXgrKykNCgkJCQl7DQoJCQkJCXJvd3Nfc3RyICs9ICIsIityb3dzX2FycmF5W2luZGV4XTsNCgkJCQl9DQoJCQkJZnJhbWVzZXRfLnJvd3MgPSByb3dzX3N0ci5zdWJzdHJpbmcoMSxyb3dzX3N0ci5sZW5ndGgpOwkNCgkJCX0NCgkJfQ0KCX0sDQoJDQoJLy8gbWFrZSBob3Jpem9udGFsIGFycmFuZ2UgZnJhbWUgaW5zZXBhcmFibGUgYXJyYW5nZSB0b2dldGhlci4NCglhdXRvQXJyYW5nZUZyYW1lcyA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJICAgdmFyIGZyYW1lXyA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50KGRvY3VtZW50Xyk7DQoJICAgaWYodGhpcy5pc1RhcmdldE9ialR5cGUoZnJhbWVfLCAiRlJBTUUiKSkNCgkgICB7DQoJCSAgIHZhciBpZ25vcmVBdHRyID0gdGhpcy5nZXRBdHRyaWJ1dGUoZnJhbWVfLCAiaWdub3JlIik7DQoJCSAgIGlmKHRoaXMuanVkZ2VJc051bGwoaWdub3JlQXR0cikpDQoJCSAgIHsNCgkJCSAgIHZhciBmcmFtZXNldF8gPSBmcmFtZV8ucGFyZW50Tm9kZTsNCgkJCSAgIGlmKHRoaXMuanVkZ2VJc05vdE51bGwoZnJhbWVzZXRfLnJvd3MpKQ0KCQkJICAgew0KCQkJCSAgdmFyIGZyYW1lcyA9ICBmcmFtZXNldF8uY2hpbGROb2RlczsNCgkJCQkgIHZhciBtYXhWYWx1ZUFycmF5ID0gbmV3IEFycmF5KCk7DQoJCQkJICB2YXIgZnJhbWVBcnJheSA9IG5ldyBBcnJheSgpOw0KCQkJCSAgdmFyIHN1bV9oZWlnaHQgPSAwOw0KCQkJCSAgdmFyIHNjcm9sbEJhck51bSA9IDA7DQoJCQkJICBmb3IgKCB2YXIgaW5kZXggPSAwOyBpbmRleCA8IGZyYW1lcy5sZW5ndGg7IGluZGV4KyspIA0KCQkJCSAgew0KCQkJCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShmcmFtZXNbaW5kZXhdLCAiRlJBTUUiKSkNCgkJCQkJew0KCQkJCQkJZnJhbWVBcnJheVtmcmFtZUFycmF5Lmxlbmd0aF0gPSBmcmFtZXNbaW5kZXhdOw0KCQkJCQkJdmFyIG1heFZhbHVlID0gdGhpcy5maW5kU3ViTm9kZXNNYXhWYWx1ZSh0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKGZyYW1lc1tpbmRleF0pLmJvZHkpOw0KCQkJCQkJaWYodGhpcy5qdWRnZUlzTm90TnVsbChtYXhWYWx1ZSkpDQoJCQkJCQl7DQoJCQkJCQkJbWF4VmFsdWVBcnJheVttYXhWYWx1ZUFycmF5Lmxlbmd0aF0gPSBtYXhWYWx1ZTsNCgkJCQkJCQlzY3JvbGxCYXJOdW0gKz0gbWF4VmFsdWUub3ZlcmZsb3dfeCA/IDEgOiAwOw0KCQkJCQkJCXN1bV9oZWlnaHQgKz0gKG1heFZhbHVlLm92ZXJmbG93X3ggPyBtYXhWYWx1ZS5tYXhfaGVpZ2h0ICsgdGhpcy5TQ1JPTExfQkFSX1NJWkUgOiBtYXhWYWx1ZS5tYXhfaGVpZ2h0KTsNCgkJCQkJCX0NCgkJCQkJIH0NCgkJCQkgIH0NCgkJCQkgIHZhciBkZWZhdWx0SGVpZ2h0ID0gdGhpcy5kZWZhdWx0VG9wSWZyYW1lU2l6ZShkb2N1bWVudF8pOw0KCQkJCSAgaWYoZGVmYXVsdEhlaWdodCA+IHN1bV9oZWlnaHQgJiYgbWF4VmFsdWVBcnJheS5sZW5ndGggPT0gZnJhbWVBcnJheS5sZW5ndGgpDQoJCQkJICB7DQoJCQkJCXZhciBmaW5kTGFzdElzTm90WmVybyA9IGZhbHNlOw0KCQkJCQlmb3IgKCB2YXIgaW5kZXgyID0gbWF4VmFsdWVBcnJheS5sZW5ndGggLSAxIDsgaW5kZXgyID4gMCA7IGluZGV4Mi0tKSANCgkJCQkJew0KCQkJCQkJaWYobWF4VmFsdWVBcnJheVtpbmRleDJdLm1heF9oZWlnaHQgPiAwICYmICFmaW5kTGFzdElzTm90WmVybykNCgkJCQkJCXsNCgkJCQkJCQltYXhWYWx1ZUFycmF5W2luZGV4Ml0ubWF4X2hlaWdodCArPSBkZWZhdWx0SGVpZ2h0IC0gc3VtX2hlaWdodCArIHNjcm9sbEJhck51bSAqIHRoaXMuU0NST0xMX0JBUl9TSVpFOw0KCQkJCQkJCWZpbmRMYXN0SXNOb3RaZXJvID0gdHJ1ZTsNCgkJCQkJCX0NCgkJCQkJCXRoaXMucmVzaXplRnJhbWVzZXQoZnJhbWVzZXRfLCBmcmFtZUFycmF5W2luZGV4Ml0sIG1heFZhbHVlQXJyYXlbaW5kZXgyXSk7DQoJCQkJCX0NCgkJCQkgfQ0KCQkJCSBlbHNlDQoJCQkJIHsNCgkJCQkJIGZvciAoIHZhciBpbmRleDMgPSAwOyBpbmRleDMgPCBmcmFtZUFycmF5Lmxlbmd0aDsgaW5kZXgzKyspIA0KCQkJCQkgew0KCQkJCQkJdGhpcy5yZXNpemVGcmFtZXNldChmcmFtZXNldF8sIGZyYW1lQXJyYXlbaW5kZXgzXSk7DQoJCQkJCSB9DQoJCQkJIH0NCgkJCQkgdGhpcy5yZXNpemVQYXJlbnRGcmFtZXNldChmcmFtZXNldF8ucGFyZW50Tm9kZSk7DQoJCQkgIH0NCgkJICAgfQ0KCSAgIH0NCgl9LA0KCQ0KCS8qDQoJICogY2FsY3VsYXRlIGN1cnJlbnQgZnJhbWUncyBsZXZlbA0KCSAqICJsZXZlbCIgbWVhbiBjdXJyZW50IGZyYW1lJ3Mgc2VxdWVuY2UuDQoJICovDQoJZnJhbWVMZXZlbCA6IGZ1bmN0aW9uKGZyYW1lX2VsZSl7DQoJCXZhciBsZXZlbD0wOyANCgkJdmFyIHBfZnJhbWUgPSB0aGlzLmdldFByZXZpb3VzRWxlbWVudChmcmFtZV9lbGUpOw0KCQl3aGlsZSghdGhpcy5qdWRnZUlzTnVsbChwX2ZyYW1lKSAmJiBwX2ZyYW1lLm5vZGVOYW1lID09ICJGUkFNRSIpDQoJCXsNCgkJCWxldmVsKys7DQoJCQlwX2ZyYW1lID0gdGhpcy5nZXRQcmV2aW91c0VsZW1lbnQocF9mcmFtZSk7DQoJCX0NCgkJdmFyIGZyYW1lc2V0XyA9IGZyYW1lX2VsZS5wYXJlbnROb2RlOw0KCQl2YXIgdG90YWxGcmFtZXMgPSBmcmFtZXNldF8uY29scyAhPSAiIiA/IGZyYW1lc2V0Xy5jb2xzLnNwbGl0KCIsIikubGVuZ3RoIDogZnJhbWVzZXRfLnJvd3Muc3BsaXQoIiwiKS5sZW5ndGg7DQoJCXJldHVybiB7ImxldmVsIiA6IGxldmVsLCJpc0xhc3RMZXZlbCIgOiAobGV2ZWwrMSkgPT0gdG90YWxGcmFtZXN9Ow0KCX0sDQoJLyoNCgkgKiBHZXQgdGhlIHByZXZpb3VzIGVsZW1lbnQuIA0KCSAqIHByZXZpb3VzRWxlbWVudFNpYmxpbmc6IGNhbm5vdCBzdXBwb3J0IElFOA0KCSAqICovDQoJZ2V0UHJldmlvdXNFbGVtZW50IDogZnVuY3Rpb24oZWxlbWVudCkNCgl7DQoJCXZhciBwcmVfZnJhbWU7DQoJCXRyeQ0KCQl7DQoJCQlwcmVfZnJhbWUgPSBlbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7DQoJCQlpZih0aGlzLmp1ZGdlSXNOdWxsKHByZV9mcmFtZSkpDQoJCQl7DQoJCQkJcHJlX2ZyYW1lID0gZWxlbWVudC5wcmV2aW91c1NpYmxpbmcNCgkJCX0NCgkJfQ0KCQljYXRjaChlKXsNCgkJCXByZV9mcmFtZSA9IGVsZW1lbnQucHJldmlvdXNTaWJsaW5nDQoJCX0NCgkJcmV0dXJuIHByZV9mcmFtZTsNCgl9LA0KCQ0KCS8vY2FsY3VsYXRlIHRoZSBzdW0gb2YgZnJhbWVzJyBoZWlnaHQgb2YgZnJhbWVzZXQNCglmcmFtZXNUb3RhbEhlaWdodCA6IGZ1bmN0aW9uKGZyYW1lc2V0XyxjdXJyZW50RnJhbWVfKXsNCgkJaWYoZnJhbWVzZXRfLnJvd3MgIT0gIiIpDQoJCXsNCgkJCXZhciBzdW0gPSB0aGlzLmNhbGN1bGF0ZUZyYW1lc2V0Um93c1N1bShmcmFtZXNldF8pOw0KCQkJLy8jIyMjIyMjIyMjIyMjI3RoZXNlIGNvZGVzIGFyZSB0byBzZXQgcG9ydGxldCBkZWZhdWx0IGhlaWdodCB3aGljaCBjdXJyZW50IGhvcml6b250YWwgZnJhbWUgaXMgYSB0cmVlIyMjIyMjIyMjIyMjIyMjIw0KCQkJaWYodGhpcy5qdWRnZUlzT2JqKGN1cnJlbnRGcmFtZV8pICYmIGN1cnJlbnRGcmFtZV8ubm9kZU5hbWUgPT0gIkZSQU1FIikNCgkJCXsNCgkJCQl2YXIgaXNIb3Jpem9udGFsVHJlZSA9IHRoaXMuZ2V0QXR0cmlidXRlKGN1cnJlbnRGcmFtZV8sICJpc0hvcml6b250YWxUcmVlIik7DQoJCQkJaWYoaXNIb3Jpem9udGFsVHJlZSkNCgkJCQl7DQoJCQkJCXZhciBkb2N1bWVudF8gPSB0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKGN1cnJlbnRGcmFtZV8pOw0KCQkJCQl2YXIgZGVmYXVsdEhlaWdodCA9IHRoaXMuZGVmYXVsdFRvcElmcmFtZVNpemUoZG9jdW1lbnRfKTsNCgkJCQkJaWYodGhpcy5qdWRnZUlzTm90TnVsbChkZWZhdWx0SGVpZ2h0KSkNCgkJCQkJewkJCQkJCQkNCgkJCQkJCXN1bSA9IHN1bSA8IGRlZmF1bHRIZWlnaHQgPyBkZWZhdWx0SGVpZ2h0IDogc3VtOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQkJLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoJCQlyZXR1cm4gc3VtOw0KCQl9DQoJCWVsc2UNCgkJew0KCQkJLy9pZiBmcmFtZXNldCBpcyB2ZXJ0aWNhbCBzZXBhcmF0ZWQscmV0dXJuIGxhcmdlc3QgZnJhbWUncyBoZWlnaHQuDQoJCQl2YXIgbWF4X2hlaWdodCA9IDA7DQoJCQl2YXIgY19ub2RlcyA9IGZyYW1lc2V0Xy5jaGlsZHJlbjsNCgkJCWlmKHRoaXMuanVkZ2VJc09iaihjX25vZGVzKSkNCgkJCXsNCgkJCQlmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgY19ub2Rlcy5sZW5ndGggOyBpbmRleCsrKQ0KCQkJCXsNCgkJCQkJdmFyIGZyYW1lXyA9IGNfbm9kZXNbaW5kZXhdOw0KCQkJCQlpZih0aGlzLmp1ZGdlSXNPYmooZnJhbWVfKSkNCgkJCQkJew0KCQkJCQkJaWYoZnJhbWVfLm5vZGVOYW1lID09ICJGUkFNRSIpDQoJCQkJCQl7DQoJCQkJCQkJdmFyIGRvY3VtZW50XyA9IHRoaXMuZ2V0RG9jdW1lbnRGcm9tRnJhbWUoZnJhbWVfKTsNCgkJCQkJCQlpZih0aGlzLmlzSGF2ZUVsZW1lbnRzKGRvY3VtZW50Xy5ib2R5KS5sZW5ndGggPiAwKQ0KCQkJCQkJCXsNCgkJCQkJCQkJaWYoZnJhbWVfLmlzTGVmdFRyZWUpDQoJCQkJCQkJCXsNCgkJCQkJCQkJCXZhciBkZWZhdWx0TWF4SGVpZ2h0ID0gdGhpcy5kZWZhdWx0VG9wSWZyYW1lU2l6ZShkb2N1bWVudF8pOw0KCQkJCQkJCQkJbWF4X2hlaWdodCA9IGRlZmF1bHRNYXhIZWlnaHQgPiBtYXhfaGVpZ2h0ID8gZGVmYXVsdE1heEhlaWdodCA6IG1heF9oZWlnaHQ7DQoJCQkJCQkJCX0NCgkJCQkJCQkJZWxzZQ0KCQkJCQkJCQl7DQoJCQkJCQkJCQl2YXIgbWF4VmFsdWUgPSB0aGlzLmZpbmRTdWJOb2Rlc01heFZhbHVlKGRvY3VtZW50Xy5ib2R5KTsNCgkJCQkJCQkJCWlmKCF0aGlzLmp1ZGdlSXNOdWxsKG1heFZhbHVlKSkNCgkJCQkJCQkJCXsNCgkJCQkJCQkJCQltYXhWYWx1ZS5tYXhfaGVpZ2h0ID0gbWF4VmFsdWUub3ZlcmZsb3dfeCA/IG1heFZhbHVlLm1heF9oZWlnaHQgKyB0aGlzLlNDUk9MTF9CQVJfU0laRSA6IG1heFZhbHVlLm1heF9oZWlnaHQ7DQoJCQkJCQkJCQkJbWF4X2hlaWdodCA9IG1heFZhbHVlLm1heF9oZWlnaHQgPiBtYXhfaGVpZ2h0ID8gbWF4VmFsdWUubWF4X2hlaWdodCA6IG1heF9oZWlnaHQ7DQoJCQkJCQkJCQl9DQoJCQkJCQkJCX0NCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCQllbHNlIGlmKGZyYW1lXy5ub2RlTmFtZSA9PSAiRlJBTUVTRVQiKQ0KCQkJCQkJew0KCQkJCQkJCXZhciBzdWJNYXhfaGVpZ2h0ID0gdGhpcy5mcmFtZXNUb3RhbEhlaWdodChmcmFtZV8pOw0KCQkJCQkJCW1heF9oZWlnaHQgPSBzdWJNYXhfaGVpZ2h0ID4gbWF4X2hlaWdodCA/IHN1Yk1heF9oZWlnaHQgOiBtYXhfaGVpZ2h0Ow0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQkJcmV0dXJuIG1heF9oZWlnaHQ7DQoJCX0NCgl9LA0KCQ0KCWNhbGN1bGF0ZUZyYW1lc2V0Um93c1N1bSA6IGZ1bmN0aW9uKGZyYW1lc2V0XyxsaW1pdENhbGN1bGF0ZUxldmVsKXsNCgkJaWYodGhpcy5qdWRnZUlzT2JqKGZyYW1lc2V0XykgJiYgZnJhbWVzZXRfLnJvd3MgIT0gIiIpDQoJCXsNCgkJCXZhciByb3dBcnJheSAgPSBmcmFtZXNldF8ucm93cy5zcGxpdCgiLCIpOw0KCQkJdmFyIHN1bSA9IDA7DQoJCQlmb3IgKHZhciBpbmRleCA9IDAgOyBpbmRleCA8IHJvd0FycmF5Lmxlbmd0aCA7IGluZGV4KyspIA0KCQkJew0KCQkJCWlmKHRoaXMucmVnRXhlYy50ZXN0KHJvd0FycmF5W2luZGV4XSkpDQoJCQkJew0KCQkJCQlzdW0gKz0gcGFyc2VJbnQocm93QXJyYXlbaW5kZXhdKTsNCgkJCQl9DQoJCQkJaWYodGhpcy5qdWRnZUlzTnVsbChsaW1pdENhbGN1bGF0ZUxldmVsKSAmJiBpbmRleCA9PSBsaW1pdENhbGN1bGF0ZUxldmVsKQ0KCQkJCXsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQkJdmFyIGZyYW1lU3BhY2luZ1ZhbCA9IHRoaXMuZ2V0QXR0cmlidXRlKGZyYW1lc2V0XywgImZyYW1lU3BhY2luZyIpOw0KCQkJdmFyIGJvcmRlclZhbCA9IHRoaXMuZ2V0QXR0cmlidXRlKGZyYW1lc2V0XywgImJvcmRlciIpOw0KCQkJc3VtID0gdGhpcy5yZWdFeGVjLnRlc3QoZnJhbWVTcGFjaW5nVmFsKSA/ICBzdW0gKyBwYXJzZUludChmcmFtZVNwYWNpbmdWYWwpIDogc3VtOw0KCQkJc3VtID0gdGhpcy5yZWdFeGVjLnRlc3QoYm9yZGVyVmFsKSA/ICBzdW0gKyBwYXJzZUludChib3JkZXJWYWwpIDogc3VtOw0KCQkJcmV0dXJuICsrc3VtOw0KCQl9DQoJCXJldHVybiAwOw0KCX0sDQoNCgkvL3Jlc2l6ZSBpZnJhbWUNCglhdXRvUmVzaXplSWZyYW1lIDogZnVuY3Rpb24oKXsNCgkJaWYodGhpcy5pZnJhbWVzXy5sZW5ndGggPiAwKQ0KCQl7DQoJCQlmb3IgKCB2YXIgaW5kZXggPSB0aGlzLmlmcmFtZXNfLmxlbmd0aC0xOyBpbmRleCA+PSAwOyBpbmRleC0tKSANCgkJCXsNCgkJCQl0aGlzLnJlc2l6ZUlmcmFtZSh0aGlzLmlmcmFtZXNfW2luZGV4XSk7DQoJCQl9DQoJCX0NCgl9LA0KCQ0KCXJlc2l6ZUlmcmFtZSA6IGZ1bmN0aW9uKGlmcmFtZV8pew0KCQl2YXIgYm9vbCA9IHRoaXMuaXNUYXJnZXRPYmpUeXBlKGlmcmFtZV8sICJJRlJBTUUiKTsgDQoJCWlmKGJvb2wpDQoJCXsNCgkJCWJvb2wgPSB0aGlzLmp1ZGdlSXNJZ25vcmVBbGxPclNlbGYoaWZyYW1lXyk7DQoJCQlpZihib29sKQ0KCQkJew0KCQkJCXJldHVybiBmYWxzZTsNCgkJCX0NCgkJCWJvb2wgPSB0aGlzLmp1ZGdlSXNIaWRkZW4oaWZyYW1lXykNCgkJCWlmKGJvb2wpDQoJCQl7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfQ0KCQkJdmFyIGRvY3VtZW50XyA9IHRoaXMuZ2V0RG9jdW1lbnRGcm9tRnJhbWUoaWZyYW1lXyk7DQoJCQlpZih0aGlzLmp1ZGdlSXNPYmooZG9jdW1lbnRfKSAmJiB0aGlzLmlzSGF2ZUVsZW1lbnRzKGRvY3VtZW50Xy5ib2R5KS5sZW5ndGggPiAwKQ0KCQkJew0KCQkJCXZhciBtYXhWYWx1ZSA9IHRoaXMuZmluZFN1Yk5vZGVzTWF4VmFsdWUoZG9jdW1lbnRfLmJvZHkpOw0KCQkJCXRoaXMucmVzaXplSWZyYW1lNE5ld1VJKGRvY3VtZW50XywgbWF4VmFsdWUpOw0KCQkJCWlmKHRoaXMuanVkZ2VJc05vdE51bGwobWF4VmFsdWUpICYmIG1heFZhbHVlLm1heF9oZWlnaHQgIT0gMCkNCgkJCQl7DQoJCQkJICAgIGlmKG1heFZhbHVlLm92ZXJmbG93X3gpDQoJCQkJCXsNCgkJCSAgICAJCW1heFZhbHVlLm1heF9oZWlnaHQgKz0gdGhpcy5TQ1JPTExfQkFSX1NJWkU7DQoJCQkJCX0NCgkJCQkgCXZhciBib3JkZXJfbWFyZ2luX3RvcF92YWx1ZSA9IHRoaXMuZ2V0Q3VycmVudFN0eWxlKGRvY3VtZW50XywgZG9jdW1lbnRfLmJvZHkpLm1hcmdpblRvcDsNCgkJCQkgCXZhciBib3JkZXJfbWFyZ2luX2JvdHRvbV92YWx1ZSA9IHRoaXMuZ2V0Q3VycmVudFN0eWxlKGRvY3VtZW50XywgZG9jdW1lbnRfLmJvZHkpLm1hcmdpbkJvdHRvbTsNCgkJCQkgCWJvcmRlcl9tYXJnaW5fdG9wX3ZhbHVlID0gdGhpcy5qdWRnZUlzTnVsbChib3JkZXJfbWFyZ2luX3RvcF92YWx1ZSkgfHwgYm9yZGVyX21hcmdpbl90b3BfdmFsdWUgPT0gImF1dG8iID8gMCA6IHBhcnNlSW50KGJvcmRlcl9tYXJnaW5fdG9wX3ZhbHVlKTsNCgkJCQkgCWJvcmRlcl9tYXJnaW5fYm90dG9tX3ZhbHVlID0gdGhpcy5qdWRnZUlzTnVsbChib3JkZXJfbWFyZ2luX2JvdHRvbV92YWx1ZSkgfHwgYm9yZGVyX21hcmdpbl9ib3R0b21fdmFsdWUgPT0gImF1dG8iID8gMCA6IHBhcnNlSW50KGJvcmRlcl9tYXJnaW5fYm90dG9tX3ZhbHVlKTsJCQkJCSAJDQoJCQkJIAl2YXIgaGVpZ2h0VmFsdWUgPSBib3JkZXJfbWFyZ2luX3RvcF92YWx1ZSArIGJvcmRlcl9tYXJnaW5fYm90dG9tX3ZhbHVlICsgbWF4VmFsdWUubWF4X2hlaWdodDsNCgkJCQkgCXRoaXMuc2V0U3R5bGVIZWlnaHQoaWZyYW1lXywgaGVpZ2h0VmFsdWUpOw0KCQkJCX0NCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KGlmcmFtZV8sIDApOw0KCQkJfQ0KCQkJcmV0dXJuIHRydWU7DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoNCiAgICByZXNpemVJZnJhbWU0TmV3VUkgOiBmdW5jdGlvbihkb2N1bWVudF8sIG1heFZhbHVlKXsNCiAgICAgICAgaWYoIXRoaXMuaXNPbGRVSSgpICYmICF0aGlzLmlzUG9wVXBXaW5kb3coZG9jdW1lbnRfKSkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGlnbm9yZVNjcm9sbCA9ICBkb2N1bWVudF8ucXVlcnlTZWxlY3RvcigiYm9keS5wYWdlLWZpeFNjcm9sbCIpOw0KICAgICAgICAgICAgdmFyIGNvbnRlbnRQYW5lbCA9IGRvY3VtZW50Xy5xdWVyeVNlbGVjdG9yKCJkaXYud29yay1zcGFjZSIpOw0KDQogICAgICAgICAgICBpZiAodGhpcy5qdWRnZUlzT2JqKGNvbnRlbnRQYW5lbCkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIG1heFZhbHVlNENvbnRlbnQgPSB0aGlzLmZpbmRTdWJOb2Rlc01heFZhbHVlKGNvbnRlbnRQYW5lbCk7DQogICAgICAgICAgICAgICAgaWYodGhpcy5qdWRnZUlzT2JqKGlnbm9yZVNjcm9sbCkgJiYgdGhpcy5qdWRnZUlzTm90TnVsbChtYXhWYWx1ZTRDb250ZW50KSl7DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuanVkZ2VJc05vdE51bGwobWF4VmFsdWUpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZS5tYXhfd2lkdGggPSBtYXhWYWx1ZTRDb250ZW50Lm1heF93aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlLm1heF9oZWlnaHQgPSBtYXhWYWx1ZTRDb250ZW50Lm1heF9oZWlnaHQgKyA1MDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIGlmKCF0aGlzLmp1ZGdlSXNPYmooaWdub3JlU2Nyb2xsKSAmJiB0aGlzLmp1ZGdlSXNOb3ROdWxsKG1heFZhbHVlNENvbnRlbnQpKXsNCg0KICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmp1ZGdlSXNOb3ROdWxsKG1heFZhbHVlKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZS5tYXhfd2lkdGggKz0gbWF4VmFsdWU0Q29udGVudC5tYXhfd2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZS5tYXhfaGVpZ2h0ICs9IG1heFZhbHVlNENvbnRlbnQubWF4X2hlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZSA9IG1heFZhbHVlNENvbnRlbnQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYobWF4VmFsdWUubWF4X3dpZHRoIDwgZG9jdW1lbnRfLmJvZHkuY2xpZW50V2lkdGgpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZS5tYXhfd2lkdGggPSBkb2N1bWVudF8uYm9keS5jbGllbnRXaWR0aDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYobWF4VmFsdWUubWF4X2hlaWdodCA8IGRvY3VtZW50Xy5ib2R5LmNsaWVudEhlaWdodCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIG1heFZhbHVlLm1heF9oZWlnaHQgPSBkb2N1bWVudF8uYm9keS5jbGllbnRIZWlnaHQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgfQ0KICAgIH0sDQoJDQoNCgkvLyByZXNpemUgYWxsIGlmcmFtZXMgYmV0d2VlbiB0b3AgaWZyYW1lIGFuZCBjdXJyZW50IGNvbnRhaW5lci4NCglyZXNpemVJZnJhbWVzQmV0d2VlblRvcEFuZEN1cnJlbnRDb250YWluZXIgOiBmdW5jdGlvbihkb2N1bWVudF8pew0KCQl0cnkNCgkJew0KCQkJdmFyIGZlID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQoZG9jdW1lbnRfKTsNCgkJCXdoaWxlKCF0aGlzLmlzVG9wSWZyYW1lKGZlKSkNCgkJCXsNCgkJCQlpZih0aGlzLmp1ZGdlSXNPYmooZmUucGFyZW50V2luZG93KSAmJiB0aGlzLmp1ZGdlSXNPYmooZmUucGFyZW50V2luZG93LmZyYW1lRWxlbWVudCkgJiYgZmUubm9kZU5hbWUgPT0gIiNkb2N1bWVudCIpDQoJCQkJew0KCQkJCQlmZSA9IGZlLnBhcmVudFdpbmRvdy5mcmFtZUVsZW1lbnQ7DQoJCQkJfQ0KCQkJCWVsc2UgaWYodGhpcy5qdWRnZUlzTm90TnVsbChmZS5wYXJlbnROb2RlKSkNCgkJCQl7CQkJCQkNCgkJCQkJZmUgPSBmZS5wYXJlbnROb2RlOwkJCQkJCQkNCgkJCQl9DQoJCQkJZWxzZSBpZigodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJGaXJlZm94IiB8fCB0aGlzLmdldEJyb3dzZXJUeXBlKCkgPT0gIkNocm9tZSIpICYmIHRoaXMuaXNUYXJnZXRPYmpUeXBlKGZlLCAiI2RvY3VtZW50IikpDQoJCQkJew0KCQkJCQlmZSA9IGZlLmRlZmF1bHRWaWV3LmZyYW1lRWxlbWVudDsNCgkJCQl9DQoJCQkJZWxzZQ0KCQkJCXsNCgkJCQkJcmV0dXJuOw0KCQkJCX0NCgkJCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShmZSwgIklGUkFNRSIpKQ0KCQkJCXsNCgkJCQkJaWYoIXRoaXMucmVzaXplSWZyYW1lKGZlKSkNCgkJCQkJew0KCQkJCQkJcmV0dXJuOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9Y2F0Y2goZSl7fQ0KCX0sDQoJDQoJaXNPbGRVSSA6IGZ1bmN0aW9uKCl7DQoJCWlmKHR5cGVvZihvbGRVSSkgIT0gJ3VuZGVmaW5lZCcpDQoJCXsNCgkJCXJldHVybiBvbGRVSTsNCgkJfQ0KCQlyZXR1cm4gaXNBdXRvbWF0aW9uTmV3VVg7DQoJfSwNCgkNCglpc0FBX0NsYXNzaWMgOiBmdW5jdGlvbigpew0KCQl0cnl7CQkJCQ0KCQkJdmFyIHRfY19uID0gdG9wLmRvY3VtZW50LmJvZHkuY2xhc3NOYW1lOw0KCQkJaWYodF9jX24gPT0gIk1haW4iKQ0KCQkJew0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQ0KCQl9Y2F0Y2goZSl7fQ0KCQlyZXR1cm4gZmFsc2U7DQoJfSwNCgkNCglpc1BvcFVwV2luZG93IDogZnVuY3Rpb24oZG9jdW1lbnRfKQ0KCXsNCgkJdHJ5DQoJCXsJCQkJDQoJCQlpZih0aGlzLmlzQUMzNjBQb3BVcChkb2N1bWVudF8pLmlzQUMzNjBQb3BVcCkNCgkJCXsNCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9DQoJCQl2YXIgSkNDXyA9IHRvcC5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLkpFVFNQRUVEX0NPTlRFTlRfQ09OVEFJTkVSX0lEKTsNCgkJCWlmKHRoaXMuanVkZ2VJc09iaihKQ0NfKSkNCgkJCXsNCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9DQoJCQl2YXIgaGVhZGVyID0gdG9wLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImhlYWRlcltjbGFzcz0nYXBwbGljYXRpb24tYmFyIGxheWVyLTIgbmctc2NvcGUnXSIpOw0KCQkJaWYodGhpcy5qdWRnZUlzT2JqKGhlYWRlcikpDQoJCQl7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfQ0KCQkJcmV0dXJuIHRydWU7DQoJCX0NCgkJY2F0Y2goZSkNCgkJew0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJfSwNCgkNCglpc0Zsb2F0RWxlbWVudCA6IGZ1bmN0aW9uKGRvY3VtZW50XywgZWxlKXsNCgkJdmFyIHBvc2l0aW9uOw0KCQl2YXIgY3VycmVudFN0eWxlOw0KCQl3aGlsZSh0aGlzLmp1ZGdlSXNPYmooZWxlKSkNCgkJew0KCQkJY3VycmVudFN0eWxlID0gdGhpcy5nZXRDdXJyZW50U3R5bGUoZG9jdW1lbnRfLCBlbGUpOw0KCQkJcG9zaXRpb24gPSB0aGlzLmp1ZGdlSXNOb3ROdWxsKGN1cnJlbnRTdHlsZS5wb3NpdGlvbikgPyBjdXJyZW50U3R5bGUucG9zaXRpb24udG9Mb3dlckNhc2UoKSA6ICIiOw0KCQkJaWYocG9zaXRpb24gPT0gInJlbGF0aXZlIiB8fCBwb3NpdGlvbiA9PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09ICJmaXhlZCIpDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCQllbHNlIGlmKHBvc2l0aW9uID09ICJpbmhlcml0IikNCgkJCXsNCgkJCQllbGUgPSBlbGUucGFyZW50RWxlbWVudDsNCgkJCX0NCgkJCWVsc2UgDQoJCQl7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfQ0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9LA0KCQ0KCWlzU2hvd01vZGFsRGlhbG9nIDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJaWYodGhpcy5pc1BvcFVwV2luZG93KGRvY3VtZW50XykpDQoJCXsNCgkJCXJldHVybiB0aGlzLmp1ZGdlSXNPYmooZG9jdW1lbnRfLnBhcmVudFdpbmRvdy5vcGVuZXIpOw0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9LA0KCQ0KCWlzQUMzNjBQb3BVcCA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCXRyeXsNCgkJCXZhciBmcmFtZU9iaiA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50KGRvY3VtZW50Xyk7DQoJCQl3aGlsZSghKGZyYW1lT2JqLm5hbWUuaW5kZXhPZigiaWZyX3BvcHVwIikgPiAtMSkpDQoJCQl7DQoJCQkJdmFyIGRvYyA9IHRoaXMuZ2V0RG9jdW1lbnRGcm9tRnJhbWUoZnJhbWVPYmopOw0KCQkJCWZyYW1lT2JqID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQoZG9jLnBhcmVudFdpbmRvdy5wYXJlbnQud2luZG93LmRvY3VtZW50KTsNCgkJCQlpZihkb2MucGFyZW50V2luZG93ID09IHRvcCB8fCB0aGlzLmlzVG9wSWZyYW1lKGZyYW1lT2JqKSkNCgkJCQl7DQoJCQkJCXRocm93ICJpdCBpcyBub3QgYWMzNjAgcG9wdXAiOw0KCQkJCX0NCgkJCX0NCgkJCXJldHVybiB7ImlzQUMzNjBQb3BVcCIgOiB0cnVlLCAiQUMzNjBQb3BVcE9iaiIgOiBmcmFtZU9ian07DQoJCX0NCgkJY2F0Y2goZSkNCgkJew0KCQkJcmV0dXJuIHsiaXNBQzM2MFBvcFVwIiA6IGZhbHNlLCAiQUMzNjBQb3BVcE9iaiIgOiBudWxsfTsNCgkJfQ0KCX0sDQoJDQoJaXNUb3BJZnJhbWUgOiBmdW5jdGlvbihpZnJhbWVfKXsNCgkJaWYodGhpcy5pc1RhcmdldE9ialR5cGUoaWZyYW1lXywgIklGUkFNRSIpKQ0KCQl7DQoJCQlpZihpZnJhbWVfLmlkID09ICJkaWFsb2ctYm9keSIpDQoJCQl7DQoJCQkJdGhpcy5kaWFsb2dTaW11bGF0aW9uSWZyYW1lID0gaWZyYW1lXzsNCgkJCX0NCgkJCXZhciBwYXJlbnRFbGUgPSBpZnJhbWVfLnBhcmVudEVsZW1lbnQ7IA0KCQkJaWYocGFyZW50RWxlLmlkID09ICJyZXBvcnRzX21vZCIpDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7IA0KCQkJfQ0KCQkJZWxzZSBpZihwYXJlbnRFbGUubm9kZU5hbWUgPT0gIlREIiAmJiBwYXJlbnRFbGUuY2xhc3NOYW1lID09ICJBVjM2MEJvcmRlcmVkQ29udGVudCIpDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7IA0KCQkJfQ0KCQkJZWxzZSBpZihpZnJhbWVfLmlkID09ICJpZnJhbWUtcGFnZS1jb250YWluZXIiIHx8IHRoaXMuZ2V0RG9jdW1lbnQocGFyZW50RWxlKSA9PSB0b3AuZG9jdW1lbnQpDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoJDQoJZmluZFRvcElmcmFtZSA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCXRyeXsNCgkJCXZhciB0b3BfaWZyYW1lID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQoZG9jdW1lbnRfKTsNCgkJCXZhciBhYV9jbGFzc2ljID0gdGhpcy5pc0FBX0NsYXNzaWMoKTsNCgkJCXZhciBhYV9jbGFzc2ljX2lmcmFtZTsNCgkJCXdoaWxlKCF0aGlzLmlzVG9wSWZyYW1lKHRvcF9pZnJhbWUpKQ0KCQkJew0KCQkJCWlmKHRvcF9pZnJhbWUubm9kZU5hbWUgPT0gIiNkb2N1bWVudCIpDQoJCQkJew0KCQkJCQl0b3BfaWZyYW1lID0gdGhpcy5nZXRGcmFtZUVsZW1lbnQodG9wX2lmcmFtZSk7DQoJCQkJfQ0KCQkJCWVsc2UgaWYodGhpcy5qdWRnZUlzT2JqKHRvcF9pZnJhbWUucGFyZW50Tm9kZSkpDQoJCQkJewkJCQkJDQoJCQkJCXRvcF9pZnJhbWUgPSB0b3BfaWZyYW1lLnBhcmVudE5vZGU7CQkJCQkJCQ0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlpZihhYV9jbGFzc2ljICYmIHRoaXMuaXNUYXJnZXRPYmpUeXBlKGFhX2NsYXNzaWNfaWZyYW1lLCAiSUZSQU1FIikpDQoJCQkJCXsNCgkJCQkJCXJldHVybiBhYV9jbGFzc2ljX2lmcmFtZTsNCgkJCQkJfQ0KCQkJCQl0aHJvdyAiaXQgaXMgcG9wIHVwIHdpbmRvdyI7DQoJCQkJfQ0KCQkJCWlmKGFhX2NsYXNzaWMgJiYgdGhpcy5pc1RhcmdldE9ialR5cGUodG9wX2lmcmFtZSwgIklGUkFNRSIpKQ0KCQkJCXsNCgkJCQkJYWFfY2xhc3NpY19pZnJhbWUgPSB0b3BfaWZyYW1lOw0KCQkJCX0NCgkJCX0NCgkJCXJldHVybiB0b3BfaWZyYW1lOw0KCQl9Y2F0Y2goZSl7DQoJCQlyZXR1cm4gbnVsbDsNCgkJfQ0KCX0sDQoJDQoJLyoqDQoJICogdGhpcyBtZXRob2QgaXMgdXNlZCB0byBzZXQgbWFyZ2luIHN0eWxlIG9mIHBvcHVwIHdpbmRvdy4NCgkgKi8NCglwb3BVcFdpbmRvd1Byb2Nlc3M6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCWlmKHRoaXMuaXNQb3BVcFdpbmRvdyhkb2N1bWVudF8pKQ0KCQl7DQoJCQl2YXIgc3BhY2luZyA9ICIycHgiOw0KCQkgICAgaWYgKCFpc0F1dG9tYXRpb25OZXdVWCkgDQoJCSAgICB7IC8vIEFBRVRBLTY0MQ0KCQkgICAgCXRvcC5kb2N1bWVudC5ib2R5LnN0eWxlLm1hcmdpbkxlZnQgPSBzcGFjaW5nOw0KCQkgICAgICAgIHRvcC5kb2N1bWVudC5ib2R5LnN0eWxlLm1hcmdpblJpZ2h0ID0gc3BhY2luZzsNCgkJICAgIH0NCgkJfQ0KCQllbHNlIGlmKHRoaXMuaXNBQzM2MFBvcFVwKGRvY3VtZW50XykuaXNBQzM2MFBvcFVwKQ0KCQl7DQoJCQl2YXIgY3VycmVudElmcmFtZSA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50KGRvY3VtZW50Xyk7DQoJCQlpZigibWVudUZyYW1lIiA9PSBjdXJyZW50SWZyYW1lLmlkKQ0KCQkJew0KCQkJCXZhciBib2R5Q2xhc3MgPSBkb2N1bWVudF8uYm9keS5jbGFzc05hbWU7DQoJCQkJaWYoYm9keUNsYXNzLmluZGV4T2YoIk1hcmdpbkxSWFkwcHgiKSA+IC0xICYmIGJvZHlDbGFzcy5pbmRleE9mKCJwb3B1cF9uYXZpZ2F0aW9uIikgPT0gLTEpDQoJCQkJew0KCQkJCQlkb2N1bWVudF8uYm9keS5jbGFzc05hbWUgPSBib2R5Q2xhc3MgKyAicG9wdXBfbmF2aWdhdGlvbiI7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfSwNCgkNCglmaW5kRmlyc3RQYXJlbnRJZnJhbWUgOiBmdW5jdGlvbihkb2N1bWVudF8pew0KCQlpZih0aGlzLmp1ZGdlSXNPYmooZG9jdW1lbnRfKSkNCgkJew0KCQkJdmFyIGlmcmFtZV8gPSB0aGlzLmdldEZyYW1lRWxlbWVudChkb2N1bWVudF8pOw0KCQkJd2hpbGUoIXRoaXMuaXNUYXJnZXRPYmpUeXBlKGlmcmFtZV8sICJJRlJBTUUiKSkNCgkJCXsNCgkJCQlpZihpZnJhbWVfLm5vZGVOYW1lID09ICIjZG9jdW1lbnQiKQ0KCQkJCXsNCgkJCQkJaWZyYW1lXyA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50KGlmcmFtZV8pLmZyYW1lRWxlbWVudDsNCgkJCQl9DQoJCQkJZWxzZSBpZih0aGlzLmp1ZGdlSXNPYmooaWZyYW1lXy5wYXJlbnROb2RlKSkNCgkJCQl7CQkJCQkNCgkJCQkJaWZyYW1lXyA9IGlmcmFtZV8ucGFyZW50Tm9kZTsJCQkJCQkJDQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQl7DQoJCQkJCXJldHVybiBudWxsOw0KCQkJCX0NCgkJCQlpZihpZnJhbWVfLm5vZGVOYW1lID09ICJJRlJBTUUiKQ0KCQkJCXsNCgkJCQkJcmV0dXJuIGlmcmFtZV87DQoJCQkJfQ0KCQkJfQ0KCQkJcmV0dXJuIHRoaXMuaXNUYXJnZXRPYmpUeXBlKGlmcmFtZV8sICJJRlJBTUUiKSA/IGlmcmFtZV8gOiBudWxsOw0KCQl9DQoJCXJldHVybiBudWxsOw0KCX0sDQoJDQoJZmluZFN1Yk5vZGVzTWF4VmFsdWUgOiBmdW5jdGlvbihvYmopew0KCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShvYmosICJCT0RZIikgJiYgIXRoaXMuaXNPbGRVSSgpKQ0KCQl7DQoJCQl2YXIgdGFyZ2V0RG9jID0gdGhpcy5nZXREb2N1bWVudChvYmopOw0KCQkJdmFyIGhlYWRlciA9IHRhcmdldERvYy5xdWVyeVNlbGVjdG9yKCJoZWFkZXJbY2xhc3M9J2hlYWRlciddIik7DQoJCQl2YXIgd29ya1NwYWNlVXRpbGl0eURJViA9IHRhcmdldERvYy5xdWVyeVNlbGVjdG9yKCJESVZbY2xhc3M9J3dvcmtzcGFjZS11dGlsaXR5LW1lbnUnXSxESVZbY2xhc3M9J3dvcmtzcGFjZS1uby11dGlsaXR5LW1lbnUnXSIpOw0KCQkJaWYodGhpcy5qdWRnZUlzT2JqKGhlYWRlcikgfHwgdGhpcy5qdWRnZUlzT2JqKHdvcmtTcGFjZVV0aWxpdHlESVYpKQ0KCQkJew0KCQkJCXZhciBtYXhIZWlnaHQgPSB0aGlzLmp1ZGdlSXNPYmooaGVhZGVyKSA/IHRoaXMuY2FsY3VsYXRlSGVpZ2h0KGhlYWRlcikgKyAgdGhpcy5jYWxjdWxhdGVIZWlnaHQod29ya1NwYWNlVXRpbGl0eURJVikgOiB0aGlzLmNhbGN1bGF0ZUhlaWdodCh3b3JrU3BhY2VVdGlsaXR5RElWKTsNCgkJCQlyZXR1cm4geyJtYXhfd2lkdGgiIDogb2JqLnNjcm9sbFdpZHRoICwgIm1heF9oZWlnaHQiIDogbWF4SGVpZ2h0LCAib3ZlcmZsb3dfeCIgOiBvYmouc2Nyb2xsV2lkdGggPiBvYmouY2xpZW50V2lkdGh9Ow0KCQkJfQ0KCQl9DQoJCWlmKHRoaXMuanVkZ2VJc09iaihvYmopKQ0KCQl7CQ0KCQkJdmFyIGNfbm9kZXMgPSB0aGlzLmlzSGF2ZUVsZW1lbnRzKG9iaik7DQoJCQlpZihjX25vZGVzLmxlbmd0aCA9PSAwKQ0KCQkJew0KCQkJCXJldHVybiB7Im1heF93aWR0aCIgOiAwICwgIm1heF9oZWlnaHQiIDogMCwib3ZlcmZsb3dfeCIgOiBmYWxzZX07DQoJCQl9DQoJCQlyZXR1cm4geyJtYXhfd2lkdGgiIDogb2JqLnNjcm9sbFdpZHRoICwgIm1heF9oZWlnaHQiIDogdGhpcy5jYWxjdWxhdGVIZWlnaHQoY19ub2Rlc1swXSksICJvdmVyZmxvd194IiA6IG9iai5zY3JvbGxXaWR0aCA+IG9iai5jbGllbnRXaWR0aH07DQoJCX0NCgkJcmV0dXJuIG51bGw7DQoJfSwNCgkNCglyZWN1cnNpdmVDYWxjdWxhdGUgOiBmdW5jdGlvbihvYmopew0KCQlpZih0aGlzLmp1ZGdlSXNPYmoob2JqKSkNCgkJew0KCQkJdHJ5DQoJCQl7DQoJCQkJaWYodGhpcy5qdWRnZUlzSWdub3JlQWxsKG9iaikpDQoJCQkJew0KCQkJCQlyZXR1cm47DQoJCQkJfQ0KCQkJCWlmKHRoaXMuanVkZ2VJc0hpZGRlbihvYmopKQ0KCQkJCXsNCgkJCQkJcmV0dXJuOw0KCQkJCX0NCgkJCX1jYXRjaChlKXt9DQoJCQl2YXIgdGFnX25hbWUgPSBvYmoudGFnTmFtZTsNCgkJCWlmKCF0aGlzLmp1ZGdlSXNOdWxsKHRhZ19uYW1lKSkNCgkJCXsNCgkJCQl2YXIgY2hpbGRfbm9kZXMgPSBuZXcgQXJyYXkoKTsNCgkJCQlzd2l0Y2godGFnX25hbWUpDQoJCQkJew0KCQkJCQljYXNlICJCT0RZIjoNCgkJCQkJCWNoaWxkX25vZGVzID0gb2JqLmNoaWxkTm9kZXM7IGJyZWFrOw0KCQkJCQljYXNlICJGT1JNIjoNCgkJCQkJCWlmKHRoaXMuZ2V0QnJvd3NlclR5cGUoKSA9PSAiRmlyZWZveCIgfHwgdGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJDaHJvbWUiKQ0KCQkJCQkJew0KCQkJCQkJCW9iai5zdHlsZS5tYXJnaW5Cb3R0b20gPSAiMHB4IjsNCgkJCQkJCX0NCgkJCQkJCWNoaWxkX25vZGVzID0gb2JqLmNoaWxkTm9kZXM7IGJyZWFrOw0KCQkJCQljYXNlICJESVYiOg0KCQkJCQkJaWYodGhpcy5nZXRBdHRyaWJ1dGUob2JqLCAiaXNUcmVlIikpDQoJCQkJCQl7DQoJCQkJCQkJdGhpcy50cmVlRGl2W3RoaXMudHJlZURpdi5sZW5ndGhdID0gb2JqOyANCgkJCQkJCX0NCgkJCQkJCWVsc2UNCgkJCQkJCXsJCQkJCQkJCQ0KCQkJCQkJCWNoaWxkX25vZGVzID0gb2JqLmNoaWxkTm9kZXM7IA0KCQkJCQkJfQ0KCQkJCQkJYnJlYWs7DQoJCQkJCWNhc2UgIklGUkFNRSI6DQoJCQkJCQl0aGlzLmlmcmFtZXNfW3RoaXMuaWZyYW1lc18ubGVuZ3RoXSA9IG9iajsgYnJlYWs7DQoJCQkJCWNhc2UgIlRBQkxFIjoNCgkJCQkJCXRoaXMucmVjdXJzaXZlUmVzaXplKG9iaik7DQoJCQkJCQljaGlsZF9ub2RlcyA9IG9iai5jaGlsZE5vZGVzOyBicmVhazsNCgkJCQkJY2FzZSAiVEhFQUQiOg0KCQkJCQkJY2hpbGRfbm9kZXMgPSBvYmouY2hpbGROb2RlczsgYnJlYWs7DQoJCQkJCWNhc2UgIlRCT0RZIjoNCgkJCQkJCWNoaWxkX25vZGVzID0gb2JqLmNoaWxkTm9kZXM7IGJyZWFrOw0KCQkJCQljYXNlICJURk9PVCI6DQoJCQkJCQljaGlsZF9ub2RlcyA9IG9iai5jaGlsZE5vZGVzOyBicmVhazsNCgkJCQkJY2FzZSAiVFIiOg0KCQkJCQkJY2hpbGRfbm9kZXMgPSBvYmouY2hpbGROb2RlczsgYnJlYWs7DQoJCQkJCWNhc2UgIlRIIjoNCgkJCQkJCWNoaWxkX25vZGVzID0gb2JqLmNoaWxkTm9kZXM7IGJyZWFrOw0KCQkJCQljYXNlICJURCI6DQoJCQkJCQljaGlsZF9ub2RlcyA9IG9iai5jaGlsZE5vZGVzOyBicmVhazsNCgkJCQl9DQoJCQkJZm9yICggdmFyIGMgaW4gY2hpbGRfbm9kZXMpIA0KCQkJCXsNCgkJCQkJdGhpcy5yZWN1cnNpdmVDYWxjdWxhdGUoY2hpbGRfbm9kZXNbY10pOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0sDQoJDQoJLy8gcmVzaXplIHRyZWUgY29ybmVyIGZ1bmN0aW9uIGVudHJhbmNlDQoJYXV0b1Jlc2l6ZVRyZWUgOiBmdW5jdGlvbihkb2N1bWVudF8pew0KCQl2YXIgcGFyZW50RnJhbWUgPSB0aGlzLmdldEZyYW1lRWxlbWVudChkb2N1bWVudF8pOw0KCQlpZighdGhpcy5qdWRnZUlzTnVsbChwYXJlbnRGcmFtZSkpDQoJCXsNCgkJCWZvciAodmFyIGluZGV4ID0gMDtpbmRleCA8IHRoaXMudHJlZURpdi5sZW5ndGg7IGluZGV4KyspIA0KCQkJew0KCQkJCXRoaXMucmVzaXplVHJlZSh0aGlzLnRyZWVEaXZbaW5kZXhdLHBhcmVudEZyYW1lKTsNCgkJCX0NCgkJfQ0KCX0sDQoJDQoJLy9yZXNpemUgdHJlZSBjb3JuZXINCglyZXNpemVUcmVlIDogZnVuY3Rpb24ob2JqLHBhcmVudEZyYW1lKXsNCgkJdmFyIHN1bUhlaWdodCA9IDA7DQoJCXZhciBkb2N1bWVudF8gPSB0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKHBhcmVudEZyYW1lKTsNCgkJdmFyIGVycm9yX21lc3NhZ2UgPSBkb2N1bWVudF8uZ2V0RWxlbWVudEJ5SWQoIl9lcnJvcl9tc2dfdHIiKTsNCgkJdmFyIF9tZW51X3RvcF9jb3JuZXJfdHIgPSBkb2N1bWVudF8uZ2V0RWxlbWVudEJ5SWQoIl9tZW51X3RvcF9jb3JuZXJfdHIiKTsNCgkJaWYoIXRoaXMuanVkZ2VJc051bGwoX21lbnVfdG9wX2Nvcm5lcl90cikpDQoJCXsNCgkJCXN1bUhlaWdodCA9IF9tZW51X3RvcF9jb3JuZXJfdHIuc2Nyb2xsSGVpZ2h0Ow0KCQkJdmFyIG5leHRPYmogPSBfbWVudV90b3BfY29ybmVyX3RyLm5leHRTaWJsaW5nOw0KCQkJd2hpbGUobmV4dE9iai5pZCAhPSAiX21lbnVfYm90dG9tX2Nvcm5lcl90ciIpDQoJCQl7DQoJCQkJc3VtSGVpZ2h0ICs9IG5leHRPYmouc2Nyb2xsSGVpZ2h0Ow0KCQkJCW5leHRPYmogPSBuZXh0T2JqLm5leHRTaWJsaW5nOw0KCQkJfQ0KCQkJc3VtSGVpZ2h0ICs9IG5leHRPYmouc2Nyb2xsSGVpZ2h0Ow0KCQkJdmFyIG92ZXJmbG93X3ggPSB0aGlzLmZpbmRTdWJOb2Rlc01heFZhbHVlKGRvY3VtZW50Xy5ib2R5KS5vdmVyZmxvd194Ow0KCQkJb2JqLnN0eWxlLndpZHRoID0gb2JqLnNjcm9sbFdpZHRoKyJweCI7DQoJCQlvYmouc3R5bGUub3ZlcmZsb3cgPSAiYXV0byI7DQoJCQl2YXIgaGVpZ2h0XyA9ICFvdmVyZmxvd194ID8gcGFyZW50RnJhbWUuc2Nyb2xsSGVpZ2h0IC0gc3VtSGVpZ2h0IC0gdGhpcy5TQ1JPTExfQkFSX1NJWkUgOiBwYXJlbnRGcmFtZS5zY3JvbGxIZWlnaHQgLSBzdW1IZWlnaHQ7DQoJCQlpZihoZWlnaHRfID4gMCkNCgkJCXsNCgkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KG9iaiwgaGVpZ2h0Xyk7DQoJCQkJaGVpZ2h0XyA9IG9iai5zY3JvbGxIZWlnaHQgLSBvYmouY2hpbGROb2Rlc1swXS5zY3JvbGxIZWlnaHQgLSBvYmouY2hpbGROb2Rlc1syXS5zY3JvbGxIZWlnaHQgLSBlcnJvcl9tZXNzYWdlLnNjcm9sbEhlaWdodDsNCgkJCQlpZihoZWlnaHRfID4gMCkNCgkJCQl7CQkJCQkNCgkJCQkJdmFyIGhlaWdodFZhbHVlID0gb2JqLnNjcm9sbEhlaWdodCAtIG9iai5jaGlsZE5vZGVzWzBdLnNjcm9sbEhlaWdodCAtIG9iai5jaGlsZE5vZGVzWzJdLnNjcm9sbEhlaWdodCAtIGVycm9yX21lc3NhZ2Uuc2Nyb2xsSGVpZ2h0Ow0KCQkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KG9iai5jaGlsZE5vZGVzWzFdLCBoZWlnaHRWYWx1ZSk7DQoJCQkJfQ0KCQkJCXBhcmVudEZyYW1lLnRyZWVJZCA9IG9iai5pZDsNCgkJCQlwYXJlbnRGcmFtZS5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkNCgkJCQl7DQoJCQkJCXZhciBvYmogPSBzY3JvbGxCYXJJc3N1ZS5nZXREb2N1bWVudEZyb21GcmFtZSh0aGlzKS5nZXRFbGVtZW50QnlJZCh0aGlzLnRyZWVJZCk7DQoJCQkJCXNjcm9sbEJhcklzc3VlLnJlc2l6ZVRyZWUob2JqLHRoaXMpOw0KCQkJCX07DQoJCQkgIH0NCgkJfQ0KCX0sDQoJDQoJLy9yZWN1cnNpdmUgcmVzaXplIGNvbnRhaW5lciBmcm9tIGlubmVyIHRvIG91dGVyLg0KCXJlY3Vyc2l2ZVJlc2l6ZSA6IGZ1bmN0aW9uKG9iail7DQoJCS8vd2UgZG9uJ3QgdG8gZG8gYW55dGhpbmcgaWYgcGFyYW1ldGVyIGlzIG5vdCBhIG9iamVjdCBvciBvYmplY3QncyB0eXBlIGlzIEhUTUwNCgkJaWYoIXRoaXMuanVkZ2VJc09iaihvYmopIHx8IG9iai50YWdOYW1lID09ICJIVE1MIikNCgkJew0KCQkJcmV0dXJuOw0KCQl9DQoJCQ0KCQl0cnl7DQoJCQlpZih0aGlzLmp1ZGdlSXNJZ25vcmVTZWxmKG9iaikpDQoJCQl7DQoJCQkJdGhpcy5yZWN1cnNpdmVSZXNpemUob2JqLnBhcmVudE5vZGUpOw0KCQkJCXJldHVybjsNCgkJCX0NCgkJfWNhdGNoKGUpe30NCgkJDQoJCWlmIChvYmoubm9kZU5hbWUgPT0gJ1RBQkxFJyAmJiBvYmoucmVzaXplKQ0KCQl7DQoJCQlvYmoucmVzaXplKCk7DQoJCX0NCgkJdmFyIHAgPSBvYmoucGFyZW50Tm9kZTsvL2dldCB0aGUgY29udGFpbmVyIG9mIGN1cnJlbnQgZWxlbWVudCdzIHBhcmVudA0KCQl2YXIgcmVzaXplID0gZmFsc2U7Ly9pZiB0aGlzIHZhcmlhYmxlIGlzIGZhbHNlLHdlIG5lZWRuJ3QgdG8gcmVjdXJzaXZlIHJlc2l6ZSBwYXJlbnQncyBjb250YWluZXIsIHJlZHVjZSBjYWxjdWxhdGUgZnJlcXVlbmN5Lg0KCQlpZihvYmoubm9kZU5hbWUgPT0gIkRJViIpDQoJCXsNCgkJCW9iai5zdHlsZS53aWR0aCA9ICJhdXRvIjsNCgkJCXRoaXMuc2V0U3R5bGVIZWlnaHQob2JqLCAiYXV0byIpOw0KCQkJcmVzaXplID0gdHJ1ZTsNCgkJfQ0KCQllbHNlDQoJCXsJDQoJCQlyZXNpemUgPSB0aGlzLmNhbGN1bGF0ZVdpZHRoKG9iaik7DQoJCQl2YXIgdG90YWxIZWlnaHQgPSB0aGlzLmNhbGN1bGF0ZUhlaWdodChvYmopOw0KCQkJaWYodG90YWxIZWlnaHQgPiBwLmNsaWVudEhlaWdodCkNCgkJCXsNCgkJCQl0aGlzLnNldFN0eWxlSGVpZ2h0KHAsIHRvdGFsSGVpZ2h0KTsNCgkJCQlyZXNpemUgPSB0cnVlOw0KCQkJfQ0KCQl9DQoJCWlmKHJlc2l6ZSkNCgkJewkJCQkNCgkJCXRoaXMucmVjdXJzaXZlUmVzaXplKG9iai5wYXJlbnROb2RlKTsNCgkJfQ0KCX0sDQoJDQoJLy9yZXNpemUgd2lkdGggdmFsdWUgb2YgdGhlIGNvbnRhaW5lciBvZiBjdXJyZW50IGVsZW1lbnQncyBwYXJlbnQuDQoJY2FsY3VsYXRlV2lkdGggOiBmdW5jdGlvbihvYmopew0KCQl2YXIgcCA9IG9iai5wYXJlbnROb2RlOw0KCQl2YXIgaXNJZ25vcmVTZWxmID0gdGhpcy5qdWRnZUlzSWdub3JlU2VsZihwKTsNCgkJaWYoIWlzSWdub3JlU2VsZiAmJiAob2JqLnNjcm9sbFdpZHRoID4gcC5zY3JvbGxXaWR0aCkpDQoJCXsNCgkJCXAuc3R5bGUud2lkdGggPSBvYmouc2Nyb2xsV2lkdGggKyAncHgnOw0KCQkJcmV0dXJuIHRydWU7Ly9yZXR1cm4gdHJ1ZSB3aGVuIGhhZCBjaGFuZ2VkIG9sZCB3aWR0aCB2YWx1ZS4NCgkJfQ0KCQlyZXR1cm4gZmFsc2U7DQoJfSwNCgkNCgkvKg0KCSAgY2FsY3VsYXRlIHByb3BlciBoZWlnaHQgdmFsdWUgZm9yIHRoZSBjb250YWluZXIgb2YgY3VycmVudCBlbGVtZW50J3MgcGFyZW50Lg0KCSAgd2UgY291bGRuJ3QgdG8ga25vdyBob3cgdGhlIGNvbnRhaW5lcidzIGlubmVyIGVsZW1lbnRzJyBzb3J0aW5nICwgc28gd2UgbmVlZCB0byBhZGQgYSBkaXYgZm9yIHRoZSANCgkgIGNvbnRhaW5lciB3aXRjaCBpbiB0aGUgbW9zdCBib3R0b20gYW5kIGRlbGV0ZSBpdCBhZnRlciBnZXQgdGhlIGRpdidzIG9mZnNldFRvcCB2YWx1ZSh0aGlzIGlzIHRoZSBjb250YWluZXIgbmVlZCBwcm9wZXIgaGVpZ2h0KQ0KCSovDQoJY2FsY3VsYXRlSGVpZ2h0IDogZnVuY3Rpb24ob2JqKXsNCgkJaWYodGhpcy5qdWRnZUlzTnVsbChvYmopKQ0KCQl7DQoJCQlyZXR1cm4gMDsNCgkJfQ0KCQl2YXIgcCA9IG9iai5wYXJlbnROb2RlOw0KCQlpZih0aGlzLmp1ZGdlSXNPYmoocCkpDQoJCXsNCgkJCWlmKHAubm9kZU5hbWUgPT0gIkZSQU1FU0VUIikNCgkJCXsNCgkJCQlyZXR1cm4gdGhpcy5mcmFtZXNUb3RhbEhlaWdodChwLG9iaik7DQoJCQl9DQoJCQl2YXIgb3duZXJEb2MgPSB0aGlzLmdldERvY3VtZW50KHApOw0KCQkJdmFyIGVsZUFycmF5ID0gdGhpcy5pc0hhdmVFbGVtZW50cyhwKTsNCgkJCWlmKGVsZUFycmF5Lmxlbmd0aCA+IDEpDQoJCQl7DQoJCQkJdmFyIHNjYWxlTGluZSA9IG93bmVyRG9jLmNyZWF0ZUVsZW1lbnQoIkRJViIpOw0KCQkJCQlzY2FsZUxpbmUuc3R5bGUuZm9udFNpemUgPSAiMXB4IjsNCgkJCQkJc2NhbGVMaW5lLnN0eWxlLndpZHRoID0gcC5zY3JvbGxXaWR0aCsicHgiOw0KCQkJCQlwLmFwcGVuZENoaWxkKHNjYWxlTGluZSk7DQoJCQkJdmFyIHRvdGFsSGVpZ2h0ID0gc2NhbGVMaW5lLm9mZnNldFRvcCAtIHAub2Zmc2V0VG9wOw0KCQkJCQl0aGlzLnJlbW92ZU5vZGUoc2NhbGVMaW5lKTsNCgkJCQlyZXR1cm4gdG90YWxIZWlnaHQ7DQoJCQl9DQoJCQllbHNlIGlmKGVsZUFycmF5Lmxlbmd0aCA9PSAxKQ0KCQkJew0KCQkJCXJldHVybiB0aGlzLmdldE9mZnNldEhlaWdodChvd25lckRvYywgZWxlQXJyYXlbMF0pOw0KCQkJfQ0KCQl9DQoJCXJldHVybiAwOw0KCX0sDQoJDQoJLy9qdWRnZSBjb250YWluZXIgaGFzIGJhc2UgZWxlbWVudCBvciBub3QuDQoJaXNIYXZlRWxlbWVudHMgOiBmdW5jdGlvbihjb250YWluZXIpew0KCQlpZih0aGlzLmp1ZGdlSXNPYmooY29udGFpbmVyKSkNCgkJew0KCQkJdmFyIGNfbm9kZXMgPSBjb250YWluZXIuY2hpbGROb2RlczsNCgkJCWlmKHRoaXMuanVkZ2VJc05vdE51bGwoY19ub2RlcykgJiYgY19ub2Rlcy5sZW5ndGggPiAwKQ0KCQkJew0KCQkJCXZhciBlbGVfQXJyYXkgPSBuZXcgQXJyYXkoKTsNCgkJCQlmb3IgKCB2YXIgaW5kZXggaW4gY19ub2RlcykgDQoJCQkJew0KCQkJCQl2YXIgbm9kZV9uYW1lID0gY19ub2Rlc1tpbmRleF0ubm9kZU5hbWU7DQoJCQkJCWlmKHR5cGVvZihub2RlX25hbWUpICE9ICJ1bmRlZmluZWQiICYmIG5vZGVfbmFtZSAhPSAiU0NSSVBUIiAmJiBub2RlX25hbWUgIT0gIk5PU0NSSVBUIiAmJiBub2RlX25hbWUgIT0gIkxJTksiKQ0KCQkJCQl7DQoJCQkJCQl2YXIgZWxlID0gY19ub2Rlc1tpbmRleF07DQoJCQkJCQlzd2l0Y2gobm9kZV9uYW1lKQ0KCQkJCQkJew0KCQkJCQkJCWNhc2UgIiNjb21tZW50IiA6DQoJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCWNhc2UgIklOUFVUIiA6DQoJCQkJCQkJCWlmKCF0aGlzLmp1ZGdlSXNIaWRkZW4oZWxlKSkNCgkJCQkJCQkJew0KCQkJCQkJCQkJZWxlX0FycmF5W2VsZV9BcnJheS5sZW5ndGhdID0gZWxlOw0KCQkJCQkJCQl9DQoJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCWNhc2UgIiN0ZXh0IiA6DQoJCQkJCQkJCWlmKGVsZS5ub2RlVmFsdWUucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCAiIikgIT0gIiIpDQoJCQkJCQkJCXsNCgkJCQkJCQkJCWVsZV9BcnJheVtlbGVfQXJyYXkubGVuZ3RoXSA9IGVsZTsNCgkJCQkJCQkJfQ0KCQkJCQkJCQlicmVhazsNCgkJCQkJCQlkZWZhdWx0Og0KCQkJCQkJCQlpZighdGhpcy5qdWRnZUlzSGlkZGVuKGVsZSkpDQoJCQkJCQkJCXsNCgkJCQkJCQkJCWVsZV9BcnJheVtlbGVfQXJyYXkubGVuZ3RoXSA9IGVsZTsNCgkJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJCWlmKGVsZV9BcnJheS5sZW5ndGggPT0gMSAmJiB0aGlzLmlzVGFyZ2V0T2JqVHlwZShlbGVfQXJyYXlbMF0sICJGT1JNIikpDQoJCQkJew0KCQkJCQllbGVfQXJyYXkgPSB0aGlzLmlzSGF2ZUVsZW1lbnRzKGVsZV9BcnJheVswXSk7DQoJCQkJfQ0KCQkJCXJldHVybiBlbGVfQXJyYXk7DQoJCQl9DQoJCX0NCgkJcmV0dXJuIG5ldyBBcnJheSgpOw0KCX0sDQoJDQoJanVkZ2VJc0hpZGRlbiA6IGZ1bmN0aW9uKGVsZSl7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihlbGUpKQ0KCQl7DQoJCQlpZighdGhpcy5qdWRnZUlzTnVsbChlbGUuc3R5bGUuZGlzcGxheSkpDQoJCQl7DQoJCQkJaWYoZWxlLnN0eWxlLmRpc3BsYXkudG9VcHBlckNhc2UoKSA9PSAiTk9ORSIpDQoJCQkJew0KCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQl9DQoJCQl9DQoJCQlpZighdGhpcy5qdWRnZUlzTnVsbChlbGUuc3R5bGUudmlzaWJpbGl0eSkpDQoJCQl7DQoJCQkJaWYoZWxlLnN0eWxlLnZpc2liaWxpdHkudG9VcHBlckNhc2UoKSA9PSAiSElEREVOIikNCgkJCQl7DQoJCQkJCXJldHVybiB0cnVlOw0KCQkJCX0NCgkJCX0NCgkJCWlmKCF0aGlzLmp1ZGdlSXNOdWxsKGVsZS50eXBlKSAmJiAhdGhpcy5qdWRnZUlzT2JqKGVsZS50eXBlKSkNCgkJCXsNCgkJCQlpZihlbGUudHlwZS50b1VwcGVyQ2FzZSgpID09ICJISURERU4iKQ0KCQkJCXsNCgkJCQkJcmV0dXJuIHRydWU7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9LA0KCQ0KCS8vanVkZ2UgY3VycmVudCBwYXJhbWV0ZXIgaXMgbnVsbCBvciBub3QNCglqdWRnZUlzTnVsbCA6IGZ1bmN0aW9uKGVsZSl7DQoJCWlmKGVsZSA9PSBudWxsIHx8IHR5cGVvZihlbGUpID09ICJ1bmRlZmluZWQiIHx8ICFlbGUpDQoJCXsNCgkJCXJldHVybiB0cnVlOw0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9LA0KDQoJanVkZ2VJc05vdE51bGwgOiBmdW5jdGlvbihlbGUpew0KCQlpZihlbGUgPT0gbnVsbCB8fCB0eXBlb2YoZWxlKSA9PSAidW5kZWZpbmVkIiB8fCAhZWxlKQ0KCQl7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkJcmV0dXJuIHRydWU7DQoJfSwNCgkNCgkvL2p1ZGdlIGN1cnJlbnQgcGFyYW1ldGVyIGlzIG9iamVjdCB0eXBlIG9yIG5vdA0KCWp1ZGdlSXNPYmogOiBmdW5jdGlvbihvYmopew0KCQl0cnl7DQoJCQlpZih0eXBlb2Yob2JqKSA9PSAib2JqZWN0IiAmJiBvYmoubm9kZU5hbWUgIT0gIiN0ZXh0IikNCgkJCXsNCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0NCgkJfWNhdGNoKGUpe30NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoJDQoJZ2V0RG9jdW1lbnRGcm9tRnJhbWUgOiBmdW5jdGlvbihmcmFtZU9iail7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihmcmFtZU9iaikpDQoJCXsNCgkJCXRyeQ0KCQkJew0KCQkJCXJldHVybiBmcmFtZU9iai5jb250ZW50V2luZG93LmRvY3VtZW50Ow0KCQkJfQ0KCQkJY2F0Y2goZSkNCgkJCXsNCgkJCQlyZXR1cm4gZnJhbWVPYmouZG9jdW1lbnQ7CQkJCQkNCgkJCX0NCgkJfQ0KCQlyZXR1cm4gZG9jdW1lbnQ7DQoJfSwNCgkNCglnZXREb2N1bWVudCA6IGZ1bmN0aW9uKGVsZSl7DQoJCWlmKHRoaXMuaXNUYXJnZXRPYmpUeXBlKGVsZSwgIklGUkFNRSIpIHx8IHRoaXMuaXNUYXJnZXRPYmpUeXBlKGVsZSwgIkZSQU1FIikpDQoJCXsNCgkJCXJldHVybiB0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKGVsZSk7DQoJCX0NCgkJcmV0dXJuIGVsZS5kb2N1bWVudCA/IGVsZS5kb2N1bWVudCA6IGVsZS5vd25lckRvY3VtZW50Ow0KCX0sDQoJDQoJc3RhcnRXb3JraW5nIDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJaWYoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSAibG9hZGluZyIpDQoJCXsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KCQlyZXR1cm4gdHJ1ZTsNCgl9LA0KCQ0KCXJlc2l6ZUlmcmFtZU5vSG9yaXpvbnRhbFNjcm9sbEJhciA6IGZ1bmN0aW9uKGlmcmFtZV8pew0KCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShpZnJhbWVfLCAiSUZSQU1FIikgJiYgIXRoaXMuanVkZ2VJc0hpZGRlbihpZnJhbWVfKSkNCgkJew0KCQkJdmFyIGRvYyA9IHRoaXMuZ2V0RG9jdW1lbnRGcm9tRnJhbWUoaWZyYW1lXyk7DQoJCQl2YXIgbWF4VmFsdWUgPSB0aGlzLmZpbmRTdWJOb2Rlc01heFZhbHVlKGRvYy5ib2R5KTsNCgkJCWlmKHRoaXMuanVkZ2VJc05vdE51bGwobWF4VmFsdWUpKXsNCgkJCQlpZnJhbWVfLnN0eWxlLndpZHRoID0gbWF4VmFsdWUubWF4X3dpZHRoKyJweCI7DQoJCQl9DQoJCX0NCgl9LA0KCQ0KCXJlc2l6ZUlmcmFtZU5vU2Nyb2xsQmFyIDogZnVuY3Rpb24oaWZyYW1lXyl7DQoJCWlmKCF0aGlzLmp1ZGdlSXNJZ25vcmVBbGxPclNlbGYoaWZyYW1lXykgJiYgdGhpcy5pc1RhcmdldE9ialR5cGUoaWZyYW1lXywgIklGUkFNRSIpICYmICF0aGlzLmp1ZGdlSXNIaWRkZW4oaWZyYW1lXykpDQoJCXsNCgkJCXZhciBkb2MgPSB0aGlzLmdldERvY3VtZW50RnJvbUZyYW1lKGlmcmFtZV8pOw0KCQkJdmFyIG1heFZhbHVlID0gdGhpcy5maW5kU3ViTm9kZXNNYXhWYWx1ZShkb2MuYm9keSk7DQoJCQlpZih0aGlzLmp1ZGdlSXNOb3ROdWxsKG1heFZhbHVlKSkNCgkJCXsNCgkJCQlpZnJhbWVfLnN0eWxlLndpZHRoID0gbWF4VmFsdWUubWF4X3dpZHRoKyJweCI7DQoJCQkJdGhpcy5zZXRTdHlsZUhlaWdodChpZnJhbWVfLCBtYXhWYWx1ZS5tYXhfaGVpZ2h0KTsNCgkJCX0NCgkJfQ0KCX0sDQoJDQoJanVkZ2VJc1BvcFVwSWdub3JlIDogZnVuY3Rpb24ob2JqKXsNCgkJaWYodGhpcy5qdWRnZUlzTnVsbChvYmoucG9wVXBBZGRJZ25vcmUpKQ0KCQl7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkJcmV0dXJuIHRydWU7DQoJfSwNCgkNCglqdWRnZUlzSWdub3JlQWxsT3JTZWxmIDogZnVuY3Rpb24ob2JqKXsNCgkJaWYodGhpcy5qdWRnZUlzSWdub3JlQWxsKG9iaikgfHwgdGhpcy5qdWRnZUlzSWdub3JlU2VsZihvYmopKQ0KCQl7DQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfQ0KCQlyZXR1cm4gZmFsc2U7DQoJfSwNCgkNCglqdWRnZUlzSWdub3JlQWxsIDogZnVuY3Rpb24ob2JqKXsNCgkJaWYgKHRoaXMuanVkZ2VJc09iaihvYmopKSANCgkJew0KCQkJdmFyIGlnbm9yZUF0dHIgPSB0aGlzLmdldEF0dHJpYnV0ZShvYmosICJpZ25vcmUiKTsNCgkJCWlmICh0aGlzLmp1ZGdlSXNOb3ROdWxsKGlnbm9yZUF0dHIpICYmIGlnbm9yZUF0dHIudG9VcHBlckNhc2UoKSA9PSAiQUxMIikgDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoNCglqdWRnZUlzSWdub3JlU2VsZiA6IGZ1bmN0aW9uKG9iaikgew0KCQlpZiAodGhpcy5qdWRnZUlzT2JqKG9iaikpIA0KCQl7DQoJCQl2YXIgaWdub3JlQXR0ciA9IHRoaXMuZ2V0QXR0cmlidXRlKG9iaiwgImlnbm9yZSIpOw0KCQkJaWYgKHRoaXMuanVkZ2VJc05vdE51bGwoaWdub3JlQXR0cikgJiYgaWdub3JlQXR0ci50b1VwcGVyQ2FzZSgpID09ICJTRUxGIikgDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoJDQoJZ2V0QXR0cmlidXRlIDogZnVuY3Rpb24ob2JqLCBhdHRyTmFtZSl7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihvYmopKQ0KCQl7DQoJCQl2YXIgYXR0ciA9IG9iai5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpOw0KCQkJaWYodGhpcy5qdWRnZUlzTnVsbChhdHRyKSkNCgkJCXsNCgkJCQlyZXR1cm4gZXZhbCgib2JqLiIrYXR0ck5hbWUpOw0KCQkJfQ0KCQkJcmV0dXJuIGF0dHI7DQoJCX0NCgkJcmV0dXJuIG51bGw7DQoJfSwNCgkNCglzZXRJZ25vcmVTZWxmIDogZnVuY3Rpb24ob2JqKXsNCgkJaWYodGhpcy5qdWRnZUlzT2JqKG9iaikpDQoJCXsNCgkJCW9iai5pZ25vcmU9IlNFTEYiOw0KCQl9DQoJfSwNCgkNCglzZXRJZ25vcmVBbGwgOiBmdW5jdGlvbihvYmopew0KCQlpZih0aGlzLmp1ZGdlSXNPYmoob2JqKSkNCgkJew0KCQkJb2JqLmlnbm9yZT0iQUxMIjsNCgkJfQ0KCX0sDQoJDQoJcmVtb3ZlU2ltdWxhdGVEaWFsb2cgOiBmdW5jdGlvbihvYmopew0KCQlpZih0aGlzLmp1ZGdlSXNPYmoob2JqKSkNCgkJew0KCQkJb2JqLnNpbXVsYXRlRGlhbG9nID0gbnVsbDsNCgkJCW9iai5yZW1vdmVBdHRyaWJ1dGUoInNpbXVsYXRlRGlhbG9nIik7DQoJCX0NCgl9LA0KCQ0KCXJlbW92ZUlnbm9yZSA6IGZ1bmN0aW9uKG9iail7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihvYmopKQ0KCQl7DQoJCQlvYmouaWdub3JlID0gbnVsbDsNCgkJCW9iai5yZW1vdmVBdHRyaWJ1dGUoImlnbm9yZSIpOw0KCQl9DQoJfSwNCg0KCXJlbW92ZUxvY2tlZEtleSA6IGZ1bmN0aW9uKG9iail7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihvYmopKQ0KCQl7DQoJCQlvYmoubG9ja2VkS2V5ID0gbnVsbDsNCgkJCW9iai5yZW1vdmVBdHRyaWJ1dGUoImxvY2tlZEtleSIpOw0KCQl9DQoJfSwNCg0KCXNldFN0eWxlSGVpZ2h0IDogZnVuY3Rpb24ob2JqLHZhbHVlKXsNCgkJDQoJCWlmKHRoaXMuanVkZ2VJc09iaihvYmopICYmIHRoaXMuanVkZ2VJc05vdE51bGwob2JqLm5vZGVOYW1lKSkNCgkgICAgew0KCSAgICAgIGlmKG9iai5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpICE9ICJURCIpDQoJICAgICAgew0KCQkgICB2YXIgY3NzVmFsdWU7DQoJICAgICAgICBpZihvYmoubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PSAiRElWIikNCgkgICAgICAgIHsNCgkgICAgICAgICAgY3NzVmFsdWUgPSAiYXV0byI7DQoJICAgICAgICB9DQoJDQoJICAgICAgICBpZih0aGlzLnJlZ0V4ZWMudGVzdCh2YWx1ZSkpDQoJICAgICAgICB7DQoJICAgICAgICAgIGNzc1ZhbHVlID0gcGFyc2VJbnQodmFsdWUpICsgJ3B4JzsNCgkgICAgICAgIH0NCgkgICAgICAgIG9iai5zdHlsZS5oZWlnaHQgPSBjc3NWYWx1ZTsNCgkgICAgICAgIGNvcnBzZUNvZGUob2JqLCB2YWx1ZSk7DQoJICAgICAgfQ0KCSAgICB9DQogICAgfSwNCgkNCglpc1RhcmdldE9ialR5cGUgOiBmdW5jdGlvbihlbGUsbm9kZU5hbWUpew0KCQlpZih0aGlzLmp1ZGdlSXNPYmooZWxlKSANCgkJCSYmIHRoaXMuanVkZ2VJc05vdE51bGwoZWxlLm5vZGVOYW1lKSANCgkJCSYmIHRoaXMuanVkZ2VJc05vdE51bGwobm9kZU5hbWUpKQ0KCQl7DQoJCQlpZihlbGUubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PSBub2RlTmFtZS50b1VwcGVyQ2FzZSgpKQ0KCQkJew0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQkNCgkJfQ0KCQlyZXR1cm4gZmFsc2U7DQoJfSwNCgkNCglpbml0SG9yaXpvbnRhbFNjcm9sbEJhclBvc2l0aW9uIDogZnVuY3Rpb24oZG9jdW1lbnRfLCBlbGUsIHZhbCl7DQoJCXZhciBldmVudF8gPSB3aW5kb3cuZXZlbnQ7DQoJCWlmKHRoaXMuanVkZ2VJc09iaihldmVudF8pICYmIGV2ZW50Xy50eXBlLnRvVXBwZXJDYXNlKCkgPT0gIkxPQUQiKQ0KCQl7DQoJCQl2YXIgYm9vbCA9IHRoaXMuY2hlY2tBcihkb2N1bWVudF8ucGFyZW50V2luZG93KTsNCgkJCWlmKGJvb2wpDQoJCQl7DQoJCQkJZWxlLnNjcm9sbFJpZ2h0ID0gdmFsOw0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KCQkJCWVsZS5zY3JvbGxMZWZ0ID0gdmFsOw0KCQkJfQ0KCQl9DQoJfSwNCgkNCgljaGVja0FyIDogZnVuY3Rpb24od2luKSB7DQoJCXZhciBpID0gMDsNCgkJd2hpbGUgKHdpbikgDQoJCXsNCgkJCWlmICh0aGlzLmp1ZGdlSXNOb3ROdWxsKHdpbi5wcm9maWxlKSkgDQoJCQl7DQoJCQkJaWYgKHdpbi5wcm9maWxlLmxhbmd1YWdlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigiYXIiKSA+PSAwKSANCgkJCQl7DQoJCQkJCXJldHVybiB0cnVlOw0KCQkJCX0gDQoJCQkJZWxzZSANCgkJCQl7DQoJCQkJCXJldHVybiBmYWxzZTsNCgkJCQl9DQoJCQl9DQoJCQl3aW4gPSB3aW4ucGFyZW50Ow0KCQkJaSsrOw0KCQkJaWYgKGkgPj0gMTApDQoJCQl7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoJDQoJY2hlY2tSZXN1bHQgOiBmdW5jdGlvbihkb2N1bWVudF8pIHsNCgkJZG9jdW1lbnRfLmJvZHkuc3R5bGUub3ZlcmZsb3dYID0gImF1dG8iOw0KCQl2YXIgaWZyYW1lXyA9IHRoaXMuZ2V0RnJhbWVFbGVtZW50KGRvY3VtZW50Xyk7DQoJCXZhciBpc0lnbm9yZSA9IHRoaXMuanVkZ2VJc0lnbm9yZUFsbE9yU2VsZihpZnJhbWVfKTsNCgkJdmFyIGlzU3lzUG9wV2luZG93ID0gdGhpcy5pc1BvcFVwV2luZG93KGRvY3VtZW50Xyk7DQoJCXZhciBpc0FjMzYwUG9wdXBXaW5kb3cgPSB0aGlzLmlzQUMzNjBQb3BVcChkb2N1bWVudF8pLmlzQUMzNjBQb3BVcDsNCgkJaWYgKCEoaXNJZ25vcmUgfHwgaXNTeXNQb3BXaW5kb3cgfHwgaXNBYzM2MFBvcHVwV2luZG93KSAmJiB0aGlzLmlzVGFyZ2V0T2JqVHlwZShpZnJhbWVfLCAiSUZSQU1FIikpIA0KCQl7DQoJCQl2YXIgcmVtYWluSGVpZ2h0ID0gZG9jdW1lbnRfLmJvZHkuc2Nyb2xsSGVpZ2h0IC0gZG9jdW1lbnRfLmJvZHkuY2xpZW50SGVpZ2h0OyANCgkJCXZhciByZW1haW5XaWR0aCA9IGRvY3VtZW50Xy5ib2R5LnNjcm9sbFdpZHRoIC0gZG9jdW1lbnRfLmJvZHkuY2xpZW50V2lkdGg7IA0KCQkJaWYgKHJlbWFpbkhlaWdodCA+PSAwICYmIHJlbWFpbldpZHRoID49IDANCgkJCQkJJiYgdGhpcy5TQ1JPTExfQkFSX1NJWkUgPj0gcmVtYWluSGVpZ2h0DQoJCQkJCSYmIHRoaXMuU0NST0xMX0JBUl9TSVpFID49IHJlbWFpbldpZHRoKQ0KCQkJew0KCQkJCWRvY3VtZW50Xy5ib2R5LnN0eWxlLm92ZXJmbG93WCA9ICJoaWRkZW4iOw0KCQkJCXJlbWFpbkhlaWdodCA9IGRvY3VtZW50Xy5ib2R5LnNjcm9sbEhlaWdodCAtIGRvY3VtZW50Xy5ib2R5LmNsaWVudEhlaWdodDsgDQoJCQkJcmVtYWluV2lkdGggPSBkb2N1bWVudF8uYm9keS5zY3JvbGxXaWR0aCAtIGRvY3VtZW50Xy5ib2R5LmNsaWVudFdpZHRoOyANCgkJCQlpZihyZW1haW5IZWlnaHQgIT0gMCB8fCByZW1haW5XaWR0aCAhPSAwKQ0KCQkJCXsNCgkJCQkJZG9jdW1lbnRfLmJvZHkuc3R5bGUub3ZlcmZsb3dYID0gImF1dG8iOw0KCQkJCX0NCgkJCQllbHNlIGlmKGRvY3VtZW50Xy5ib2R5LnNjcm9sbFdpZHRoID4gZG9jdW1lbnRfLmJvZHkuc2Nyb2xsV2lkdGggDQoJCQkJCQl8fCBkb2N1bWVudF8uYm9keS5zY3JvbGxIZWlnaHQgPiBkb2N1bWVudF8uYm9keS5zY3JvbGxIZWlnaHQpDQoJCQkJew0KCQkJCQlkb2N1bWVudF8uYm9keS5zdHlsZS5vdmVyZmxvd1ggPSAiYXV0byI7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfSwNCgkNCglzY3JvbGxUb1RhcmdldEVsZW1lbnQgOiBmdW5jdGlvbihjdXJyZW50RWxlLCB0YXJnZXRFbGVtZW50VHlwZSl7DQoJCWlmKHRoaXMuaXNUYXJnZXRPYmpUeXBlKGN1cnJlbnRFbGUsdGFyZ2V0RWxlbWVudFR5cGUpKQ0KCQl7DQoJCQlyZXR1cm4gY3VycmVudEVsZTsNCgkJfQ0KCQllbHNlIGlmKHRoaXMuaXNUYXJnZXRPYmpUeXBlKGN1cnJlbnRFbGUucGFyZW50Tm9kZSwgIkJPRFkiKSkNCgkJew0KCQkJcmV0dXJuIG51bGw7DQoJCX0NCgkJaWYodGhpcy5qdWRnZUlzT2JqKGN1cnJlbnRFbGUpICYmIHRoaXMuanVkZ2VJc09iaihjdXJyZW50RWxlLnBhcmVudE5vZGUpKQ0KCQl7DQoJCQlyZXR1cm4gdGhpcy5zY3JvbGxUb1RhcmdldEVsZW1lbnQoY3VycmVudEVsZS5wYXJlbnROb2RlLCB0YXJnZXRFbGVtZW50VHlwZSk7CQkJDQoJCX0NCgl9LA0KCQ0KCXJlbG9hZCA6IGZ1bmN0aW9uKGVsZW1lbnRPYmopew0KCQllbGVtZW50T2JqID0gdGhpcy5zY3JvbGxUb1RhcmdldEVsZW1lbnQoZWxlbWVudE9iaiwgIkRJViIpOw0KCQlpZih0aGlzLmp1ZGdlSXNPYmooZWxlbWVudE9iaikpDQoJCXsNCgkJCWVsZW1lbnRPYmouY2xhc3NOYW1lID0gZWxlbWVudE9iai5jbGFzc05hbWU7IA0KCQl9DQoJfSwNCgkNCglleGVjdXRlQ2FsbEJhY2sgOiBmdW5jdGlvbigpew0KCQlpZih0eXBlb2YodGhpcy5jYWxsQmFja0ZuKSA9PSAnZnVuY3Rpb24nKQ0KCQl7DQoJCQl2YXIgY29weUNhbGxCYWNrRm4gPSB0aGlzLmNhbGxCYWNrRm47IA0KCQkJZGVsZXRlIHRoaXMuY2FsbEJhY2tGbjsNCgkJCWNvcHlDYWxsQmFja0ZuKCk7DQoJCX0NCgkJdGhpcy5jYWxsQmFja0ZuID0gbnVsbDsNCgl9LA0KCQ0KCWV4cGFuc2lvbkZ1biA6IGZ1bmN0aW9uKGRvY3VtZW50Xyl7DQoJCXZhciBjdXJyZW50RnJhbWUgPSB0aGlzLmdldEZyYW1lRWxlbWVudChkb2N1bWVudF8pOw0KCQlpZih0aGlzLmlzVGFyZ2V0T2JqVHlwZShjdXJyZW50RnJhbWUsICJJRlJBTUUiKSkNCgkJew0KCQkJY3VycmVudEZyYW1lLmRvU2hvdyA9IGZ1bmN0aW9uKGlmcmFtZV8sZG9jdW1lbnRfKQ0KCQkJew0KCQkJCWlmKHRoaXMuanVkZ2VJc0hpZGRlbihpZnJhbWVfKSkNCgkJCQl7DQoJCQkJCWlmcmFtZV8uc3R5bGUuZGlzcGxheSA9ICIiOw0KCQkJCX0NCgkJCQl0aGlzLmF1dG9BZGp1c3RPdXRlckNvbnRhaW5lcihkb2N1bWVudF8pOw0KCQkJfS5iaW5kKHRoaXMsY3VycmVudEZyYW1lLGRvY3VtZW50Xyk7DQoJCQkNCgkJCWN1cnJlbnRGcmFtZS5kb0hpZGRlbiA9IGZ1bmN0aW9uKGlmcmFtZV8sZG9jdW1lbnRfKQ0KCQkJew0KCQkJCWlmKCF0aGlzLmp1ZGdlSXNIaWRkZW4oaWZyYW1lXykpDQoJCQkJew0KCQkJCQlpZnJhbWVfLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQoJCQkJfQ0KCQkJCXRoaXMuYXV0b0FkanVzdE91dGVyQ29udGFpbmVyKGRvY3VtZW50Xyk7DQoJCQl9LmJpbmQodGhpcyxjdXJyZW50RnJhbWUsZG9jdW1lbnRfKTsNCgkJfQ0KCX0sDQoJDQoJZ2V0RnJhbWVFbGVtZW50IDogZnVuY3Rpb24oZG9jdW1lbnRfKXsNCgkJdHJ5ew0KCQkJaWYodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJJRSIpDQoJCQl7DQoJCQkJcmV0dXJuIGRvY3VtZW50Xy5mcmFtZXMuZnJhbWVFbGVtZW50Ow0KCQkJfQ0KCQkJaWYodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJGaXJlZm94IikNCgkJCXsNCgkJCQlyZXR1cm4gZG9jdW1lbnRfLmRlZmF1bHRWaWV3LmZyYW1lRWxlbWVudDsNCgkJCX0NCgkJCWlmKHRoaXMuZ2V0QnJvd3NlclR5cGUoKSA9PSAiQ2hyb21lIikNCgkJCXsNCgkJCQlyZXR1cm4gZG9jdW1lbnRfLmRlZmF1bHRWaWV3LmZyYW1lRWxlbWVudDsNCgkJCX0NCgkJfWNhdGNoKGUpe30NCgl9LA0KCQ0KCWdldE9mZnNldEhlaWdodCA6IGZ1bmN0aW9uKGRvY3VtZW50XywgZWxlKXsNCgkJaWYodGhpcy5qdWRnZUlzT2JqKGVsZSkpDQoJCXsNCgkJCXZhciBpc0Zsb2F0RWxlID0gdGhpcy5pc0Zsb2F0RWxlbWVudChkb2N1bWVudF8sIGVsZSk7DQoJCQlpZihlbGUub2Zmc2V0SGVpZ2h0ID4gZWxlLnNjcm9sbEhlaWdodCkNCgkJCXsNCgkJCQlyZXR1cm4gaXNGbG9hdEVsZSAmJiB0aGlzLnJlZ0V4ZWMudGVzdChlbGUub2Zmc2V0VG9wKSANCgkJCQkJCT8gZWxlLm9mZnNldEhlaWdodCArIGVsZS5vZmZzZXRUb3AgDQoJCQkJCQk6IGVsZS5vZmZzZXRIZWlnaHQ7DQoJCQl9DQoJCQlyZXR1cm4gaXNGbG9hdEVsZSAmJiB0aGlzLnJlZ0V4ZWMudGVzdChlbGUub2Zmc2V0VG9wKSANCgkJCQkJPyBlbGUuc2Nyb2xsSGVpZ2h0ICsgZWxlLm9mZnNldFRvcCANCgkJCQkJOiBlbGUuc2Nyb2xsSGVpZ2h0Ow0KCQl9DQoJfSwNCgkNCglyZW1vdmVOb2RlIDogZnVuY3Rpb24oZWxlKXsNCgkJaWYodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJJRSIpDQoJCXsNCgkJCWVsZS5yZW1vdmVOb2RlKHRydWUpOwkNCgkJfQ0KCQlpZih0aGlzLmdldEJyb3dzZXJUeXBlKCkgPT0gIkZpcmVmb3giKQ0KCQl7DQoJCQllbGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGUpOw0KCQl9DQoJCWlmKHRoaXMuZ2V0QnJvd3NlclR5cGUoKSA9PSAiQ2hyb21lIikNCgkJew0KCQkJZWxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlKTsNCgkJfQ0KCX0sDQoJDQoJZ2V0Q3VycmVudFN0eWxlIDogZnVuY3Rpb24oZG9jdW1lbnRfLCBlbGUpew0KCQlpZih0aGlzLmdldEJyb3dzZXJUeXBlKCkgPT0gIklFIikNCgkJew0KCQkJcmV0dXJuIGVsZS5jdXJyZW50U3R5bGU7DQoJCX0NCgkJaWYodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJGaXJlZm94IikNCgkJew0KCQkJcmV0dXJuIGRvY3VtZW50Xy5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZSxmYWxzZSk7DQoJCX0NCgkJaWYodGhpcy5nZXRCcm93c2VyVHlwZSgpID09ICJDaHJvbWUiKQ0KCQl7DQoJCQlyZXR1cm4gZG9jdW1lbnRfLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlLGZhbHNlKTsNCgkJfQ0KCX0sDQoJDQoJZ2V0QnJvd3NlclR5cGUgOiBmdW5jdGlvbigpew0KCSAgIGlmKCF0aGlzLmJyb3dzZXJUeXBlKQ0KCSAgIHsNCgkJICAgaWYgKCEhd2luZG93LkFjdGl2ZVhPYmplY3QgfHwgIkFjdGl2ZVhPYmplY3QiIGluIHdpbmRvdykgIA0KCQkgICB7ICANCgkJCSAgIHRoaXMuYnJvd3NlclR5cGUgPSAiSUUiOyAgDQoJCSAgIH0gIA0KCQkgICBlbHNlIGlmKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiRmlyZWZveCIpPjApDQoJCSAgIHsgIA0KCQkJICAgdGhpcy5icm93c2VyVHlwZSA9ICJGaXJlZm94IjsgIA0KCQkgICB9ICANCgkJICAgZWxzZSBpZih3aW5kb3cuTWVzc2FnZUV2ZW50ICYmICFkb2N1bWVudC5nZXRCb3hPYmplY3RGb3IgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKSA+PSAwKQ0KCQkgICB7DQoJCQkgICB0aGlzLmJyb3dzZXJUeXBlID0gIkNocm9tZSI7DQoJCSAgIH0gDQoJCSAgIGVsc2UNCgkJICAgew0KCQkJICAgdGhpcy5icm93c2VyVHlwZSA9ICJJRSI7ICANCgkJICAgfQ0KCSAgIH0NCgkgICByZXR1cm4gdGhpcy5icm93c2VyVHlwZTsNCgl9LA0KCQ0KCXNpbXVsYXRlRGlhbG9nV2luZG93IDogZnVuY3Rpb24oZG9jdW1lbnRfKSB7DQoJCXZhciBpc1NGT0RTID0gdGhpcy5qdWRnZUlzT2JqKHRoaXMuZGlhbG9nU2ltdWxhdGlvbklmcmFtZSk7ICAgDQoJCWlmKGlzU0ZPRFMpDQoJCXsNCgkJCXZhciBmcmFtZV8gPSB0aGlzLmdldEZyYW1lRWxlbWVudChkb2N1bWVudCk7DQoJCQl0aGlzLnJlbW92ZVNpbXVsYXRlRGlhbG9nKGZyYW1lXyk7DQoJCQl2YXIgZGlhbG9nU2ltdWxhdGlvbldpbiA9IHRoaXMuZGlhbG9nU2ltdWxhdGlvbklmcmFtZS5jb250ZW50V2luZG93Ow0KCQkJZG9jdW1lbnRfLmRlZmF1bHRWaWV3LmRpYWxvZ0FyZ3VtZW50cyA9IGRpYWxvZ1NpbXVsYXRpb25XaW4uZGlhbG9nQXJndW1lbnRzOw0KCQkJdmFyIG5ld0Nsb3NlRm4gPSBmdW5jdGlvbihzY3JvbGxCYXJJbnN0YW5jZSkgDQoJCQl7DQoJCQkJdmFyIGRpYWxvZ0Nsb3NlSWNvbiA9IHNjcm9sbEJhckluc3RhbmNlLmdldFByZXZpb3VzRWxlbWVudChzY3JvbGxCYXJJbnN0YW5jZS5kaWFsb2dTaW11bGF0aW9uSWZyYW1lKTsNCgkJCQlBYzM2MC5kaXNwYXRjaEV2ZW50KGRpYWxvZ0Nsb3NlSWNvbiwgImNsaWNrIik7DQoJCQl9Ow0KCQkJZGlhbG9nU2ltdWxhdGlvbldpbi5jbG9zZSA9IG5ld0Nsb3NlRm4uYmluZChkaWFsb2dTaW11bGF0aW9uV2luLCB0aGlzKTsNCgkJCXZhciBkaWFsb2dTaW11bGF0aW9uRG9jID0gdGhpcy5kaWFsb2dTaW11bGF0aW9uSWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7DQoJCQl2YXIgc3ViSWZyYW1lcyA9IGRpYWxvZ1NpbXVsYXRpb25Eb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlmcmFtZSIpOw0KCQkJaWYodGhpcy5qdWRnZUlzTm90TnVsbChzdWJJZnJhbWVzKSAmJiBzdWJJZnJhbWVzLmxlbmd0aCA+IDApDQoJCQl7DQoJCQkJdmFyIHN1YklmcmFtZTsNCgkJCQlmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCBzdWJJZnJhbWVzLmxlbmd0aCA7IGluZGV4KyspDQoJCQkJew0KCQkJCQlzdWJJZnJhbWUgPSBzdWJJZnJhbWVzW2luZGV4XTsNCgkJCQkJc3ViSWZyYW1lLmNvbnRlbnRXaW5kb3cuZGlhbG9nQXJndW1lbnRzID0gZGlhbG9nU2ltdWxhdGlvbldpbi5kaWFsb2dBcmd1bWVudHM7DQoJCQkJCS8vVGhpcyBpcyB1c2VkIHRvIHByb2Nlc3MgSWZyYW1lIHN0cnVjdHVyZS4NCgkJCQkJc3ViSWZyYW1lLmNvbnRlbnRXaW5kb3cuY2xvc2UgPSBuZXdDbG9zZUZuLmJpbmQoc3ViSWZyYW1lLmNvbnRlbnRXaW5kb3csIHRoaXMpOw0KCQkJCX0NCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQkvL1RoaXMgaXMgdXNlZCB0byBwcm9jZXNzIEZyYW1lc2V0IHN0cnVjdHVyZS4NCgkJCQlkb2N1bWVudF8uZGVmYXVsdFZpZXcuY2xvc2UgPSBuZXdDbG9zZUZuLmJpbmQoZG9jdW1lbnRfLmRlZmF1bHRWaWV3LCB0aGlzKTsNCgkJCX0NCgkJfQ0KCX0sDQoJDQoJY2xvc2VTaW11bGF0ZURpYWxvZ1dpbmRvdyA6IGZ1bmN0aW9uKHdpbmRvd18pIHsNCgkJdmFyIGRvY3VtZW50XyA9IHRoaXMuZ2V0RG9jdW1lbnQod2luZG93Xyk7DQoJCXRoaXMuZmluZFRvcElmcmFtZShkb2N1bWVudF8pOw0KCQl0aGlzLnNpbXVsYXRlRGlhbG9nV2luZG93KGRvY3VtZW50Xyk7DQoJCXdpbmRvd18uY2xvc2UoKTsNCgl9LA0KCQ0KCWdldFJhbmRvbVN0cmluZyA6IGZ1bmN0aW9uKCkgew0KCSAgICB2YXIgJGNoYXJzID0gJ0FCQ0RFRkdISktNTlBRUlNUV1hZWmFiY2RlZmhpamttbnByc3R3eHl6MjM0NTY3OCc7IA0KCSAgICB2YXIgbWF4UG9zID0gJGNoYXJzLmxlbmd0aDsNCgkgICAgdmFyIGtleSA9ICcnOw0KCSAgICBmb3IgKGkgPSAwOyBpIDwgMTg7IGkrKykgDQoJICAgIHsNCgkgICAgCWtleSArPSAkY2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heFBvcykpOw0KCSAgICB9DQoJICAgIHJldHVybiBrZXk7DQoJfSwNCgkNCgl2YWxpZGF0ZUxvY2tlZEtleSA6IGZ1bmN0aW9uKGVsZSwga2V5KXsNCgkJaWYodGhpcy5qdWRnZUlzT2JqKGVsZSkpDQoJCXsNCgkJCXZhciBsb2NrZWRLZXkgPSB0aGlzLmdldEF0dHJpYnV0ZShlbGUsICJsb2NrZWRLZXkiKTsgDQoJCQlpZih0aGlzLmp1ZGdlSXNOb3ROdWxsKGxvY2tlZEtleSkpDQoJCQl7DQoJCQkJdmFyIHNpbXVsYXRlRGlhbG9nID0gdGhpcy5nZXRBdHRyaWJ1dGUoZWxlLCAic2ltdWxhdGVEaWFsb2ciKTsgDQoJCQkJaWYodGhpcy5qdWRnZUlzTm90TnVsbChzaW11bGF0ZURpYWxvZykpDQoJCQkJew0KCQkJCQlyZXR1cm4gbG9ja2VkS2V5ID09PSBrZXkgPyB0cnVlIDogZmFsc2U7DQoJCQkJfQ0KCQkJCWVsc2UgaWYodGhpcy5qdWRnZUlzTm90TnVsbChrZXkpKQ0KCQkJCXsNCgkJCQkJcmV0dXJuIGxvY2tlZEtleSA9PT0ga2V5ID8gdHJ1ZSA6IGZhbHNlOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCQlyZXR1cm4gdHJ1ZTsNCgl9DQp9Ow==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="1030891968" offset="0" length="599" />
        <PacketInfo time="1030891984" offset="599" length="11716" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>