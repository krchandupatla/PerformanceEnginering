<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="186">
  <HTTPTask id="188" hostname="aa-pt6245.dev.accela.com:5443" path="/portlets/framework/includes/javascript/ac360base.js" url="https://aa-pt6245.dev.accela.com:5443/portlets/framework/includes/javascript/ac360base.js" ip="13.93.163.237" port="5443" client_ip="10.1.61.63" client_port="11584" connectionId="2032" origin="Primary" startDateTime="2017-08-28T11:38:08.769-07:00" startTime="7888" endTime="7901" sendTime="11" waitTime="1" receiveTime="2">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Referer" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9jb21tb25zL2NhcC9teUNBUERldGFpbFBvcnRsZXQuanNwP21vZHVsZT0tc2VsZWN0LQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SlNFU1NJT05JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEpTRVNTSU9OSUQ9KioqKioqKioqKioqKioqKioqKioqKioqKioqOyBMQVNURVNUX1JFUVVFU1RfVElNRT0xNTAzOTQ1NDg2MzM3OyBob3N0U2lnbk9uPXRydWU7IGdfY3VycmVudF9sYW5ndWFnZV9leHQ9ZW5fVVM7IExBVEVTVF9XRUJfU0VSVkVSPTEwLjEuMC42OyBMQVRFU1RfU0VTU0lPTl9JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEFDQXV0aD03NzM2MjAxNDkzMTM2NjIyNTcyODg2NTM3NDA1MDg5NjkxODQ2NjMzNjY3Mjk5NTA0OTExNDkxODQyNTA1OTgyNjUyODk1OTAxNjQyMTUyNjM4NjkxNzE2NDgzNTExNzc1MzY1MTQ2NjI3NDczOTk4MzMzMTI2NDU1ODMzODM2MDsgQUNTaWduT25Nb2R1bGU9U1NPU3RhbmRhcmQ7IEFBUGVyc2lzdExvZ2luU2VydlByb3ZDb2RlPUZMQUdTVEFGRjsgTG9naW5TZXJ2UHJvdkNvZGU0TXVsdGlBZ2VuY3k9RkxBR1NUQUZGOyBMb2dpblVzZXJuYW1lNE11bHRpQWdlbmN5PTE3OUREMTNBMTg2MDI4RjQ7IEFDU2lnbm9mZj0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9zZWN1cml0eS9zaWdub3V0LmRvIjsgQUNTd2l0Y2hBZ2VuY3k9Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9wb3J0bGV0cy9mcmFtZXdvcmsvaW5jbHVkZXMvamF2YXNjcmlwdC9hYzM2MGJhc2UuanMgSFRUUC8xLjENClJlZmVyZXI6IGh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9jYXAvbXlDQVBEZXRhaWxQb3J0bGV0LmpzcD9tb2R1bGU9LXNlbGVjdC0NClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbw0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTDQpBY2NlcHQ6ICovKg0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KSG9zdDogYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMNCkNvb2tpZTogSlNFU1NJT05JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEpTRVNTSU9OSUQ9KioqKioqKioqKioqKioqKioqKioqKioqKioqOyBMQVNURVNUX1JFUVVFU1RfVElNRT0xNTAzOTQ1NDg2MzM3OyBob3N0U2lnbk9uPXRydWU7IGdfY3VycmVudF9sYW5ndWFnZV9leHQ9ZW5fVVM7IExBVEVTVF9XRUJfU0VSVkVSPTEwLjEuMC42OyBMQVRFU1RfU0VTU0lPTl9JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEFDQXV0aD03NzM2MjAxNDkzMTM2NjIyNTcyODg2NTM3NDA1MDg5NjkxODQ2NjMzNjY3Mjk5NTA0OTExNDkxODQyNTA1OTgyNjUyODk1OTAxNjQyMTUyNjM4NjkxNzE2NDgzNTExNzc1MzY1MTQ2NjI3NDczOTk4MzMzMTI2NDU1ODMzODM2MDsgQUNTaWduT25Nb2R1bGU9U1NPU3RhbmRhcmQ7IEFBUGVyc2lzdExvZ2luU2VydlByb3ZDb2RlPUZMQUdTVEFGRjsgTG9naW5TZXJ2UHJvdkNvZGU0TXVsdGlBZ2VuY3k9RkxBR1NUQUZGOyBMb2dpblVzZXJuYW1lNE11bHRpQWdlbmN5PTE3OUREMTNBMTg2MDI4RjQ7IEFDU2lnbm9mZj0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9zZWN1cml0eS9zaWdub3V0LmRvIjsgQUNTd2l0Y2hBZ2VuY3k9Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="JSESSIONID" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dlprbHVkcWdqOFpqR00yb29qT05Fa09K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="JSESSIONID" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>KioqKioqKioqKioqKioqKioqKioqKioqKioq</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LASTEST_REQUEST_TIME" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTUwMzk0NTQ4NjMzNw==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="hostSignOn" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dHJ1ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="g_current_language_ext" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW5fVVM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_WEB_SERVER" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTAuMS4wLjY=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_SESSION_ID" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dlprbHVkcWdqOFpqR00yb29qT05Fa09K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACAuth" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzczNjIwMTQ5MzEzNjYyMjU3Mjg4NjUzNzQwNTA4OTY5MTg0NjYzMzY2NzI5OTUwNDkxMTQ5MTg0MjUwNTk4MjY1Mjg5NTkwMTY0MjE1MjYzODY5MTcxNjQ4MzUxMTc3NTM2NTE0NjYyNzQ3Mzk5ODMzMzEyNjQ1NTgzMzgzNjA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignOnModule" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>U1NPU3RhbmRhcmQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="AAPersistLoginServProvCode" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginServProvCode4MultiAgency" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginUsername4MultiAgency" index="11">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTc5REQxM0ExODYwMjhGNA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignoff" index="12">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvc2VjdXJpdHkvc2lnbm91dC5kbyI=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSwitchAgency" index="13">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QXBhY2hlLUNveW90ZS8xLjE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHJpdmF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBVVEM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-XSS-Protection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFTVEVTVF9SRVFVRVNUX1RJTUU9MTUwMzk0NTQ4NjM1MzsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFURVNUX1dFQl9TRVJWRVI9MTAuMS4wLjY7IERvbWFpbj1kZXYuYWNjZWxhLmNvbTsgUGF0aD0vOyBTZWN1cmU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFURVNUX1NFU1NJT05fSUQ9dlprbHVkcWdqOFpqR00yb29qT05Fa09KOyBEb21haW49ZGV2LmFjY2VsYS5jb207IFBhdGg9LzsgU2VjdXJl</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Vy8iNTQzMTctMTQ5ODc0NzEzNjAwMCI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAyOSBKdW4gMjAxNyAxNDozODo1NiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9qYXZhc2NyaXB0</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Transfer-Encoding" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2h1bmtlZA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOCBBdWcgMjAxNyAxODozODowNSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IEFwYWNoZS1Db3lvdGUvMS4xDQpDYWNoZS1Db250cm9sOiBwcml2YXRlDQpFeHBpcmVzOiBUaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIFVUQw0KWC1YU1MtUHJvdGVjdGlvbjogMA0KU2V0LUNvb2tpZTogTEFTVEVTVF9SRVFVRVNUX1RJTUU9MTUwMzk0NTQ4NjM1MzsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZQ0KU2V0LUNvb2tpZTogTEFURVNUX1dFQl9TRVJWRVI9MTAuMS4wLjY7IERvbWFpbj1kZXYuYWNjZWxhLmNvbTsgUGF0aD0vOyBTZWN1cmUNClNldC1Db29raWU6IExBVEVTVF9TRVNTSU9OX0lEPXZaa2x1ZHFnajhaakdNMm9vak9ORWtPSjsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZQ0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkVUYWc6IFcvIjU0MzE3LTE0OTg3NDcxMzYwMDAiDQpMYXN0LU1vZGlmaWVkOiBUaHUsIDI5IEp1biAyMDE3IDE0OjM4OjU2IEdNVA0KQ29udGVudC1UeXBlOiB0ZXh0L2phdmFzY3JpcHQNClRyYW5zZmVyLUVuY29kaW5nOiBjaHVua2VkDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkRhdGU6IE1vbiwgMjggQXVnIDIwMTcgMTg6Mzg6MDUgR01UDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>Ly9BY2NlbGEgQXV0b21hdGlvbg0KLy9GaWxlOiBhYzM2MGJhc2UuanMNCi8vQWNjZWxhLCBJbmMuDQovL0NvcHlyaWdodCAoQyk6IDIwMTAtMjAxNA0KaWYgKHR5cGVvZiBqUXVlcnkgPT09ICJ1bmRlZmluZWQiKQ0Kew0KCWRvY3VtZW50LndyaXRlKCI8c2NyaXB0IHNyYz0nL3BvcnRsZXRzL2ZyYW1ld29yay9pbmNsdWRlcy9qYXZhc2NyaXB0L2pxdWVyeS9qcXVlcnktMS4xMS4wLm1pbi5qcyc+PC9zY3JpcHQ+Iik7ICANCn0NCmRvY3VtZW50LndyaXRlKCI8c2NyaXB0IHNyYz0nL3BvcnRsZXRzL2ZyYW1ld29yay9pbmNsdWRlcy9qYXZhc2NyaXB0L2hhc2hNYXAuanMnPjwvc2NyaXB0PiIpOw0KZG9jdW1lbnQud3JpdGUoIjxzY3JpcHQgc3JjPScvcG9ydGxldHMvZnJhbWV3b3JrL2luY2x1ZGVzL2phdmFzY3JpcHQvYWMzNjB1aS5qcyc+PC9zY3JpcHQ+Iik7DQpkb2N1bWVudC53cml0ZSgiPHNjcmlwdCBzcmM9Jy9wb3J0bGV0cy9mcmFtZXdvcmsvaW5jbHVkZXMvamF2YXNjcmlwdC9hYzM2MFNjcm9sbEJhci5qcyc+PC9zY3JpcHQ+Iik7DQpkb2N1bWVudC53cml0ZSgiPHNjcmlwdCBzcmM9Jy9wb3J0bGV0cy9mcmFtZXdvcmsvaW5jbHVkZXMvamF2YXNjcmlwdC9BYzM2MFRvb2xNYW5hZ2VyLmpzJz48L3NjcmlwdD4iKTsNCg0KZnVuY3Rpb24gZ2V0QmFzZVVSTCgpDQp7DQoJdmFyIHJvb3QgPSBsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0Ow0KCXJldHVybiByb290Ow0KfQ0KDQpmdW5jdGlvbiBpc0lFQnJvd3NlcigpDQp7DQogICByZXR1cm4gKCJBY3RpdmVYT2JqZWN0IiBpbiB3aW5kb3cpOwkNCn0NCg0KdmFyIGlzRnJvbUZvcm1SZXBvcnQgPSBmYWxzZTsNCmZ1bmN0aW9uIG9wZW5Gb3JtUmVwb3J0KHJlcG9ydElELHByaW50T25seSkNCnsNCglpc0Zyb21Gb3JtUmVwb3J0ID0gdHJ1ZTsNCgl2YXIgcG9ydGxldFZhcnNWYWx1ZSA9IG51bGw7DQoJdmFyIHBvcnRsZXRWYXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvcnRsZXRWYXJzIik7DQoJaWYgKHBvcnRsZXRWYXJzKQ0KCXsNCgkJcG9ydGxldFZhcnNWYWx1ZSA9IHBvcnRsZXRWYXJzLnZhbHVlOw0KCX0NCgkNCgl2YXIgaWRzID0gbnVsbDsNCglpZiAodHlwZW9mIGdldElEICE9ICd1bmRlZmluZWQnKSB7DQoJCXZhciBpZHMgPSBnZXRJRCgpOw0KCX0NCgljaGVja0RvY1RlbXAocmVwb3J0SUQsbnVsbCxpZHMscHJpbnRPbmx5LHBvcnRsZXRWYXJzVmFsdWUsIG51bGwpOw0KfQ0KDQovL0dldCBwYXJhbWV0ZXIgdmFsdWUgZnJvbSBxdWVyeSBTdHJpbmcNCmZ1bmN0aW9uIGd1cChuYW1lICkNCnsNCgkgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xbXS8sIlxcXFsiKS5yZXBsYWNlKC9bXF1dLywiXFxcXSIpOw0KCSB2YXIgcmVnZXhTID0gIltcXD8mXSIrbmFtZSsiPShbXiYjXSopIjsNCgkgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCggcmVnZXhTICk7DQoJIHZhciByZXN1bHRzID0gcmVnZXguZXhlYyggd2luZG93LmxvY2F0aW9uLmhyZWYgKTsNCgkgaWYoIHJlc3VsdHMgPT0gbnVsbCApDQoJCXJldHVybiAiIjsNCgkgZWxzZQ0KCQlyZXR1cm4gcmVzdWx0c1sxXTsNCn0NCg0KZnVuY3Rpb24gZ2V0UG9ydGxldFZhcnMocmVwb3J0SUQsY2hlY2tJRHNTdHIpDQp7DQoJdmFyIHNlcnZpY2VVUkwgPSB3aW5kb3cubG9jYXRpb24uaHJlZiArICImZ2V0UG9ydGxldFZhcj1ZJkV4cG9ydEZpbGVUeXBlPXBhZ2luZ0NzdiZyZXBvcnRJRD0iICsgcmVwb3J0SUQgKyAiJklEcz0iICsgY2hlY2tJRHNTdHI7DQoJdmFyIGZvcm0xID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm9ybU5hbWUpOw0KCXZhciByZXQgPSBudWxsOw0KCUFjY2VsYURvam8ueGhyUG9zdCh7DQoJCQl1cmw6IHNlcnZpY2VVUkwsDQoJCQlzeW5jOnRydWUsDQoJCQloYW5kbGVBczoianNvbiIsDQoJCQlmb3JtOiBmb3JtMSwNCgkJCWxvYWQ6IGZ1bmN0aW9uKHR5cGUsIGRhdGEsIGV2dCl7DQoJCQkJcmV0ID0gdHlwZS5tc2c7DQoJCQl9LA0KCQkJZXJyb3I6IGZ1bmN0aW9uKHR5cGUsIGVycm9yKQ0KCQkJew0KCQkJCWFsZXJ0KCdlcnJvcicpOw0KCQkJfQ0KCX0pOw0KCXJldHVybiByZXQ7DQp9DQoNCmZ1bmN0aW9uIGNvbnN0cnVjdFVSTCh1cmxTdHJpbmcsIHBvcnRsZXRJRCwgZm9ybU5hbWUsIG9iamVjdE5hbWUsIHJvd0luZGV4LCBwYWdlTm8sIHBhZ2VTaXplKQ0Kew0KCXZhciByZXQgPSB1cmxTdHJpbmcgKyAiJnBvcnRsZXRJRD0iICsgcG9ydGxldElEICsgIiZmb3JtTmFtZT0iICsgZm9ybU5hbWU7DQoJcmV0ID0gcmV0ICsgIiZvYmplY3ROYW1lPSIgKyBvYmplY3ROYW1lICsgIiZyb3dJbmRleD0iICsgcm93SW5kZXg7DQoJcmV0ID0gcmV0ICsgIiZwYWdlTm89IiArIHBhZ2VObyArICImcGFnZVNpemU9IiArIHBhZ2VTaXplOw0KCXJldHVybiByZXQ7DQoNCn0NCg0KdmFyIGNoZWNrSURzID0gbnVsbDsNCmZ1bmN0aW9uIG9wZW5MaXN0UmVwb3J0KHJlcG9ydElELHNpbmdsZVdpbmRvdyxJRHMscHJpbnRPbmx5LHNhdmUyRURNUyxoYXNQb3J0bGV0VmFyKQ0KewkJCQ0KCWlzRnJvbUZvcm1SZXBvcnQgPSBmYWxzZTsNCglpZihJRHM9PSIifHxJRHM9PW51bGwpDQoJew0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KCWVsc2UNCgl7DQoJCXZhciBJRHNTcGxpdD1JRHMrIixudWxsIjsNCgkJdmFyIElzPUlEc1NwbGl0LnNwbGl0KCIsIik7DQoJCXZhciBsZW5ndGhJPUlzLmxlbmd0aDsJCQ0KCQl2YXIgZWRtc1N0cmluZyA9ICcnOw0KCQlpZihsZW5ndGhJID4gMikNCgkJew0KCQkJZWRtc1N0cmluZyA9ICImTm90U2F2ZVRvRURNUz1ZIjsNCgkJCWlmKHNhdmUyRURNUyAhPW51bGwgJiYgc2F2ZTJFRE1TPT0iMSIpDQoJCQl7DQoJCQkJYWxlcnQoY2FuTm90U2F2ZVJlcG9ydCk7DQoJCQl9DQoJCX0NCgkJdmFyIG9iamVjdE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib2JqZWN0TmFtZSIpLnZhbHVlOw0KCQlpZiAobGVuZ3RoSSA8PSAyICYmIHNhdmUyRURNUyAhPW51bGwgJiYgc2F2ZTJFRE1TPT0iMSIpDQoJCXsJCQkNCgkJCWNoZWNrRG9jVGVtcChyZXBvcnRJRCxzaW5nbGVXaW5kb3csSURzLHByaW50T25seSxoYXNQb3J0bGV0VmFyLCBlZG1zU3RyaW5nKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCXZhciBvYmplY3ROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm9iamVjdE5hbWUiKS52YWx1ZTsNCgkJCXZhciBwYWdlU2l6ZVIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFnZVNpemVSIik7DQoJCQl2YXIgaXNEeW5hUGFnaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlzRHluYVBhZ2luZyIpOw0KCQkJdmFyIHZpZXdJRCA9IGdldFZpZXdJRCgpOw0KCQkJdmFyIGNoZWNrSURzU3RyID0gZ2V0Q2hlY2tJRHNTdHIoSURzKTsNCgkJCXBvcHVwUmVwb3J0QWZ0ZXJDaGVja0RvY1RlbXAocmVwb3J0SUQsc2luZ2xlV2luZG93LElEcyxwcmludE9ubHksaGFzUG9ydGxldFZhcixlZG1zU3RyaW5nLG9iamVjdE5hbWUsdmlld0lELHBhZ2VTaXplUixpc0R5bmFQYWdpbmcsY2hlY2tJRHNTdHIsY2hlY2tJRHMsY3Vyck1vZHVsZSkNCgkJfQ0KCX0NCn0NCg0KZnVuY3Rpb24gZ2V0Q2hlY2tJRHNTdHIoSURzKQ0Kew0KCXZhciByb3dJRHM7DQoJaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCkNCgl7DQoJCXJvd0lEcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0W2lkPSdhYzM2MF9saXN0X2lkJ10iKTsNCgl9DQoJZWxzZQ0KCXsNCgkJcm93SURzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoImFjMzYwX2xpc3RfaWQiKTsNCgl9DQoJdmFyIElEc1NwbGl0PUlEcysiLG51bGwiOw0KCXZhciBsZW5ndGhJPUlEc1NwbGl0LnNwbGl0KCIsIikubGVuZ3RoOwkNCgljaGVja0lEcyA9IG5ldyBBcnJheShsZW5ndGhJLTEpOw0KCXZhciBjaGVja0lEc1N0ciA9ICIiOw0KCXZhciBpc1JhaWRvID0gZmFsc2U7Ly9SYWlkbyBpZHMgaGFzIG5vIGNoZWNrQWxsDQoJdmFyIHN0YXJ0SW5kZXggPSAxOw0KCWlmKHJvd0lEc1swXSAhPSBudWxsICYmIHJvd0lEc1swXS50eXBlPT0icmFkaW8iKQ0KCXsJDQoJCXN0YXJ0SW5kZXggPSAwOw0KCX0NCgl2YXIgY2hlY2tJbmRleCA9IDA7DQoJZm9yKHJvd0luZGV4PXN0YXJ0SW5kZXg7IHJvd0luZGV4IDwgcm93SURzLmxlbmd0aDsgcm93SW5kZXgrKykNCgl7DQoJCWlmKHJvd0lEc1tyb3dJbmRleF0uY2hlY2tlZCkNCgkJew0KCQkJY2hlY2tJRHNbY2hlY2tJbmRleF0gPSByb3dJbmRleCAtIHN0YXJ0SW5kZXg7DQoJCQkNCgkJCWlmKGNoZWNrSW5kZXggIT0gMCkNCgkJCXsNCgkJCQljaGVja0lEc1N0ciA9IGNoZWNrSURzU3RyICsgIiwiOw0KCQkJfQ0KCQkJY2hlY2tJRHNTdHIgPSBjaGVja0lEc1N0ciArICIiICsgKHJvd0luZGV4IC0gc3RhcnRJbmRleCk7DQoJCQkNCgkJCWNoZWNrSW5kZXgrKzsNCgkJfQ0KCX0NCgkNCglyZXR1cm4gY2hlY2tJRHNTdHI7DQp9DQoNCmZ1bmN0aW9uIGdldFZpZXdJRCgpDQp7DQoJdmFyIHZpZXdJRCA9IG51bGw7DQoJdmFyIHZpZXdJRE9iamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJDdXJyZW50Vmlld0lEIilbMF07DQoJaWYgKHZpZXdJRE9iamVjdCkNCgl7DQoJCXZpZXdJRCA9IHZpZXdJRE9iamVjdC52YWx1ZTsNCgl9DQoJcmV0dXJuIHZpZXdJRDsNCn0NCg0KZnVuY3Rpb24gY2hlY2tEb2NUZW1wKHJlcG9ydElkLHNpbmdsZVdpbmRvdyxJRHMscHJpbnRPbmx5LGhhc1BvcnRsZXRWYXIsIGVkbXNTdHJpbmcpDQp7DQoJdmFyIGNoZWNrRG9jVGVtcFVSTCA9IGdldEJhc2VVUkwoKSArICIvcG9ydGxldHMvcmVwb3J0cy9yZXBvcnRTaG93LmRvP21vZGU9Y2hlY2tEb2NUZW1wbGF0ZSZyZXBvcnRJZD0iKyByZXBvcnRJZCArICImbW9kdWxlPSIgKyBjdXJyTW9kdWxlOw0KCXZhciByZXR1cm5EYXRhID0gc2VuZEh0dHBSZXF1ZXN0KGNoZWNrRG9jVGVtcFVSTCwgbnVsbCwgZmFsc2UpOw0KCXZhciBkYXRhID0gZXZhbCgiKCIgKyByZXR1cm5EYXRhICsgIikiKTsNCgl2YXIgb2JqZWN0TmFtZSA9IG51bGw7DQoJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJvYmplY3ROYW1lIikpDQoJew0KCQlvYmplY3ROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm9iamVjdE5hbWUiKS52YWx1ZTsJCQ0KCX0NCgl2YXIgdmlld0lET2JqZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkN1cnJlbnRWaWV3SUQiKVswXTsNCgl2YXIgcGFnZVNpemVSID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhZ2VTaXplUiIpOw0KCXZhciBpc0R5bmFQYWdpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaXNEeW5hUGFnaW5nIik7DQoJdmFyIGNoZWNrSURzU3RyID0gZ2V0Q2hlY2tJRHNTdHIoSURzKTsNCgl2YXIgdmlld0lEID0gZ2V0Vmlld0lEKCk7DQoJDQoJaWYgKGRhdGEubmVlZFNob3dEb2NUZW1wKQ0KCXsNCgkJdmFyIHVybCA9ICIvcG9ydGxldHMvcmVwb3J0cy9yZXBvcnRTaG93Rm9yRG9jLmRvP21vZGU9c2hvd0RvY1RlbXBsYXRlJnJlcG9ydElkPSIgKyByZXBvcnRJZCArICImbW9kdWxlPSIgKyBjdXJyTW9kdWxlDQoJCQkJCQkrICImc2luZ2xlV2luZG93PSIgKyBzaW5nbGVXaW5kb3cgKyAiJklEcz0iICsgSURzICsgIiZwcmludE9ubHk9IiArIHByaW50T25seSANCgkJCQkJCSsgIiZoYXNQb3J0bGV0VmFyPSIgKyBoYXNQb3J0bGV0VmFyICsgIiZlZG1zU3RyaW5nPSIgKyBlZG1zU3RyaW5nICsgIiZvYmplY3ROYW1lPSIgKyBvYmplY3ROYW1lICsgIiZwb3J0bGV0SUQ9IiArIHZpZXdJRA0KCQkJCQkJKyAiJnBhZ2VTaXplUj0iICsgcGFnZVNpemVSICsgIiZpc0R5bmFQYWdpbmc9IiArIGlzRHluYVBhZ2luZyArICImY2hlY2tJRHNTdHI9IiArIGNoZWNrSURzU3RyICsgIiZjaGVja0lEcz0iICsgY2hlY2tJRHM7DQoJCXdpbmRvdy5zaG93TW9kYWxEaWFsb2codXJsLHdpbmRvdywnZGlhbG9nV2lkdGg6NzAwcHg7ZGlhbG9nSGVpZ2h0OjQwMHB4O3Jlc2l6YWJsZTp5ZXM7c2Nyb2xsOnllcztNaW5pbWl6ZT15ZXM7TWF4aW1pemU9eWVzJyk7DQoJfQ0KCWVsc2UNCgl7DQoJCXBvcHVwUmVwb3J0QWZ0ZXJDaGVja0RvY1RlbXAocmVwb3J0SWQsc2luZ2xlV2luZG93LElEcyxwcmludE9ubHksaGFzUG9ydGxldFZhcixlZG1zU3RyaW5nLG9iamVjdE5hbWUsdmlld0lELHBhZ2VTaXplUixpc0R5bmFQYWdpbmcsY2hlY2tJRHNTdHIsY2hlY2tJRHMsY3Vyck1vZHVsZSk7DQoJfQ0KCXJldHVybiBmYWxzZTsNCn0NCg0KDQpmdW5jdGlvbiBwb3B1cFJlcG9ydEFmdGVyQ2hlY2tEb2NUZW1wKHJlcG9ydElkLHNpbmdsZVdpbmRvdyxJRHMscHJpbnRPbmx5LGhhc1BvcnRsZXRWYXIsZWRtc1N0cmluZyxvYmplY3ROYW1lLHZpZXdJRCxwYWdlU2l6ZVIsaXNEeW5hUGFnaW5nT2JqZWN0LGNoZWNrSURzU3RyLGNoZWNrSURzLGN1cnJNb2R1bGUpDQp7DQoJdmFyIHVybFN0cmluZyA9IGdldEJhc2VVUkwoKSArIGdldFJlcG9ydFVSTCgpICsgIiZyZXBvcnRJZD0iICsgcmVwb3J0SWQgKyAiJm1vZHVsZT0iICsgY3Vyck1vZHVsZTsNCglpZiAoaXNGcm9tRm9ybVJlcG9ydCkNCgl7DQoJCXZhciBwYXJhbSA9ICIiOw0KCQlpZih2aWV3SUQgJiYgdmlld0lEICE9IG51bGwgJiYgdmlld0lEICE9ICdudWxsJykNCgkJew0KCQkJdXJsU3RyaW5nID0gdXJsU3RyaW5nICsgIiZwb3J0bGV0SUQ9IiArIHZpZXdJRDsNCgkJCWlmKGhhc1BvcnRsZXRWYXIgJiYgaGFzUG9ydGxldFZhciAhPSBudWxsICYmIGhhc1BvcnRsZXRWYXIgIT0gJ251bGwnKQ0KCQkJew0KCQkJCXZhciBqc29uT2JqID0gQWNjZWxhRG9qby5mcm9tSnNvbihoYXNQb3J0bGV0VmFyKTsNCgkJCQl2YXIgcGFyYW0gPSAiIjsNCgkJCQlpZiAoanNvbk9ialtyZXBvcnRJZF0pLy9oZXJlIG5lZWQgcG9zdCBzaW5jZSBnZXQgcXVlcnkgc3RyaW5nIGNhbid0IGhhdmUgdG9vIG1hbnkgY2hhcnMNCgkJCQl7DQoJCQkJCXBhcmFtID0gQWNjZWxhRG9qby50b0pzb24oanNvbk9ialtyZXBvcnRJZF0pOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkNCgkJaWYgKElEcyAhPSBudWxsKSB7DQoJCQl1cmxTdHJpbmcgKz0gIiZJRD0iICsgSURzOw0KCQl9DQoJCXBvcHVwUmVwb3J0KHVybFN0cmluZywgMTAwLCBwcmludE9ubHksIHJlcG9ydElkLCBwYXJhbSk7DQoJfQ0KCWVsc2UNCgl7DQoJCXVybFN0cmluZyA9IHVybFN0cmluZyArIGVkbXNTdHJpbmc7DQoJCXZhciBwYWdlU2l6ZSA9ICIiOw0KCQlpZihwYWdlU2l6ZVIpDQoJCXsNCgkJCXBhZ2VTaXplID0gcGFnZVNpemVSLnZhbHVlOw0KCQl9IA0KCQkNCgkJdmFyIGlzRHluYVBhZ2luZyA9IGZhbHNlOyANCgkJaWYoaXNEeW5hUGFnaW5nT2JqZWN0KQ0KCQl7DQoJCQlpc0R5bmFQYWdpbmcgPSB0cnVlOw0KCQl9IA0KCQkNCgkJdmFyIElEc1NwbGl0PUlEcysiLG51bGwiOw0KCQl2YXIgSXM9SURzU3BsaXQuc3BsaXQoIiwiKTsNCgkJdmFyIGxlbmd0aEk9SXMubGVuZ3RoOwkNCgkJDQoJCXZhciBsaXN0VXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7DQoJCWlmKGxpc3RVcmwuaW5kZXhPZigicGFnZU5vIik9PSAtMSkNCgkJew0KCQkJdmFyIHBhZ2VObyA9IGd1cCgncGFnZScsIGxpc3RVcmwpOw0KCQl9DQoJCWVsc2UNCgkJew0KCQkJdmFyIHBhZ2VObyA9IGd1cCgncGFnZU5vJywgbGlzdFVybCk7DQoJCX0NCgkJdmFyIHJlY29yZHMgPSBudWxsOw0KCQl2YXIgbGVmdE9mZnNldCA9IDEwMDsNCgkJaWYoaGFzUG9ydGxldFZhciA9PSAiWSIgJiYgaXNEeW5hUGFnaW5nKQ0KCQl7DQoJCQlyZWNvcmRzID0gZ2V0UG9ydGxldFZhcnMocmVwb3J0SWQsY2hlY2tJRHNTdHIpOw0KCQl9DQoNCgkJaWYoc2luZ2xlV2luZG93PT0iWSIpDQoJCXsNCg0KCQkJdmFyIHJlcG9ydFZhclN0ciA9ICIiOw0KCQkJdmFyIHBhcmFtZXRlcnNNYXAgPSB7fTsNCgkJCWlmKHJlY29yZHMgIT0gbnVsbCkNCgkJCXsNCgkJCQkvL21lcmdlIHBhcmFtZXRlciBhcnJheSB0byBvbmUgcGFyYW1ldGVyIA0KCQkJCWZpbGxQYXJhbWV0ZXJzTWFwKHBhcmFtZXRlcnNNYXAsIHJlY29yZHMpOw0KCQkJCXJlcG9ydFZhclN0ciA9IEFjY2VsYURvam8udG9Kc29uKHBhcmFtZXRlcnNNYXApOw0KCQkJfQ0KCQkJdXJsU3RyaW5nID0gdXJsU3RyaW5nICsgIiZJRD0iICsgSURzOw0KCQkJaWYodmlld0lEICYmIHZpZXdJRCAhPSBudWxsICYmIHZpZXdJRCAhPSAnbnVsbCcpDQoJCQl7DQoJCQkJdXJsU3RyaW5nID0gY29uc3RydWN0VVJMKHVybFN0cmluZywgdmlld0lELCBmb3JtTmFtZSwgb2JqZWN0TmFtZSwgY2hlY2tJRHNTdHIsIHBhZ2VObywgcGFnZVNpemUpOw0KCQkJfQ0KCQkJcG9wdXBSZXBvcnQodXJsU3RyaW5nLCAxMDAsIHByaW50T25seSwgIiIsIHJlcG9ydFZhclN0cik7DQoJCX0NCgkJZWxzZQ0KCQl7CQkJCQ0KCQkJdmFyIHJlcG9ydFZhclN0ciA9ICIiOw0KCQkJaWYoY2hlY2tJRHMgPT0gbnVsbCkNCgkJCXsNCgkJCQljaGVja0lEcyA9IGNoZWNrSURzU3RyLnNwbGl0KCIsIik7DQoJCQl9DQoJCQlmb3IodmFyIGk9MDtpPGxlbmd0aEktMTtpKyspDQoJCQl7DQoJCQkJaWYocmVjb3JkcyAhPSBudWxsKQ0KCQkJCXsNCgkJCQkJcmVwb3J0VmFyU3RyID0gQWNjZWxhRG9qby50b0pzb24ocmVjb3Jkc1tpXSk7DQoJCQkJfQ0KCQkJCWxlZnRPZmZzZXQgPSBsZWZ0T2Zmc2V0ICsgaSo0MDsNCgkJCQl2YXIgcmVwb3J0VVJMID0gdXJsU3RyaW5nICsgIiZJRD0iICsgSXNbaV07DQoJCQkJaWYodmlld0lEICYmIHZpZXdJRCAhPSBudWxsICYmIHZpZXdJRCAhPSAnbnVsbCcpDQoJCQkJew0KCQkJCQlyZXBvcnRVUkwgPSBjb25zdHJ1Y3RVUkwocmVwb3J0VVJMLCB2aWV3SUQsIGZvcm1OYW1lLCBvYmplY3ROYW1lLCBjaGVja0lEc1tpXSwgcGFnZU5vLCBwYWdlU2l6ZSk7DQoJCQkJfQ0KDQoJCQkJcG9wdXBSZXBvcnQocmVwb3J0VVJMLCBsZWZ0T2Zmc2V0LCBwcmludE9ubHksIGksIHJlcG9ydFZhclN0cik7DQoJCQl9DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgl9DQp9DQoNCmZ1bmN0aW9uIGdldFJlcG9ydFVSTCgpDQp7DQoJcmV0dXJuICIvcG9ydGxldHMvcmVwb3J0cy9yZXBvcnRTaG93LmRvP21vZGU9c2hvdyI7DQp9DQoNCi8qKg0KICogVG8gcG9wdXAgcmVwb3J0IHdpbmRvdywgaWYgdGhlIHJlcG9ydFZhclN0ciBpcyBub3QgZW1wdHksIHRoZW4gb3BlbiBvbmUgYmxhbmsgd2luZG93LCB0aGVuIGNyZWF0ZSBvbmUgZm9ybSB0aGVuIHN1Ym1pdCBpdCB0bw0KICogYXZvaWQgdG9vIG1hbnkgY2hhcnMgaW4gcXVlcnkgc3RyaW5nIGZvciBnZXQNCiAqICoqLw0KZnVuY3Rpb24gcG9wdXBSZXBvcnQodXJsU3RyaW5nLCBsZWZ0T2Zmc2V0LCBwcmludE9ubHksIGksIHJlcG9ydFZhclN0cikNCnsNCglsZWZ0T2Zmc2V0ID0gZ2V0RGlyZWN0aW9uKCkgPyBnZXRTY3JlZW5MZWZ0KGxlZnRPZmZzZXQsODAwKSA6IGxlZnRPZmZzZXQ7DQoJdmFyIHdpbiA9IHdpbmRvdy5vcGVuKCIvcG9ydGxldHMvY29tbW9ucy9yZXBvcnQvcmVwb3J0RmFjZS5qc3A/VVJMPSIrZW5jb2RlVVJJQ29tcG9uZW50KHVybFN0cmluZykrIiZyZXBvcnRWYXJTdHI9IitlbmNvZGVVUklDb21wb25lbnQocmVwb3J0VmFyU3RyKSwgInJlcG9ydFdpbmRvdyIgKyBpLCAiaGVpZ2h0PTYwMCwgd2lkdGg9ODAwLCB0b3A9NzUsIGxlZnQ9IiArIGxlZnRPZmZzZXQrIix0b29sYmFyPW5vLCBtZW51YmFyPW5vLCBzY3JvbGxiYXJzPXllcywgcmVzaXphYmxlPXllcywgbG9jYXRpb249bm8sIHN0YXR1cz15ZXMiKQ0KCWlmKHByaW50T25seT09J1knKQ0KCXsNCgkJd2luZG93LmZvY3VzKCk7DQoJfQ0KfQ0KDQpmdW5jdGlvbiBmaWxsUGFyYW1ldGVyc01hcChwYXJhbWV0ZXJzTWFwLCByZWNvcmRzKQ0Kew0KCWZvcih2YXIgaT0wIDsgaTxyZWNvcmRzLmxlbmd0aDsgaSsrKQ0KCXsNCgkJaWYoaSA9PSAwKQ0KCQl7DQoJCQlmb3IodmFyIHAgaW4gcmVjb3Jkc1tpXSkNCgkJCXsNCgkJCQlwYXJhbWV0ZXJzTWFwW3BdID0gcmVjb3Jkc1tpXVtwXTsNCgkJCX0NCgkJfWVsc2UNCgkJew0KCQkJZm9yKHZhciBwIGluIHJlY29yZHNbaV0pDQoJCQl7DQoJCQkJcGFyYW1ldGVyc01hcFtwXSA9IHBhcmFtZXRlcnNNYXBbcF0gKyAiLCIgKyByZWNvcmRzW2ldW3BdOw0KCQkJfQ0KCQl9DQoJfQ0KfQ0KDQpmdW5jdGlvbiBnZXRDdXJyZW50VVJMKCkNCnsNCgl2YXIgZmllbGROYW1lID0gInZhbHVlKEN1cnJlbnRFbnRyeVVSTCkiOw0KCXZhciBwYXRoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZmllbGROYW1lKS52YWx1ZTsNCgl2YXIgcmV0ID0gZ2V0QmFzZVVSTCgpICsgcGF0aCArICImbW9kdWxlPSIgKyBjdXJyTW9kdWxlOw0KCXJldHVybiByZXQ7DQp9DQoNCg0KZnVuY3Rpb24gZ2V0UG9ydGxldFZhcnMocmVwb3J0SUQsY2hlY2tJRHNTdHIpDQp7DQoJdmFyIHNlcnZpY2VVUkwgPSBnZXRDdXJyZW50VVJMKCkgKyAiJmdldFBvcnRsZXRWYXI9WSZFeHBvcnRGaWxlVHlwZT1wYWdpbmdDc3YmcmVwb3J0SUQ9IiArIHJlcG9ydElEICsgIiZJRHM9IiArIGNoZWNrSURzU3RyOw0KCXZhciBmb3JtMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZvcm1OYW1lKTsNCgl2YXIgcmV0ID0gbnVsbDsNCglBY2NlbGFEb2pvLnhoclBvc3Qoew0KCQkJdXJsOiBzZXJ2aWNlVVJMLA0KCQkJc3luYzp0cnVlLA0KCQkJaGFuZGxlQXM6Impzb24iLA0KCQkJZm9ybTogZm9ybTEsDQoJCQlsb2FkOiBmdW5jdGlvbih0eXBlLCBkYXRhLCBldnQpew0KCQkJCXJldCA9IHR5cGUubXNnOw0KCQkJfSwNCgkJCWVycm9yOiBmdW5jdGlvbih0eXBlLCBlcnJvcikNCgkJCXsNCgkJCQlhbGVydCgnZXJyb3IgPT0gJyArIGVycm9yLmRlc2NyaXB0aW9uKTsNCgkJCX0NCgl9KTsNCglyZXR1cm4gcmV0Ow0KfQ0KDQoNCmZ1bmN0aW9uIHBvcFdpbmRvd0Nsb3NlKCkNCnsNCglpZih3aW5kb3cucGFyZW50KQ0KCXsNCgkJaWYod2luZG93LnRvcC53aW5kb3cuZnJhbWVzWydnYnNlYXJjaCddKQ0KCQl7DQoJCQl3aW5kb3cudG9wLndpbmRvdy5mcmFtZXNbJ2dic2VhcmNoJ10uY2xvc2VBY3RpdmVUYWIoKTsNCgkJCQ0KCQl9DQoJCWVsc2UNCgkJew0KCQkJd2luZG93LnBhcmVudC5jbG9zZSgpOw0KCQl9DQoJCQ0KCX0gDQoJZWxzZSANCgl7DQoJCXdpbmRvdy5jbG9zZSgpOw0KCX0NCglyZXR1cm4gZmFsc2U7DQp9DQpmdW5jdGlvbiBvcGVuQ2FwTG9nKHVybFN0cmluZykNCnsNCgl3aW5kb3dPcGVuKCIvcG9ydGxldHMiK3VybFN0cmluZywgImF1ZGl0TG9nV2luZG93IiwgImhlaWdodD02MDAsIHdpZHRoPTgwMCwgdG9wPTc1ICx0b29sYmFyPW5vLCBtZW51YmFyPW5vLCBzY3JvbGxiYXJzPXllcywgcmVzaXphYmxlPXllcywgbG9jYXRpb249bm8sIHN0YXR1cz15ZXMsbGVmdD0iK2dldFNjcmVlbkxlZnQoMTAwLDgwMCkpOw0KfQ0KDQpTdHJpbmcucHJvdG90eXBlLnRyaW0gPSBmdW5jdGlvbigpDQp7DQoJcmV0dXJuIHRoaXMucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCIiKTsgICANCn0NCg0KU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQWxsID0gZnVuY3Rpb24ob2xkU3RyLCBuZXdTdHIpDQp7DQoJcmV0dXJuIHRoaXMucmVwbGFjZShuZXcgUmVnRXhwKG9sZFN0ciwiZ20iKSwgbmV3U3RyKTsJDQp9DQoNClN0cmluZy5wcm90b3R5cGUudW5pY29kZUFuZFV0ZjhUcmltID0gZnVuY3Rpb24oKQ0Kew0KCXZhciByID0gdGhpcy5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csICIiKTsNCglyID0gbHJlbW92ZWJsYW5rKHIpOw0KCXIgPSBycmVtb3ZlYmxhbmsocik7DQoJcmV0dXJuIHI7DQp9DQoNCmZ1bmN0aW9uIGxyZW1vdmVibGFuayhzKQ0Kew0KCWlmIChzLmxlbmd0aCA9PSAxICYmIHMuY2hhckNvZGVBdCgwKSA9PSAxNjApDQoJCXJldHVybiAiIjsNCglpZiAocy5jaGFyQ29kZUF0KDApID09IDE2MCkNCgl7DQoJCXMgPSBzLnN1YnN0cigxLCBzLmxlbmd0aCAtIDEpOw0KCQlyZXR1cm4gbHJlbW92ZWJsYW5rKHMpOw0KCX0NCgllbHNlDQoJew0KCQlyZXR1cm4gczsNCgl9DQp9DQoNCmZ1bmN0aW9uIHJyZW1vdmVibGFuayhzKQ0Kew0KCWlmIChzLmxlbmd0aCA9PSAxICYmIHMuY2hhckNvZGVBdCgwKSA9PSAxNjApDQoJCXJldHVybiAiIjsNCglpZiAocy5jaGFyQ29kZUF0KHMubGVuZ3RoLTEpID09IDE2MCkNCgl7DQoJCXMgPSBzLnN1YnN0cigwLCBzLmxlbmd0aCAtIDEpOw0KCQlyZXR1cm4gcnJlbW92ZWJsYW5rKHMpOw0KCX0NCgllbHNlDQoJew0KCQlyZXR1cm4gczsNCgl9DQp9DQoNCkJhc2VKUyA9IHsNCgkNCglhcnJheUNvbnRhaW5zIDogZnVuY3Rpb24oYXJyYXksIG9iail7DQoJCWZvcih2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgew0KCQkJaWYoYXJyYXlbaV0gPT0gb2JqKXsNCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0NCgkJfQ0KCQkNCgkJcmV0dXJuIGZhbHNlOw0KCX0sDQoJDQoJLyoqDQoJICogQ2xvbmUgSlMgT2JqZWN0DQoJICovDQoJY2xvbmVBbGw6IGZ1bmN0aW9uIChvYmopew0KCQlpZihvYmogPT0gbnVsbCB8fCB0eXBlb2Yob2JqKSAhPSAnb2JqZWN0JykgIA0KCQl7DQoJCQlyZXR1cm4gb2JqOw0KCQl9DQoJCQkgICANCgkJdmFyIHRlbXAgPSBuZXcgb2JqLmNvbnN0cnVjdG9yKCk7ICAgICAgIA0KCQlmb3IodmFyIGtleSBpbiBvYmopICAgDQoJCXsNCgkJCXRlbXBba2V5XSA9IHRoaXMuY2xvbmVBbGwob2JqW2tleV0pOyANCgkJfQ0KCQ0KCQlyZXR1cm4gdGVtcDsgIA0KCX0sDQoJDQoJYXBwbHk6ZnVuY3Rpb24obywgYyl7DQoJCWlmKG8gJiYgYyAmJiB0eXBlb2YgYyA9PSAnb2JqZWN0Jyl7DQoJCQlmb3IodmFyIHAgaW4gYyl7DQoJCQkJaWYgKGNbcF0pDQoJCQkJCW9bcF0gPSBjW3BdOw0KCQkJfQ0KCQl9DQoJCXJldHVybiBvOw0KCX0sDQoJaGFzaENvZGU6IGZ1bmN0aW9uKHN0cil7DQogICAgICAgIHZhciBoID0gMDsNCiAgICAgICAgdmFyIGxlbiA9IHN0ci5sZW5ndGg7DQoJCXZhciB0PS0yMTQ3NDgzNjQ4KjI7DQoNCiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKXsNCiAgICAgICAgICAgIGggKz0gc3RyLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIH0NCgkJDQoJCXdoaWxlKGg+MjE0NzQ4MzY0Nyl7DQoJCQloKz10Ow0KCQl9DQogICAgICAgIHJldHVybiB+aDsNCiAgICB9LA0KCQ0KCS8vY291bnQgdGhlIGhhc2gNCgloYXNoIDogZnVuY3Rpb24oeCl7DQoJCXZhciBoID0gdGhpcy5oYXNoQ29kZSh4KTsNCgkJaCArPSB+KGggPDwgOSk7DQoJCWggXj0gIChoID4+PiAxNCk7DQoJCWggKz0gIChoIDw8IDQpOw0KCQloIF49ICAoaCA+Pj4gMTApOw0KCQlyZXR1cm4gaDsNCgl9LA0KDQoJanNvblRvU3RyOiBmdW5jdGlvbihvYmopeyAgIA0KCQkNCgkJdmFyIFRISVMgPSB0aGlzOyAgICANCgkJc3dpdGNoKHR5cGVvZihvYmopKXsgICANCgkJCWNhc2UgJ3N0cmluZyc6ICAgDQoJCQkJcmV0dXJuICciJyArIG9iai5yZXBsYWNlKC8oWyJcXF0pL2csICdcXCQxJykgKyAnIic7ICAgDQoJCQljYXNlICdhcnJheSc6ICAgDQoJCQkJcmV0dXJuICdbJyArIG9iai5tYXAoVEhJUy5qc29uVG9TdHIpLmpvaW4oJywnKSArICddJzsgICANCgkJCWNhc2UgJ29iamVjdCc6IA0KCQkJCSBpZihPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQXJyYXldJyl7ICAgDQoJCQkJCXZhciBzdHJBcnIgPSBbXTsgICANCgkJCQkJdmFyIGxlbiA9IG9iai5sZW5ndGg7ICAgDQoJCQkJCWZvcih2YXIgaT0wOyBpPGxlbjsgaSsrKXsgICANCgkJCQkJCXN0ckFyci5wdXNoKFRISVMuanNvblRvU3RyKG9ialtpXSkpOyAgIA0KCQkJCQl9ICAgDQoJCQkJCXJldHVybiAnWycgKyBzdHJBcnIuam9pbignLCcpICsgJ10nOyAgIA0KCQkJCX1lbHNlIGlmKG9iaj09bnVsbCl7ICAgDQoJCQkJCXJldHVybiAnbnVsbCc7ICAgCSAgDQoJCQkJfWVsc2V7ICAgDQoJCQkJCXZhciBzdHJpbmcgPSBbXTsgICANCgkJCQkJZm9yICh2YXIgcHJvcGVydHkgaW4gb2JqKSBzdHJpbmcucHVzaChUSElTLmpzb25Ub1N0cihwcm9wZXJ0eSkgKyAnOicgKyBUSElTLmpzb25Ub1N0cihvYmpbcHJvcGVydHldKSk7ICAgDQoJCQkJCXJldHVybiAneycgKyBzdHJpbmcuam9pbignLCcpICsgJ30nOyAgIA0KCQkJCX0gICANCgkJCWNhc2UgJ251bWJlcic6ICAgDQoJCQkJcmV0dXJuIG9iajsgICANCgkJCWNhc2UgZmFsc2U6ICAgDQoJCQkJcmV0dXJuIG9iajsgICANCgkJCSBjYXNlICdib29sZWFuJzoNCiAgICAgICAgICAgICAgICByZXR1cm4gb2JqOw0KCQl9ICAgDQoJfSwNCg0KCXN0clRvSnNvbjogZnVuY3Rpb24oc3RyKXsNCgkJaWYoc3RyICE9IG51bGwgJiYgdHlwZW9mIHN0ciAhPSAndW5kZWZpbmVkJykNCgkJew0KCQkJc3RyID0gc3RyLnJlcGxhY2UoL1xyXG4vZywiXFxuIik7IA0KCQl9DQoJCXJldHVybiBldmFsKCcoJyArIHN0ciArICcpJyk7ICAgDQoJfSwNCg0KCWNyZWF0ZURlbGVnYXRlIDogZnVuY3Rpb24ob2JqZWN0LCBtZXRob2QsIGFyZ3MpDQogICAgew0KICAgICAgICB2YXIgZGVsZWdhdGUgPSBmdW5jdGlvbigpDQogICAgICAgIHsNCiAgICAgICAgICAgIHJldHVybiBtZXRob2QuYXBwbHkob2JqZWN0LCBhcmdzKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZGVsZWdhdGU7DQogICAgfSwNCiAgICANCiAgICBpbmNyZWFzZSA6IChmdW5jdGlvbigpew0KCQl2YXIgaWQgPSAwOw0KCQlyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gaWQrKzt9Ow0KCX0pKCksDQoNCglkZWNyZWFzZUZuIDogZnVuY3Rpb24oKQ0KCXsNCgkJdmFyIGlkID0gMDsNCgkJcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIC0taWQ7fTsNCgl9KCksDQoJDQoJYWRkRXZlbnRIYW5kbGVyIDogZnVuY3Rpb24gKHRhcmdldCwgdHlwZSwgZnVuYykNCgl7DQoJCXZhciBoYXNBdHRhY2hlZCA9IHRoaXMuX19hZGRMaXN0ZW5lcnModGFyZ2V0LCB0eXBlLCBmdW5jKTsNCgkJDQoJCWlmKGhhc0F0dGFjaGVkKQ0KCQl7DQoJCQlyZXR1cm47DQoJCX0NCgkJDQoJCWlmICh0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcikNCgkJew0KCQkgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCB0aGlzLmdldEV2ZW50SGFuZGxlcigpLCBmYWxzZSk7DQoJCX0NCgkJZWxzZSBpZiAodGFyZ2V0LmF0dGFjaEV2ZW50KQ0KCQl7DQoJCSAgIHRhcmdldC5hdHRhY2hFdmVudCgib24iICsgdHlwZSwgdGhpcy5nZXRFdmVudEhhbmRsZXIoKSk7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCSAgIHRhcmdldFsib24iICsgdHlwZV0gPSB0aGlzLmdldEV2ZW50SGFuZGxlcigpOw0KCQl9DQoJfSwNCgkNCglfX2FkZExpc3RlbmVyczogZnVuY3Rpb24odGFyZ2V0LCB0eXBlLCBmdW5jKQ0KCXsNCgkJdmFyIGhhc0F0dGFjaGVkID0gZmFsc2U7DQoJCWlmICghdGFyZ2V0Lmxpc3RlbmVyKQ0KCQl7DQoJCQl0YXJnZXQubGlzdGVuZXIgPSB7fTsNCgkJfQ0KCQkNCgkJaWYgKCF0YXJnZXQubGlzdGVuZXJbdHlwZV0pDQoJCXsNCgkJCXZhciBmbkFycmF5ID0gW2Z1bmNdOw0KCQkJdGFyZ2V0Lmxpc3RlbmVyW3R5cGVdID0gZm5BcnJheTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCXRhcmdldC5saXN0ZW5lclt0eXBlXS5wdXNoKGZ1bmMpOw0KCQkJaGFzQXR0YWNoZWQgPSB0cnVlOw0KCQl9DQoJCQ0KCQlyZXR1cm4gaGFzQXR0YWNoZWQ7DQoJfSwNCg0KLy9hc3N1cmUgdGhlIGxpc3RlbmVyIGV4ZWN1dGUgc2VxdWVuY2UNCglnZXRFdmVudEhhbmRsZXI6IGZ1bmN0aW9uKCkNCgl7DQoJCWlmICh0aGlzLnRlbXBsYXRlTGlzdGVuZXIpDQoJCXsNCgkJCXJldHVybiB0aGlzLnRlbXBsYXRlTGlzdGVuZXI7DQoJCX0NCgkJdmFyIHRlbXBsYXRlTGlzdGVuZXIgPSBmdW5jdGlvbihlKXsNCgkJCXZhciBsaXN0ZW5lcjsNCgkJCWlmIChlLnNyY0VsZW1lbnQpDQoJCQl7DQoJCQkJbGlzdGVuZXIgPSBlLnNyY0VsZW1lbnQubGlzdGVuZXIgJiYgZS5zcmNFbGVtZW50Lmxpc3RlbmVyW2UudHlwZV07CQ0KCQkJfQ0KCQkJZWxzZSBpZiAoZS5jdXJyZW50VGFyZ2V0KQ0KCQkJew0KCQkJCWxpc3RlbmVyID0gZS5jdXJyZW50VGFyZ2V0Lmxpc3RlbmVyICYmIGUuY3VycmVudFRhcmdldC5saXN0ZW5lcltlLnR5cGVdOw0KCQkJfQ0KCQkJDQoJCQlpZighbGlzdGVuZXIpDQoJCQl7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJDQoJCQlmb3IodmFyIGkgPSAwOyBpIDwgbGlzdGVuZXIubGVuZ3RoOyBpKyspDQoJCQl7DQoJCQkJbGlzdGVuZXJbaV0oZSk7DQoJCQl9DQoJCX07DQoJCXRoaXMudGVtcGxhdGVMaXN0ZW5lciA9IHRlbXBsYXRlTGlzdGVuZXI7DQoJCXJldHVybiB0ZW1wbGF0ZUxpc3RlbmVyOw0KCX0sDQoNCiAJaHRtbEVuY29kZSA6IGZ1bmN0aW9uKHZhbHVlKQ0KIAl7DQoJCXJldHVybiBBYzM2MC5odG1sRW5jb2RlKHZhbHVlKTsNCiAgICB9LA0KICAgIA0KICAgICBodG1sRGVjb2RlIDogZnVuY3Rpb24odmFsdWUpDQogICAgIHsNCgkJcmV0dXJuIEFjMzYwLmh0bWxEZWNvZGUodmFsdWUpOw0KICAgICB9DQp9Ow0KDQovL2RhdGUgY2hlY2sgbG9naWMgDQp2YXIgeWVhclBhcnRpdGlvbmVyPW51bGw7DQp2YXIgeWVhclBhcnRpdGlvbmVyRGVmYXVsdD0zMDsgDQovL3N0b3JlIHRoZSB5ZWFyIHBhcnRpdGlvbmVyIGZvciB0aGUgZGF0ZSBzZWxlY3QgDQovKioNCiAqIGRhdGUgZm9ybWF0IHZhbGlkYXRlIGJ5IG1hc2sNCiAqLw0KZnVuY3Rpb24gaXNWYWxpZERhdGUoIGRhdGUpIA0Kew0KCWlmIChkYXRlID09IG51bGwgKQ0KCXsNCgkJcmV0dXJuIGZhbHNlOw0KCX0NCgl0cnkgew0KCQlyZXR1cm4gKHZhbGlkYXRlTnVtYmVyQnlSYW5nZSggZGF0ZS55ZWFyLCAwLCA5OSApIA0KCQkJCSYmICB2YWxpZGF0ZU51bWJlckJ5UmFuZ2UoIGRhdGUubW9udGgsIDEsIDEyICkgDQoJCQkJJiYgIHZhbGlkYXRlTnVtYmVyQnlSYW5nZSggZGF0ZS5kYXksIDEsIDMxICkNCgkJCQkpDQoJfSBjYXRjaCAoZSkgew0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KfQ0KDQovKioNCiAqIEdldCBkYXRlIG9iamVjdCBieSBkYXRlIGFuZCBkYXRlIG1hc2sgYXJyYXkuDQogKiANCiAqIEBwYXJhbSBkYXRlQXJyYXkNCiAqIEBwYXJhbSBtYXNrQXJyYXkNCiAqIEByZXR1cm4gZGF0ZSBvYmplY3QuDQogKi8NCmZ1bmN0aW9uIGdldERhdGVPYmplY3QoZGF0ZUFycmF5LCBtYXNrQXJyYXkpDQp7DQoJaWYoIGRhdGVBcnJheS5sZW5ndGggIT0gMyB8fCBtYXNrQXJyYXkubGVuZ3RoICE9IDMgKQ0KCXsNCgkJcmV0dXJuIG51bGw7DQoJfQ0KCSANCgl2YXIgZGF0ZSA9IHsieWVhciI6LTEsICJ5ZWFyUG9zIjotMSwgIm1vbnRoIjotMSwgImRheSI6IC0xfTsgDQoJLy9nZXQgdGhlIGluZGV4IG9mIG1vbnRoLGRheSx5ZWFyIGFuZCB1c2UgdGhlIGluZGV4IHRvIGdldCBjb3JyZXNwb25kaW5nIHZhbHVlOw0KCWZvciAoIHZhciBpID0gMDsgaSA8IG1hc2tBcnJheS5sZW5ndGg7IGkrKykgDQoJew0KCQlpZiAobWFza0FycmF5W2ldLmluZGV4T2YoIm1tIikgPj0gMCkgDQoJCXsNCgkJCWRhdGUubW9udGggPSBkYXRlQXJyYXlbaV07DQoJCX0NCgkJZWxzZSBpZiAobWFza0FycmF5W2ldLmluZGV4T2YoImRkIikgPj0gMCkgDQoJCXsNCgkJCWRhdGUuZGF5ID0gZGF0ZUFycmF5W2ldOw0KCQl9DQoJCWVsc2UgaWYgKG1hc2tBcnJheVtpXS5pbmRleE9mKCJ5eSIpID49IDApIHsNCgkJCWRhdGUueWVhciA9IGRhdGVBcnJheVtpXTsNCgkJCWRhdGUueWVhclBvcyA9IGk7DQoJCX0NCgl9DQoJcmV0dXJuIGRhdGU7DQp9DQoNCi8qKg0KICogVmFsaWRhdGUgTnVtYmVyIGJ5IHJhbmdlLg0KICoNCiAqIEBwYXJhbSBudW0gLSBpdCBzaG91bGQgYmUgYSB2YWxpZCBudW1iZXINCiAqIEBwYXJhbSBtaW5pbXVtIC0gdGhlIG1pbmltdW0gdmFsdWUNCiAqIEBwYXJhbSBtYXhpbXVtIC0gdGhlIG1heGltdW0gdmFsdWUNCiAqIEByZXR1cm4NCiAqLw0KZnVuY3Rpb24gdmFsaWRhdGVOdW1iZXJCeVJhbmdlKG51bSwgbWluaW11bSwgbWF4aW11bSkNCnsNCglyZXR1cm4gaXNOdW1iZXIobnVtKSAmJiAgTnVtYmVyKG51bSkgPj0gbWluaW11bSAmJiBOdW1iZXIobnVtKSA8PSBtYXhpbXVtOw0KfQ0KDQovKg0KKiBnZXQgdGhlIHJlcGxhY2UgcmVnZXggYnkgdGhlIHBvc2l0aW9uIHllYXIgYW5kIHNsaXBDaGFyDQoqKi8NCmZ1bmN0aW9uIGdldFllYXJSZXBsYWNlcih5ZWFyQXQsc2xpcENoYXIseWVhcikNCnsNCgl2YWx1ZVllYXI9TnVtYmVyKHllYXIpOw0KCWlmKHllYXJBdD09MCkNCgl7DQoJCWlmKHZhbHVlWWVhcj49eWVhclBhcnRpdGlvbmVyKQ0KCQl7DQoJCQl5ZWFyPSIxOSIreWVhcitzbGlwQ2hhcjsNCgkJfWVsc2UNCgkJew0KCQkJeWVhcj0iMjAiK3llYXIrc2xpcENoYXI7DQoJCX0NCgl9DQoJZWxzZSBpZih5ZWFyQXQ9PTIpDQoJew0KCQlpZih2YWx1ZVllYXI+PXllYXJQYXJ0aXRpb25lcikNCgkJew0KCQkJeWVhcj1zbGlwQ2hhcisiMTkiK3llYXI7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQl5ZWFyPXNsaXBDaGFyKyIyMCIreWVhcjsNCgkJfQ0KCX0NCglpZihwcm9maWxlLmlzRW5hYmxlZDUwOCl7DQoJCXZhciBhbGVydE1lc3NhZ2UgPSBnZXRUZXh0bGFibGUoImVycm9yLmpzLmRhdGVmb3JtYXQueWVhcmZvcm1hdC5sYWJlbCIpK3llYXI7DQoJCWFsZXJ0KGFsZXJ0TWVzc2FnZSk7DQoJfQ0KCXJldHVybiB5ZWFyOw0KfQ0KLyoNCiogZ2V0IHRoZSB5ZWFyIHBhcnRpdGlvbmVyIGZyb20gc3RhbmRhcmQgY2hvaWNlcyB1c2luZyBhamF4IG1ldGhvZA0KKiovDQpmdW5jdGlvbiBnZXRZZWFyUGFydGl0aW9uZXIoKQ0Kew0KCQ0KCWlmKHllYXJQYXJ0aXRpb25lcj09bnVsbHx8eWVhclBhcnRpdGlvbmVyPT0iIikNCgl7DQoJCXRyeQ0KCQl7DQoJCQl2YXIgcmV0dXJuRGF0YSA9IHNlbmRIdHRwUmVxdWVzdCgiL3BvcnRsZXRzL2kxOG4vYWpheC5kbz9tb2RlPWdldEJpekRvbWFpbkJ5TmFtZSZkb21haW5OYW1lPURBVEVfVEhSRVNIT0xEIiwgbnVsbCwgZmFsc2UpOw0KCQkJdmFyIGpzb25PYmpzPW5ldyBBcnJheSgpOw0KCQkJaWYocmV0dXJuRGF0YSE9bnVsbCYmcmV0dXJuRGF0YSE9IiIpDQoJCQl7DQoJCQkJanNvbk9ianM9QmFzZUpTLnN0clRvSnNvbihyZXR1cm5EYXRhKTsNCgkJCQlpZihqc29uT2Jqc1swXVsnYml6ZG9tYWluVmFsdWUnXSE9bnVsbCYmdHlwZW9mKGpzb25PYmpzWzBdWydiaXpkb21haW5WYWx1ZSddKSE9J3VuZGVmaW5lZCcpDQoJCQkJew0KCQkJCQkvL3llYXJQYXJ0aXRpb25lcj0NCgkJCQkJeWVhclBhcnRpdGlvbmVyPU51bWJlcihqc29uT2Jqc1swXVsnYml6ZG9tYWluVmFsdWUnXSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWNhdGNoKGUpDQoJCXsNCgkJCXllYXJQYXJ0aXRpb25lcj1udWxsOw0KCQl9DQoJfQ0KCXJldHVybiB5ZWFyUGFydGl0aW9uZXI7DQp9DQovKg0KKiBpZiB1c2VyIGlucHV0IGRvdWJsZSBkaWdpdGFsIHllYXIscmVwbGFjZSB0aGUgeWVhciB3aXRoIHRoZSBzdGFuZGFyZCBjaG9pY2VzIHNldHRpbmcNCiogQHJldHVybiB0cnVlLSAuLi47IGZhbHNlLS4uLg0KKiovDQpmdW5jdGlvbiByZXNldERvdWJsZURpZ2l0YWxZZWFyKGRhdGVJbnB1dCxtYXNrKQ0Kew0KCS8vZ2V0IHRoZSBzdGFuZGFyZCBjaG9pY2UgYnkgYWpheCAuIGlmIHRoZXJlIGlzIG5vIHN0YW5kYXJkIGNob2ljZSBpdCB3aWxsIHVzZSBkZWZhdWx0IHZhbHVlIDMwDQoJDQoJeWVhclBhcnRpdGlvbmVyPWdldFllYXJQYXJ0aXRpb25lcigpOw0KCS8vY2hlY2sgdGhlIHllYXJQYXJ0aXRpb25lciAgdmFsaWQNCglpZih5ZWFyUGFydGl0aW9uZXIgPT0gbnVsbCB8fCAhaXNOdW1iZXIoeWVhclBhcnRpdGlvbmVyKSANCgkJCXx8ICF2YWxpZGF0ZU51bWJlckJ5UmFuZ2UoeWVhclBhcnRpdGlvbmVyICwgMCAsIDEwMCkpDQoJew0KCQl5ZWFyUGFydGl0aW9uZXI9eWVhclBhcnRpdGlvbmVyRGVmYXVsdDsNCgl9DQoJdmFyIGRhdGVTdHIgPSBkYXRlSW5wdXQudmFsdWUucmVwbGFjZSgvKF5ccyopfChccyokKS9pZywiIik7DQoJdmFyIHNsaXBDaGFyID0gIiI7DQoJdmFyIHllYXIgPSAiIjsNCgl2YXIgZGF0ZUFycmF5ID0gbnVsbDsNCgl2YXIgbWFza0FycmF5ID0gbnVsbDsNCgl2YXIgcmVwbGFjZVJlZ2V4ID0gIiI7DQoJdHJ5DQoJew0KCQkvL2dldCB0aGUgc3BsaXQgY2hhcg0KCQl2YXIgc2xpcENoYXJzID0gbmV3IEFycmF5KCctJywnLycsJ1xcJyk7DQoJCWZvciAoIHZhciBpID0gMDsgaSA8IHNsaXBDaGFycy5sZW5ndGg7IGkrKykgDQoJCXsNCgkJCWlmKGRhdGVTdHIuaW5kZXhPZihzbGlwQ2hhcnNbaV0pID4gMCkNCgkJCXsNCgkJCQlzbGlwQ2hhciA9IHNsaXBDaGFyc1tpXTsNCgkJCQlicmVhazsNCgkJCX0JDQoJCX0NCgkJLy9ob2xkIGJhY2sgdGhlIGludmFsaWQgY29uZGl0aW9uIA0KCQlkYXRlQXJyYXkgPSBkYXRlU3RyLnNwbGl0KHNsaXBDaGFyKTsNCgkJbWFza0FycmF5ID0gbWFzay50b0xvd2VyQ2FzZSgpLnNwbGl0KHNsaXBDaGFyKTsNCgkJDQoJCXZhciBkYXRlT2JqID0gZ2V0RGF0ZU9iamVjdChkYXRlQXJyYXksIG1hc2tBcnJheSk7DQoJCQ0KCQkvL0V4Y2VwdCBkYXksIG1vbnRoIGFuZCB5ZWFyIGluIHRoZSBkYXRlSW5wdXQgYW5kIGRhdGUgbWFzaw0KCQlpZihtYXNrLmluZGV4T2Yoc2xpcENoYXIpIDwgMCB8fCBzbGlwQ2hhciA9PSAiIiB8fCBkYXRlT2JqID09IG51bGwNCgkJCQl8fCAhaXNWYWxpZERhdGUoZGF0ZU9iaikpDQoJCXsNCgkJCS8vaW52YWxpZCBpbnB1dCwgcmV0dXJuIHRydWUuDQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfQ0KCQkvL2dldCB0aGUgcG9zaXRpb24gb2YgeWVhciBpbiB0aGUgaW5wdXQgdmFsdWUsIHRoZW4gYnVpbGQgY29ycmVzcG9uZGluZyByZXBsYWNlUmVnZXggdG8gcmVwbGFjZSB0aGUgMiBkaWdpdCB0byA0CQkNCgkJeWVhciA9IGRhdGVPYmoueWVhcjsNCgkJaWYoeWVhci5sZW5ndGggPiAyKS8vaWYgdXNlciBpbnB1dCB5ZWFyIGlzIDAwMTIgb3IgMDExIG9yIDAwMDENCgkJew0KCQkJeWVhciA9IE51bWJlcih5ZWFyKSsiIjsNCgkJfQ0KCQlpZih5ZWFyLmxlbmd0aCA9PSAxICkNCgkJew0KCQkJeWVhciA9ICIwIiArIHllYXI7Ly9pZiB1c2VyIGlucHV0IHllYXIgbGVzcyB0aGFuIDEwLCB3ZSB3aWxsIGFkZCBjaGFyICIwIiBiZWZvcmUgdGhlIHllYXIgY2hhcg0KCQl9DQoJCQ0KCQkvL2dldCB0aGUgcmVwbGFjZSBSZWdFeHAgYW5kIDQgZGlnaXQgeWVhciANCgkJaWYoZGF0ZU9iai55ZWFyUG9zID09IDApIC8vIHl5L01NL2RkIA0KCQl7DQoJCQlyZXBsYWNlUmVnZXggPSBuZXcgUmVnRXhwKCJeIitkYXRlT2JqLnllYXIrc2xpcENoYXIsImciKTsvL2dldCB0aGUgcmVwbGFjZSByZWdleCANCgkJCXllYXIgPSBnZXRZZWFyUmVwbGFjZXIoZGF0ZU9iai55ZWFyUG9zLHNsaXBDaGFyLHllYXIpOw0KCQl9DQoJCWVsc2UgaWYgKGRhdGVPYmoueWVhclBvcyA9PSAyKSAgIC8vIGRkL01NL3l5IG9yIE1NL2RkL3l5DQoJCXsNCgkJCXJlcGxhY2VSZWdleCA9IG5ldyBSZWdFeHAoc2xpcENoYXIrZGF0ZU9iai55ZWFyKyIkIiwiZyIpOy8vZ2V0IHRoZSByZXBsYWNlIHJlZ2V4IA0KCQkJeWVhciA9IGdldFllYXJSZXBsYWNlcihkYXRlT2JqLnllYXJQb3Msc2xpcENoYXIseWVhcik7DQoJCX0NCgkJLy9yZXBsYWNlIHRoZSB0d28gZGlnaXQgeWVhciB0byBmb3VyDQoJCWRhdGVTdHIgPSBkYXRlU3RyLnJlcGxhY2UocmVwbGFjZVJlZ2V4LHllYXIpOw0KCQkvL2ZpbGwgYmFjayB0aGUgNCBkaWdpdCB2YWx1ZSB0byBkYXRlIGlucHV0DQoJCWRhdGVJbnB1dC52YWx1ZSA9IGRhdGVTdHI7DQoJCXJldHVybiBmYWxzZTsNCgl9DQoJY2F0Y2goZSkNCgl7DQoJCXJldHVybiB0cnVlOw0KCX0JDQp9DQoNCi8qDQoqY2hlY2tEYXRlDQoqLw0KDQpmdW5jdGlvbiBjaGVja0RhdGUoSW5wdXQsaSxjdXJyZW50RGF0ZVN0cikNCnsNCglpZihjaGVja0lucHV0KElucHV0KSl7DQoJCXJldHVybjsNCgl9DQoJaWYodHlwZW9mKElucHV0KSA9PSAnc3RyaW5nJyl7DQoJCUlucHV0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKElucHV0KTsNCgl9DQoJaWYoY2hlY2tJbnB1dChJbnB1dCkpew0KCQlyZXR1cm47DQoJfQ0KCWlmKElucHV0LmluaXRSZWFsVmFsdWUpew0KCQlJbnB1dC5pbml0UmVhbFZhbHVlKCk7DQoJfQ0KCWlmKGJsdXJlZCkNCgl7DQoJCWJsdXJlZCA9IGZhbHNlOw0KCQlyZXR1cm47DQoJfQ0KCXZhciBmb3JtTmFtZT1kb2N1bWVudC5mb3Jtc1swXS5uYW1lOw0KCXZhciBpbnB1dERhdGVOYW1lID0gSW5wdXQubmFtZTsNCgkNCglpZih1c2VySW5wdXREYXRlICE9ICIiICYmIHR5cGVvZihJbnB1dCkhPSd1bmRlZmluZWQnICYmIElucHV0ICE9IG51bGwgJiYgSW5wdXQudmFsdWUgIT0gIiIpDQoJew0KCQlpZihpbnB1dERhdGVOYW1lLmluZGV4T2YoIl92YWx1ZSIpIT0gLTEpDQoJCXsNCgkJCXZhciBoaWRkZW5fbmFtZSA9IGlucHV0RGF0ZU5hbWUuc3Vic3RyaW5nKDAsaW5wdXREYXRlTmFtZS5pbmRleE9mKCJfdmFsdWUiKSkrIl9tYXNrZm9ybWF0IitpbnB1dERhdGVOYW1lLnN1YnN0cmluZygoaW5wdXREYXRlTmFtZS5pbmRleE9mKCJfdmFsdWUiKSs3KSwoaW5wdXREYXRlTmFtZS5sZW5ndGgtMSkpOw0KCQkJdmFyIG1hc2sgPSBldmFsKCJkb2N1bWVudC4iK2Zvcm1OYW1lKyIuZWxlbWVudHNbXCciK2hpZGRlbl9uYW1lKyJcJ10udmFsdWUiKTsNCgkJCWlmKG1hc2suaW5kZXhPZigieXl5eSIpIT0tMSkNCgkJCXsNCgkJCQlyZXNldERvdWJsZURpZ2l0YWxZZWFyKElucHV0LG1hc2spOw0KCQkJfQ0KCQkJdmFyIHVzZXJJbnB1dERhdGUgPSAoSW5wdXQudmFsdWUpLnJlcGxhY2UoLyheXHMqKXwoXHMqJCkvaWcsIiIpOw0KCQkJdmFyIGNoZWNrRGF0ZU1ldGhvZCA9IGNoZWNrTWFzayhtYXNrKTsNCgkJCQ0KCQkJDQoJCQkNCgkJCWlmKGV2YWwoIlwiIit1c2VySW5wdXREYXRlKyJcIi4iK2NoZWNrRGF0ZU1ldGhvZCkpDQoJCQl7DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCQllbHNlDQoJCQl7DQoJCQkJaWYoaSA9PSAwKQ0KCQkJCXsJICANCgkJCQkJYmx1cmVkID0gdHJ1ZTsNCgkJCQl9CQkNCgkJCQkNCgkJCQl2YXIgY3VyckRhdGUgPSBnZXRBZ2VuY3lEYXRlQnlQYXR0ZXJuKG1hc2spOw0KCQkJCUlucHV0LnZhbHVlID0gY3VyckRhdGU7DQoJCQkJaWYoSW5wdXQuaXNsYW1pY1ZhbHVlQ2hhbmdlKXsNCgkJCQkJSW5wdXQuaXNsYW1pY1ZhbHVlQ2hhbmdlKCk7DQoJCQkJfQ0KCQkJCXJldHVybiBmYWxzZTsNCgkJCQ0KCQkJfQ0KCQl9DQoJCWVsc2UNCgkJew0KCQkJbWFzayA9IGdldERhdGVGb3JtYXQoKTsNCgkJCWlmKG1hc2suaW5kZXhPZigieXl5eSIpIT0tMSkNCgkJCXsNCgkJCQlyZXNldERvdWJsZURpZ2l0YWxZZWFyKElucHV0LG1hc2spOw0KCQkJfQ0KCQkJdmFyIHVzZXJJbnB1dERhdGUgPSAoSW5wdXQudmFsdWUpLnJlcGxhY2UoLyheXHMqKXwoXHMqJCkvaWcsIiIpOw0KCQkJDQoJCQl2YXIgY2hlY2tEYXRlTWV0aG9kID0gIklzRGF0ZSgnIittYXNrKyInKSI7DQoJCQlpZihldmFsKCJcIiIrdXNlcklucHV0RGF0ZSsiXCIuIitjaGVja0RhdGVNZXRob2QpKQ0KCQkJew0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KCQkJCWlmKGk9PTApDQoJCQkJewkgICAgICAgICAgIAkgIA0KCQkJCQlibHVyZWQgPSB0cnVlOyAgICAgICAgICAgCSAgICAgICAgICAgCSAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICAJIA0KCQkJCX0NCgkJCQ0KCQkJCXZhciBjdXJyRGF0ZSA9IGdldEFnZW5jeURhdGVCeVBhdHRlcm4obWFzayk7DQoJCQkJaWYocHJvZmlsZS5pc0VuYWJsZWQ1MDgpew0KCQkJCQl2YXIgYWxlcnRNZXNzYWdlID0gZ2V0VGV4dGxhYmxlKCJlcnJvci5qcy5kYXRlZm9ybWF0LmxhYmVsIikrY3VyckRhdGU7DQoJCQkJCWFsZXJ0KGFsZXJ0TWVzc2FnZSk7DQoJCQkJfQ0KCQkJCUlucHV0LnZhbHVlID0gY3VyckRhdGU7CSAgICAgICAgICAgCQ0KCQkJCUlucHV0LmZvY3VzKCk7DQoJCQkJaWYoSW5wdXQuaXNsYW1pY1ZhbHVlQ2hhbmdlKXsNCgkJCQkJSW5wdXQuaXNsYW1pY1ZhbHVlQ2hhbmdlKCk7DQoJCQkJfQ0KCQkJCXJldHVybiBmYWxzZTsNCgkJCX0NCgkJfQ0KCX0NCn0NCmZ1bmN0aW9uIGNoZWNrSW5wdXQoaW5wdXQpew0KCWlmKHR5cGVvZihpbnB1dCkgPT0gJ3VuZGVmaW5lZCcgfHwgaW5wdXQgPT0gbnVsbCB8fCBpbnB1dD09Jycpew0KCQlyZXR1cm4gdHJ1ZTsNCgl9DQoJcmV0dXJuIGZhbHNlOw0KfQ0KLy9hZGQgZm9yIEZFSU4vU1NOIE1BU0sgMjAxMS0wMS0xNA0KZnVuY3Rpb24gaW5pdE1hc2sobWFza1N0eWxlLCBJZCwgaGFzRklEKQ0Kew0KCS8vR2V0IHRoZSBlbGVtZW50IHdobyBuZWVkIGFkZCBtYXNrLg0KCXZhciBvYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChJZCk7DQoJaWYgKCFoYXNGSUQpLy9oYXNuJ3QgdGhlIGZpZCB0aGVuIHJldHVybjsNCgl7DQoJCWlmIChvYmopDQoJCXsNCgkJCXZhciB2YWx1ZSA9IG9iai52YWx1ZTsNCgkJCWlmICh2YWx1ZSkNCgkJCXsNCgkJCQlvYmoudmFsdWUgPSB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAoJy0nLCJnbSIpLCIiKTsNCgkJCX0NCgkJCW9iai5tYXhMZW5ndGggPSAiOSI7DQoJCX0NCgkJcmV0dXJuIGZhbHNlOw0KCX0NCgltYXNrKG9iaiwgbWFza1N0eWxlKTsNCn0NCg0KLy9hZGQgbWFzayB0byBvYmoNCmZ1bmN0aW9uIG1hc2sob2JqLCBtYXNrU3R5bGUpDQp7DQoJLy9HZXQgbWFzayBzdHlsZS4NCgl2YXIgbWFzayA9IG5ldyBBVjM2ME1hc2sobWFza1N0eWxlKTsNCgkgICANCglpZihvYmogIT0gbnVsbCkNCgl7DQoJCS8vQXR0YWNoIG1hc2suDQoJCW1hc2suYXR0YWNoKG9iaik7DQoJCW1hc2suX19tYXRjaE1hc2tSdWxlID0gZnVuY3Rpb24odmFsdWUpDQoJCXsNCgkJCXJldHVybiB0cnVlOw0KCQl9DQoJfQ0KfQ0KLy9hZGQgZm9yIEZFSU4vU1NOIE1BU0sgMjAxMS0wMS0xNAkNCg0KDQoJLyoqIGhvb2sgdXNpbmcgc3RhbmRhcmRzIGJhc2VkIHByb3RvdHlwZSAqICovDQoJZnVuY3Rpb24gaGlqYWNrU3RhbmRhcmQoKSB7DQoJCVhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5fb3BlbiA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOw0KCQlYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzcykgew0KCQkJdGhpcy51cmwgPSB1cmw7DQoJCQkNCgkJCXRoaXMuX29wZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCgkJfQ0KCQkNCgkJWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9zZW5kID0gWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQ7DQoJCVhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oZGF0YSkgew0KCQkJaWYodGhpcy5vbnNlbmQgIT0gbnVsbCkgew0KCQkJCXRoaXMub25zZW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7DQoJCQl9DQoJCQkNCgkJCXRoaXMuX3NlbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCgkJfQ0KCX0NCg0KCS8qKiBpZSBkb2VzIG5vdCBwcm9wZXJseSBzdXBwb3J0IHByb3RvdHlwZSAtIHdyYXAgY29tcGxldGVseSAqICovDQoJZnVuY3Rpb24gaGlqYWNrRXhwbG9yZXIoKSB7DQoJCXZhciBfWE1MSHR0cFJlcXVlc3QgPSB3aW5kb3cuWE1MSHR0cFJlcXVlc3Q7DQoJCQ0KCQlmdW5jdGlvbiBhbGxvY19YTUxIdHRwUmVxdWVzdCgpIHsNCgkJCXRoaXMuYmFzZSA9IF9YTUxIdHRwUmVxdWVzdCA/IG5ldyBfWE1MSHR0cFJlcXVlc3QgOiBuZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7DQoJCX0NCgkJDQoJCWZ1bmN0aW9uIGluaXRfWE1MSHR0cFJlcXVlc3QoKSB7DQoJCQlyZXR1cm4gbmV3IGFsbG9jX1hNTEh0dHBSZXF1ZXN0Ow0KCQl9DQoJCXZhciAgc3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpew0KCQkJdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApOw0KCQkJdmFyIHNlbGYgPSBhcmdzWzBdOw0KCQkJDQoJCQl0cnkgeyBzZWxmLnN0YXR1cyA9IHNlbGYuYmFzZS5zdGF0dXM7IH0gY2F0Y2ggKGUpIHsgfQ0KCQkJdHJ5IHsgc2VsZi5zdGF0dXNUZXh0ID0gc2VsZi5iYXNlLnN0YXR1c1RleHQ7IH0gY2F0Y2ggKGUpIHsgfQ0KCQkJdHJ5IHsgc2VsZi5yZWFkeVN0YXRlID0gc2VsZi5iYXNlLnJlYWR5U3RhdGU7IH0gY2F0Y2ggKGUpIHsgfQ0KCQkJdHJ5IHsgc2VsZi5yZXNwb25zZVRleHQgPSBzZWxmLmJhc2UucmVzcG9uc2VUZXh0OyB9IGNhdGNoKGUpIHsgfQ0KCQkJdHJ5IHsgc2VsZi5yZXNwb25zZVhNTCA9IHNlbGYuYmFzZS5yZXNwb25zZVhNTDsgfSBjYXRjaChlKSB7IH0NCgkJCQ0KCQkJDQoJCQkvL2ludm9rZSBwcm94eSBvbnJlYWRzdGF0ZWNoYW5nZSBtZXRob2QNCgkJCWlmKHNlbGYub25yZWFkeXN0YXRlY2hhbmdlICE9IG51bGwpIHsNCgkJCQlzZWxmLm9ucmVhZHlzdGF0ZWNoYW5nZS5hcHBseSh0aGlzLCBhcmdzWzFdKTsNCgkJCX0NCgkJCQ0KCQkJLy93cml0ZSB0b2tlbg0KCQkJdG9rZW4ud3JpdGVUb2tlbihzZWxmLmJhc2UpOw0KCQl9DQoJCTsNCgkJDQoJCWluaXRfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlID0gYWxsb2NfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlOw0KCQkNCgkJLyoqIGNvbnN0YW50cyAqICovDQoJCWluaXRfWE1MSHR0cFJlcXVlc3QuVU5TRU5UID0gMDsNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5PUEVORUQgPSAxOw0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LkhFQURFUlNfUkVDRUlWRUQgPSAyOw0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LkxPQURJTkcgPSAzOw0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LkRPTkUgPSA0Ow0KCQkNCgkJLyoqIHByb3BlcnRpZXMgKiAqLw0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zdGF0dXMgPSAwOw0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zdGF0dXNUZXh0ID0gIiI7DQoJCWluaXRfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnJlYWR5U3RhdGUgPSBpbml0X1hNTEh0dHBSZXF1ZXN0LlVOU0VOVDsNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUucmVzcG9uc2VUZXh0ID0gIiI7DQoJCWluaXRfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnJlc3BvbnNlWE1MID0gbnVsbDsNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub25zZW5kID0gbnVsbDsNCgkJDQoJCWluaXRfWE1MSHR0cFJlcXVlc3QudXJsID0gbnVsbDsNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOw0KDQoJCS8qKiBtZXRob2RzICogKi8NCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzcykgew0KCQkJdmFyIHNlbGYgPSB0aGlzOw0KCQkJDQoJCQkvL2FwcGVuZCB0b2tlbiB0byB1cmwuDQoJCQl1cmwgPSB0b2tlbi5kZWFsV2l0aFVybCh1cmwsIG1ldGhvZCk7DQoJCQkNCgkJCXRoaXMuYmFzZS5vcGVuKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzcyk7DQoJCQkNCgkJCXRoaXMuYmFzZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsNCgkJCQlzdGF0ZUNoYW5nZShzZWxmLCBhcmd1bWVudHMpOw0KCQkJfQ0KCQl9Ow0KCQkNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKGRhdGEpIHsNCgkJCWlmKHRoaXMub25zZW5kICE9IG51bGwpIHsNCgkJCQl0aGlzLm9uc2VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KCQkJfQ0KCQkJdGhpcy5iYXNlLnNlbmQoZGF0YSk7DQoJCX0NCgkJDQoJCWluaXRfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24oKSB7DQoJCQl0aGlzLmJhc2UuYWJvcnQoKTsNCgkJfQ0KCQkNCgkJaW5pdF9YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzID0gZnVuY3Rpb24oKSB7DQoJCQlyZXR1cm4gdGhpcy5iYXNlLmdldEFsbFJlc3BvbnNlSGVhZGVycygpOw0KCQl9DQoJCQ0KCQlpbml0X1hNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5nZXRSZXNwb25zZUhlYWRlciA9IGZ1bmN0aW9uKG5hbWUpIHsNCgkJCXJldHVybiB0aGlzLmJhc2UuZ2V0UmVzcG9uc2VIZWFkZXIobmFtZSk7DQoJCX0NCgkJDQoJCWluaXRfWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNldFJlcXVlc3RIZWFkZXIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgew0KCQkJcmV0dXJuIHRoaXMuYmFzZS5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKTsNCgkJfQ0KCQkNCgkJLyoqIGhvb2sgKiAqLw0KCQlYTUxIdHRwUmVxdWVzdCA9IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCA9IGluaXRfWE1MSHR0cFJlcXVlc3Q7DQoJfQ0KDQoJZnVuY3Rpb24gaGlqYWNrQUpBWCgpDQoJew0KCQlpZighIXdpbmRvdy5BY3RpdmVYT2JqZWN0IHx8ICJBY3RpdmVYT2JqZWN0IiBpbiB3aW5kb3cgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUiKT49MSkgew0KCQkJaGlqYWNrRXhwbG9yZXIoKTsNCgkJfSBlbHNlIHsNCgkJCWhpamFja1N0YW5kYXJkKCk7DQoJCX0NCg0KCQlYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub25zZW5kID0gZnVuY3Rpb24oZGF0YSkgew0KCQkJdGhpcy5zZXRSZXF1ZXN0SGVhZGVyKCJYLVJlcXVlc3RlZC1XaXRoIiwgIlhfUkVRVUVTVEVEX1dJVEgiKTsNCgkJfTsNCgl9DQoJDQoJDQoJaWYgKHR5cGVvZihwcm9maWxlKSAhPSAidW5kZWZpbmVkIg0KCQkmJiBwcm9maWxlICE9IG51bGwNCgkJJiYgcHJvZmlsZS5lbmFibGVTZWN1cml0eURlZmVuc2UpDQoJew0KCQloaWphY2tBSkFYKCk7CQkNCgl9DQoJDQoNCgkNCgkNCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1iZWxvdyBpcyB1c2UgaW4gc2Vzc3Rpb24gdGltZSBvdXQ9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CQ0KdmFyIGJha1RpbWUgPSAwOw0KdmFyIGxvY2FsTGF0ZXN0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOw0KdmFyIGJDaGFuZ2VkID0gZmFsc2U7DQp2YXIgcmVkaXJlY3RVUkwgPSAiIjsNCg0KLy91dGlsaXR5IGZ1bmN0aW9uIGNhbGxlZCBieSBnZXRDb29raWUoKQ0KZnVuY3Rpb24gZ2V0Q29va2llVmFsKG9mZnNldCkNCnsNCgl2YXIgZW5kc3RyID0gZG9jdW1lbnQuY29va2llLmluZGV4T2YoIjsiLCBvZmZzZXQpOw0KCWlmKGVuZHN0ciA9PSAtMSkNCgl7DQoJCWVuZHN0ciA9IGRvY3VtZW50LmNvb2tpZS5sZW5ndGg7DQoJfQ0KCXJldHVybiB1bmVzY2FwZShkb2N1bWVudC5jb29raWUuc3Vic3RyaW5nKG9mZnNldCwgZW5kc3RyKSk7DQp9DQoNCi8vIHByaW1hcnkgZnVuY3Rpb24gdG8gcmV0cmlldmUgY29va2llIGJ5IG5hbWUNCmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKQ0Kew0KCXZhciBhcmcgPSBuYW1lICsgIj0iOw0KCXZhciBhbGVuID0gYXJnLmxlbmd0aDsNCgl2YXIgY2xlbiA9IGRvY3VtZW50LmNvb2tpZS5sZW5ndGg7DQoJdmFyIGkgPSAwOw0KCXdoaWxlKGkgPCBjbGVuKQ0KCXsNCgkJdmFyIGogPSBpICsgYWxlbjsNCgkJaWYgKGRvY3VtZW50LmNvb2tpZS5zdWJzdHJpbmcoaSwgaikgPT0gYXJnKQ0KCQl7DQoJCQlyZXR1cm4gZ2V0Q29va2llVmFsKGopOw0KCQl9DQoJCWkgPSBkb2N1bWVudC5jb29raWUuaW5kZXhPZigiICIsIGkpICsgMTsNCgkJaWYoaSA9PSAwKSBicmVhazsNCgl9DQoJcmV0dXJuIG51bGw7DQp9DQoNCmZ1bmN0aW9uIHRpbWVvdXRUaW1lcigpIA0Kew0KCXZhciBsYXRlc3RUaW1lID0gZ2V0Q29va2llKCJMQVNURVNUX1JFUVVFU1RfVElNRSIpOw0KCWlmIChsYXRlc3RUaW1lICE9IG51bGwgJiYgbGF0ZXN0VGltZSAhPSAiIikNCgl7DQoJCWxhdGVzdFRpbWUgPSBsYXRlc3RUaW1lICogMTsNCgkJaWYgKGxhdGVzdFRpbWUgIT0gYmFrVGltZSkNCgkJew0KCQkJaWYgKHNlc3Npb25UaW1lT3V0V2Fybk9iai51c2VySGFzQ2FuY2VsV29yayA9PSBmYWxzZSkNCgkJCXsNCgkJCQlsb2NhbExhdGVzdFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsNCgkJCQliYWtUaW1lID0gbGF0ZXN0VGltZTsNCgkJCX0NCgkJfQ0KCX0NCgkNCgl2YXIgdG1wVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbG9jYWxMYXRlc3RUaW1lOw0KDQoJaWYgKHRtcFRpbWUgPiB0aW1lb3V0IHx8IGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKCJBQ1NpZ25vZmYiKSA9PSAtMSkNCgl7DQoJCWxvZ291dCgpOw0KCX0NCgllbHNlIGlmICh0bXBUaW1lID4gd2FyblRpbWVvdXRUaW1lICYmIHdhcm5UaW1lb3V0VGltZSA+IDApLy9wcm9tcHQgd2FybiB3aW5kb3cgdG8gdXNlciB0aGUgc2Vzc2lvbiBhYm91dCB0aW1lIG91dC4NCgl7DQoJCXNlc3Npb25UaW1lT3V0V2Fybk9iai53YXJuVGltZW91dCgpOwkNCgl9DQp9DQoNCnZhciBzZXNzaW9uVGltZU91dFdhcm5PYmogPSB7DQoNCgkvL2ludm9rZSByZW1vdGUgcmVmcmVzaCBzZXNzaW9uIHVwZGF0ZSBsb2NhbCB0aW1lLg0KCXJlbmV3U2Vzc2lvbiA6IGZ1bmN0aW9uKCkgewkNCgkJdmFyIHVybCA9ICIvcG9ydGxldHMvZnJhbWV3b3JrL2luY2x1ZGVzL2Vycm9yL2VtcHR5LmpzcCI7DQoJCXZhciBjb250ZW50ID0gc2VuZEh0dHBSZXF1ZXN0KHVybCwgIiIsIGZhbHNlKTsNCgkJaWYgKGNvbnRlbnQpDQoJCXsNCgkJCXNlc3Npb25UaW1lT3V0V2Fybk9iai5yZW5ld0FsZXJ0V2luKCk7DQoJCX0NCgl9LA0KDQoJY2FuY2VsQWxlcnRXaW4gOiBmdW5jdGlvbigpIHsNCgkJdGhpcy51c2VySGFzQ2FuY2VsV29yayA9IHRydWU7DQoJfSwNCgkNCglyZW5ld0FsZXJ0V2luIDogZnVuY3Rpb24oKSB7DQoJCXRoaXMudXNlckhhc0NhbmNlbFdvcmsgPSBmYWxzZTsNCgl9LA0KCQ0KCS8vd2hlbiBjaGlsZCB3aW5kb3cgY2xvc2UgYnkgY3VzdG9tZXIuDQoJY2xvc2VQb3BXaW5kb3cgOiBmdW5jdGlvbigpIHsNCgkJaWYgKHNlc3Npb25UaW1lT3V0V2Fybk9iai53YXJuV2luZG93KQ0KCQkJc2Vzc2lvblRpbWVPdXRXYXJuT2JqLndhcm5XaW5kb3cuY2xvc2VXaW4oKTsNCgkJdG9wLmNsZWFySW50ZXJ2YWwodG9wLnJlZnJlc2hXYXJuTXNnSWQpOw0KCX0sDQoNCgl3YXJuVGltZW91dCA6IGZ1bmN0aW9uKCl7DQoJCWlmICh0aGlzLnVzZXJIYXNDYW5jZWxXb3JrIHx8IHRoaXMuZ2V0QWJvdXRUaW1lb3V0KCkgPCAwKQ0KCQkJcmV0dXJuIGZhbHNlOw0KCQl0aGlzLmNhbmNlbEFsZXJ0V2luKCk7DQoJCXNlc3Npb25UaW1lT3V0V2Fybk9iai50bXBhYm91dFRpbWVvdXQgPSB0aGlzLmdldEFib3V0VGltZW91dCgpOw0KCQkNCgkJdGhpcy53YXJuV2luZG93ID0gd2luZG93LnNob3dNb2RhbERpYWxvZygiL3BvcnRsZXRzL2ZyYW1ld29yay9pbmNsdWRlcy9lcnJvci90aW1lb3V0d2Fybi5qc3AiLHdpbmRvdywnZGlhbG9nV2lkdGg9NTUwcHg7ZGlhbG9nSGVpZ2h0PTEwMHB4O2xvY2F0aW9uPW5vO2RlcGVuZGVudD1ubztyZXNpemFibGU9bm87dG9vbGJhcj1ubztzdGF0dXM9bm87ZGlyZWN0b3JpZXM9bm87bWVudWJhcj1ubztzY3JvbGxiYXJzPW5vJyxmYWxzZSk7DQoJDQoJfSwNCgkNCgl1cGRhdGVNc2cgOiBmdW5jdGlvbigpDQoJew0KCQl2YXIgbWVzc2FnZSA9IHNlc3Npb25UaW1lT3V0V2Fybk9iai5nZXRXYXJuTXNnKCk7DQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiX21zZ0NvbnRlbnQiKSl7DQoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiX21zZ0NvbnRlbnQiKS5pbm5lckhUTUwgPSBtZXNzYWdlOw0KCQkJc2Nyb2xsQmFySXNzdWUuYXV0b0FkanVzdEZvckVycm9yTXNnRGlzcGxheSgpOw0KCQl9CQ0KCX0sCQ0KCS8vd2hlbiB1c2UgY2FuY2VsLCB0aGUgd2FybiB3aW5kb3cgZG9uJ3Qgb3Blbi4NCgl1c2VySGFzQ2FuY2VsV29yazogZmFsc2UsDQoJDQoJZ2V0QWJvdXRUaW1lb3V0IDogZnVuY3Rpb24oKXsNCgkJcmV0dXJuIGFib3V0VGltZW91dA0KCX0sDQoJDQoJZ2V0V2Fybk1zZzogZnVuY3Rpb24oKQ0KCXsNCgkJDQoJCWlmIChzZXNzaW9uVGltZU91dFdhcm5PYmoudG1wYWJvdXRUaW1lb3V0IDw9IDApDQoJCXsNCgkJCXNlc3Npb25UaW1lT3V0V2Fybk9iai5jbG9zZVBvcFdpbmRvdygpOw0KCQkJdmFyIG1lc3NhZ2UgPSBhYm91dFRpbWVvdXRNc2cucmVwbGFjZSgiezB9IiwgMCk7DQoJCQlyZXR1cm4gbWVzc2FnZTsNCgkJfQ0KCQl2YXIgbWVzc2FnZSA9IGFib3V0VGltZW91dE1zZy5yZXBsYWNlKCJ7MH0iLCBzZXNzaW9uVGltZU91dFdhcm5PYmoudG1wYWJvdXRUaW1lb3V0KTsNCgkJc2Vzc2lvblRpbWVPdXRXYXJuT2JqLnRtcGFib3V0VGltZW91dCA9IHNlc3Npb25UaW1lT3V0V2Fybk9iai50bXBhYm91dFRpbWVvdXQgLSAxOw0KCQlyZXR1cm4gbWVzc2FnZTsNCgl9DQoJDQp9DQoNCmZ1bmN0aW9uIHNldFRpbWVvdXRUaW1lcigpDQp7DQoJdmFyIHNlcnZQcm92Q29kZSA9IGdldENvb2tpZSgiQUNBUGVyc2lzdExvZ2luU2VydlByb3ZDb2RlIik7DQoJdmFyIGhvc3RTaWduT24gPSBnZXRDb29raWUoImhvc3RTaWduT24iKTsNCgl2YXIgQUNTaWduT25Nb2R1bGUgPSBnZXRDb29raWUoIkFDU2lnbk9uTW9kdWxlIik7DQoJcmVkaXJlY3RVcmwgPSAiL3Nzb0FkYXB0ZXIvbG9nb3V0QWN0aW9uLmRvP2F1dG9tYXRpY0xvZ291dD10cnVlJmhvc3RTaWduT249IiArIGhvc3RTaWduT247DQoJdHJ5IA0KCXsNCgkJaWYgKHR5cGVvZih0b3AudGltZW91dF93YXRjaGVyKSAhPSAndW5kZWZpbmVkJykNCgkJew0KCQkJdG9wLmNsZWFySW50ZXJ2YWwodG9wLnRpbWVvdXRfd2F0Y2hlcik7DQoJCX0NCgkJDQoJCWlmICh0aW1lb3V0ID4gMCkNCgkJew0KCQkJdG9wLnRpbWVvdXRfd2F0Y2hlciA9IHRvcC5zZXRJbnRlcnZhbCh0aW1lb3V0VGltZXIsIDEwMDApOw0KCQl9DQoJfQ0KCWNhdGNoIChlKSB7fQ0KfQ0KDQpmdW5jdGlvbiBsb2dvdXQoKSANCnsNCgl0b3AuY2xlYXJJbnRlcnZhbCh0b3AudGltZW91dF93YXRjaGVyKTsNCglpZiAoYXV0b0xvZ291dCkgDQoJew0KCQl3aW5kb3cudG9wLmxvY2F0aW9uLmhyZWYgPSByZWRpcmVjdFVybDsNCgl9DQoJZWxzZQ0KCXsNCgkJc2Vzc2lvblRpbWVPdXRXYXJuT2JqLmNsb3NlUG9wV2luZG93KCk7DQoJCWFsZXJ0KHRpbWVvdXRNZXNzYWdlKTsNCgl9DQp9DQovKioNCiAqIA0KICogQHBhcmFtIHVybCB0aGUgY29udGVudCB1cmwgcmVxdWlyZWQhDQogKiBAcGFyYW0gd2lkdGggcmVxdWlyZWQhDQogKiBAcGFyYW0gaGVpZ2h0IHJlcXVpcmVkIQ0KICogQHBhcmFtIHRpdGxlIHJlcXVpcmVkIQ0KICogQHBhcmFtIGNvbnRlbnRUeXBlICByZXF1aXJlZCENCiAqIEBwYXJhbSBzY3JvbGxUeXBlIA0KICogQHBhcmFtIGNhbGxEb2N1bWVudCBpZiBkbyBub3QgbmVlZCByZXR1cm4gZG9tIHRvIGNhbGwgZG9jdW1lbnQsdGhlIHZhbHVlIG11c3QgYmUgbnVsbC4NCiAqIAkJCQkJICAgb3RoZXJ3aXNlIHRoZSBjYWxsRG9jdW1lbnQgbXVzdCBiZSB0aGUgY2FsbGVyIGRvY3VtZW50LiANCiAqIAkJCQkJICAgd2UgY2FuIGdldCBpbiB0aGVzZSB3YXlzOg0KICogCQkJCQkgICBwYXJlbnQuYWNQb3AuaW5mby5jYWxsRG9jdW1lbnQ6Z2V0IHRoZSBjYWxsZXIgZG9jdW1lbnQuDQogKiAJCQkJCSAgIHBhcmVudC5hY1BvcC5pbmZvLmNhbGxEb2N1bWVudC5TY3JpcHQud2luZG93OmdldCB0aGUgd2luZG93IG9iamVjdCBvZiB0aGUgY2FsbGVyLg0KICogCQkJCQkgICB0aGVuIHlvdSBjYW4gdXNlIHBhcmVudC5hY1BvcC5pbmZvLmNhbGxEb2N1bWVudC5TY3JpcHQud2luZG93IGluc3RlYWQgb2YgcGFyZW50LiANCiAqIEByZXR1cm4NCiAqLw0KZnVuY3Rpb24gY3JlYXRlUG9wSW5BcHAodXJsLHdpZHRoLGhlaWdodCx0aXRsZSxjb250ZW50VHlwZSxzY3JvbGxUeXBlLGNhbGxEb2N1bWVudCxjdXN0b21NYXJnaW4sY2FsbEJhY2spDQp7DQoJdmFyIGN1cnJlbnQgPSAndGhpcy5wYXJlbnQnOw0KCWZvcih2YXIgaSA9IDE7aTw9MTA7aSsrKQ0KCXsNCgkJaWYodHlwZW9mKGV2YWwoY3VycmVudCArICcuYWNQb3AnKSkgPT0gJ3VuZGVmaW5lZCcpDQoJCXsNCgkJCWN1cnJlbnQgPSBjdXJyZW50ICsnLnBhcmVudCc7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KCX0NCgkNCgl2YXIgdG9wUG9wID0gZXZhbChjdXJyZW50ICsgJy5hY1BvcCcpOw0KCQ0KCWlmKHR5cGVvZih0b3BQb3ApID09ICd1bmRlZmluZWQnKQ0KCXsNCgkJdmFyIGN1cnJlbnRGcmFtZSA9IHNjcm9sbEJhcklzc3VlLmdldEZyYW1lRWxlbWVudChjYWxsRG9jdW1lbnQpOw0KCQlpZihzY3JvbGxCYXJJc3N1ZS5qdWRnZUlzT2JqKGN1cnJlbnRGcmFtZSkpDQoJCXsNCgkJCWN1cnJlbnRGcmFtZS5jb250ZW50V2luZG93LnRlbXBQb3AgPSB0b3BQb3A7DQoJCX0NCgkJZWxzZSBpZihzY3JvbGxCYXJJc3N1ZS5pc1BvcFVwV2luZG93KGNhbGxEb2N1bWVudCkpDQoJCXsNCgkJCXdpbmRvdy50ZW1wUG9wID0gdG9wUG9wOw0KCQl9DQoJCXRvcFBvcCA9IG5ldyBQb3B1cCh7IGNvbnRlbnRUeXBlOjEsc2Nyb2xsVHlwZTpmYWxzZSxpc1JlbG9hZE9uQ2xvc2U6ZmFsc2Usd2lkdGg6NTAwLGhlaWdodDozMzAsbGF5b3V0OiIifSk7DQoJfQ0KCS8vd2lkdGggPSAod2lkdGgvd2luZG93LnNjcmVlbi5hdmFpbFdpZHRoICogZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCkgPiAyMDAgPyAod2lkdGgvd2luZG93LnNjcmVlbi5hdmFpbFdpZHRoICogZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCkgOiAyMDA7DQoJLy9oZWlnaHQgPSAoaGVpZ2h0Lyh3aW5kb3cuc2NyZWVuLmF2YWlsSGVpZ2h0IC0gMTIwKSAqIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KSA+IDMwMCA/IChoZWlnaHQvd2luZG93LnNjcmVlbi5hdmFpbEhlaWdodCAqIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KSA6IDMwMDsNCgl0b3BQb3Auc2V0Q29udGVudCgidGl0bGUiLHRpdGxlKTsNCgl0b3BQb3Auc2V0Q29udGVudCgid2lkdGgiLHdpZHRoKTsNCgl0b3BQb3Auc2V0Q29udGVudCgiaGVpZ2h0IixoZWlnaHQpOw0KCXRvcFBvcC5zZXRDb250ZW50KCJzY3JvbGxUeXBlIixzY3JvbGxUeXBlKTsNCgl0b3BQb3Auc2V0Q29udGVudCgiY29udGVudFR5cGUiLGNvbnRlbnRUeXBlKTsNCgl0b3BQb3Auc2V0Q29udGVudCgiY29udGVudFVybCIsdXJsKTsNCglpZihjYWxsQmFjaykNCgl7DQoJCXRvcFBvcC5zZXRDb250ZW50KCJjYWxsQmFja0FmdGVyQ2xvc2UiLGNhbGxCYWNrKTsNCgl9DQoJZWxzZQ0KCXsNCgkJdG9wUG9wLnNldENvbnRlbnQoImNhbGxCYWNrQWZ0ZXJDbG9zZSIsIG51bGwpOw0KCX0NCglpZihjYWxsRG9jdW1lbnQgIT0gbnVsbCkNCgl7DQoJCXRvcFBvcC5zZXRDb250ZW50KCJjYWxsRG9jdW1lbnQiLGNhbGxEb2N1bWVudCk7DQoJfQ0KCWlmKHR5cGVvZiBjdXN0b21NYXJnaW4gIT0gJ3VuZGVmaW5lZCcpDQoJew0KCQl0b3BQb3Auc2V0Q29udGVudCgiY3VzdG9tTWFyZ2luIixjdXN0b21NYXJnaW4pOw0KCX0NCgllbHNlDQoJew0KCQl0b3BQb3Auc2V0Q29udGVudCgiY3VzdG9tTWFyZ2luIiwiMCAxMHB4Iik7IC8vIHNldCBkZWZhdWx0IG1hcmdpbg0KCX0NCgl0b3BQb3AuYnVpbGQoKTsNCgl0b3BQb3Auc2hvdygpOw0KCXJldHVybiB0b3BQb3A7DQoJLy9hbGVydCh0aGlzLnBhcmVudC5wYXJlbnQucGFyZW50LnBhcmVudC5wYXJlbnQucGFyZW50LmFjUG9wKTsNCn0NCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1hYm92ZSBpcyB1c2UgaW4gc2Vzc3Rpb24gdGltZSBvdXQ9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCg0KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PWNoZWNrIHRoZSBzdHlsZSBpcyBzdGFuZGFyZCBvciBzaW1wbGUgYmVnaW49PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi8vdXNlIGluIG5ldyBzdHlsZQ0KZnVuY3Rpb24gZ2V0VGFiVG9wKCkNCnsNCgl2YXIgXyRtYWluQ29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfJG1haW5Db250ZW50Jyk7DQoJaWYgKF8kbWFpbkNvbnRlbnQpDQoJCXJldHVybiBfJG1haW5Db250ZW50Lm9mZnNldFRvcDsNCglyZXR1cm4gMDsNCn0NCg0KZnVuY3Rpb24gZ2V0VGhlbWVGb2xkZXIoKQ0Kew0KCWlmICh0eXBlb2YocHJvZmlsZSkgIT0gInVuZGVmaW5lZCIpDQoJCXJldHVybiBwcm9maWxlLnRoZW1lOw0KCXJldHVybiAnc2t5X2JsdWUnOw0KfQ0KDQovL2RlZmluZSBpbiBkZWZhdWx0LnZtLCB0aGlzIHNob3VsZCBhZGQgaW4gc3R5bGUNCnZhciBwcmltYXJ5QVBPQmFja2dyb3VuZCA9ICcjRkZGRkZGJzsNCg0KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PWNoZWNrIHRoZSBzdHlsZSBpcyBzdGFuZGFyZCBvciBzaW1wbGUgZW5kPT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQmVnaW4gRm9yIEpldHNwZWVkID09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQpmdW5jdGlvbiBqZXRzcGVlZGlmcmFtZVJlc2l6ZSgpDQp7Ly8gTmVlZCBRQSB0byB0ZXN0IHRoZSBTYWxlc0ZvcmNlIElEOiAxMUFDQy0wMTU3MCBmb3IgdGhlIGNoYW5nZS4NCn0NCg0KZnVuY3Rpb24gaW5pdFBhZ2UoKQ0Kew0KCWlmcmFtZVJlc2l6ZSgpOw0KfQ0KDQpmdW5jdGlvbiBhamR1c3R2MzYwbGlzdGRpdih3aW5PYmopDQp7DQoJDQp9DQoNCg0KZnVuY3Rpb24gcmVmcmVzaEZyYW1lKG9iaixmcmFtZW5hbWUpDQp7DQoJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVuYW1lKSE9bnVsbCkNCgl7DQoJCWlmKGZyYW1lbmFtZSA9PSAnbXl0YXNrcycgfHwgZnJhbWVuYW1lID09ICdnYnNlYXJjaCcpDQoJCXsNCgkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZyYW1lbmFtZSkuc3JjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVuYW1lKS5zcmM7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQkgIHZhciB0YXJnZXRVUkw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVuYW1lKS5jb250ZW50V2luZG93LmxvY2F0aW9uKyIiOw0KCQkJICAvLyBJZiBjdXJyZW50IGRvbWFpbiBjb21lIGZyb20gdGhpcmQtcGFydCwgZS5nLiBodHRwOi8vd3d3LnlhaG9vLmNvbSwgdGhlbiB1c2UgaWZyYW1lLnNyYyBhcyBpdCB1cmwuDQoJCQkgIGlmICghdGFyZ2V0VVJMKQ0KCQkJICB7DQoJCQkJICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZW5hbWUpLnNyYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZyYW1lbmFtZSkuc3JjOw0KCQkJICB9DQoJCQkgIGVsc2UNCgkJCSAgew0KCQkJCSAgaWYodGFyZ2V0VVJMLmluZGV4T2YoInJlZnJlc2hGcmFtZSIpPDApDQoJCQkJICB7DQoJCQkJCSAgaWYodGFyZ2V0VVJMLmluZGV4T2YoIj8iKTwwKQ0KCQkJCQkgIHsNCgkJCQkJCSAgdGFyZ2V0VVJMPXRhcmdldFVSTCsiP3JlZnJlc2hGcmFtZT1ZIjsJCQkJCQkgIA0KCQkJCQkgIH0NCgkJCQkJICBlbHNlDQoJCQkJCSAgew0KCQkJCQkJICB0YXJnZXRVUkw9dGFyZ2V0VVJMKyImcmVmcmVzaEZyYW1lPVkiOwkJCQkJCSAgCQkJCQkJICAgIA0KCQkJCQkgIH0JCQkJCQkgICAgDQoJCQkJICB9DQoJCQkJICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZW5hbWUpLmNvbnRlbnRXaW5kb3cubG9jYXRpb24gPSB0YXJnZXRVUkw7CQ0KCQkJICB9DQoJCX0NCgl9DQp9DQpmdW5jdGlvbiBtaW5pbWl6ZUZyYW1lKG9iaixmcmFtZW5hbWUsIHJlc3RvcmVBbHQpDQp7CQkNCglpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZW5hbWUpIT1udWxsICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZyYW1lbmFtZSkuc3R5bGUuZGlzcGxheSAhPSAnbm9uZScpDQoJewkJDQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZyYW1lbmFtZSkuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCgkJaWZyYW1lUmVzaXplKCk7DQoJCXZhciAgIG9QYXJlbnQgICA9ICAgb2JqLnBhcmVudE5vZGU7DQoJCXZhciAgIHBDaGlsZDMgICA9ICAgb1BhcmVudC5jaGlsZHJlblsyXTsNCgkJdmFyICAgbWluaW1pemVBbHQgPSBvYmouY2hpbGRyZW5bMF0uYWx0Ow0KCQlvYmoub25jbGljayA9IGZ1bmN0aW9uKCkNCgkJew0KCQkJcmVzdG9yZU1pbkZyYW1lKG9iaixmcmFtZW5hbWUsbWluaW1pemVBbHQpOyANCgkJCXJldHVybiBmYWxzZTsJCQkNCgkJfTsNCgkJDQoJCS8vRm9yIG5ldyBVSSwgaXQgYWRkIGJlbG93IGV2ZW50IHRvIGNoYW5nZWQgdGhlaXIgaWNvbnMgYXMgbW91c2UgbW92ZSBvbiB0aGVtDQoJCW9iai5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKCkNCgkJew0KCQkJb2JqLmNoaWxkcmVuWzBdLnNyYyA9Z2V0UmVwbGFjZVBpYyhvYmouY2hpbGRyZW5bMF0uc3JjLCdidG5fcmVzdG9yZV9ob3Zlci5wbmcnKTsNCgkJfQ0KCQkNCgkJb2JqLm9ubW91c2VvdXQgPSBmdW5jdGlvbigpDQoJCXsNCgkJCW9iai5jaGlsZHJlblswXS5zcmMgPWdldFJlcGxhY2VQaWMob2JqLmNoaWxkcmVuWzBdLnNyYywncmVzdG9yZS5naWYnKTsNCgkJfQ0KCQkNCgkJb2JqLmNoaWxkcmVuWzBdLnNyYyA9IGdldFJlcGxhY2VQaWMob2JqLmNoaWxkcmVuWzBdLnNyYywgJ3Jlc3RvcmUuZ2lmJyk7DQoJCW9iai5jaGlsZHJlblswXS5hbHQgPSByZXN0b3JlQWx0Ow0KCQlvYmoudGl0bGUgPSAncmVzdG9yZSc7DQoJCWlmIChwQ2hpbGQzKSB7DQoJCQkvL3BDaGlsZDMuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCgkJCXBDaGlsZDMuc3R5bGUudmlzaWJpbGl0eSA9ICJoaWRkZW4iOw0KCQl9CQkJCQkNCgl9DQp9DQoNCmZ1bmN0aW9uIGdldFJlcGxhY2VQaWMoc3JjUGF0aCxwaWMpDQp7DQoJdmFyIGxhc3RJbmRleCA9IHNyY1BhdGgubGFzdEluZGV4T2YoIi8iKQ0KCXZhciBhbGxTdHI9ICcnOw0KCWlmKGxhc3RJbmRleCAhPSAtMSkNCgl7DQoJCXZhciBiZWdpblNlY3QgPSBzcmNQYXRoLnN1YnN0cmluZygwLGxhc3RJbmRleCk7DQoJCWFsbFN0ciA9IGJlZ2luU2VjdCArIi8iK3BpYzsNCgl9DQoJZWxzZQ0KCXsNCgkJYWxsU3RyID0gc3JjUGF0aDsNCgl9DQoJDQoJcmV0dXJuIGFsbFN0cjsNCn0NCg0KZnVuY3Rpb24gcmVzdG9yZU1pbkZyYW1lKG9iaixmcmFtZW5hbWUsbWluaW1pemVBbHQpDQp7DQoJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVuYW1lKSE9bnVsbCAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZW5hbWUpLnN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnKQ0KCXsJCQ0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmcmFtZW5hbWUpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KCQkNCgkJdmFyICAgb1BhcmVudCAgID0gICBvYmoucGFyZW50Tm9kZTsNCgkJdmFyICAgcENoaWxkMyAgID0gICBvUGFyZW50LmNoaWxkcmVuWzJdOw0KCQl2YXIgICByZXN0b3JlQWx0ID0gb2JqLmNoaWxkcmVuWzBdLmFsdDsNCgkJb2JqLm9uY2xpY2sgPSBmdW5jdGlvbigpDQoJCXsNCgkJCW1pbmltaXplRnJhbWUob2JqLGZyYW1lbmFtZSxyZXN0b3JlQWx0KTsgDQoJCQlyZXR1cm4gZmFsc2U7CQkJDQoJCX07DQoJCQ0KCQkvL0ZvciBuZXcgVUksIGl0IGFkZCBiZWxvdyBldmVudHMgdG8gY2hhbmdlZCB0aGVpciBpY29ucyBhcyBtb3VzZSBtb3ZlIG9uIHRoZW0NCgkJb2JqLm9ubW91c2VvdmVyID0gZnVuY3Rpb24oKQ0KCQl7DQoJCQlvYmouY2hpbGRyZW5bMF0uc3JjID0gZ2V0UmVwbGFjZVBpYyhvYmouY2hpbGRyZW5bMF0uc3JjLCdidG5fbWluX2hvdmVyLnBuZycpOw0KCQl9DQoJCQ0KCQlvYmoub25tb3VzZW91dCA9IGZ1bmN0aW9uKCkNCgkJew0KCQkJb2JqLmNoaWxkcmVuWzBdLnNyYyA9IGdldFJlcGxhY2VQaWMob2JqLmNoaWxkcmVuWzBdLnNyYywnbWluaW1pemUuZ2lmJyk7DQoJCQl9DQoJCQ0KCQlvYmouY2hpbGRyZW5bMF0uc3JjID0gZ2V0UmVwbGFjZVBpYyhvYmouY2hpbGRyZW5bMF0uc3JjLCAnbWluaW1pemUuZ2lmJyk7DQoJCW9iai5jaGlsZHJlblswXS5hbHQgPSBtaW5pbWl6ZUFsdDsNCgkJb2JqLnRpdGxlID0gJ21pbmltaXplJzsNCgkJDQoJCWlmIChwQ2hpbGQzKSB7DQoJCQkvL3BDaGlsZDMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJCQlwQ2hpbGQzLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJCX0NCgkJaWZyYW1lUmVzaXplKCk7DQoJfQ0KfQ0KDQpmdW5jdGlvbiBNTV9zd2FwSW1hZ2U0TmV3KG9iaixkZXN0UGljKSANCnsgDQoJDQoJaWYgKG9iaiE9bnVsbCAmJiAhb2JqLmRpc2FibGVkKQ0KCXsNCgkJLy9CZWNhdXNlIGl0IG9ubHkgaGF2ZSBvbiBjaGlsZCBub2RlDQoJCXZhciBjaGlsZE5vZGUgPSBvYmouZmlyc3RDaGlsZDsNCgkJaWYoY2hpbGROb2RlKQ0KCQl7DQoJCQlpZighY2hpbGROb2RlLm9TcmMpDQoJCQl7DQoJCQkJY2hpbGROb2RlLm9TcmM9Y2hpbGROb2RlLnNyYzsNCgkJCX0NCgkJCWNoaWxkTm9kZS5zcmM9ZGVzdFBpYzsNCgkJfQ0KCX0NCn0NCg0KZnVuY3Rpb24gTU1fc3dhcEltZ1Jlc3RvcmU0TmV3KG9iaikNCnsNCglpZiAob2JqIT1udWxsICYmICFvYmouZGlzYWJsZWQpDQoJew0KCQkvL0JlY2F1c2UgaXQgb25seSBoYXZlIG9uIGNoaWxkIG5vZGUNCgkJdmFyIGNoaWxkTm9kZSA9IG9iai5maXJzdENoaWxkOw0KCQlpZihjaGlsZE5vZGUpDQoJCXsNCgkJCWNoaWxkTm9kZS5zcmM9Y2hpbGROb2RlLm9TcmM7DQoJCX0NCgl9DQp9DQoNCmZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSANCnsNCiAgIHZhciBhcnJTdHIgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoIjsgIik7DQogICBmb3IodmFyIGkgPSAwO2kgPCBhcnJTdHIubGVuZ3RoO2kgKyspDQogICB7DQogICAJCXZhciB0ZW1wID0gYXJyU3RyW2ldLnNwbGl0KCI9Iik7DQogICAgCWlmKHRlbXBbMF0gPT0gbmFtZSkgcmV0dXJuIHVuZXNjYXBlKHRlbXBbMV0pOw0KICAgfQ0KfQ0KZnVuY3Rpb24gZGVsQ29va2llKG5hbWUsY3ZhbCkNCnsNCiAgICB2YXIgZXhwID0gbmV3IERhdGUoKTsNCiAgICBleHAuc2V0VGltZShleHAuZ2V0VGltZSgpIC0gMSk7DQoJZG9jdW1lbnQuY29va2llID0gbmFtZSsiPSIrZXNjYXBlKGN2YWwpKyI7IGV4cGlyZXM9IitleHAudG9HTVRTdHJpbmcoKSsiOyBwYXRoPS8iOw0KfQ0KDQp2YXIgZXhwaXJlZERheXMgPSBnZXRDb29raWUoIkxpY2Vuc2VFeHBpcmVkRGF5cyIpOw0KdmFyIGV4cGlyZWRNb2R1bGVzID0gZ2V0Q29va2llKCJMaWNlbnNlRXhwaXJlZE1vZHVsZXMiKTsNCmlmIChleHBpcmVkRGF5cyAhPSBudWxsICYmIGV4cGlyZWRNb2R1bGVzICE9IG51bGwpDQp7DQoJZGVsQ29va2llKCJMaWNlbnNlRXhwaXJlZERheXMiLGV4cGlyZWREYXlzKTsNCglkZWxDb29raWUoIkxpY2Vuc2VFeHBpcmVkTW9kdWxlcyIsZXhwaXJlZE1vZHVsZXMpOw0KCXdpbmRvdy5vcGVuKCIvcG9ydGxldHMvY29tbW9ucy9wcm9kdWN0bGljZW5zZS9saWNlbnNlRXhwaXJlLmpzcD9MaWNlbnNlRXhwaXJlZERheXM9IiArIGV4cGlyZWREYXlzICsgIiZMaWNlbnNlRXhwaXJlZE1vZHVsZXM9IiArIGV4cGlyZWRNb2R1bGVzDQoJCSwnJywnaGVpZ2h0PTMwMCwgd2lkdGg9NDAwLCB0b3A9NzUsIGxlZnQ9MTAwLHRvb2xiYXI9bm8sIG1lbnViYXI9bm8sIHNjcm9sbGJhcnM9eWVzLCByZXNpemFibGU9eWVzLCBsb2NhdGlvbj1ubywgc3RhdHVzPW5vJyk7DQp9DQoNCmZ1bmN0aW9uIGpldHNwZWVkT25Mb2FkKCkNCnsNCglNTV9wcmVsb2FkSW1hZ2VzKCcvamV0c3BlZWQvYWNjZWxhL2ltYWdlcy9uYXZfYmFyX2hvbWUtb3Zlci5qcGcnKTsNCg0KCWlmKHR5cGVvZiBzZXRHbG9iYWxGb2N1cyAhPSAndW5kZWZpbmVkJyAmJiBzZXRHbG9iYWxGb2N1cykgcmV0dXJuOw0KCXZhciBvYmpGcmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnSUZSQU1FJyk7DQoJdmFyIGZvY3VzZWQgPSBmYWxzZTsNCglmb3IodmFyIGk9MDsgaTxvYmpGcmFtZXMubGVuZ3RoOyBpKyspDQoJew0KCQl2YXIgZ2V0Rm9jdXMgPSBmb2N1c1RvSWZyYW1lKG9iakZyYW1lc1tpXSk7DQoJCWZvY3VzZWQgPSAoZ2V0Rm9jdXMgPT0gMSk7DQoJCWlmKGdldEZvY3VzICE9IDApDQoJCXsNCgkJCWJyZWFrOw0KCQl9DQoNCgl9DQoJaWYoZm9jdXNlZCkNCgl7DQoJCXNldEdsb2JhbEZvY3VzID0gdHJ1ZTsNCgl9DQoJZmluaXNoTG9hZGluZyA9IHRydWU7DQp9DQoNCmZ1bmN0aW9uIGZvY3VzVG9JZnJhbWUoc3ViSWZyYW1lKQ0Kew0KCXZhciByZXQgPSAwOw0KCXRyeXsNCgkJaWYoIHN1YklmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmZvcm1zICYmIHN1YklmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmZvcm1zLmxlbmd0aCA+IDApDQoJCXsNCgkJCXJldCA9IGZvY3VzRmlyc3RGb3JtRWxlbWVudChzdWJJZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5mb3Jtc1swXSk7DQoJCQlpZihyZXQpIA0KCQkJCXJldHVybiAxDQoJCQllbHNlDQoJCQkJcmV0dXJuIDA7DQoJCX0NCg0KCQl2YXIgb2JqRnJhbWVzID0gc3ViSWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ0lGUkFNRScpOw0KCQlmb3IodmFyIGo9MDsgaiA8IG9iakZyYW1lcy5sZW5ndGg7IGorKykNCgkJew0KCQkJaWYob2JqRnJhbWVzW2pdLnJlYWR5U3RhdGUgPT0gImNvbXBsZXRlIikNCgkJCXsNCgkJCQlpZihmb2N1c0ZpcnN0Rm9ybUVsZW1lbnQob2JqRnJhbWVzW2pdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZm9ybXNbMF0pKQ0KCQkJCXsNCgkJCQkJcmV0ID0gMTsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfWVsc2UNCgkJCXsNCgkJCQlmaW5pc2hMb2FkaW5nID0gZmFsc2U7DQoJCQkJcmV0ID0gLTE7DQoJCQkJYnJlYWs7DQoJCQl9DQoNCgkJfQ0KCX1jYXRjaChlKXt9DQoJcmV0dXJuIHJldDsNCn0NCg0KLy9HZXQgcGFyYW1ldGVyIHZhbHVlIGZyb20gcXVlcnkgU3RyaW5nDQpmdW5jdGlvbiBndXAobmFtZSwgdXJsSnVkZ2UpDQp7DQoJIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcW10vLCJcXFxbIikucmVwbGFjZSgvW1xdXS8sIlxcXF0iKTsNCgkgdmFyIHJlZ2V4UyA9ICJbXFw/Jl0iK25hbWUrIj0oW14mI10qKSI7DQoJIHZhciByZWdleCA9IG5ldyBSZWdFeHAoIHJlZ2V4UyApOw0KCSB2YXIgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsSnVkZ2UpOw0KCSBpZiggcmVzdWx0cyA9PSBudWxsICkNCgkJcmV0dXJuICIiOw0KCSBlbHNlDQoJCXJldHVybiByZXN1bHRzWzFdOw0KfQ0KDQpmdW5jdGlvbiBpc0Zyb21KZXRzcGVlZCgpDQp7DQoJdmFyIHJlZmVyID0gZG9jdW1lbnQucmVmZXJyZXI7DQoJdmFyIGlzZnJvbWpldCA9IGZhbHNlOw0KCWlmKHJlZmVyKQ0KCXsNCgkJaWYgKHJlZmVyLmluZGV4T2YoImlzRnJvbVBvcnRsZXQ9WSIpID4gLTEpDQoJCXsNCgkJCWlzZnJvbWpldCA9IHRydWU7DQoJCX0NCgl9DQoJcmV0dXJuIGlzZnJvbWpldDsNCn0NCg0KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBFbmQgRm9yIEpldHNwZWVkID09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQoNCi8vZ2V0IGFjY2VsYSBtYWluIHRhYmxlIGluIG5vZGVzLg0KZnVuY3Rpb24gZ2V0TWFpblRhYmxlKCkNCnsNCglyZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ0FjY2VsYU1haW5UYWJsZScpOw0KfQ0KDQovL2RhdGUgcGlja2VyIHNlbGVjdGVkDQovKioNCiAqIGZ1bmN0aW9uIHRvIGdldCBpbnNwZWN0aW9uIGRhdGUgICAgDQogKi8NCmZ1bmN0aW9uIHNlbGVjdERhdGUoZGF0ZU5hbWUsIG51bSwgZm4pDQp7DQoJdmFyIHN0clRvZGF5ID0gZ2V0QWdlbmN5RGF0ZSgpOyANCgkvL2FsZXJ0KGRhdGVOYW1lKyJ8IitudW0pOw0KCXZhciBmb3JtTmFtZSA9IGRvY3VtZW50LmZvcm1zWzBdLm5hbWU7DQoJdmFyIHJlYWRPbmx5ID0gZG9jdW1lbnQuZm9ybXNbMF0uZWxlbWVudHNbZGF0ZU5hbWVdLmdldEF0dHJpYnV0ZSgncmVhZG9ubHknKSArICIiOw0KCWlmIChyZWFkT25seSA9PSAidHJ1ZSIpDQoJew0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KCS8vIFlhbiBYaWFvIC0gU3VwcG9ydCBOZXRzY2FwZSBhbmQgRmlyZWZveCAoU0FOIyAwNkFDVC0wMDAwMC0wMDIzNSk6IA0KCS8vIE9yaWdpbmFsIGNvZGUgYXNzdW1lZCB0aGF0IHdpbmRvdy5ldmVudCBpcyB0aGUgY3VycmVudCBldmVudC4NCgkvLyBIb3dldmVyLCBGaXJlZm94IGRvZXMgbm90IGRlZmluZSB3aW5kb3cuZXZlbnQgYXQgYWxsLiBBcyByZXN1bHQsIHdlIG5lZWQgdG8gdXNlICJ0aGlzLmV2ZW4iIGluc3RlYWQgb2YgImV2ZW4iLg0KCXZhciBldmVudCA9ICh3aW5kb3cuZXZlbnQpID8gd2luZG93LmV2ZW50IDogdGhpcy5ldmVudDsNCgkNCglpZiAoZXZlbnQpDQoJew0KCQl2YXIgbGVmdDEgPSBldmVudC5zY3JlZW5YOw0KCQl2YXIgdG9wMSA9IGV2ZW50LnNjcmVlblk7DQoJfQ0KCQ0KCS8qDQoJaWYobGVmdDErMjI3PnNjcmVlbi53aWR0aCl7DQoJCWxlZnQxID1sZWZ0MS0yMjc7DQoJfQ0KCWlmKHRvcDErMTc1PnNjcmVlbi5oZWlnaHQpew0KCQl0b3AxID10b3AxLTE3NTsNCgl9DQoJKi8NCgkNCgkvL0ZpeEJ1ZyA1NzE3ODpDYWxlbmRhciBXaWRnZXQgUG9wIFVwIFdpbmRvdyBBcHBlYXJzIE9mZiBTY3JlZW4gDQoJaWYobGVmdDErMzIwKzIwPndpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCl7DQoJCWxlZnQxID1sZWZ0MS0zMjAtMjA7DQoJfQ0KCXZhciB4SGVpZ2h0PTY1Ow0KCWlmKHRvcDErMzAwK3hIZWlnaHQ+d2luZG93LnNjcmVlbi5hdmFpbEhlaWdodCl7CQ0KCQl0b3AxPXRvcDEtMzAwLXhIZWlnaHQ7DQoJfQ0KCQ0KCXZhciBzZXR0aW5ncyA9ICJ3aWR0aD0zMjAsaGVpZ2h0PTMwMCx0b3A9Iit0b3AxKyIsbGVmdD0iK2xlZnQxOw0KCXNldHRpbmdzICs9ICIsc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPW5vLHRvb2xiYXI9bm8sc3RhdHVzPW5vLG1lbnViYXI9bm8sc2Nyb2xsYmFycz1ubyI7DQoJDQoJLyoqDQoJICogIHRoZSAiL3BvcnRsZXRzL2NvbW1vbnMvZGF0YXBpY2tlci9kYXRlVmlldy5qc3A/IiBkbyBub3QgbmVlZCBzc28gYXV0aGVudGljYXRlDQoJICogIHRoZSBzc28gc2Vzc2lvbiBpZCB3aWxsIGFkZCBpbiBjb29raWUgLCB0byBwYXNzIHNzbyBhdXRoZW50aWNhdGUNCiAgICAgKi8NCgl2YXIgdGFyZ2V0VVJMPSIvcG9ydGxldHMvcGlja2VyL0RhdGVQaWNrZXIuZG8/Y3VyRGF0ZT0iK3N0clRvZGF5KyImZm9ybT0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGZvcm1OYW1lKSArICImaW5wdXREYXRlPSIgKyBlbmNvZGVVUklDb21wb25lbnQoZGF0ZU5hbWUpICsgIiZ1c2VySW5wdXREYXRlPSIgKyB1c2VySW5wdXREYXRlOw0KCQ0KCXZhciB1c2VySW5wdXREYXRlID0gZXZhbCgiZG9jdW1lbnQuIitmb3JtTmFtZSsiLmVsZW1lbnRzWyciK2RhdGVOYW1lKyInXS52YWx1ZSIpOw0KCS8vIFlhbiBYaWFvIC0gU3VwcG9ydCBOZXRzY2FwZSBhbmQgRmlyZWZveCAoU0FOIyAwNkFDVC0wMDAwMC0wMDIzNSk6IA0KCS8vIGFjY291bnQgZm9yICJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZShjYXBNb2RlbCpmaWxlRGF0ZSkpIGhhcyBubyBwcm9wZXJ0aWVzIiBjYXVzaW5nIGRhdGUgcGlja2VyIG5vdCB3b3JraW5nIGluIEZpcmVmb3ggYW5kIE5ldHNjYXBlLg0KCXZhciBpbnB1dERhdGVOYW1lOw0KCWlmKCBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShkYXRlTmFtZSlbMF0gIT0gdW5kZWZpbmVkICYmIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKGRhdGVOYW1lKVswXSAhPSBudWxsKQ0KCQlpbnB1dERhdGVOYW1lID0gZXZhbCgiZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoJyIrZGF0ZU5hbWUrIicpWzBdLm5hbWUiKTsNCgllbHNlDQoJCWlucHV0RGF0ZU5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkYXRlTmFtZSkubmFtZTsNCglpZihpbnB1dERhdGVOYW1lLmluZGV4T2YoIl92YWx1ZSIpIT0gLTEpDQoJew0KCQl2YXIgaGlkZGVuX25hbWUgPSBpbnB1dERhdGVOYW1lLnN1YnN0cmluZygwLGlucHV0RGF0ZU5hbWUuaW5kZXhPZigiX3ZhbHVlIikpKyJfbWFza2Zvcm1hdCIraW5wdXREYXRlTmFtZS5zdWJzdHJpbmcoKGlucHV0RGF0ZU5hbWUuaW5kZXhPZigiX3ZhbHVlIikrNyksKGlucHV0RGF0ZU5hbWUubGVuZ3RoLTEpKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KCQl2YXIgbWFzayA9IGV2YWwoImRvY3VtZW50LiIrZm9ybU5hbWUrIi5lbGVtZW50c1tcJyIraGlkZGVuX25hbWUrIlwnXS52YWx1ZSIpOw0KCQl0YXJnZXRVUkw9dGFyZ2V0VVJMKyImbWFzaz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hc2spOw0KCX0NCgkNCgkNCglpZihudW0hPW51bGwgJiYgbnVtLmxlbmd0aD4wKQ0KCXsNCgkJdGFyZ2V0VVJMPXRhcmdldFVSTCsgIiZudW09IiArIG51bTsNCgl9DQoJaWYgKHR5cGVvZiAoZm4pICE9ICd1bmRlZmluZWQnKQ0KCXsNCgkJdmFyIGFyZyA9IGZuLmNhbGwodGhpcyk7DQoJCXRhcmdldFVSTCArPSAoIiYiK2FyZyk7DQoJfQ0KCXJldHVybiBvcGVuU3ViV2luZG93KHNldHRpbmdzLHRhcmdldFVSTCwiRGF0YVBpY2tlciIpOw0KfQ0KDQovKioNCiAqIGZ1bmN0aW9uIHRvIGdldCBpbnNwZWN0aW9uIGRhdGUgZm9yIGF1dG8gYXNzaWduIGZ1bmN0aW9uLg0KICovDQpmdW5jdGlvbiBzZWxlY3REYXRlRm9yQXV0b0Fzc2lnbihkYXRlTmFtZSkNCnsNCglyZXR1cm4gc2VsZWN0RGF0ZShkYXRlTmFtZSwgJycpOw0KfQ0KDQovKioNCiAqIGZ1bmN0aW9uIHRvIGdldCB3b3JrZmxvdyBjYWxlbmRhci4NCiAqIA0KICovDQpmdW5jdGlvbiBzZWxlY3RXb3JrZmxvd0RhdGUoZGF0ZU5hbWUsIGNhbGVuZGFySUQpDQp7DQoJaWYgKGNhbGVuZGFySUQgPT0gJycgfHwgY2FsZW5kYXJJRCA9PSAnMCcpDQoJCXNlbGVjdERhdGUoZGF0ZU5hbWUsICcnKTsNCgllbHNlDQoJCXNlbGVjdERhdGUoZGF0ZU5hbWUsICcnLCBmdW5jdGlvbigpe3JldHVybiAiY2FsZW5kYXJJRD0iK2NhbGVuZGFySUQrIiZjYWxlbmRhclR5cGU9d29ya2Zsb3ciO30pOw0KCQ0KDQp9DQoNCi8vbW92ZSBmcm9tIGFjMzYwLmpzDQpmdW5jdGlvbiBhZGp1c3RMaXN0Q29udGFpbmVyKCkNCnsNCglpZih0aGlzLl9fX3NldERIVE1MKQ0KCXsNCgkJX19fc2V0REhUTUwoKTsNCgl9DQp9DQoNClRhYmxlSGVscGVyID0gew0KCWluc2VydFJvdzogZnVuY3Rpb24odGFibGUpDQoJewkNCgkJdmFyIGllID0gaXNJRUJyb3dzZXIoKTsNCgkJdmFyIHJvdzsNCgkJaWYoaWUpDQoJCXsNCgkJCXJvdz10YWJsZS5pbnNlcnRSb3coKTsNCgkJfWVsc2UNCgkJew0KCQkJcm93PXRhYmxlLmluc2VydFJvdygtMSk7CQkgIA0KCQl9CQ0KCQlyZXR1cm4gcm93Ow0KCX0sDQoJDQoJaW5zZXJ0Q2VsbDpmdW5jdGlvbihyb3cpDQoJew0KCQl2YXIgaWUgPSBpc0lFQnJvd3NlcigpOw0KCQl2YXIgY2VsbDsNCgkJaWYoaWUpDQoJCXsNCgkJCWNlbGw9cm93Lmluc2VydENlbGwoKTsNCgkJfWVsc2UNCgkJew0KCQkJY2VsbD1yb3cuaW5zZXJ0Q2VsbCgtMSk7ICANCgkJfQkNCgkJcmV0dXJuIGNlbGw7DQoJfQ0KfQ0KDQpNZW51QmFyQ29ybmVyID0gew0KCQlhZGRVcENvcm5lciA6IGZ1bmN0aW9uKHdpZHRoKXsNCgkJCXZhciBzdHI9IiI7DQoJCQlzdHI9Ijx0YWJsZSBpZD0nbWVudWJhcl9jb3JuZXJfdXAnIGJvcmRlcj0nMCcgY2VsbHBhZGRpbmc9JzAnIGNlbGxzcGFjaW5nPScwJyB3aWR0aD0nIit3aWR0aCsiJz4iOw0KCQkJc3RyKz0iCTx0cj4iOw0KCQkJc3RyKz0iCQk8dGQ+IjsNCgkJCXN0cis9IgkJCTx0YWJsZSBjbGFzcz0nc2VjdGlvbi1oZWFkZXItdXAnPiI7DQoJCQlzdHIrPSIJCQkJPHRyPiI7DQoJCQlzdHIrPSIJCQkJCTx0ZCBjbGFzcz0nc2VjdGlvbi1oZWFkZXItdXAtbGVmdCc+PHNwYW4gc3R5bGU9J2ZvbnQtc2l6ZTogMHB4Oyc+Jm5ic3A7PC9zcGFuPjwvdGQ+IjsNCgkJCXN0cis9IgkJCQkJPHRkIGNsYXNzPSdzZWN0aW9uLWhlYWRlci11cC1jZW50ZXInIGNvbFNwYW49JzEwJz48c3BhbiBzdHlsZT0nZm9udC1zaXplOiAwcHg7Jz4mbmJzcDs8L3NwYW4+PC90ZD4iOw0KCQkJc3RyKz0iCQkJCQk8dGQgY2xhc3M9J3NlY3Rpb24taGVhZGVyLXVwLXJpZ2h0JyA+PHNwYW4gc3R5bGU9J2ZvbnQtc2l6ZTogMHB4Oyc+Jm5ic3A7PC9zcGFuPjwvdGQ+IjsNCgkJCXN0cis9IgkJCQk8L3RyPiI7DQoJCQlzdHIrPSIJCQk8L3RhYmxlPiI7DQoJCQlzdHIrPSIJCTwvdGQ+IjsNCgkJCXN0cis9Igk8L3RyPiI7DQoJCQlzdHIrPSI8L3RhYmxlPiI7DQoJCQlyZXR1cm4gc3RyOw0KCQl9LA0KCQlhZGREb3duQ29ybmVyIDogZnVuY3Rpb24od2lkdGgpew0KCQkJdmFyIHN0cj0iIjsNCgkJCXN0cj0iPHRhYmxlIGlkPSdtZW51YmFyX2Nvcm5lcl9kb3duJyBzdHlsZT0nbWFyZ2luLWJvdHRvbTogMHB4OycgYm9yZGVyPScwJyBjZWxscGFkZGluZz0nMCcgY2VsbHNwYWNpbmc9JzAnIHdpZHRoPSciK3dpZHRoKyInPiI7DQoJCQlzdHIrPSIJPHRyPiI7DQoJCQlzdHIrPSIJCTx0ZD4iOw0KCQkJc3RyKz0iCQkJPHRhYmxlIGNsYXNzPSdzZWN0aW9uLWhlYWRlci11cCc+IjsNCgkJCXN0cis9IgkJCQk8dHI+IjsNCgkJCXN0cis9IgkJCQkJPHRkIGNsYXNzPSdzZWN0aW9uLWhlYWRlci1kb3duLWxlZnQnPjxzcGFuIHN0eWxlPSdmb250LXNpemU6IDBweDsnPiZuYnNwOzwvc3Bhbj48L3RkPiI7DQoJCQlzdHIrPSIJCQkJCTx0ZCBjbGFzcz0nc2VjdGlvbi1oZWFkZXItZG93bi1jZW50ZXInIGNvbFNwYW49JzEwJz48c3BhbiBzdHlsZT0nZm9udC1zaXplOiAwcHg7Jz4mbmJzcDs8L3NwYW4+PC90ZD4iOw0KCQkJc3RyKz0iCQkJCQk8dGQgY2xhc3M9J3NlY3Rpb24taGVhZGVyLWRvd24tcmlnaHQnPjxzcGFuIHN0eWxlPSdmb250LXNpemU6IDBweDsnPiZuYnNwOzwvc3Bhbj48L3RkPiI7DQoJCQlzdHIrPSIJCQkJPC90cj4iOw0KCQkJc3RyKz0iCQkJPC90YWJsZT4iOw0KCQkJc3RyKz0iCQk8L3RkPiI7DQoJCQlzdHIrPSIJPC90cj4iOw0KCQkJc3RyKz0iPC90YWJsZT4iOw0KCQkJcmV0dXJuIHN0cjsNCgkJfSwNCgkJYWRkQ29ybmVyIDogZnVuY3Rpb24odGFyZ2V0SWQsaXNMYXlPdXQpew0KCQkJdmFyIHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldElkKTsNCgkJCWlmKHR5cGVvZih0YXJnZXQpPT0nb2JqZWN0Jyl7DQoJCQkJaWYoc2Nyb2xsQmFySXNzdWUuanVkZ2VJc09iaih0YXJnZXQucHJldmlvdXNTaWJsaW5nKSAmJiB0YXJnZXQucHJldmlvdXNTaWJsaW5nLmlkID09ICJtZW51YmFyX2Nvcm5lcl91cCIpew0KCQkJCQlyZXR1cm47DQoJCQkJfQ0KCQkJCXZhciB3aWR0aCA9IHRhcmdldC53aWR0aCE9MCA/IHRhcmdldC53aWR0aCA6IHRhcmdldC5vZmZzZXRXaWR0aDsNCgkJCQlpZih3aWR0aD09MCl7DQoJCQkJCXdpZHRoPSIxMDAlIjsNCgkJCQl9DQoJCQkJdGFyZ2V0LmNsYXNzTmFtZSs9Im1lbnUtYmFyLXN0eWxlIjsNCgkJCQl0YXJnZXQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVCZWdpbicsIHRoaXMuYWRkVXBDb3JuZXIod2lkdGgpKTsNCgkJCQl0YXJnZXQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlckVuZCcsIHRoaXMuYWRkRG93bkNvcm5lcih3aWR0aCkpOw0KCQkJfQ0KCQl9DQp9DQoNCi8vZ2V0IGVsZW1lbnQncyBhYnNvbHV0bHkgcG9zaXRpb24uDQpmdW5jdGlvbiBnZXRBYnNvbHV0bHlQb3NpdGlvbihlbGVJZCl7DQoJdmFyIHNyY09iaiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZUlkKTsNCglpZihzcmNPYmo9PW51bGwpew0KCQlyZXR1cm4geyJ0b3AiOjAsImxlZnQiOjB9Ow0KCX0NCgl2YXIgdD1zcmNPYmoub2Zmc2V0VG9wOyANCgl2YXIgbD1zcmNPYmoub2Zmc2V0TGVmdDsgDQoJd2hpbGUoKHNyY09iaiA9IHNyY09iai5vZmZzZXRQYXJlbnQpKXsgDQoJCWlmKHNyY09iai5pZD09Il8kbWFpbkNvbnRlbnQiKXsNCgkJCWJyZWFrOw0KCQl9DQoJCXQrPXNyY09iai5vZmZzZXRUb3A7IGwrPXNyY09iai5vZmZzZXRMZWZ0OyANCgl9DQoJcmV0dXJuIHsidG9wIjp0LCJsZWZ0IjpsfTsNCn0NCg0KdGFiSGFuZGxlID0gew0KCQkNCglyZXNpemVUYWIgOiBmdW5jdGlvbigpDQoJew0KCQl2YXIgXyRtYWluQ29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfJG1haW5Db250ZW50Jyk7DQoJCWlmIChfJG1haW5Db250ZW50ICYmIF8kbWFpbkNvbnRlbnQub2Zmc2V0SGVpZ2h0IDwgMTUwKQ0KCQl7DQoJCQlfJG1haW5Db250ZW50LnN0eWxlLmhlaWdodCA9ICcyNjBweCc7DQoJCX0NCgkJaWYgKF8kbWFpbkNvbnRlbnQpDQoJCXsNCgkJCV8kbWFpbkNvbnRlbnQub25yZXNpemUgPSBmdW5jdGlvbigpew0KCQkJDQoJCQkJdmFyIF8kbWFpbkNvbnRlbnRfdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ18kbWFpbkNvbnRlbnRfdG9wJyk7DQoJCQkJdmFyIF8kbWFpbkNvbnRlbnRfYm90dG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ18kbWFpbkNvbnRlbnRfYm90dG9tJyk7DQoJCQkJXyRtYWluQ29udGVudF90b3Auc3R5bGUud2lkdGggPSB0aGlzLm9mZnNldFdpZHRoICsgJ3B4JzsNCgkJCQlfJG1haW5Db250ZW50X2JvdHRvbS5zdHlsZS53aWR0aCA9IHRoaXMub2Zmc2V0V2lkdGggKyAncHgnOw0KCQkJCQ0KCQkJfQ0KCQl9DQoJfSwNCgkJDQoJc2V0VGFiSGVpZ2h0OiBmdW5jdGlvbigpDQoJew0KCQl2YXIgXyRtYWluQ29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfJG1haW5Db250ZW50Jyk7DQoJCWlmIChfJG1haW5Db250ZW50ICYmIF8kbWFpbkNvbnRlbnQub2Zmc2V0SGVpZ2h0IDwgMTUwKQ0KCQl7DQoJCQlfJG1haW5Db250ZW50LnN0eWxlLmhlaWdodCA9ICcyNjBweCc7DQoJCX0NCgl9DQp9DQoNCg0KLy9JRSBidWcuIHdoZW4gZGl2LmlubmVySFRNTD0iIiwgYnV0IGRpdiBoZWlnaHQgbm90IGVxdWFsIDAuDQpmdW5jdGlvbiBzZXRNc2dEaXZIdG1sKG1zZ0RpdklkLCB0ZXh0KQ0Kew0KCXZhciBtc2dEaXZPYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtc2dEaXZJZCk7CQkNCglpZighbXNnRGl2T2JqIHx8IHRleHQgPT0gdW5kZWZpbmVkKQ0KCXsNCgkJcmV0dXJuOw0KCX0NCgltc2dEaXZPYmouaW5uZXJIVE1MID0gdGV4dDsNCg0KCWlmKHRleHQudHJpbSgpID09ICIiKQ0KCXsNCgkJaWYobXNnRGl2T2JqLnN0eWxlLmRpc3BsYXkgIT0gIm5vbmUiKQ0KCQl7DQoJCQltc2dEaXZPYmouc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCgkJfQ0KCX0gZWxzZSANCgl7DQoJCWlmKG1zZ0Rpdk9iai5zdHlsZS5kaXNwbGF5ID09ICJub25lIikNCgkJew0KCQkJbXNnRGl2T2JqLnN0eWxlLmRpc3BsYXkgPSAiIjsNCgkJfQ0KCX0NCn0NCmZ1bmN0aW9uIGdldEFHSVNXaW5kb3dsZXNzKCkNCnsNCglyZXR1cm4gdHJ1ZTsNCn0NCmZ1bmN0aW9uIHNldEJvZHlDb2xvcihzdHlsZUZsYWcsY29sb3IpDQp7DQoJaWYoIXN0eWxlRmxhZykNCgl7DQoJCWRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yOw0KCX0NCn0NCg0KDQovKipzZW5kIEh0dHBSZXF1ZXN0LCB0aGlzIG1ldGhvZCBtb3ZlIGZyb20gYWMzNjAqLw0KZnVuY3Rpb24gc2VuZEh0dHBSZXF1ZXN0KHVybCwgcGFyYW0sIHN5bmMsIGNhbGxGbikNCnsNCgl2YXIgcmV0dXJuRGF0YSA9ICIiOw0KCWlmIChBYzM2MC52YWxpZGF0b3IuaXNFbXB0eShjYWxsRm4pKQ0KCXsNCgkJY2FsbEZuID0gZnVuY3Rpb24gY2FsbEJhY2socmV0dXJuVHh0KQ0KCQl7DQoJCQlyZXR1cm5EYXRhID0gcmV0dXJuVHh0Ow0KCQl9OyANCgl9DQoJDQoJaWYgKCFBYzM2MCkNCgkJcmV0dXJuOw0KCQ0KCXZhciBhamF4ID0gbmV3IEFjMzYwLmFqYXgoKTsNCiAgICBhamF4LnNlbmQodXJsLCBwYXJhbSwgY2FsbEZuLCBzeW5jKTsNCiAgICByZXR1cm4gcmV0dXJuRGF0YTsNCn0NCg0KLyoqc2VuZCBIdHRwUmVxdWVzdCwgdGhpcyBtZXRob2QgbW92ZSBmcm9tIGFjMzYwKi8NCg0KLyoqDQogKiBHZXQgbWF4aW11bSBkaXNwbGF5IHdpZHRoIG9mIHNwZWNpZmllZCBsYWJlbHMuDQogKiANCiAqIGxhYmVsVGV4dEFycmF5IHtTdHJpbmdbXX0gYW4gYXJyYXkgb2YgbGFiZWwgdGV4dC4NCiAqIHBhcmVudEVsZSB7SHRtbCBFbGVtZW50fSBIdG1sIGVsZW1lbnQgd2hpY2ggdGhlIGxhYmVscyBkaXNwbGF5IGluLg0KICogDQogKiByZXR1cm4ge0ludGVnZXIpIG1heCB3aWR0aA0KICovDQpmdW5jdGlvbiBnZXRNYXhEaXNwbGF5V2lkdGgobGFiZWxUZXh0QXJyYXksIHBhcmVudEVsZSkNCnsNCglpZighbGFiZWxUZXh0QXJyYXkpCXsNCgkJcmV0dXJuIDA7DQoJfQ0KCWlmKGxhYmVsVGV4dEFycmF5LmNvbnN0cnVjdG9yICE9IEFycmF5KSB7DQoJCWFyclRleHQgPSBbbGFiZWxUZXh0QXJyYXldOw0KCX0gZWxzZSB7DQoJCWFyclRleHQgPSBsYWJlbFRleHRBcnJheTsNCgl9DQoNCgl2YXIgb2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLA0KCQltYXhXaWR0aCA9IDAsIHdpZHRoOw0KCQlvZGl2LnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsNCgkJb2Rpdi5zdHlsZS5sZWZ0ID0gIi0xMDAwcHgiOw0KCQlvZGl2LnN0eWxlLm1hcmdpbiA9ICIwcHgiOw0KCQlvZGl2LnN0eWxlLnBhZGRpbmcgPSAiMHB4IjsNCgkJaWYocGFyZW50RWxlKSB7DQoJCQlvZGl2LnN0eWxlLmZvbnRTaXplID0gJChwYXJlbnRFbGUpLmNzcygnZm9udC1zaXplJyk7DQoJCQlvZGl2LnN0eWxlLmZvbnRGYW1pbHkgPSAkKHBhcmVudEVsZSkuY3NzKCdmb250LWZhbWlseScpOw0KCQkJb2Rpdi5zdHlsZS5mb250U3R5bGUgPSAkKHBhcmVudEVsZSkuY3NzKCdmb250LXN0eWxlJyk7DQoJCX0NCgkJZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvZGl2KTsNCg0KCWZvcih2YXIgaSA9IDAsIGxlbiA9IGFyclRleHQubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsNCgkJdmFyIGxhYmVsVGV4dCA9IGFyclRleHRbaV07DQoJCWlmKGxhYmVsVGV4dCkgew0KCQkJb2Rpdi5pbm5lckhUTUwgPSBsYWJlbFRleHQ7DQoJCQl3aWR0aCA9IG9kaXYub2Zmc2V0V2lkdGg7DQoJCX0gZWxzZSB7DQoJCQl3aWR0aCA9IDA7DQoJCX0NCgkJbWF4V2lkdGggPSBNYXRoLm1heCh3aWR0aCwgbWF4V2lkdGgpOw0KCX0NCglkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG9kaXYpOw0KDQoJcmV0dXJuIG1heFdpZHRoOw0KfQ0KDQp2YXIgYWMzNjBiYXNlID0gew0KCQ0KCXN0b3BQcm9wYWdhdGlvbiA6IGZ1bmN0aW9uKGUpDQoJew0KCQlpZihzY3JvbGxCYXJJc3N1ZS5nZXRCcm93c2VyVHlwZSgpID09ICJGaXJlZm94IikNCgkJew0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsgCQ0KCQl9DQoJfSwNCgkNCglnZXRUZXh0V2lkdGggOiBmdW5jdGlvbihlbGUsIHN0cikNCgl7DQoJCWlmKHNjcm9sbEJhcklzc3VlLmp1ZGdlSXNOdWxsKHN0cikpDQoJCXsNCgkJCXJldHVybiAwOw0KCQl9DQoJCXZhciB0ZXh0V2lkdGggPSAwOw0KCQlpZihzY3JvbGxCYXJJc3N1ZS5nZXRCcm93c2VyVHlwZSgpID09ICJJRSIpDQoJCXsNCgkJCXZhciB0ZXh0UmFuZ2UgPSBlbGUuY3JlYXRlVGV4dFJhbmdlKCk7DQoJCQl0ZXh0V2lkdGggPSB0ZXh0UmFuZ2UuYm91bmRpbmdXaWR0aDsNCgkJfQ0KCQllbHNlIA0KCQl7DQoJCQl2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIkRJViIpOyAgDQoJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNwYW4pOyAgDQoJCQlzcGFuLnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsgIA0KCQkJc3Bhbi5zdHlsZS53aGl0ZVNwYWNlID0gIm5vd3JhcCI7ICANCgkJCWlmKHNjcm9sbEJhcklzc3VlLmp1ZGdlSXNPYmooZWxlKSkNCgkJCXsNCgkJCQl2YXIgZWxlU3R5bGUgPSBzY3JvbGxCYXJJc3N1ZS5nZXRDdXJyZW50U3R5bGUoZG9jdW1lbnQsIGVsZSk7DQoJCQkJc3Bhbi5zdHlsZS5mb250U3R5bGUgPSBlbGVTdHlsZS5mb250U3R5bGU7DQoJCQkJc3Bhbi5zdHlsZS5mb250VmFyaWFudCA9IGVsZVN0eWxlLmZvbnRWYXJpYW50Ow0KCQkJCXNwYW4uc3R5bGUuZm9udFdlaWdodCA9IGVsZVN0eWxlLmZvbnRXZWlnaHQ7DQoJCQkJc3Bhbi5zdHlsZS5mb250U2l6ZSA9IGVsZVN0eWxlLmZvbnRTaXplOw0KCQkJCXNwYW4uc3R5bGUubGluZUhlaWdodCA9IGVsZVN0eWxlLmxpbmVIZWlnaHQ7DQoJCQkJc3Bhbi5zdHlsZS5mb250RmFtaWx5ID0gZWxlU3R5bGUuZm9udEZhbWlseTsNCgkJCX0NCgkJCXNwYW4uaW5uZXJUZXh0ID0gc3RyOyAgDQoJCQl0ZXh0V2lkdGggPSBzcGFuLm9mZnNldFdpZHRoOw0KCQkJc2Nyb2xsQmFySXNzdWUucmVtb3ZlTm9kZShzcGFuKTsNCgkJfQ0KCQlyZXR1cm4gdGV4dFdpZHRoOyAgDQoJfSwNCgkNCgkvL1RoaXMgbWV0aG9kIGp1c3QgYmUgdXNlZCB0byBzb2x2ZSBzcGVjaWFsIGNhc2UuIFBsZWFzZSBkb24ndCB1c2UgaXQgdG8gb3RoZXIgcGxhY2VzLg0KCWdldEVsZW1lbnRzIDogZnVuY3Rpb24oc3BlY2lhbE5hbWUsIG5hbWUsIG51bWJlcikNCgl7DQoJCXZhciBlbGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoc3BlY2lhbE5hbWUpOw0KCQlpZihzY3JvbGxCYXJJc3N1ZS5qdWRnZUlzTm90TnVsbChlbGVzKSAmJiBlbGVzLmxlbmd0aCA+IDApDQoJCXsNCgkJCXJldHVybiBlbGVzOw0KCQl9DQoJCWVsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShuYW1lKTsNCgkJaWYoc2Nyb2xsQmFySXNzdWUuanVkZ2VJc05vdE51bGwoZWxlcykgJiYgZWxlcy5sZW5ndGggPiAwKQ0KCQl7DQoJCQl2YXIgcHJvcGVydHlWYWwgPSBzY3JvbGxCYXJJc3N1ZS5nZXRBdHRyaWJ1dGUoZWxlc1tudW1iZXJdLCAicHJvcGVydHkiKTsNCgkJCWlmKHNwZWNpYWxOYW1lID09IHByb3BlcnR5VmFsKQ0KCQkJew0KCQkJCXJldHVybiBuZXcgQXJyYXkoZWxlc1tudW1iZXJdKTsNCgkJCX0NCgkJfQkJDQoJfQ0KfTs=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>