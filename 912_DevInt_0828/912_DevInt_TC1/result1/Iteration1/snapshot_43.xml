<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="43">
  <HTTPTask id="45" hostname="aa-pt6245.dev.accela.com:5443" path="/portlets/spa/bower_components/handlebars/handlebars.js" url="https://aa-pt6245.dev.accela.com:5443/portlets/spa/bower_components/handlebars/handlebars.js" ip="13.93.163.237" port="5443" client_ip="10.1.61.63" client_port="11580" connectionId="1716" origin="Primary" startDateTime="2017-08-28T11:38:04.894-07:00" startTime="4013" endTime="4041" sendTime="19" waitTime="3" receiveTime="5">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Referer" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9zcGEvZGFzaGJvYXJkLmRv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SlNFU1NJT05JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEpTRVNTSU9OSUQ9KioqKioqKioqKioqKioqKioqKioqKioqKioqOyBMQVNURVNUX1JFUVVFU1RfVElNRT0xNTAzOTQ1NDgyNDYyOyBob3N0U2lnbk9uPXRydWU7IGdfY3VycmVudF9sYW5ndWFnZV9leHQ9ZW5fVVM7IExBVEVTVF9XRUJfU0VSVkVSPTEwLjEuMC42OyBMQVRFU1RfU0VTU0lPTl9JRD12WmtsdWRxZ2o4WmpHTTJvb2pPTkVrT0o7IEFDQXV0aD03NzM2MjAxNDkzMTM2NjIyNTcyODg2NTM3NDA1MDg5NjkxODQ2NjMzNjY3Mjk5NTA0OTExNDkxODQyNTA1OTgyNjUyODk1OTAxNjQyMTUyNjM4NjkxNzE2NDgzNTExNzc1MzY1MTQ2NjI3NDczOTk4MzMzMTI2NDU1ODMzODM2MDsgQUNTaWduT25Nb2R1bGU9U1NPU3RhbmRhcmQ7IEFBUGVyc2lzdExvZ2luU2VydlByb3ZDb2RlPUZMQUdTVEFGRjsgTG9naW5TZXJ2UHJvdkNvZGU0TXVsdGlBZ2VuY3k9RkxBR1NUQUZGOyBMb2dpblVzZXJuYW1lNE11bHRpQWdlbmN5PTE3OUREMTNBMTg2MDI4RjQ7IEFDU2lnbm9mZj0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9zZWN1cml0eS9zaWdub3V0LmRvIjsgQUNTd2l0Y2hBZ2VuY3k9Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9wb3J0bGV0cy9zcGEvYm93ZXJfY29tcG9uZW50cy9oYW5kbGViYXJzL2hhbmRsZWJhcnMuanMgSFRUUC8xLjENClJlZmVyZXI6IGh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvc3BhL2Rhc2hib2FyZC5kbw0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tvDQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkFjY2VwdC1MYW5ndWFnZTogZW4tVVMNCkFjY2VwdDogKi8qDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQpIb3N0OiBhYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0Mw0KQ29va2llOiBKU0VTU0lPTklEPXZaa2x1ZHFnajhaakdNMm9vak9ORWtPSjsgSlNFU1NJT05JRD0qKioqKioqKioqKioqKioqKioqKioqKioqKio7IExBU1RFU1RfUkVRVUVTVF9USU1FPTE1MDM5NDU0ODI0NjI7IGhvc3RTaWduT249dHJ1ZTsgZ19jdXJyZW50X2xhbmd1YWdlX2V4dD1lbl9VUzsgTEFURVNUX1dFQl9TRVJWRVI9MTAuMS4wLjY7IExBVEVTVF9TRVNTSU9OX0lEPXZaa2x1ZHFnajhaakdNMm9vak9ORWtPSjsgQUNBdXRoPTc3MzYyMDE0OTMxMzY2MjI1NzI4ODY1Mzc0MDUwODk2OTE4NDY2MzM2NjcyOTk1MDQ5MTE0OTE4NDI1MDU5ODI2NTI4OTU5MDE2NDIxNTI2Mzg2OTE3MTY0ODM1MTE3NzUzNjUxNDY2Mjc0NzM5OTgzMzMxMjY0NTU4MzM4MzYwOyBBQ1NpZ25Pbk1vZHVsZT1TU09TdGFuZGFyZDsgQUFQZXJzaXN0TG9naW5TZXJ2UHJvdkNvZGU9RkxBR1NUQUZGOyBMb2dpblNlcnZQcm92Q29kZTRNdWx0aUFnZW5jeT1GTEFHU1RBRkY7IExvZ2luVXNlcm5hbWU0TXVsdGlBZ2VuY3k9MTc5REQxM0ExODYwMjhGNDsgQUNTaWdub2ZmPSJodHRwczovL2FhLXB0NjI0NS5kZXYuYWNjZWxhLmNvbTo1NDQzL3BvcnRsZXRzL3NlY3VyaXR5L3NpZ25vdXQuZG8iOyBBQ1N3aXRjaEFnZW5jeT0iaHR0cHM6Ly9hYS1wdDYyNDUuZGV2LmFjY2VsYS5jb206NTQ0My9wb3J0bGV0cy9jb21tb25zL3Nzby9ibGFuay5qc3AiDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="JSESSIONID" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dlprbHVkcWdqOFpqR00yb29qT05Fa09K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="JSESSIONID" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>KioqKioqKioqKioqKioqKioqKioqKioqKioq</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LASTEST_REQUEST_TIME" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTUwMzk0NTQ4MjQ2Mg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="hostSignOn" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dHJ1ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="g_current_language_ext" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW5fVVM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_WEB_SERVER" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTAuMS4wLjY=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LATEST_SESSION_ID" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dlprbHVkcWdqOFpqR00yb29qT05Fa09K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACAuth" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzczNjIwMTQ5MzEzNjYyMjU3Mjg4NjUzNzQwNTA4OTY5MTg0NjYzMzY2NzI5OTUwNDkxMTQ5MTg0MjUwNTk4MjY1Mjg5NTkwMTY0MjE1MjYzODY5MTcxNjQ4MzUxMTc3NTM2NTE0NjYyNzQ3Mzk5ODMzMzEyNjQ1NTgzMzgzNjA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignOnModule" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>U1NPU3RhbmRhcmQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="AAPersistLoginServProvCode" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginServProvCode4MultiAgency" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RkxBR1NUQUZG</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="LoginUsername4MultiAgency" index="11">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTc5REQxM0ExODYwMjhGNA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSignoff" index="12">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvc2VjdXJpdHkvc2lnbm91dC5kbyI=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ACSwitchAgency" index="13">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Imh0dHBzOi8vYWEtcHQ2MjQ1LmRldi5hY2NlbGEuY29tOjU0NDMvcG9ydGxldHMvY29tbW9ucy9zc28vYmxhbmsuanNwIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QXBhY2hlLUNveW90ZS8xLjE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-XSS-Protection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFTVEVTVF9SRVFVRVNUX1RJTUU9MTUwMzk0NTQ4MjQ3ODsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFURVNUX1dFQl9TRVJWRVI9MTAuMS4wLjY7IERvbWFpbj1kZXYuYWNjZWxhLmNvbTsgUGF0aD0vOyBTZWN1cmU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Set-Cookie" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TEFURVNUX1NFU1NJT05fSUQ9dlprbHVkcWdqOFpqR00yb29qT05Fa09KOyBEb21haW49ZGV2LmFjY2VsYS5jb207IFBhdGg9LzsgU2VjdXJl</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Vy8iMTcxNjUyLTE1MDE2MTc0ODAwMDAi</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAwMSBBdWcgMjAxNyAxOTo1ODowMCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9qYXZhc2NyaXB0</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Transfer-Encoding" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2h1bmtlZA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOCBBdWcgMjAxNyAxODozODowMSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IEFwYWNoZS1Db3lvdGUvMS4xDQpYLVhTUy1Qcm90ZWN0aW9uOiAwDQpTZXQtQ29va2llOiBMQVNURVNUX1JFUVVFU1RfVElNRT0xNTAzOTQ1NDgyNDc4OyBEb21haW49ZGV2LmFjY2VsYS5jb207IFBhdGg9LzsgU2VjdXJlDQpTZXQtQ29va2llOiBMQVRFU1RfV0VCX1NFUlZFUj0xMC4xLjAuNjsgRG9tYWluPWRldi5hY2NlbGEuY29tOyBQYXRoPS87IFNlY3VyZQ0KU2V0LUNvb2tpZTogTEFURVNUX1NFU1NJT05fSUQ9dlprbHVkcWdqOFpqR00yb29qT05Fa09KOyBEb21haW49ZGV2LmFjY2VsYS5jb207IFBhdGg9LzsgU2VjdXJlDQpBY2NlcHQtUmFuZ2VzOiBieXRlcw0KRVRhZzogVy8iMTcxNjUyLTE1MDE2MTc0ODAwMDAiDQpMYXN0LU1vZGlmaWVkOiBUdWUsIDAxIEF1ZyAyMDE3IDE5OjU4OjAwIEdNVA0KQ29udGVudC1UeXBlOiB0ZXh0L2phdmFzY3JpcHQNClRyYW5zZmVyLUVuY29kaW5nOiBjaHVua2VkDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkRhdGU6IE1vbiwgMjggQXVnIDIwMTcgMTg6Mzg6MDEgR01UDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyoqIQ0KDQogQGxpY2Vuc2UNCiBoYW5kbGViYXJzIHY0LjAuMTANCg0KQ29weXJpZ2h0IChDKSAyMDExLTIwMTYgYnkgWWVodWRhIEthdHoNCg0KUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQ0Kb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwNCmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMNCnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwNCmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcw0KZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoNCg0KVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4NCmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLg0KDQpUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUg0KSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksDQpGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUNCkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVINCkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sDQpPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElODQpUSEUgU09GVFdBUkUuDQoNCiovDQooZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkgew0KCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykNCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7DQoJZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpDQoJCWRlZmluZShbXSwgZmFjdG9yeSk7DQoJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpDQoJCWV4cG9ydHNbIkhhbmRsZWJhcnMiXSA9IGZhY3RvcnkoKTsNCgllbHNlDQoJCXJvb3RbIkhhbmRsZWJhcnMiXSA9IGZhY3RvcnkoKTsNCn0pKHRoaXMsIGZ1bmN0aW9uKCkgew0KcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXANCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlDQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsNCg0KLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uDQovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgew0KDQovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQ0KLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkNCi8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOw0KDQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpDQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsNCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9LA0KLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLA0KLyoqKioqKi8gCQkJbG9hZGVkOiBmYWxzZQ0KLyoqKioqKi8gCQl9Ow0KDQovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbg0KLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsNCg0KLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkDQovKioqKioqLyAJCW1vZHVsZS5sb2FkZWQgPSB0cnVlOw0KDQovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlDQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsNCi8qKioqKiovIAl9DQoNCg0KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pDQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsNCg0KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlDQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsNCg0KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fDQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7DQoNCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMNCi8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsNCi8qKioqKiovIH0pDQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KLyoqKioqKi8gKFsNCi8qIDAgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfaGFuZGxlYmFyc1J1bnRpbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOw0KDQoJdmFyIF9oYW5kbGViYXJzUnVudGltZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzUnVudGltZSk7DQoNCgkvLyBDb21waWxlciBpbXBvcnRzDQoNCgl2YXIgX2hhbmRsZWJhcnNDb21waWxlckFzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOw0KDQoJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJBc3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc0NvbXBpbGVyQXN0KTsNCg0KCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyQmFzZSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOw0KDQoJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJDb21waWxlciA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpOw0KDQoJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJKYXZhc2NyaXB0Q29tcGlsZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKTsNCg0KCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVySmF2YXNjcmlwdENvbXBpbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNDb21waWxlckphdmFzY3JpcHRDb21waWxlcik7DQoNCgl2YXIgX2hhbmRsZWJhcnNDb21waWxlclZpc2l0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsNCg0KCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyVmlzaXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzQ29tcGlsZXJWaXNpdG9yKTsNCg0KCXZhciBfaGFuZGxlYmFyc05vQ29uZmxpY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsNCg0KCXZhciBfaGFuZGxlYmFyc05vQ29uZmxpY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc05vQ29uZmxpY3QpOw0KDQoJdmFyIF9jcmVhdGUgPSBfaGFuZGxlYmFyc1J1bnRpbWUyWydkZWZhdWx0J10uY3JlYXRlOw0KCWZ1bmN0aW9uIGNyZWF0ZSgpIHsNCgkgIHZhciBoYiA9IF9jcmVhdGUoKTsNCg0KCSAgaGIuY29tcGlsZSA9IGZ1bmN0aW9uIChpbnB1dCwgb3B0aW9ucykgew0KCSAgICByZXR1cm4gX2hhbmRsZWJhcnNDb21waWxlckNvbXBpbGVyLmNvbXBpbGUoaW5wdXQsIG9wdGlvbnMsIGhiKTsNCgkgIH07DQoJICBoYi5wcmVjb21waWxlID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zKSB7DQoJICAgIHJldHVybiBfaGFuZGxlYmFyc0NvbXBpbGVyQ29tcGlsZXIucHJlY29tcGlsZShpbnB1dCwgb3B0aW9ucywgaGIpOw0KCSAgfTsNCg0KCSAgaGIuQVNUID0gX2hhbmRsZWJhcnNDb21waWxlckFzdDJbJ2RlZmF1bHQnXTsNCgkgIGhiLkNvbXBpbGVyID0gX2hhbmRsZWJhcnNDb21waWxlckNvbXBpbGVyLkNvbXBpbGVyOw0KCSAgaGIuSmF2YVNjcmlwdENvbXBpbGVyID0gX2hhbmRsZWJhcnNDb21waWxlckphdmFzY3JpcHRDb21waWxlcjJbJ2RlZmF1bHQnXTsNCgkgIGhiLlBhcnNlciA9IF9oYW5kbGViYXJzQ29tcGlsZXJCYXNlLnBhcnNlcjsNCgkgIGhiLnBhcnNlID0gX2hhbmRsZWJhcnNDb21waWxlckJhc2UucGFyc2U7DQoNCgkgIHJldHVybiBoYjsNCgl9DQoNCgl2YXIgaW5zdCA9IGNyZWF0ZSgpOw0KCWluc3QuY3JlYXRlID0gY3JlYXRlOw0KDQoJX2hhbmRsZWJhcnNOb0NvbmZsaWN0MlsnZGVmYXVsdCddKGluc3QpOw0KDQoJaW5zdC5WaXNpdG9yID0gX2hhbmRsZWJhcnNDb21waWxlclZpc2l0b3IyWydkZWZhdWx0J107DQoNCglpbnN0WydkZWZhdWx0J10gPSBpbnN0Ow0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gaW5zdDsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiAxICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgkidXNlIHN0cmljdCI7DQoNCglleHBvcnRzWyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAob2JqKSB7DQoJICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogew0KCSAgICAiZGVmYXVsdCI6IG9iag0KCSAgfTsNCgl9Ow0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KLyoqKi8gfSksDQovKiAyICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpWydkZWZhdWx0J107DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoNCgl2YXIgX2hhbmRsZWJhcnNCYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsNCg0KCXZhciBiYXNlID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2hhbmRsZWJhcnNCYXNlKTsNCg0KCS8vIEVhY2ggb2YgdGhlc2UgYXVnbWVudCB0aGUgSGFuZGxlYmFycyBvYmplY3QuIE5vIG5lZWQgdG8gc2V0dXAgaGVyZS4NCgkvLyAoVGhpcyBpcyBkb25lIHRvIGVhc2lseSBzaGFyZSBjb2RlIGJldHdlZW4gY29tbW9uanMgYW5kIGJyb3dzZSBlbnZzKQ0KDQoJdmFyIF9oYW5kbGViYXJzU2FmZVN0cmluZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpOw0KDQoJdmFyIF9oYW5kbGViYXJzU2FmZVN0cmluZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzU2FmZVN0cmluZyk7DQoNCgl2YXIgX2hhbmRsZWJhcnNFeGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOw0KDQoJdmFyIF9oYW5kbGViYXJzRXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNFeGNlcHRpb24pOw0KDQoJdmFyIF9oYW5kbGViYXJzVXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJdmFyIFV0aWxzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2hhbmRsZWJhcnNVdGlscyk7DQoNCgl2YXIgX2hhbmRsZWJhcnNSdW50aW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7DQoNCgl2YXIgcnVudGltZSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9oYW5kbGViYXJzUnVudGltZSk7DQoNCgl2YXIgX2hhbmRsZWJhcnNOb0NvbmZsaWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7DQoNCgl2YXIgX2hhbmRsZWJhcnNOb0NvbmZsaWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNOb0NvbmZsaWN0KTsNCg0KCS8vIEZvciBjb21wYXRpYmlsaXR5IGFuZCB1c2FnZSBvdXRzaWRlIG9mIG1vZHVsZSBzeXN0ZW1zLCBtYWtlIHRoZSBIYW5kbGViYXJzIG9iamVjdCBhIG5hbWVzcGFjZQ0KCWZ1bmN0aW9uIGNyZWF0ZSgpIHsNCgkgIHZhciBoYiA9IG5ldyBiYXNlLkhhbmRsZWJhcnNFbnZpcm9ubWVudCgpOw0KDQoJICBVdGlscy5leHRlbmQoaGIsIGJhc2UpOw0KCSAgaGIuU2FmZVN0cmluZyA9IF9oYW5kbGViYXJzU2FmZVN0cmluZzJbJ2RlZmF1bHQnXTsNCgkgIGhiLkV4Y2VwdGlvbiA9IF9oYW5kbGViYXJzRXhjZXB0aW9uMlsnZGVmYXVsdCddOw0KCSAgaGIuVXRpbHMgPSBVdGlsczsNCgkgIGhiLmVzY2FwZUV4cHJlc3Npb24gPSBVdGlscy5lc2NhcGVFeHByZXNzaW9uOw0KDQoJICBoYi5WTSA9IHJ1bnRpbWU7DQoJICBoYi50ZW1wbGF0ZSA9IGZ1bmN0aW9uIChzcGVjKSB7DQoJICAgIHJldHVybiBydW50aW1lLnRlbXBsYXRlKHNwZWMsIGhiKTsNCgkgIH07DQoNCgkgIHJldHVybiBoYjsNCgl9DQoNCgl2YXIgaW5zdCA9IGNyZWF0ZSgpOw0KCWluc3QuY3JlYXRlID0gY3JlYXRlOw0KDQoJX2hhbmRsZWJhcnNOb0NvbmZsaWN0MlsnZGVmYXVsdCddKGluc3QpOw0KDQoJaW5zdFsnZGVmYXVsdCddID0gaW5zdDsNCg0KCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGluc3Q7DQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107DQoNCi8qKiovIH0pLA0KLyogMyAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgew0KDQoJInVzZSBzdHJpY3QiOw0KDQoJZXhwb3J0c1siZGVmYXVsdCJdID0gZnVuY3Rpb24gKG9iaikgew0KCSAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgew0KCSAgICByZXR1cm4gb2JqOw0KCSAgfSBlbHNlIHsNCgkgICAgdmFyIG5ld09iaiA9IHt9Ow0KDQoJICAgIGlmIChvYmogIT0gbnVsbCkgew0KCSAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsNCgkgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIG5ld09ialsiZGVmYXVsdCJdID0gb2JqOw0KCSAgICByZXR1cm4gbmV3T2JqOw0KCSAgfQ0KCX07DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQovKioqLyB9KSwNCi8qIDQgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCglleHBvcnRzLkhhbmRsZWJhcnNFbnZpcm9ubWVudCA9IEhhbmRsZWJhcnNFbnZpcm9ubWVudDsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOw0KDQoJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsNCg0KCXZhciBfaGVscGVycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOw0KDQoJdmFyIF9kZWNvcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7DQoNCgl2YXIgX2xvZ2dlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOw0KDQoJdmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTsNCg0KCXZhciBWRVJTSU9OID0gJzQuMC4xMCc7DQoJZXhwb3J0cy5WRVJTSU9OID0gVkVSU0lPTjsNCgl2YXIgQ09NUElMRVJfUkVWSVNJT04gPSA3Ow0KDQoJZXhwb3J0cy5DT01QSUxFUl9SRVZJU0lPTiA9IENPTVBJTEVSX1JFVklTSU9OOw0KCXZhciBSRVZJU0lPTl9DSEFOR0VTID0gew0KCSAgMTogJzw9IDEuMC5yYy4yJywgLy8gMS4wLnJjLjIgaXMgYWN0dWFsbHkgcmV2MiBidXQgZG9lc24ndCByZXBvcnQgaXQNCgkgIDI6ICc9PSAxLjAuMC1yYy4zJywNCgkgIDM6ICc9PSAxLjAuMC1yYy40JywNCgkgIDQ6ICc9PSAxLngueCcsDQoJICA1OiAnPT0gMi4wLjAtYWxwaGEueCcsDQoJICA2OiAnPj0gMi4wLjAtYmV0YS4xJywNCgkgIDc6ICc+PSA0LjAuMCcNCgl9Ow0KDQoJZXhwb3J0cy5SRVZJU0lPTl9DSEFOR0VTID0gUkVWSVNJT05fQ0hBTkdFUzsNCgl2YXIgb2JqZWN0VHlwZSA9ICdbb2JqZWN0IE9iamVjdF0nOw0KDQoJZnVuY3Rpb24gSGFuZGxlYmFyc0Vudmlyb25tZW50KGhlbHBlcnMsIHBhcnRpYWxzLCBkZWNvcmF0b3JzKSB7DQoJICB0aGlzLmhlbHBlcnMgPSBoZWxwZXJzIHx8IHt9Ow0KCSAgdGhpcy5wYXJ0aWFscyA9IHBhcnRpYWxzIHx8IHt9Ow0KCSAgdGhpcy5kZWNvcmF0b3JzID0gZGVjb3JhdG9ycyB8fCB7fTsNCg0KCSAgX2hlbHBlcnMucmVnaXN0ZXJEZWZhdWx0SGVscGVycyh0aGlzKTsNCgkgIF9kZWNvcmF0b3JzLnJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnModGhpcyk7DQoJfQ0KDQoJSGFuZGxlYmFyc0Vudmlyb25tZW50LnByb3RvdHlwZSA9IHsNCgkgIGNvbnN0cnVjdG9yOiBIYW5kbGViYXJzRW52aXJvbm1lbnQsDQoNCgkgIGxvZ2dlcjogX2xvZ2dlcjJbJ2RlZmF1bHQnXSwNCgkgIGxvZzogX2xvZ2dlcjJbJ2RlZmF1bHQnXS5sb2csDQoNCgkgIHJlZ2lzdGVySGVscGVyOiBmdW5jdGlvbiByZWdpc3RlckhlbHBlcihuYW1lLCBmbikgew0KCSAgICBpZiAoX3V0aWxzLnRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHsNCgkgICAgICBpZiAoZm4pIHsNCgkgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGhlbHBlcnMnKTsNCgkgICAgICB9DQoJICAgICAgX3V0aWxzLmV4dGVuZCh0aGlzLmhlbHBlcnMsIG5hbWUpOw0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHRoaXMuaGVscGVyc1tuYW1lXSA9IGZuOw0KCSAgICB9DQoJICB9LA0KCSAgdW5yZWdpc3RlckhlbHBlcjogZnVuY3Rpb24gdW5yZWdpc3RlckhlbHBlcihuYW1lKSB7DQoJICAgIGRlbGV0ZSB0aGlzLmhlbHBlcnNbbmFtZV07DQoJICB9LA0KDQoJICByZWdpc3RlclBhcnRpYWw6IGZ1bmN0aW9uIHJlZ2lzdGVyUGFydGlhbChuYW1lLCBwYXJ0aWFsKSB7DQoJICAgIGlmIChfdXRpbHMudG9TdHJpbmcuY2FsbChuYW1lKSA9PT0gb2JqZWN0VHlwZSkgew0KCSAgICAgIF91dGlscy5leHRlbmQodGhpcy5wYXJ0aWFscywgbmFtZSk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgaWYgKHR5cGVvZiBwYXJ0aWFsID09PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0F0dGVtcHRpbmcgdG8gcmVnaXN0ZXIgYSBwYXJ0aWFsIGNhbGxlZCAiJyArIG5hbWUgKyAnIiBhcyB1bmRlZmluZWQnKTsNCgkgICAgICB9DQoJICAgICAgdGhpcy5wYXJ0aWFsc1tuYW1lXSA9IHBhcnRpYWw7DQoJICAgIH0NCgkgIH0sDQoJICB1bnJlZ2lzdGVyUGFydGlhbDogZnVuY3Rpb24gdW5yZWdpc3RlclBhcnRpYWwobmFtZSkgew0KCSAgICBkZWxldGUgdGhpcy5wYXJ0aWFsc1tuYW1lXTsNCgkgIH0sDQoNCgkgIHJlZ2lzdGVyRGVjb3JhdG9yOiBmdW5jdGlvbiByZWdpc3RlckRlY29yYXRvcihuYW1lLCBmbikgew0KCSAgICBpZiAoX3V0aWxzLnRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHsNCgkgICAgICBpZiAoZm4pIHsNCgkgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGRlY29yYXRvcnMnKTsNCgkgICAgICB9DQoJICAgICAgX3V0aWxzLmV4dGVuZCh0aGlzLmRlY29yYXRvcnMsIG5hbWUpOw0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHRoaXMuZGVjb3JhdG9yc1tuYW1lXSA9IGZuOw0KCSAgICB9DQoJICB9LA0KCSAgdW5yZWdpc3RlckRlY29yYXRvcjogZnVuY3Rpb24gdW5yZWdpc3RlckRlY29yYXRvcihuYW1lKSB7DQoJICAgIGRlbGV0ZSB0aGlzLmRlY29yYXRvcnNbbmFtZV07DQoJICB9DQoJfTsNCg0KCXZhciBsb2cgPSBfbG9nZ2VyMlsnZGVmYXVsdCddLmxvZzsNCg0KCWV4cG9ydHMubG9nID0gbG9nOw0KCWV4cG9ydHMuY3JlYXRlRnJhbWUgPSBfdXRpbHMuY3JlYXRlRnJhbWU7DQoJZXhwb3J0cy5sb2dnZXIgPSBfbG9nZ2VyMlsnZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDUgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoJZXhwb3J0cy5leHRlbmQgPSBleHRlbmQ7DQoJZXhwb3J0cy5pbmRleE9mID0gaW5kZXhPZjsNCglleHBvcnRzLmVzY2FwZUV4cHJlc3Npb24gPSBlc2NhcGVFeHByZXNzaW9uOw0KCWV4cG9ydHMuaXNFbXB0eSA9IGlzRW1wdHk7DQoJZXhwb3J0cy5jcmVhdGVGcmFtZSA9IGNyZWF0ZUZyYW1lOw0KCWV4cG9ydHMuYmxvY2tQYXJhbXMgPSBibG9ja1BhcmFtczsNCglleHBvcnRzLmFwcGVuZENvbnRleHRQYXRoID0gYXBwZW5kQ29udGV4dFBhdGg7DQoJdmFyIGVzY2FwZSA9IHsNCgkgICcmJzogJyZhbXA7JywNCgkgICc8JzogJyZsdDsnLA0KCSAgJz4nOiAnJmd0OycsDQoJICAnIic6ICcmcXVvdDsnLA0KCSAgIiciOiAnJiN4Mjc7JywNCgkgICdgJzogJyYjeDYwOycsDQoJICAnPSc6ICcmI3gzRDsnDQoJfTsNCg0KCXZhciBiYWRDaGFycyA9IC9bJjw+IidgPV0vZywNCgkgICAgcG9zc2libGUgPSAvWyY8PiInYD1dLzsNCg0KCWZ1bmN0aW9uIGVzY2FwZUNoYXIoY2hyKSB7DQoJICByZXR1cm4gZXNjYXBlW2Nocl07DQoJfQ0KDQoJZnVuY3Rpb24gZXh0ZW5kKG9iaiAvKiAsIC4uLnNvdXJjZSAqLykgew0KCSAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsNCgkgICAgZm9yICh2YXIga2V5IGluIGFyZ3VtZW50c1tpXSkgew0KCSAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYXJndW1lbnRzW2ldLCBrZXkpKSB7DQoJICAgICAgICBvYmpba2V5XSA9IGFyZ3VtZW50c1tpXVtrZXldOw0KCSAgICAgIH0NCgkgICAgfQ0KCSAgfQ0KDQoJICByZXR1cm4gb2JqOw0KCX0NCg0KCXZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7DQoNCglleHBvcnRzLnRvU3RyaW5nID0gdG9TdHJpbmc7DQoJLy8gU291cmNlZCBmcm9tIGxvZGFzaA0KCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXN0aWVqcy9sb2Rhc2gvYmxvYi9tYXN0ZXIvTElDRU5TRS50eHQNCgkvKiBlc2xpbnQtZGlzYWJsZSBmdW5jLXN0eWxlICovDQoJdmFyIGlzRnVuY3Rpb24gPSBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7DQoJICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nOw0KCX07DQoJLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpDQoJLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8NCglpZiAoaXNGdW5jdGlvbigveC8pKSB7DQoJICBleHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gKHZhbHVlKSB7DQoJICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgJiYgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7DQoJICB9Ow0KCX0NCglleHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uOw0KDQoJLyogZXNsaW50LWVuYWJsZSBmdW5jLXN0eWxlICovDQoNCgkvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLw0KCXZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAodmFsdWUpIHsNCgkgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnID8gdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IEFycmF5XScgOiBmYWxzZTsNCgl9Ow0KDQoJZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTsNCgkvLyBPbGRlciBJRSB2ZXJzaW9ucyBkbyBub3QgZGlyZWN0bHkgc3VwcG9ydCBpbmRleE9mIHNvIHdlIG11c3QgaW1wbGVtZW50IG91ciBvd24sIHNhZGx5Lg0KDQoJZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgdmFsdWUpIHsNCgkgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykgew0KCSAgICBpZiAoYXJyYXlbaV0gPT09IHZhbHVlKSB7DQoJICAgICAgcmV0dXJuIGk7DQoJICAgIH0NCgkgIH0NCgkgIHJldHVybiAtMTsNCgl9DQoNCglmdW5jdGlvbiBlc2NhcGVFeHByZXNzaW9uKHN0cmluZykgew0KCSAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7DQoJICAgIC8vIGRvbid0IGVzY2FwZSBTYWZlU3RyaW5ncywgc2luY2UgdGhleSdyZSBhbHJlYWR5IHNhZmUNCgkgICAgaWYgKHN0cmluZyAmJiBzdHJpbmcudG9IVE1MKSB7DQoJICAgICAgcmV0dXJuIHN0cmluZy50b0hUTUwoKTsNCgkgICAgfSBlbHNlIGlmIChzdHJpbmcgPT0gbnVsbCkgew0KCSAgICAgIHJldHVybiAnJzsNCgkgICAgfSBlbHNlIGlmICghc3RyaW5nKSB7DQoJICAgICAgcmV0dXJuIHN0cmluZyArICcnOw0KCSAgICB9DQoNCgkgICAgLy8gRm9yY2UgYSBzdHJpbmcgY29udmVyc2lvbiBhcyB0aGlzIHdpbGwgYmUgZG9uZSBieSB0aGUgYXBwZW5kIHJlZ2FyZGxlc3MgYW5kDQoJICAgIC8vIHRoZSByZWdleCB0ZXN0IHdpbGwgZG8gdGhpcyB0cmFuc3BhcmVudGx5IGJlaGluZCB0aGUgc2NlbmVzLCBjYXVzaW5nIGlzc3VlcyBpZg0KCSAgICAvLyBhbiBvYmplY3QncyB0byBzdHJpbmcgaGFzIGVzY2FwZWQgY2hhcmFjdGVycyBpbiBpdC4NCgkgICAgc3RyaW5nID0gJycgKyBzdHJpbmc7DQoJICB9DQoNCgkgIGlmICghcG9zc2libGUudGVzdChzdHJpbmcpKSB7DQoJICAgIHJldHVybiBzdHJpbmc7DQoJICB9DQoJICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoYmFkQ2hhcnMsIGVzY2FwZUNoYXIpOw0KCX0NCg0KCWZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHsNCgkgIGlmICghdmFsdWUgJiYgdmFsdWUgIT09IDApIHsNCgkgICAgcmV0dXJuIHRydWU7DQoJICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkgew0KCSAgICByZXR1cm4gdHJ1ZTsNCgkgIH0gZWxzZSB7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgIH0NCgl9DQoNCglmdW5jdGlvbiBjcmVhdGVGcmFtZShvYmplY3QpIHsNCgkgIHZhciBmcmFtZSA9IGV4dGVuZCh7fSwgb2JqZWN0KTsNCgkgIGZyYW1lLl9wYXJlbnQgPSBvYmplY3Q7DQoJICByZXR1cm4gZnJhbWU7DQoJfQ0KDQoJZnVuY3Rpb24gYmxvY2tQYXJhbXMocGFyYW1zLCBpZHMpIHsNCgkgIHBhcmFtcy5wYXRoID0gaWRzOw0KCSAgcmV0dXJuIHBhcmFtczsNCgl9DQoNCglmdW5jdGlvbiBhcHBlbmRDb250ZXh0UGF0aChjb250ZXh0UGF0aCwgaWQpIHsNCgkgIHJldHVybiAoY29udGV4dFBhdGggPyBjb250ZXh0UGF0aCArICcuJyA6ICcnKSArIGlkOw0KCX0NCg0KLyoqKi8gfSksDQovKiA2ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX09iamVjdCRkZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oNylbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoNCgl2YXIgZXJyb3JQcm9wcyA9IFsnZGVzY3JpcHRpb24nLCAnZmlsZU5hbWUnLCAnbGluZU51bWJlcicsICdtZXNzYWdlJywgJ25hbWUnLCAnbnVtYmVyJywgJ3N0YWNrJ107DQoNCglmdW5jdGlvbiBFeGNlcHRpb24obWVzc2FnZSwgbm9kZSkgew0KCSAgdmFyIGxvYyA9IG5vZGUgJiYgbm9kZS5sb2MsDQoJICAgICAgbGluZSA9IHVuZGVmaW5lZCwNCgkgICAgICBjb2x1bW4gPSB1bmRlZmluZWQ7DQoJICBpZiAobG9jKSB7DQoJICAgIGxpbmUgPSBsb2Muc3RhcnQubGluZTsNCgkgICAgY29sdW1uID0gbG9jLnN0YXJ0LmNvbHVtbjsNCg0KCSAgICBtZXNzYWdlICs9ICcgLSAnICsgbGluZSArICc6JyArIGNvbHVtbjsNCgkgIH0NCg0KCSAgdmFyIHRtcCA9IEVycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIG1lc3NhZ2UpOw0KDQoJICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUgaW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRvZXNuJ3Qgd29yay4NCgkgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGVycm9yUHJvcHMubGVuZ3RoOyBpZHgrKykgew0KCSAgICB0aGlzW2Vycm9yUHJvcHNbaWR4XV0gPSB0bXBbZXJyb3JQcm9wc1tpZHhdXTsNCgkgIH0NCg0KCSAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8NCgkgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkgew0KCSAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFeGNlcHRpb24pOw0KCSAgfQ0KDQoJICB0cnkgew0KCSAgICBpZiAobG9jKSB7DQoJICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZTsNCg0KCSAgICAgIC8vIFdvcmsgYXJvdW5kIGlzc3VlIHVuZGVyIHNhZmFyaSB3aGVyZSB3ZSBjYW4ndCBkaXJlY3RseSBzZXQgdGhlIGNvbHVtbiB2YWx1ZQ0KCSAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovDQoJICAgICAgaWYgKF9PYmplY3QkZGVmaW5lUHJvcGVydHkpIHsNCgkgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnY29sdW1uJywgew0KCSAgICAgICAgICB2YWx1ZTogY29sdW1uLA0KCSAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlDQoJICAgICAgICB9KTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgdGhpcy5jb2x1bW4gPSBjb2x1bW47DQoJICAgICAgfQ0KCSAgICB9DQoJICB9IGNhdGNoIChub3ApIHsNCgkgICAgLyogSWdub3JlIGlmIHRoZSBicm93c2VyIGlzIHZlcnkgcGFydGljdWxhciAqLw0KCSAgfQ0KCX0NCg0KCUV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsNCg0KCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IEV4Y2VwdGlvbjsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiA3ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLCBfX2VzTW9kdWxlOiB0cnVlIH07DQoNCi8qKiovIH0pLA0KLyogOCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJdmFyICQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOw0KCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7DQoJICByZXR1cm4gJC5zZXREZXNjKGl0LCBrZXksIGRlc2MpOw0KCX07DQoNCi8qKiovIH0pLA0KLyogOSAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgew0KDQoJdmFyICRPYmplY3QgPSBPYmplY3Q7DQoJbW9kdWxlLmV4cG9ydHMgPSB7DQoJICBjcmVhdGU6ICAgICAkT2JqZWN0LmNyZWF0ZSwNCgkgIGdldFByb3RvOiAgICRPYmplY3QuZ2V0UHJvdG90eXBlT2YsDQoJICBpc0VudW06ICAgICB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSwNCgkgIGdldERlc2M6ICAgICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLA0KCSAgc2V0RGVzYzogICAgJE9iamVjdC5kZWZpbmVQcm9wZXJ0eSwNCgkgIHNldERlc2NzOiAgICRPYmplY3QuZGVmaW5lUHJvcGVydGllcywNCgkgIGdldEtleXM6ICAgICRPYmplY3Qua2V5cywNCgkgIGdldE5hbWVzOiAgICRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcywNCgkgIGdldFN5bWJvbHM6ICRPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzLA0KCSAgZWFjaDogICAgICAgW10uZm9yRWFjaA0KCX07DQoNCi8qKiovIH0pLA0KLyogMTAgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCglleHBvcnRzLnJlZ2lzdGVyRGVmYXVsdEhlbHBlcnMgPSByZWdpc3RlckRlZmF1bHRIZWxwZXJzOw0KDQoJdmFyIF9oZWxwZXJzQmxvY2tIZWxwZXJNaXNzaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7DQoNCgl2YXIgX2hlbHBlcnNCbG9ja0hlbHBlck1pc3NpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0Jsb2NrSGVscGVyTWlzc2luZyk7DQoNCgl2YXIgX2hlbHBlcnNFYWNoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7DQoNCgl2YXIgX2hlbHBlcnNFYWNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNFYWNoKTsNCg0KCXZhciBfaGVscGVyc0hlbHBlck1pc3NpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsNCg0KCXZhciBfaGVscGVyc0hlbHBlck1pc3NpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0hlbHBlck1pc3NpbmcpOw0KDQoJdmFyIF9oZWxwZXJzSWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsNCg0KCXZhciBfaGVscGVyc0lmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNJZik7DQoNCgl2YXIgX2hlbHBlcnNMb2cgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsNCg0KCXZhciBfaGVscGVyc0xvZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzTG9nKTsNCg0KCXZhciBfaGVscGVyc0xvb2t1cCA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOw0KDQoJdmFyIF9oZWxwZXJzTG9va3VwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNMb29rdXApOw0KDQoJdmFyIF9oZWxwZXJzV2l0aCA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpOw0KDQoJdmFyIF9oZWxwZXJzV2l0aDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzV2l0aCk7DQoNCglmdW5jdGlvbiByZWdpc3RlckRlZmF1bHRIZWxwZXJzKGluc3RhbmNlKSB7DQoJICBfaGVscGVyc0Jsb2NrSGVscGVyTWlzc2luZzJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7DQoJICBfaGVscGVyc0VhY2gyWydkZWZhdWx0J10oaW5zdGFuY2UpOw0KCSAgX2hlbHBlcnNIZWxwZXJNaXNzaW5nMlsnZGVmYXVsdCddKGluc3RhbmNlKTsNCgkgIF9oZWxwZXJzSWYyWydkZWZhdWx0J10oaW5zdGFuY2UpOw0KCSAgX2hlbHBlcnNMb2cyWydkZWZhdWx0J10oaW5zdGFuY2UpOw0KCSAgX2hlbHBlcnNMb29rdXAyWydkZWZhdWx0J10oaW5zdGFuY2UpOw0KCSAgX2hlbHBlcnNXaXRoMlsnZGVmYXVsdCddKGluc3RhbmNlKTsNCgl9DQoNCi8qKiovIH0pLA0KLyogMTEgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoNCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsNCg0KCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgew0KCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2Jsb2NrSGVscGVyTWlzc2luZycsIGZ1bmN0aW9uIChjb250ZXh0LCBvcHRpb25zKSB7DQoJICAgIHZhciBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlLA0KCSAgICAgICAgZm4gPSBvcHRpb25zLmZuOw0KDQoJICAgIGlmIChjb250ZXh0ID09PSB0cnVlKSB7DQoJICAgICAgcmV0dXJuIGZuKHRoaXMpOw0KCSAgICB9IGVsc2UgaWYgKGNvbnRleHQgPT09IGZhbHNlIHx8IGNvbnRleHQgPT0gbnVsbCkgew0KCSAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpOw0KCSAgICB9IGVsc2UgaWYgKF91dGlscy5pc0FycmF5KGNvbnRleHQpKSB7DQoJICAgICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkgew0KCSAgICAgICAgaWYgKG9wdGlvbnMuaWRzKSB7DQoJICAgICAgICAgIG9wdGlvbnMuaWRzID0gW29wdGlvbnMubmFtZV07DQoJICAgICAgICB9DQoNCgkgICAgICAgIHJldHVybiBpbnN0YW5jZS5oZWxwZXJzLmVhY2goY29udGV4dCwgb3B0aW9ucyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpOw0KCSAgICAgIH0NCgkgICAgfSBlbHNlIHsNCgkgICAgICBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuaWRzKSB7DQoJICAgICAgICB2YXIgZGF0YSA9IF91dGlscy5jcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpOw0KCSAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IF91dGlscy5hcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMubmFtZSk7DQoJICAgICAgICBvcHRpb25zID0geyBkYXRhOiBkYXRhIH07DQoJICAgICAgfQ0KDQoJICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIG9wdGlvbnMpOw0KCSAgICB9DQoJICB9KTsNCgl9Ow0KDQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107DQoNCi8qKiovIH0pLA0KLyogMTIgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOw0KDQoJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsNCg0KCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgew0KCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2VhY2gnLCBmdW5jdGlvbiAoY29udGV4dCwgb3B0aW9ucykgew0KCSAgICBpZiAoIW9wdGlvbnMpIHsNCgkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnTXVzdCBwYXNzIGl0ZXJhdG9yIHRvICNlYWNoJyk7DQoJICAgIH0NCg0KCSAgICB2YXIgZm4gPSBvcHRpb25zLmZuLA0KCSAgICAgICAgaW52ZXJzZSA9IG9wdGlvbnMuaW52ZXJzZSwNCgkgICAgICAgIGkgPSAwLA0KCSAgICAgICAgcmV0ID0gJycsDQoJICAgICAgICBkYXRhID0gdW5kZWZpbmVkLA0KCSAgICAgICAgY29udGV4dFBhdGggPSB1bmRlZmluZWQ7DQoNCgkgICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykgew0KCSAgICAgIGNvbnRleHRQYXRoID0gX3V0aWxzLmFwcGVuZENvbnRleHRQYXRoKG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCwgb3B0aW9ucy5pZHNbMF0pICsgJy4nOw0KCSAgICB9DQoNCgkgICAgaWYgKF91dGlscy5pc0Z1bmN0aW9uKGNvbnRleHQpKSB7DQoJICAgICAgY29udGV4dCA9IGNvbnRleHQuY2FsbCh0aGlzKTsNCgkgICAgfQ0KDQoJICAgIGlmIChvcHRpb25zLmRhdGEpIHsNCgkgICAgICBkYXRhID0gX3V0aWxzLmNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBleGVjSXRlcmF0aW9uKGZpZWxkLCBpbmRleCwgbGFzdCkgew0KCSAgICAgIGlmIChkYXRhKSB7DQoJICAgICAgICBkYXRhLmtleSA9IGZpZWxkOw0KCSAgICAgICAgZGF0YS5pbmRleCA9IGluZGV4Ow0KCSAgICAgICAgZGF0YS5maXJzdCA9IGluZGV4ID09PSAwOw0KCSAgICAgICAgZGF0YS5sYXN0ID0gISFsYXN0Ow0KDQoJICAgICAgICBpZiAoY29udGV4dFBhdGgpIHsNCgkgICAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IGNvbnRleHRQYXRoICsgZmllbGQ7DQoJICAgICAgICB9DQoJICAgICAgfQ0KDQoJICAgICAgcmV0ID0gcmV0ICsgZm4oY29udGV4dFtmaWVsZF0sIHsNCgkgICAgICAgIGRhdGE6IGRhdGEsDQoJICAgICAgICBibG9ja1BhcmFtczogX3V0aWxzLmJsb2NrUGFyYW1zKFtjb250ZXh0W2ZpZWxkXSwgZmllbGRdLCBbY29udGV4dFBhdGggKyBmaWVsZCwgbnVsbF0pDQoJICAgICAgfSk7DQoJICAgIH0NCg0KCSAgICBpZiAoY29udGV4dCAmJiB0eXBlb2YgY29udGV4dCA9PT0gJ29iamVjdCcpIHsNCgkgICAgICBpZiAoX3V0aWxzLmlzQXJyYXkoY29udGV4dCkpIHsNCgkgICAgICAgIGZvciAodmFyIGogPSBjb250ZXh0Lmxlbmd0aDsgaSA8IGo7IGkrKykgew0KCSAgICAgICAgICBpZiAoaSBpbiBjb250ZXh0KSB7DQoJICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihpLCBpLCBpID09PSBjb250ZXh0Lmxlbmd0aCAtIDEpOw0KCSAgICAgICAgICB9DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHZhciBwcmlvcktleSA9IHVuZGVmaW5lZDsNCg0KCSAgICAgICAgZm9yICh2YXIga2V5IGluIGNvbnRleHQpIHsNCgkgICAgICAgICAgaWYgKGNvbnRleHQuaGFzT3duUHJvcGVydHkoa2V5KSkgew0KCSAgICAgICAgICAgIC8vIFdlJ3JlIHJ1bm5pbmcgdGhlIGl0ZXJhdGlvbnMgb25lIHN0ZXAgb3V0IG9mIHN5bmMgc28gd2UgY2FuIGRldGVjdA0KCSAgICAgICAgICAgIC8vIHRoZSBsYXN0IGl0ZXJhdGlvbiB3aXRob3V0IGhhdmUgdG8gc2NhbiB0aGUgb2JqZWN0IHR3aWNlIGFuZCBjcmVhdGUNCgkgICAgICAgICAgICAvLyBhbiBpdGVybWVkaWF0ZSBrZXlzIGFycmF5Lg0KCSAgICAgICAgICAgIGlmIChwcmlvcktleSAhPT0gdW5kZWZpbmVkKSB7DQoJICAgICAgICAgICAgICBleGVjSXRlcmF0aW9uKHByaW9yS2V5LCBpIC0gMSk7DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgIHByaW9yS2V5ID0ga2V5Ow0KCSAgICAgICAgICAgIGkrKzsNCgkgICAgICAgICAgfQ0KCSAgICAgICAgfQ0KCSAgICAgICAgaWYgKHByaW9yS2V5ICE9PSB1bmRlZmluZWQpIHsNCgkgICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEsIHRydWUpOw0KCSAgICAgICAgfQ0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGlmIChpID09PSAwKSB7DQoJICAgICAgcmV0ID0gaW52ZXJzZSh0aGlzKTsNCgkgICAgfQ0KDQoJICAgIHJldHVybiByZXQ7DQoJICB9KTsNCgl9Ow0KDQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107DQoNCi8qKiovIH0pLA0KLyogMTMgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsNCg0KCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7DQoNCglleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHsNCgkgIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdoZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24gKCkgLyogW2FyZ3MsIF1vcHRpb25zICovew0KCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgew0KCSAgICAgIC8vIEEgbWlzc2luZyBmaWVsZCBpbiBhIHt7Zm9vfX0gY29uc3RydWN0Lg0KCSAgICAgIHJldHVybiB1bmRlZmluZWQ7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgLy8gU29tZW9uZSBpcyBhY3R1YWxseSB0cnlpbmcgdG8gY2FsbCBzb21ldGhpbmcsIGJsb3cgdXAuDQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ01pc3NpbmcgaGVscGVyOiAiJyArIGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0ubmFtZSArICciJyk7DQoJICAgIH0NCgkgIH0pOw0KCX07DQoNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiAxNCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7DQoJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbiAoY29uZGl0aW9uYWwsIG9wdGlvbnMpIHsNCgkgICAgaWYgKF91dGlscy5pc0Z1bmN0aW9uKGNvbmRpdGlvbmFsKSkgew0KCSAgICAgIGNvbmRpdGlvbmFsID0gY29uZGl0aW9uYWwuY2FsbCh0aGlzKTsNCgkgICAgfQ0KDQoJICAgIC8vIERlZmF1bHQgYmVoYXZpb3IgaXMgdG8gcmVuZGVyIHRoZSBwb3NpdGl2ZSBwYXRoIGlmIHRoZSB2YWx1ZSBpcyB0cnV0aHkgYW5kIG5vdCBlbXB0eS4NCgkgICAgLy8gVGhlIGBpbmNsdWRlWmVyb2Agb3B0aW9uIG1heSBiZSBzZXQgdG8gdHJlYXQgdGhlIGNvbmR0aW9uYWwgYXMgcHVyZWx5IG5vdCBlbXB0eSBiYXNlZCBvbiB0aGUNCgkgICAgLy8gYmVoYXZpb3Igb2YgaXNFbXB0eS4gRWZmZWN0aXZlbHkgdGhpcyBkZXRlcm1pbmVzIGlmIDAgaXMgaGFuZGxlZCBieSB0aGUgcG9zaXRpdmUgcGF0aCBvciBuZWdhdGl2ZS4NCgkgICAgaWYgKCFvcHRpb25zLmhhc2guaW5jbHVkZVplcm8gJiYgIWNvbmRpdGlvbmFsIHx8IF91dGlscy5pc0VtcHR5KGNvbmRpdGlvbmFsKSkgew0KCSAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcmV0dXJuIG9wdGlvbnMuZm4odGhpcyk7DQoJICAgIH0NCgkgIH0pOw0KDQoJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcigndW5sZXNzJywgZnVuY3Rpb24gKGNvbmRpdGlvbmFsLCBvcHRpb25zKSB7DQoJICAgIHJldHVybiBpbnN0YW5jZS5oZWxwZXJzWydpZiddLmNhbGwodGhpcywgY29uZGl0aW9uYWwsIHsgZm46IG9wdGlvbnMuaW52ZXJzZSwgaW52ZXJzZTogb3B0aW9ucy5mbiwgaGFzaDogb3B0aW9ucy5oYXNoIH0pOw0KCSAgfSk7DQoJfTsNCg0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDE1ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7DQoJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9nJywgZnVuY3Rpb24gKCkgLyogbWVzc2FnZSwgb3B0aW9ucyAqL3sNCgkgICAgdmFyIGFyZ3MgPSBbdW5kZWZpbmVkXSwNCgkgICAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdOw0KCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGggLSAxOyBpKyspIHsNCgkgICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsNCgkgICAgfQ0KDQoJICAgIHZhciBsZXZlbCA9IDE7DQoJICAgIGlmIChvcHRpb25zLmhhc2gubGV2ZWwgIT0gbnVsbCkgew0KCSAgICAgIGxldmVsID0gb3B0aW9ucy5oYXNoLmxldmVsOw0KCSAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmRhdGEubGV2ZWwgIT0gbnVsbCkgew0KCSAgICAgIGxldmVsID0gb3B0aW9ucy5kYXRhLmxldmVsOw0KCSAgICB9DQoJICAgIGFyZ3NbMF0gPSBsZXZlbDsNCg0KCSAgICBpbnN0YW5jZS5sb2cuYXBwbHkoaW5zdGFuY2UsIGFyZ3MpOw0KCSAgfSk7DQoJfTsNCg0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDE2ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7DQoJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9va3VwJywgZnVuY3Rpb24gKG9iaiwgZmllbGQpIHsNCgkgICAgcmV0dXJuIG9iaiAmJiBvYmpbZmllbGRdOw0KCSAgfSk7DQoJfTsNCg0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDE3ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQoJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7DQoNCglleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHsNCgkgIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCd3aXRoJywgZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMpIHsNCgkgICAgaWYgKF91dGlscy5pc0Z1bmN0aW9uKGNvbnRleHQpKSB7DQoJICAgICAgY29udGV4dCA9IGNvbnRleHQuY2FsbCh0aGlzKTsNCgkgICAgfQ0KDQoJICAgIHZhciBmbiA9IG9wdGlvbnMuZm47DQoNCgkgICAgaWYgKCFfdXRpbHMuaXNFbXB0eShjb250ZXh0KSkgew0KCSAgICAgIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhOw0KCSAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHsNCgkgICAgICAgIGRhdGEgPSBfdXRpbHMuY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTsNCgkgICAgICAgIGRhdGEuY29udGV4dFBhdGggPSBfdXRpbHMuYXBwZW5kQ29udGV4dFBhdGgob3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoLCBvcHRpb25zLmlkc1swXSk7DQoJICAgICAgfQ0KDQoJICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIHsNCgkgICAgICAgIGRhdGE6IGRhdGEsDQoJICAgICAgICBibG9ja1BhcmFtczogX3V0aWxzLmJsb2NrUGFyYW1zKFtjb250ZXh0XSwgW2RhdGEgJiYgZGF0YS5jb250ZXh0UGF0aF0pDQoJICAgICAgfSk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcmV0dXJuIG9wdGlvbnMuaW52ZXJzZSh0aGlzKTsNCgkgICAgfQ0KCSAgfSk7DQoJfTsNCg0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDE4ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoJZXhwb3J0cy5yZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzID0gcmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9yczsNCg0KCXZhciBfZGVjb3JhdG9yc0lubGluZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOw0KDQoJdmFyIF9kZWNvcmF0b3JzSW5saW5lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlY29yYXRvcnNJbmxpbmUpOw0KDQoJZnVuY3Rpb24gcmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyhpbnN0YW5jZSkgew0KCSAgX2RlY29yYXRvcnNJbmxpbmUyWydkZWZhdWx0J10oaW5zdGFuY2UpOw0KCX0NCg0KLyoqKi8gfSksDQovKiAxOSAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7DQoJICBpbnN0YW5jZS5yZWdpc3RlckRlY29yYXRvcignaW5saW5lJywgZnVuY3Rpb24gKGZuLCBwcm9wcywgY29udGFpbmVyLCBvcHRpb25zKSB7DQoJICAgIHZhciByZXQgPSBmbjsNCgkgICAgaWYgKCFwcm9wcy5wYXJ0aWFscykgew0KCSAgICAgIHByb3BzLnBhcnRpYWxzID0ge307DQoJICAgICAgcmV0ID0gZnVuY3Rpb24gKGNvbnRleHQsIG9wdGlvbnMpIHsNCgkgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBwYXJ0aWFscyBzdGFjayBmcmFtZSBwcmlvciB0byBleGVjLg0KCSAgICAgICAgdmFyIG9yaWdpbmFsID0gY29udGFpbmVyLnBhcnRpYWxzOw0KCSAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gX3V0aWxzLmV4dGVuZCh7fSwgb3JpZ2luYWwsIHByb3BzLnBhcnRpYWxzKTsNCgkgICAgICAgIHZhciByZXQgPSBmbihjb250ZXh0LCBvcHRpb25zKTsNCgkgICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9yaWdpbmFsOw0KCSAgICAgICAgcmV0dXJuIHJldDsNCgkgICAgICB9Ow0KCSAgICB9DQoNCgkgICAgcHJvcHMucGFydGlhbHNbb3B0aW9ucy5hcmdzWzBdXSA9IG9wdGlvbnMuZm47DQoNCgkgICAgcmV0dXJuIHJldDsNCgkgIH0pOw0KCX07DQoNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiAyMCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJdmFyIGxvZ2dlciA9IHsNCgkgIG1ldGhvZE1hcDogWydkZWJ1ZycsICdpbmZvJywgJ3dhcm4nLCAnZXJyb3InXSwNCgkgIGxldmVsOiAnaW5mbycsDQoNCgkgIC8vIE1hcHMgYSBnaXZlbiBsZXZlbCB2YWx1ZSB0byB0aGUgYG1ldGhvZE1hcGAgaW5kZXhlcyBhYm92ZS4NCgkgIGxvb2t1cExldmVsOiBmdW5jdGlvbiBsb29rdXBMZXZlbChsZXZlbCkgew0KCSAgICBpZiAodHlwZW9mIGxldmVsID09PSAnc3RyaW5nJykgew0KCSAgICAgIHZhciBsZXZlbE1hcCA9IF91dGlscy5pbmRleE9mKGxvZ2dlci5tZXRob2RNYXAsIGxldmVsLnRvTG93ZXJDYXNlKCkpOw0KCSAgICAgIGlmIChsZXZlbE1hcCA+PSAwKSB7DQoJICAgICAgICBsZXZlbCA9IGxldmVsTWFwOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICBsZXZlbCA9IHBhcnNlSW50KGxldmVsLCAxMCk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgcmV0dXJuIGxldmVsOw0KCSAgfSwNCg0KCSAgLy8gQ2FuIGJlIG92ZXJyaWRkZW4gaW4gdGhlIGhvc3QgZW52aXJvbm1lbnQNCgkgIGxvZzogZnVuY3Rpb24gbG9nKGxldmVsKSB7DQoJICAgIGxldmVsID0gbG9nZ2VyLmxvb2t1cExldmVsKGxldmVsKTsNCg0KCSAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGxvZ2dlci5sb29rdXBMZXZlbChsb2dnZXIubGV2ZWwpIDw9IGxldmVsKSB7DQoJICAgICAgdmFyIG1ldGhvZCA9IGxvZ2dlci5tZXRob2RNYXBbbGV2ZWxdOw0KCSAgICAgIGlmICghY29uc29sZVttZXRob2RdKSB7DQoJICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUNCgkgICAgICAgIG1ldGhvZCA9ICdsb2cnOw0KCSAgICAgIH0NCg0KCSAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBtZXNzYWdlID0gQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykgew0KCSAgICAgICAgbWVzc2FnZVtfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07DQoJICAgICAgfQ0KDQoJICAgICAgY29uc29sZVttZXRob2RdLmFwcGx5KGNvbnNvbGUsIG1lc3NhZ2UpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUNCgkgICAgfQ0KCSAgfQ0KCX07DQoNCglleHBvcnRzWydkZWZhdWx0J10gPSBsb2dnZXI7DQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107DQoNCi8qKiovIH0pLA0KLyogMjEgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsNCg0KCS8vIEJ1aWxkIG91dCBvdXIgYmFzaWMgU2FmZVN0cmluZyB0eXBlDQoJJ3VzZSBzdHJpY3QnOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCglmdW5jdGlvbiBTYWZlU3RyaW5nKHN0cmluZykgew0KCSAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7DQoJfQ0KDQoJU2FmZVN0cmluZy5wcm90b3R5cGUudG9TdHJpbmcgPSBTYWZlU3RyaW5nLnByb3RvdHlwZS50b0hUTUwgPSBmdW5jdGlvbiAoKSB7DQoJICByZXR1cm4gJycgKyB0aGlzLnN0cmluZzsNCgl9Ow0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gU2FmZVN0cmluZzsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiAyMiAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJdmFyIF9PYmplY3Qkc2VhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpWydkZWZhdWx0J107DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpWydkZWZhdWx0J107DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoJZXhwb3J0cy5jaGVja1JldmlzaW9uID0gY2hlY2tSZXZpc2lvbjsNCglleHBvcnRzLnRlbXBsYXRlID0gdGVtcGxhdGU7DQoJZXhwb3J0cy53cmFwUHJvZ3JhbSA9IHdyYXBQcm9ncmFtOw0KCWV4cG9ydHMucmVzb2x2ZVBhcnRpYWwgPSByZXNvbHZlUGFydGlhbDsNCglleHBvcnRzLmludm9rZVBhcnRpYWwgPSBpbnZva2VQYXJ0aWFsOw0KCWV4cG9ydHMubm9vcCA9IG5vb3A7DQoNCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsNCg0KCXZhciBVdGlscyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlscyk7DQoNCgl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7DQoNCgl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOw0KDQoJdmFyIF9iYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsNCg0KCWZ1bmN0aW9uIGNoZWNrUmV2aXNpb24oY29tcGlsZXJJbmZvKSB7DQoJICB2YXIgY29tcGlsZXJSZXZpc2lvbiA9IGNvbXBpbGVySW5mbyAmJiBjb21waWxlckluZm9bMF0gfHwgMSwNCgkgICAgICBjdXJyZW50UmV2aXNpb24gPSBfYmFzZS5DT01QSUxFUl9SRVZJU0lPTjsNCg0KCSAgaWYgKGNvbXBpbGVyUmV2aXNpb24gIT09IGN1cnJlbnRSZXZpc2lvbikgew0KCSAgICBpZiAoY29tcGlsZXJSZXZpc2lvbiA8IGN1cnJlbnRSZXZpc2lvbikgew0KCSAgICAgIHZhciBydW50aW1lVmVyc2lvbnMgPSBfYmFzZS5SRVZJU0lPTl9DSEFOR0VTW2N1cnJlbnRSZXZpc2lvbl0sDQoJICAgICAgICAgIGNvbXBpbGVyVmVyc2lvbnMgPSBfYmFzZS5SRVZJU0lPTl9DSEFOR0VTW2NvbXBpbGVyUmV2aXNpb25dOw0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdUZW1wbGF0ZSB3YXMgcHJlY29tcGlsZWQgd2l0aCBhbiBvbGRlciB2ZXJzaW9uIG9mIEhhbmRsZWJhcnMgdGhhbiB0aGUgY3VycmVudCBydW50aW1lLiAnICsgJ1BsZWFzZSB1cGRhdGUgeW91ciBwcmVjb21waWxlciB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBydW50aW1lVmVyc2lvbnMgKyAnKSBvciBkb3duZ3JhZGUgeW91ciBydW50aW1lIHRvIGFuIG9sZGVyIHZlcnNpb24gKCcgKyBjb21waWxlclZlcnNpb25zICsgJykuJyk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgLy8gVXNlIHRoZSBlbWJlZGRlZCB2ZXJzaW9uIGluZm8gc2luY2UgdGhlIHJ1bnRpbWUgZG9lc24ndCBrbm93IGFib3V0IHRoaXMgcmV2aXNpb24geWV0DQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1RlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGEgbmV3ZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gJyArICdQbGVhc2UgdXBkYXRlIHlvdXIgcnVudGltZSB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBjb21waWxlckluZm9bMV0gKyAnKS4nKTsNCgkgICAgfQ0KCSAgfQ0KCX0NCg0KCWZ1bmN0aW9uIHRlbXBsYXRlKHRlbXBsYXRlU3BlYywgZW52KSB7DQoJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLw0KCSAgaWYgKCFlbnYpIHsNCgkgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ05vIGVudmlyb25tZW50IHBhc3NlZCB0byB0ZW1wbGF0ZScpOw0KCSAgfQ0KCSAgaWYgKCF0ZW1wbGF0ZVNwZWMgfHwgIXRlbXBsYXRlU3BlYy5tYWluKSB7DQoJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbmtub3duIHRlbXBsYXRlIG9iamVjdDogJyArIHR5cGVvZiB0ZW1wbGF0ZVNwZWMpOw0KCSAgfQ0KDQoJICB0ZW1wbGF0ZVNwZWMubWFpbi5kZWNvcmF0b3IgPSB0ZW1wbGF0ZVNwZWMubWFpbl9kOw0KDQoJICAvLyBOb3RlOiBVc2luZyBlbnYuVk0gcmVmZXJlbmNlcyByYXRoZXIgdGhhbiBsb2NhbCB2YXIgcmVmZXJlbmNlcyB0aHJvdWdob3V0IHRoaXMgc2VjdGlvbiB0byBhbGxvdw0KCSAgLy8gZm9yIGV4dGVybmFsIHVzZXJzIHRvIG92ZXJyaWRlIHRoZXNlIGFzIHBzdWVkby1zdXBwb3J0ZWQgQVBJcy4NCgkgIGVudi5WTS5jaGVja1JldmlzaW9uKHRlbXBsYXRlU3BlYy5jb21waWxlcik7DQoNCgkgIGZ1bmN0aW9uIGludm9rZVBhcnRpYWxXcmFwcGVyKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHsNCgkgICAgaWYgKG9wdGlvbnMuaGFzaCkgew0KCSAgICAgIGNvbnRleHQgPSBVdGlscy5leHRlbmQoe30sIGNvbnRleHQsIG9wdGlvbnMuaGFzaCk7DQoJICAgICAgaWYgKG9wdGlvbnMuaWRzKSB7DQoJICAgICAgICBvcHRpb25zLmlkc1swXSA9IHRydWU7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgcGFydGlhbCA9IGVudi5WTS5yZXNvbHZlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpOw0KCSAgICB2YXIgcmVzdWx0ID0gZW52LlZNLmludm9rZVBhcnRpYWwuY2FsbCh0aGlzLCBwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKTsNCg0KCSAgICBpZiAocmVzdWx0ID09IG51bGwgJiYgZW52LmNvbXBpbGUpIHsNCgkgICAgICBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV0gPSBlbnYuY29tcGlsZShwYXJ0aWFsLCB0ZW1wbGF0ZVNwZWMuY29tcGlsZXJPcHRpb25zLCBlbnYpOw0KCSAgICAgIHJlc3VsdCA9IG9wdGlvbnMucGFydGlhbHNbb3B0aW9ucy5uYW1lXShjb250ZXh0LCBvcHRpb25zKTsNCgkgICAgfQ0KCSAgICBpZiAocmVzdWx0ICE9IG51bGwpIHsNCgkgICAgICBpZiAob3B0aW9ucy5pbmRlbnQpIHsNCgkgICAgICAgIHZhciBsaW5lcyA9IHJlc3VsdC5zcGxpdCgnXG4nKTsNCgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gbGluZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7DQoJICAgICAgICAgIGlmICghbGluZXNbaV0gJiYgaSArIDEgPT09IGwpIHsNCgkgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgfQ0KDQoJICAgICAgICAgIGxpbmVzW2ldID0gb3B0aW9ucy5pbmRlbnQgKyBsaW5lc1tpXTsNCgkgICAgICAgIH0NCgkgICAgICAgIHJlc3VsdCA9IGxpbmVzLmpvaW4oJ1xuJyk7DQoJICAgICAgfQ0KCSAgICAgIHJldHVybiByZXN1bHQ7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1RoZSBwYXJ0aWFsICcgKyBvcHRpb25zLm5hbWUgKyAnIGNvdWxkIG5vdCBiZSBjb21waWxlZCB3aGVuIHJ1bm5pbmcgaW4gcnVudGltZS1vbmx5IG1vZGUnKTsNCgkgICAgfQ0KCSAgfQ0KDQoJICAvLyBKdXN0IGFkZCB3YXRlcg0KCSAgdmFyIGNvbnRhaW5lciA9IHsNCgkgICAgc3RyaWN0OiBmdW5jdGlvbiBzdHJpY3Qob2JqLCBuYW1lKSB7DQoJICAgICAgaWYgKCEobmFtZSBpbiBvYmopKSB7DQoJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnIicgKyBuYW1lICsgJyIgbm90IGRlZmluZWQgaW4gJyArIG9iaik7DQoJICAgICAgfQ0KCSAgICAgIHJldHVybiBvYmpbbmFtZV07DQoJICAgIH0sDQoJICAgIGxvb2t1cDogZnVuY3Rpb24gbG9va3VwKGRlcHRocywgbmFtZSkgew0KCSAgICAgIHZhciBsZW4gPSBkZXB0aHMubGVuZ3RoOw0KCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsNCgkgICAgICAgIGlmIChkZXB0aHNbaV0gJiYgZGVwdGhzW2ldW25hbWVdICE9IG51bGwpIHsNCgkgICAgICAgICAgcmV0dXJuIGRlcHRoc1tpXVtuYW1lXTsNCgkgICAgICAgIH0NCgkgICAgICB9DQoJICAgIH0sDQoJICAgIGxhbWJkYTogZnVuY3Rpb24gbGFtYmRhKGN1cnJlbnQsIGNvbnRleHQpIHsNCgkgICAgICByZXR1cm4gdHlwZW9mIGN1cnJlbnQgPT09ICdmdW5jdGlvbicgPyBjdXJyZW50LmNhbGwoY29udGV4dCkgOiBjdXJyZW50Ow0KCSAgICB9LA0KDQoJICAgIGVzY2FwZUV4cHJlc3Npb246IFV0aWxzLmVzY2FwZUV4cHJlc3Npb24sDQoJICAgIGludm9rZVBhcnRpYWw6IGludm9rZVBhcnRpYWxXcmFwcGVyLA0KDQoJICAgIGZuOiBmdW5jdGlvbiBmbihpKSB7DQoJICAgICAgdmFyIHJldCA9IHRlbXBsYXRlU3BlY1tpXTsNCgkgICAgICByZXQuZGVjb3JhdG9yID0gdGVtcGxhdGVTcGVjW2kgKyAnX2QnXTsNCgkgICAgICByZXR1cm4gcmV0Ow0KCSAgICB9LA0KDQoJICAgIHByb2dyYW1zOiBbXSwNCgkgICAgcHJvZ3JhbTogZnVuY3Rpb24gcHJvZ3JhbShpLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7DQoJICAgICAgdmFyIHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSwNCgkgICAgICAgICAgZm4gPSB0aGlzLmZuKGkpOw0KCSAgICAgIGlmIChkYXRhIHx8IGRlcHRocyB8fCBibG9ja1BhcmFtcyB8fCBkZWNsYXJlZEJsb2NrUGFyYW1zKSB7DQoJICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKTsNCgkgICAgICB9IGVsc2UgaWYgKCFwcm9ncmFtV3JhcHBlcikgew0KCSAgICAgICAgcHJvZ3JhbVdyYXBwZXIgPSB0aGlzLnByb2dyYW1zW2ldID0gd3JhcFByb2dyYW0odGhpcywgaSwgZm4pOw0KCSAgICAgIH0NCgkgICAgICByZXR1cm4gcHJvZ3JhbVdyYXBwZXI7DQoJICAgIH0sDQoNCgkgICAgZGF0YTogZnVuY3Rpb24gZGF0YSh2YWx1ZSwgZGVwdGgpIHsNCgkgICAgICB3aGlsZSAodmFsdWUgJiYgZGVwdGgtLSkgew0KCSAgICAgICAgdmFsdWUgPSB2YWx1ZS5fcGFyZW50Ow0KCSAgICAgIH0NCgkgICAgICByZXR1cm4gdmFsdWU7DQoJICAgIH0sDQoJICAgIG1lcmdlOiBmdW5jdGlvbiBtZXJnZShwYXJhbSwgY29tbW9uKSB7DQoJICAgICAgdmFyIG9iaiA9IHBhcmFtIHx8IGNvbW1vbjsNCg0KCSAgICAgIGlmIChwYXJhbSAmJiBjb21tb24gJiYgcGFyYW0gIT09IGNvbW1vbikgew0KCSAgICAgICAgb2JqID0gVXRpbHMuZXh0ZW5kKHt9LCBjb21tb24sIHBhcmFtKTsNCgkgICAgICB9DQoNCgkgICAgICByZXR1cm4gb2JqOw0KCSAgICB9LA0KCSAgICAvLyBBbiBlbXB0eSBvYmplY3QgdG8gdXNlIGFzIHJlcGxhY2VtZW50IGZvciBudWxsLWNvbnRleHRzDQoJICAgIG51bGxDb250ZXh0OiBfT2JqZWN0JHNlYWwoe30pLA0KDQoJICAgIG5vb3A6IGVudi5WTS5ub29wLA0KCSAgICBjb21waWxlckluZm86IHRlbXBsYXRlU3BlYy5jb21waWxlcg0KCSAgfTsNCg0KCSAgZnVuY3Rpb24gcmV0KGNvbnRleHQpIHsNCgkgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTsNCg0KCSAgICB2YXIgZGF0YSA9IG9wdGlvbnMuZGF0YTsNCg0KCSAgICByZXQuX3NldHVwKG9wdGlvbnMpOw0KCSAgICBpZiAoIW9wdGlvbnMucGFydGlhbCAmJiB0ZW1wbGF0ZVNwZWMudXNlRGF0YSkgew0KCSAgICAgIGRhdGEgPSBpbml0RGF0YShjb250ZXh0LCBkYXRhKTsNCgkgICAgfQ0KCSAgICB2YXIgZGVwdGhzID0gdW5kZWZpbmVkLA0KCSAgICAgICAgYmxvY2tQYXJhbXMgPSB0ZW1wbGF0ZVNwZWMudXNlQmxvY2tQYXJhbXMgPyBbXSA6IHVuZGVmaW5lZDsNCgkgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VEZXB0aHMpIHsNCgkgICAgICBpZiAob3B0aW9ucy5kZXB0aHMpIHsNCgkgICAgICAgIGRlcHRocyA9IGNvbnRleHQgIT0gb3B0aW9ucy5kZXB0aHNbMF0gPyBbY29udGV4dF0uY29uY2F0KG9wdGlvbnMuZGVwdGhzKSA6IG9wdGlvbnMuZGVwdGhzOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICBkZXB0aHMgPSBbY29udGV4dF07DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gbWFpbihjb250ZXh0IC8qLCBvcHRpb25zKi8pIHsNCgkgICAgICByZXR1cm4gJycgKyB0ZW1wbGF0ZVNwZWMubWFpbihjb250YWluZXIsIGNvbnRleHQsIGNvbnRhaW5lci5oZWxwZXJzLCBjb250YWluZXIucGFydGlhbHMsIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOw0KCSAgICB9DQoJICAgIG1haW4gPSBleGVjdXRlRGVjb3JhdG9ycyh0ZW1wbGF0ZVNwZWMubWFpbiwgbWFpbiwgY29udGFpbmVyLCBvcHRpb25zLmRlcHRocyB8fCBbXSwgZGF0YSwgYmxvY2tQYXJhbXMpOw0KCSAgICByZXR1cm4gbWFpbihjb250ZXh0LCBvcHRpb25zKTsNCgkgIH0NCgkgIHJldC5pc1RvcCA9IHRydWU7DQoNCgkgIHJldC5fc2V0dXAgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KCSAgICBpZiAoIW9wdGlvbnMucGFydGlhbCkgew0KCSAgICAgIGNvbnRhaW5lci5oZWxwZXJzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMuaGVscGVycywgZW52LmhlbHBlcnMpOw0KDQoJICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsKSB7DQoJICAgICAgICBjb250YWluZXIucGFydGlhbHMgPSBjb250YWluZXIubWVyZ2Uob3B0aW9ucy5wYXJ0aWFscywgZW52LnBhcnRpYWxzKTsNCgkgICAgICB9DQoJICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsIHx8IHRlbXBsYXRlU3BlYy51c2VEZWNvcmF0b3JzKSB7DQoJICAgICAgICBjb250YWluZXIuZGVjb3JhdG9ycyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLmRlY29yYXRvcnMsIGVudi5kZWNvcmF0b3JzKTsNCgkgICAgICB9DQoJICAgIH0gZWxzZSB7DQoJICAgICAgY29udGFpbmVyLmhlbHBlcnMgPSBvcHRpb25zLmhlbHBlcnM7DQoJICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gb3B0aW9ucy5wYXJ0aWFsczsNCgkgICAgICBjb250YWluZXIuZGVjb3JhdG9ycyA9IG9wdGlvbnMuZGVjb3JhdG9yczsNCgkgICAgfQ0KCSAgfTsNCg0KCSAgcmV0Ll9jaGlsZCA9IGZ1bmN0aW9uIChpLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7DQoJICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlQmxvY2tQYXJhbXMgJiYgIWJsb2NrUGFyYW1zKSB7DQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ211c3QgcGFzcyBibG9jayBwYXJhbXMnKTsNCgkgICAgfQ0KCSAgICBpZiAodGVtcGxhdGVTcGVjLnVzZURlcHRocyAmJiAhZGVwdGhzKSB7DQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ211c3QgcGFzcyBwYXJlbnQgZGVwdGhzJyk7DQoJICAgIH0NCg0KCSAgICByZXR1cm4gd3JhcFByb2dyYW0oY29udGFpbmVyLCBpLCB0ZW1wbGF0ZVNwZWNbaV0sIGRhdGEsIDAsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOw0KCSAgfTsNCgkgIHJldHVybiByZXQ7DQoJfQ0KDQoJZnVuY3Rpb24gd3JhcFByb2dyYW0oY29udGFpbmVyLCBpLCBmbiwgZGF0YSwgZGVjbGFyZWRCbG9ja1BhcmFtcywgYmxvY2tQYXJhbXMsIGRlcHRocykgew0KCSAgZnVuY3Rpb24gcHJvZyhjb250ZXh0KSB7DQoJICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07DQoNCgkgICAgdmFyIGN1cnJlbnREZXB0aHMgPSBkZXB0aHM7DQoJICAgIGlmIChkZXB0aHMgJiYgY29udGV4dCAhPSBkZXB0aHNbMF0gJiYgIShjb250ZXh0ID09PSBjb250YWluZXIubnVsbENvbnRleHQgJiYgZGVwdGhzWzBdID09PSBudWxsKSkgew0KCSAgICAgIGN1cnJlbnREZXB0aHMgPSBbY29udGV4dF0uY29uY2F0KGRlcHRocyk7DQoJICAgIH0NCg0KCSAgICByZXR1cm4gZm4oY29udGFpbmVyLCBjb250ZXh0LCBjb250YWluZXIuaGVscGVycywgY29udGFpbmVyLnBhcnRpYWxzLCBvcHRpb25zLmRhdGEgfHwgZGF0YSwgYmxvY2tQYXJhbXMgJiYgW29wdGlvbnMuYmxvY2tQYXJhbXNdLmNvbmNhdChibG9ja1BhcmFtcyksIGN1cnJlbnREZXB0aHMpOw0KCSAgfQ0KDQoJICBwcm9nID0gZXhlY3V0ZURlY29yYXRvcnMoZm4sIHByb2csIGNvbnRhaW5lciwgZGVwdGhzLCBkYXRhLCBibG9ja1BhcmFtcyk7DQoNCgkgIHByb2cucHJvZ3JhbSA9IGk7DQoJICBwcm9nLmRlcHRoID0gZGVwdGhzID8gZGVwdGhzLmxlbmd0aCA6IDA7DQoJICBwcm9nLmJsb2NrUGFyYW1zID0gZGVjbGFyZWRCbG9ja1BhcmFtcyB8fCAwOw0KCSAgcmV0dXJuIHByb2c7DQoJfQ0KDQoJZnVuY3Rpb24gcmVzb2x2ZVBhcnRpYWwocGFydGlhbCwgY29udGV4dCwgb3B0aW9ucykgew0KCSAgaWYgKCFwYXJ0aWFsKSB7DQoJICAgIGlmIChvcHRpb25zLm5hbWUgPT09ICdAcGFydGlhbC1ibG9jaycpIHsNCgkgICAgICBwYXJ0aWFsID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ107DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcGFydGlhbCA9IG9wdGlvbnMucGFydGlhbHNbb3B0aW9ucy5uYW1lXTsNCgkgICAgfQ0KCSAgfSBlbHNlIGlmICghcGFydGlhbC5jYWxsICYmICFvcHRpb25zLm5hbWUpIHsNCgkgICAgLy8gVGhpcyBpcyBhIGR5bmFtaWMgcGFydGlhbCB0aGF0IHJldHVybmVkIGEgc3RyaW5nDQoJICAgIG9wdGlvbnMubmFtZSA9IHBhcnRpYWw7DQoJICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW3BhcnRpYWxdOw0KCSAgfQ0KCSAgcmV0dXJuIHBhcnRpYWw7DQoJfQ0KDQoJZnVuY3Rpb24gaW52b2tlUGFydGlhbChwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7DQoJICAvLyBVc2UgdGhlIGN1cnJlbnQgY2xvc3VyZSBjb250ZXh0IHRvIHNhdmUgdGhlIHBhcnRpYWwtYmxvY2sgaWYgdGhpcyBwYXJ0aWFsDQoJICB2YXIgY3VycmVudFBhcnRpYWxCbG9jayA9IG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmRhdGFbJ3BhcnRpYWwtYmxvY2snXTsNCgkgIG9wdGlvbnMucGFydGlhbCA9IHRydWU7DQoJICBpZiAob3B0aW9ucy5pZHMpIHsNCgkgICAgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoID0gb3B0aW9ucy5pZHNbMF0gfHwgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoOw0KCSAgfQ0KDQoJICB2YXIgcGFydGlhbEJsb2NrID0gdW5kZWZpbmVkOw0KCSAgaWYgKG9wdGlvbnMuZm4gJiYgb3B0aW9ucy5mbiAhPT0gbm9vcCkgew0KCSAgICAoZnVuY3Rpb24gKCkgew0KCSAgICAgIG9wdGlvbnMuZGF0YSA9IF9iYXNlLmNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7DQoJICAgICAgLy8gV3JhcHBlciBmdW5jdGlvbiB0byBnZXQgYWNjZXNzIHRvIGN1cnJlbnRQYXJ0aWFsQmxvY2sgZnJvbSB0aGUgY2xvc3VyZQ0KCSAgICAgIHZhciBmbiA9IG9wdGlvbnMuZm47DQoJICAgICAgcGFydGlhbEJsb2NrID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ10gPSBmdW5jdGlvbiBwYXJ0aWFsQmxvY2tXcmFwcGVyKGNvbnRleHQpIHsNCgkgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07DQoNCgkgICAgICAgIC8vIFJlc3RvcmUgdGhlIHBhcnRpYWwtYmxvY2sgZnJvbSB0aGUgY2xvc3VyZSBmb3IgdGhlIGV4ZWN1dGlvbiBvZiB0aGUgYmxvY2sNCgkgICAgICAgIC8vIGkuZS4gdGhlIHBhcnQgaW5zaWRlIHRoZSBibG9jayBvZiB0aGUgcGFydGlhbCBjYWxsLg0KCSAgICAgICAgb3B0aW9ucy5kYXRhID0gX2Jhc2UuY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTsNCgkgICAgICAgIG9wdGlvbnMuZGF0YVsncGFydGlhbC1ibG9jayddID0gY3VycmVudFBhcnRpYWxCbG9jazsNCgkgICAgICAgIHJldHVybiBmbihjb250ZXh0LCBvcHRpb25zKTsNCgkgICAgICB9Ow0KCSAgICAgIGlmIChmbi5wYXJ0aWFscykgew0KCSAgICAgICAgb3B0aW9ucy5wYXJ0aWFscyA9IFV0aWxzLmV4dGVuZCh7fSwgb3B0aW9ucy5wYXJ0aWFscywgZm4ucGFydGlhbHMpOw0KCSAgICAgIH0NCgkgICAgfSkoKTsNCgkgIH0NCg0KCSAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCAmJiBwYXJ0aWFsQmxvY2spIHsNCgkgICAgcGFydGlhbCA9IHBhcnRpYWxCbG9jazsNCgkgIH0NCg0KCSAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCkgew0KCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVGhlIHBhcnRpYWwgJyArIG9wdGlvbnMubmFtZSArICcgY291bGQgbm90IGJlIGZvdW5kJyk7DQoJICB9IGVsc2UgaWYgKHBhcnRpYWwgaW5zdGFuY2VvZiBGdW5jdGlvbikgew0KCSAgICByZXR1cm4gcGFydGlhbChjb250ZXh0LCBvcHRpb25zKTsNCgkgIH0NCgl9DQoNCglmdW5jdGlvbiBub29wKCkgew0KCSAgcmV0dXJuICcnOw0KCX0NCg0KCWZ1bmN0aW9uIGluaXREYXRhKGNvbnRleHQsIGRhdGEpIHsNCgkgIGlmICghZGF0YSB8fCAhKCdyb290JyBpbiBkYXRhKSkgew0KCSAgICBkYXRhID0gZGF0YSA/IF9iYXNlLmNyZWF0ZUZyYW1lKGRhdGEpIDoge307DQoJICAgIGRhdGEucm9vdCA9IGNvbnRleHQ7DQoJICB9DQoJICByZXR1cm4gZGF0YTsNCgl9DQoNCglmdW5jdGlvbiBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKSB7DQoJICBpZiAoZm4uZGVjb3JhdG9yKSB7DQoJICAgIHZhciBwcm9wcyA9IHt9Ow0KCSAgICBwcm9nID0gZm4uZGVjb3JhdG9yKHByb2csIHByb3BzLCBjb250YWluZXIsIGRlcHRocyAmJiBkZXB0aHNbMF0sIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOw0KCSAgICBVdGlscy5leHRlbmQocHJvZywgcHJvcHMpOw0KCSAgfQ0KCSAgcmV0dXJuIHByb2c7DQoJfQ0KDQovKioqLyB9KSwNCi8qIDIzICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KSwgX19lc01vZHVsZTogdHJ1ZSB9Ow0KDQovKioqLyB9KSwNCi8qIDI0ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCglfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTsNCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzApLk9iamVjdC5zZWFsOw0KDQovKioqLyB9KSwNCi8qIDI1ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkvLyAxOS4xLjIuMTcgT2JqZWN0LnNlYWwoTykNCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsNCg0KCV9fd2VicGFja19yZXF1aXJlX18oMjcpKCdzZWFsJywgZnVuY3Rpb24oJHNlYWwpew0KCSAgcmV0dXJuIGZ1bmN0aW9uIHNlYWwoaXQpew0KCSAgICByZXR1cm4gJHNlYWwgJiYgaXNPYmplY3QoaXQpID8gJHNlYWwoaXQpIDogaXQ7DQoJICB9Ow0KCX0pOw0KDQovKioqLyB9KSwNCi8qIDI2ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsNCgkgIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7DQoJfTsNCg0KLyoqKi8gfSksDQovKiAyNyAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzDQoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQ0KCSAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkNCgkgICwgZmFpbHMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOw0KCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsNCgkgIHZhciBmbiAgPSAoY29yZS5PYmplY3QgfHwge30pW0tFWV0gfHwgT2JqZWN0W0tFWV0NCgkgICAgLCBleHAgPSB7fTsNCgkgIGV4cFtLRVldID0gZXhlYyhmbik7DQoJICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uKCl7IGZuKDEpOyB9KSwgJ09iamVjdCcsIGV4cCk7DQoJfTsNCg0KLyoqKi8gfSksDQovKiAyOCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpDQoJICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApDQoJICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpDQoJICAsIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnOw0KDQoJdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2Upew0KCSAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkYNCgkgICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HDQoJICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUw0KCSAgICAsIElTX1BST1RPICA9IHR5cGUgJiAkZXhwb3J0LlANCgkgICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CDQoJICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuVw0KCSAgICAsIGV4cG9ydHMgICA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pDQoJICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXQ0KCSAgICAsIGtleSwgb3duLCBvdXQ7DQoJICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsNCgkgIGZvcihrZXkgaW4gc291cmNlKXsNCgkgICAgLy8gY29udGFpbnMgaW4gbmF0aXZlDQoJICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIGtleSBpbiB0YXJnZXQ7DQoJICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTsNCgkgICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWQNCgkgICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsNCgkgICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzDQoJICAgIGV4cG9ydHNba2V5XSA9IElTX0dMT0JBTCAmJiB0eXBlb2YgdGFyZ2V0W2tleV0gIT0gJ2Z1bmN0aW9uJyA/IHNvdXJjZVtrZXldDQoJICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0DQoJICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpDQoJICAgIC8vIHdyYXAgZ2xvYmFsIGNvbnN0cnVjdG9ycyBmb3IgcHJldmVudCBjaGFuZ2UgdGhlbSBpbiBsaWJyYXJ5DQoJICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7DQoJICAgICAgdmFyIEYgPSBmdW5jdGlvbihwYXJhbSl7DQoJICAgICAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIEMgPyBuZXcgQyhwYXJhbSkgOiBDKHBhcmFtKTsNCgkgICAgICB9Ow0KCSAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTsNCgkgICAgICByZXR1cm4gRjsNCgkgICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzDQoJICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDsNCgkgICAgaWYoSVNfUFJPVE8pKGV4cG9ydHNbUFJPVE9UWVBFXSB8fCAoZXhwb3J0c1tQUk9UT1RZUEVdID0ge30pKVtrZXldID0gb3V0Ow0KCSAgfQ0KCX07DQoJLy8gdHlwZSBiaXRtYXANCgkkZXhwb3J0LkYgPSAxOyAgLy8gZm9yY2VkDQoJJGV4cG9ydC5HID0gMjsgIC8vIGdsb2JhbA0KCSRleHBvcnQuUyA9IDQ7ICAvLyBzdGF0aWMNCgkkZXhwb3J0LlAgPSA4OyAgLy8gcHJvdG8NCgkkZXhwb3J0LkIgPSAxNjsgLy8gYmluZA0KCSRleHBvcnQuVyA9IDMyOyAvLyB3cmFwDQoJbW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0Ow0KDQovKioqLyB9KSwNCi8qIDI5ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgkvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOA0KCXZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aA0KCSAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGYgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpOw0KCWlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmDQoNCi8qKiovIH0pLA0KLyogMzAgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsNCg0KCXZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7dmVyc2lvbjogJzEuMi42J307DQoJaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmDQoNCi8qKiovIH0pLA0KLyogMzEgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCS8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZw0KCXZhciBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsNCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCB0aGF0LCBsZW5ndGgpew0KCSAgYUZ1bmN0aW9uKGZuKTsNCgkgIGlmKHRoYXQgPT09IHVuZGVmaW5lZClyZXR1cm4gZm47DQoJICBzd2l0Y2gobGVuZ3RoKXsNCgkgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7DQoJICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7DQoJICAgIH07DQoJICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpew0KCSAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpOw0KCSAgICB9Ow0KCSAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsNCgkgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTsNCgkgICAgfTsNCgkgIH0NCgkgIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXsNCgkgICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7DQoJICB9Ow0KCX07DQoNCi8qKiovIH0pLA0KLyogMzIgKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsNCg0KCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KCSAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsNCgkgIHJldHVybiBpdDsNCgl9Ow0KDQovKioqLyB9KSwNCi8qIDMzICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMpew0KCSAgdHJ5IHsNCgkgICAgcmV0dXJuICEhZXhlYygpOw0KCSAgfSBjYXRjaChlKXsNCgkgICAgcmV0dXJuIHRydWU7DQoJICB9DQoJfTsNCg0KLyoqKi8gfSksDQovKiAzNCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgew0KDQoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgey8qIGdsb2JhbCB3aW5kb3cgKi8NCgkndXNlIHN0cmljdCc7DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKEhhbmRsZWJhcnMpIHsNCgkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovDQoJICB2YXIgcm9vdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogd2luZG93LA0KCSAgICAgICRIYW5kbGViYXJzID0gcm9vdC5IYW5kbGViYXJzOw0KCSAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8NCgkgIEhhbmRsZWJhcnMubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHsNCgkgICAgaWYgKHJvb3QuSGFuZGxlYmFycyA9PT0gSGFuZGxlYmFycykgew0KCSAgICAgIHJvb3QuSGFuZGxlYmFycyA9ICRIYW5kbGViYXJzOw0KCSAgICB9DQoJICAgIHJldHVybiBIYW5kbGViYXJzOw0KCSAgfTsNCgl9Ow0KDQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107DQoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQ0KDQovKioqLyB9KSwNCi8qIDM1ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KCXZhciBBU1QgPSB7DQoJICAvLyBQdWJsaWMgQVBJIHVzZWQgdG8gZXZhbHVhdGUgZGVyaXZlZCBhdHRyaWJ1dGVzIHJlZ2FyZGluZyBBU1Qgbm9kZXMNCgkgIGhlbHBlcnM6IHsNCgkgICAgLy8gYSBtdXN0YWNoZSBpcyBkZWZpbml0ZWx5IGEgaGVscGVyIGlmOg0KCSAgICAvLyAqIGl0IGlzIGFuIGVsaWdpYmxlIGhlbHBlciwgYW5kDQoJICAgIC8vICogaXQgaGFzIGF0IGxlYXN0IG9uZSBwYXJhbWV0ZXIgb3IgaGFzaCBzZWdtZW50DQoJICAgIGhlbHBlckV4cHJlc3Npb246IGZ1bmN0aW9uIGhlbHBlckV4cHJlc3Npb24obm9kZSkgew0KCSAgICAgIHJldHVybiBub2RlLnR5cGUgPT09ICdTdWJFeHByZXNzaW9uJyB8fCAobm9kZS50eXBlID09PSAnTXVzdGFjaGVTdGF0ZW1lbnQnIHx8IG5vZGUudHlwZSA9PT0gJ0Jsb2NrU3RhdGVtZW50JykgJiYgISEobm9kZS5wYXJhbXMgJiYgbm9kZS5wYXJhbXMubGVuZ3RoIHx8IG5vZGUuaGFzaCk7DQoJICAgIH0sDQoNCgkgICAgc2NvcGVkSWQ6IGZ1bmN0aW9uIHNjb3BlZElkKHBhdGgpIHsNCgkgICAgICByZXR1cm4gKC9eXC58dGhpc1xiLy50ZXN0KHBhdGgub3JpZ2luYWwpDQoJICAgICAgKTsNCgkgICAgfSwNCg0KCSAgICAvLyBhbiBJRCBpcyBzaW1wbGUgaWYgaXQgb25seSBoYXMgb25lIHBhcnQsIGFuZCB0aGF0IHBhcnQgaXMgbm90DQoJICAgIC8vIGAuLmAgb3IgYHRoaXNgLg0KCSAgICBzaW1wbGVJZDogZnVuY3Rpb24gc2ltcGxlSWQocGF0aCkgew0KCSAgICAgIHJldHVybiBwYXRoLnBhcnRzLmxlbmd0aCA9PT0gMSAmJiAhQVNULmhlbHBlcnMuc2NvcGVkSWQocGF0aCkgJiYgIXBhdGguZGVwdGg7DQoJICAgIH0NCgkgIH0NCgl9Ow0KDQoJLy8gTXVzdCBiZSBleHBvcnRlZCBhcyBhbiBvYmplY3QgcmF0aGVyIHRoYW4gdGhlIHJvb3Qgb2YgdGhlIG1vZHVsZSBhcyB0aGUgamlzb24gbGV4ZXINCgkvLyBtdXN0IG1vZGlmeSB0aGUgb2JqZWN0IHRvIG9wZXJhdGUgcHJvcGVybHkuDQoJZXhwb3J0c1snZGVmYXVsdCddID0gQVNUOw0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KSwNCi8qIDM2ICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCA9IF9fd2VicGFja19yZXF1aXJlX18oMylbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoJZXhwb3J0cy5wYXJzZSA9IHBhcnNlOw0KDQoJdmFyIF9wYXJzZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KTsNCg0KCXZhciBfcGFyc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhcnNlcik7DQoNCgl2YXIgX3doaXRlc3BhY2VDb250cm9sID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCk7DQoNCgl2YXIgX3doaXRlc3BhY2VDb250cm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3doaXRlc3BhY2VDb250cm9sKTsNCg0KCXZhciBfaGVscGVycyA9IF9fd2VicGFja19yZXF1aXJlX18oNDApOw0KDQoJdmFyIEhlbHBlcnMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfaGVscGVycyk7DQoNCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsNCg0KCWV4cG9ydHMucGFyc2VyID0gX3BhcnNlcjJbJ2RlZmF1bHQnXTsNCg0KCXZhciB5eSA9IHt9Ow0KCV91dGlscy5leHRlbmQoeXksIEhlbHBlcnMpOw0KDQoJZnVuY3Rpb24gcGFyc2UoaW5wdXQsIG9wdGlvbnMpIHsNCgkgIC8vIEp1c3QgcmV0dXJuIGlmIGFuIGFscmVhZHktY29tcGlsZWQgQVNUIHdhcyBwYXNzZWQgaW4uDQoJICBpZiAoaW5wdXQudHlwZSA9PT0gJ1Byb2dyYW0nKSB7DQoJICAgIHJldHVybiBpbnB1dDsNCgkgIH0NCg0KCSAgX3BhcnNlcjJbJ2RlZmF1bHQnXS55eSA9IHl5Ow0KDQoJICAvLyBBbHRlcmluZyB0aGUgc2hhcmVkIG9iamVjdCBoZXJlLCBidXQgdGhpcyBpcyBvayBhcyBwYXJzZXIgaXMgYSBzeW5jIG9wZXJhdGlvbg0KCSAgeXkubG9jSW5mbyA9IGZ1bmN0aW9uIChsb2NJbmZvKSB7DQoJICAgIHJldHVybiBuZXcgeXkuU291cmNlTG9jYXRpb24ob3B0aW9ucyAmJiBvcHRpb25zLnNyY05hbWUsIGxvY0luZm8pOw0KCSAgfTsNCg0KCSAgdmFyIHN0cmlwID0gbmV3IF93aGl0ZXNwYWNlQ29udHJvbDJbJ2RlZmF1bHQnXShvcHRpb25zKTsNCgkgIHJldHVybiBzdHJpcC5hY2NlcHQoX3BhcnNlcjJbJ2RlZmF1bHQnXS5wYXJzZShpbnB1dCkpOw0KCX0NCg0KLyoqKi8gfSksDQovKiAzNyAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgew0KDQoJLy8gRmlsZSBpZ25vcmVkIGluIGNvdmVyYWdlIHRlc3RzIHZpYSBzZXR0aW5nIGluIC5pc3RhbmJ1bC55bWwNCgkvKiBKaXNvbiBnZW5lcmF0ZWQgcGFyc2VyICovDQoJInVzZSBzdHJpY3QiOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCgl2YXIgaGFuZGxlYmFycyA9IChmdW5jdGlvbiAoKSB7DQoJICAgIHZhciBwYXJzZXIgPSB7IHRyYWNlOiBmdW5jdGlvbiB0cmFjZSgpIHt9LA0KCSAgICAgICAgeXk6IHt9LA0KCSAgICAgICAgc3ltYm9sc186IHsgImVycm9yIjogMiwgInJvb3QiOiAzLCAicHJvZ3JhbSI6IDQsICJFT0YiOiA1LCAicHJvZ3JhbV9yZXBldGl0aW9uMCI6IDYsICJzdGF0ZW1lbnQiOiA3LCAibXVzdGFjaGUiOiA4LCAiYmxvY2siOiA5LCAicmF3QmxvY2siOiAxMCwgInBhcnRpYWwiOiAxMSwgInBhcnRpYWxCbG9jayI6IDEyLCAiY29udGVudCI6IDEzLCAiQ09NTUVOVCI6IDE0LCAiQ09OVEVOVCI6IDE1LCAib3BlblJhd0Jsb2NrIjogMTYsICJyYXdCbG9ja19yZXBldGl0aW9uX3BsdXMwIjogMTcsICJFTkRfUkFXX0JMT0NLIjogMTgsICJPUEVOX1JBV19CTE9DSyI6IDE5LCAiaGVscGVyTmFtZSI6IDIwLCAib3BlblJhd0Jsb2NrX3JlcGV0aXRpb24wIjogMjEsICJvcGVuUmF3QmxvY2tfb3B0aW9uMCI6IDIyLCAiQ0xPU0VfUkFXX0JMT0NLIjogMjMsICJvcGVuQmxvY2siOiAyNCwgImJsb2NrX29wdGlvbjAiOiAyNSwgImNsb3NlQmxvY2siOiAyNiwgIm9wZW5JbnZlcnNlIjogMjcsICJibG9ja19vcHRpb24xIjogMjgsICJPUEVOX0JMT0NLIjogMjksICJvcGVuQmxvY2tfcmVwZXRpdGlvbjAiOiAzMCwgIm9wZW5CbG9ja19vcHRpb24wIjogMzEsICJvcGVuQmxvY2tfb3B0aW9uMSI6IDMyLCAiQ0xPU0UiOiAzMywgIk9QRU5fSU5WRVJTRSI6IDM0LCAib3BlbkludmVyc2VfcmVwZXRpdGlvbjAiOiAzNSwgIm9wZW5JbnZlcnNlX29wdGlvbjAiOiAzNiwgIm9wZW5JbnZlcnNlX29wdGlvbjEiOiAzNywgIm9wZW5JbnZlcnNlQ2hhaW4iOiAzOCwgIk9QRU5fSU5WRVJTRV9DSEFJTiI6IDM5LCAib3BlbkludmVyc2VDaGFpbl9yZXBldGl0aW9uMCI6IDQwLCAib3BlbkludmVyc2VDaGFpbl9vcHRpb24wIjogNDEsICJvcGVuSW52ZXJzZUNoYWluX29wdGlvbjEiOiA0MiwgImludmVyc2VBbmRQcm9ncmFtIjogNDMsICJJTlZFUlNFIjogNDQsICJpbnZlcnNlQ2hhaW4iOiA0NSwgImludmVyc2VDaGFpbl9vcHRpb24wIjogNDYsICJPUEVOX0VOREJMT0NLIjogNDcsICJPUEVOIjogNDgsICJtdXN0YWNoZV9yZXBldGl0aW9uMCI6IDQ5LCAibXVzdGFjaGVfb3B0aW9uMCI6IDUwLCAiT1BFTl9VTkVTQ0FQRUQiOiA1MSwgIm11c3RhY2hlX3JlcGV0aXRpb24xIjogNTIsICJtdXN0YWNoZV9vcHRpb24xIjogNTMsICJDTE9TRV9VTkVTQ0FQRUQiOiA1NCwgIk9QRU5fUEFSVElBTCI6IDU1LCAicGFydGlhbE5hbWUiOiA1NiwgInBhcnRpYWxfcmVwZXRpdGlvbjAiOiA1NywgInBhcnRpYWxfb3B0aW9uMCI6IDU4LCAib3BlblBhcnRpYWxCbG9jayI6IDU5LCAiT1BFTl9QQVJUSUFMX0JMT0NLIjogNjAsICJvcGVuUGFydGlhbEJsb2NrX3JlcGV0aXRpb24wIjogNjEsICJvcGVuUGFydGlhbEJsb2NrX29wdGlvbjAiOiA2MiwgInBhcmFtIjogNjMsICJzZXhwciI6IDY0LCAiT1BFTl9TRVhQUiI6IDY1LCAic2V4cHJfcmVwZXRpdGlvbjAiOiA2NiwgInNleHByX29wdGlvbjAiOiA2NywgIkNMT1NFX1NFWFBSIjogNjgsICJoYXNoIjogNjksICJoYXNoX3JlcGV0aXRpb25fcGx1czAiOiA3MCwgImhhc2hTZWdtZW50IjogNzEsICJJRCI6IDcyLCAiRVFVQUxTIjogNzMsICJibG9ja1BhcmFtcyI6IDc0LCAiT1BFTl9CTE9DS19QQVJBTVMiOiA3NSwgImJsb2NrUGFyYW1zX3JlcGV0aXRpb25fcGx1czAiOiA3NiwgIkNMT1NFX0JMT0NLX1BBUkFNUyI6IDc3LCAicGF0aCI6IDc4LCAiZGF0YU5hbWUiOiA3OSwgIlNUUklORyI6IDgwLCAiTlVNQkVSIjogODEsICJCT09MRUFOIjogODIsICJVTkRFRklORUQiOiA4MywgIk5VTEwiOiA4NCwgIkRBVEEiOiA4NSwgInBhdGhTZWdtZW50cyI6IDg2LCAiU0VQIjogODcsICIkYWNjZXB0IjogMCwgIiRlbmQiOiAxIH0sDQoJICAgICAgICB0ZXJtaW5hbHNfOiB7IDI6ICJlcnJvciIsIDU6ICJFT0YiLCAxNDogIkNPTU1FTlQiLCAxNTogIkNPTlRFTlQiLCAxODogIkVORF9SQVdfQkxPQ0siLCAxOTogIk9QRU5fUkFXX0JMT0NLIiwgMjM6ICJDTE9TRV9SQVdfQkxPQ0siLCAyOTogIk9QRU5fQkxPQ0siLCAzMzogIkNMT1NFIiwgMzQ6ICJPUEVOX0lOVkVSU0UiLCAzOTogIk9QRU5fSU5WRVJTRV9DSEFJTiIsIDQ0OiAiSU5WRVJTRSIsIDQ3OiAiT1BFTl9FTkRCTE9DSyIsIDQ4OiAiT1BFTiIsIDUxOiAiT1BFTl9VTkVTQ0FQRUQiLCA1NDogIkNMT1NFX1VORVNDQVBFRCIsIDU1OiAiT1BFTl9QQVJUSUFMIiwgNjA6ICJPUEVOX1BBUlRJQUxfQkxPQ0siLCA2NTogIk9QRU5fU0VYUFIiLCA2ODogIkNMT1NFX1NFWFBSIiwgNzI6ICJJRCIsIDczOiAiRVFVQUxTIiwgNzU6ICJPUEVOX0JMT0NLX1BBUkFNUyIsIDc3OiAiQ0xPU0VfQkxPQ0tfUEFSQU1TIiwgODA6ICJTVFJJTkciLCA4MTogIk5VTUJFUiIsIDgyOiAiQk9PTEVBTiIsIDgzOiAiVU5ERUZJTkVEIiwgODQ6ICJOVUxMIiwgODU6ICJEQVRBIiwgODc6ICJTRVAiIH0sDQoJICAgICAgICBwcm9kdWN0aW9uc186IFswLCBbMywgMl0sIFs0LCAxXSwgWzcsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbMTMsIDFdLCBbMTAsIDNdLCBbMTYsIDVdLCBbOSwgNF0sIFs5LCA0XSwgWzI0LCA2XSwgWzI3LCA2XSwgWzM4LCA2XSwgWzQzLCAyXSwgWzQ1LCAzXSwgWzQ1LCAxXSwgWzI2LCAzXSwgWzgsIDVdLCBbOCwgNV0sIFsxMSwgNV0sIFsxMiwgM10sIFs1OSwgNV0sIFs2MywgMV0sIFs2MywgMV0sIFs2NCwgNV0sIFs2OSwgMV0sIFs3MSwgM10sIFs3NCwgM10sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFs1NiwgMV0sIFs1NiwgMV0sIFs3OSwgMl0sIFs3OCwgMV0sIFs4NiwgM10sIFs4NiwgMV0sIFs2LCAwXSwgWzYsIDJdLCBbMTcsIDFdLCBbMTcsIDJdLCBbMjEsIDBdLCBbMjEsIDJdLCBbMjIsIDBdLCBbMjIsIDFdLCBbMjUsIDBdLCBbMjUsIDFdLCBbMjgsIDBdLCBbMjgsIDFdLCBbMzAsIDBdLCBbMzAsIDJdLCBbMzEsIDBdLCBbMzEsIDFdLCBbMzIsIDBdLCBbMzIsIDFdLCBbMzUsIDBdLCBbMzUsIDJdLCBbMzYsIDBdLCBbMzYsIDFdLCBbMzcsIDBdLCBbMzcsIDFdLCBbNDAsIDBdLCBbNDAsIDJdLCBbNDEsIDBdLCBbNDEsIDFdLCBbNDIsIDBdLCBbNDIsIDFdLCBbNDYsIDBdLCBbNDYsIDFdLCBbNDksIDBdLCBbNDksIDJdLCBbNTAsIDBdLCBbNTAsIDFdLCBbNTIsIDBdLCBbNTIsIDJdLCBbNTMsIDBdLCBbNTMsIDFdLCBbNTcsIDBdLCBbNTcsIDJdLCBbNTgsIDBdLCBbNTgsIDFdLCBbNjEsIDBdLCBbNjEsIDJdLCBbNjIsIDBdLCBbNjIsIDFdLCBbNjYsIDBdLCBbNjYsIDJdLCBbNjcsIDBdLCBbNjcsIDFdLCBbNzAsIDFdLCBbNzAsIDJdLCBbNzYsIDFdLCBbNzYsIDJdXSwNCgkgICAgICAgIHBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGFub255bW91cyh5eXRleHQsIHl5bGVuZywgeXlsaW5lbm8sIHl5LCB5eXN0YXRlLCAkJCwgXyQNCgkgICAgICAgIC8qKi8pIHsNCg0KCSAgICAgICAgICAgIHZhciAkMCA9ICQkLmxlbmd0aCAtIDE7DQoJICAgICAgICAgICAgc3dpdGNoICh5eXN0YXRlKSB7DQoJICAgICAgICAgICAgICAgIGNhc2UgMToNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiAkJFskMCAtIDFdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVQcm9ncmFtKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDU6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA2Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDg6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA5Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gew0KCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdDb21tZW50U3RhdGVtZW50JywNCgkgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogeXkuc3RyaXBDb21tZW50KCQkWyQwXSksDQoJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDBdLCAkJFskMF0pLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKQ0KCSAgICAgICAgICAgICAgICAgICAgfTsNCg0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTA6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0NvbnRlbnRTdGF0ZW1lbnQnLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsOiAkJFskMF0sDQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICQkWyQwXSwNCgkgICAgICAgICAgICAgICAgICAgICAgICBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkNCgkgICAgICAgICAgICAgICAgICAgIH07DQoNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDExOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZVJhd0Jsb2NrKCQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdGhpcy5fJCk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxMjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgcGF0aDogJCRbJDAgLSAzXSwgcGFyYW1zOiAkJFskMCAtIDJdLCBoYXNoOiAkJFskMCAtIDFdIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxMzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVCbG9jaygkJFskMCAtIDNdLCAkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMF0sIGZhbHNlLCB0aGlzLl8kKTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE0Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZUJsb2NrKCQkWyQwIC0gM10sICQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdHJ1ZSwgdGhpcy5fJCk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxNToNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgb3BlbjogJCRbJDAgLSA1XSwgcGF0aDogJCRbJDAgLSA0XSwgcGFyYW1zOiAkJFskMCAtIDNdLCBoYXNoOiAkJFskMCAtIDJdLCBibG9ja1BhcmFtczogJCRbJDAgLSAxXSwgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA1XSwgJCRbJDBdKSB9Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTY6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHBhdGg6ICQkWyQwIC0gNF0sIHBhcmFtczogJCRbJDAgLSAzXSwgaGFzaDogJCRbJDAgLSAyXSwgYmxvY2tQYXJhbXM6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNV0sICQkWyQwXSkgfTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE3Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBwYXRoOiAkJFskMCAtIDRdLCBwYXJhbXM6ICQkWyQwIC0gM10sIGhhc2g6ICQkWyQwIC0gMl0sIGJsb2NrUGFyYW1zOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDVdLCAkJFskMF0pIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxODoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSAxXSwgJCRbJDAgLSAxXSksIHByb2dyYW06ICQkWyQwXSB9Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTk6DQoJICAgICAgICAgICAgICAgICAgICB2YXIgaW52ZXJzZSA9IHl5LnByZXBhcmVCbG9jaygkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMF0sICQkWyQwXSwgZmFsc2UsIHRoaXMuXyQpLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyYW0gPSB5eS5wcmVwYXJlUHJvZ3JhbShbaW52ZXJzZV0sICQkWyQwIC0gMV0ubG9jKTsNCgkgICAgICAgICAgICAgICAgICAgIHByb2dyYW0uY2hhaW5lZCA9IHRydWU7DQoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgc3RyaXA6ICQkWyQwIC0gMl0uc3RyaXAsIHByb2dyYW06IHByb2dyYW0sIGNoYWluOiB0cnVlIH07DQoNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDIwOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjE6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHBhdGg6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gMl0sICQkWyQwXSkgfTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDIyOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZU11c3RhY2hlKCQkWyQwIC0gM10sICQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwIC0gNF0sIHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA0XSwgJCRbJDBdKSwgdGhpcy5fJCk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyMzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVNdXN0YWNoZSgkJFskMCAtIDNdLCAkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMCAtIDRdLCB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNF0sICQkWyQwXSksIHRoaXMuXyQpOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjQ6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BhcnRpYWxTdGF0ZW1lbnQnLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICQkWyQwIC0gM10sDQoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiAkJFskMCAtIDJdLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6ICQkWyQwIC0gMV0sDQoJICAgICAgICAgICAgICAgICAgICAgICAgaW5kZW50OiAnJywNCgkgICAgICAgICAgICAgICAgICAgICAgICBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDRdLCAkJFskMF0pLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKQ0KCSAgICAgICAgICAgICAgICAgICAgfTsNCg0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjU6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlUGFydGlhbEJsb2NrKCQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdGhpcy5fJCk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyNjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgcGF0aDogJCRbJDAgLSAzXSwgcGFyYW1zOiAkJFskMCAtIDJdLCBoYXNoOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDRdLCAkJFskMF0pIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyNzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDI4Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjk6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1N1YkV4cHJlc3Npb24nLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ICQkWyQwIC0gM10sDQoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiAkJFskMCAtIDJdLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6ICQkWyQwIC0gMV0sDQoJICAgICAgICAgICAgICAgICAgICAgICAgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpDQoJICAgICAgICAgICAgICAgICAgICB9Ow0KDQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzMDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ0hhc2gnLCBwYWlyczogJCRbJDBdLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDMxOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnSGFzaFBhaXInLCBrZXk6IHl5LmlkKCQkWyQwIC0gMl0pLCB2YWx1ZTogJCRbJDBdLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDMyOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkuaWQoJCRbJDAgLSAxXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzMzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDM0Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzU6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdTdHJpbmdMaXRlcmFsJywgdmFsdWU6ICQkWyQwXSwgb3JpZ2luYWw6ICQkWyQwXSwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzNjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ051bWJlckxpdGVyYWwnLCB2YWx1ZTogTnVtYmVyKCQkWyQwXSksIG9yaWdpbmFsOiBOdW1iZXIoJCRbJDBdKSwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzNzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ0Jvb2xlYW5MaXRlcmFsJywgdmFsdWU6ICQkWyQwXSA9PT0gJ3RydWUnLCBvcmlnaW5hbDogJCRbJDBdID09PSAndHJ1ZScsIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzg6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdVbmRlZmluZWRMaXRlcmFsJywgb3JpZ2luYWw6IHVuZGVmaW5lZCwgdmFsdWU6IHVuZGVmaW5lZCwgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzOToNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ051bGxMaXRlcmFsJywgb3JpZ2luYWw6IG51bGwsIHZhbHVlOiBudWxsLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQwOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDE6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA0MjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVQYXRoKHRydWUsICQkWyQwXSwgdGhpcy5fJCk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA0MzoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVQYXRoKGZhbHNlLCAkJFskMF0sIHRoaXMuXyQpOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDQ6DQoJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDJdLnB1c2goeyBwYXJ0OiB5eS5pZCgkJFskMF0pLCBvcmlnaW5hbDogJCRbJDBdLCBzZXBhcmF0b3I6ICQkWyQwIC0gMV0gfSk7dGhpcy4kID0gJCRbJDAgLSAyXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQ1Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW3sgcGFydDogeXkuaWQoJCRbJDBdKSwgb3JpZ2luYWw6ICQkWyQwXSB9XTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQ2Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA0NzoNCgkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDg6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbJCRbJDBdXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQ5Og0KCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA1MDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNTE6DQoJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDU4Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA1OToNCgkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNjQ6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDY1Og0KCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA3MDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNzE6DQoJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDc4Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA3OToNCgkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgODI6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDgzOg0KCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA4NjoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgODc6DQoJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDkwOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA5MToNCgkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgOTQ6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDk1Og0KCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA5ODoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFskJFskMF1dOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgOTk6DQoJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDEwMDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFskJFskMF1dOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTAxOg0KCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICB9DQoJICAgICAgICB9LA0KCSAgICAgICAgdGFibGU6IFt7IDM6IDEsIDQ6IDIsIDU6IFsyLCA0Nl0sIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDg6IFsyLCA0Nl0sIDUxOiBbMiwgNDZdLCA1NTogWzIsIDQ2XSwgNjA6IFsyLCA0Nl0gfSwgeyAxOiBbM10gfSwgeyA1OiBbMSwgNF0gfSwgeyA1OiBbMiwgMl0sIDc6IDUsIDg6IDYsIDk6IDcsIDEwOiA4LCAxMTogOSwgMTI6IDEwLCAxMzogMTEsIDE0OiBbMSwgMTJdLCAxNTogWzEsIDIwXSwgMTY6IDE3LCAxOTogWzEsIDIzXSwgMjQ6IDE1LCAyNzogMTYsIDI5OiBbMSwgMjFdLCAzNDogWzEsIDIyXSwgMzk6IFsyLCAyXSwgNDQ6IFsyLCAyXSwgNDc6IFsyLCAyXSwgNDg6IFsxLCAxM10sIDUxOiBbMSwgMTRdLCA1NTogWzEsIDE4XSwgNTk6IDE5LCA2MDogWzEsIDI0XSB9LCB7IDE6IFsyLCAxXSB9LCB7IDU6IFsyLCA0N10sIDE0OiBbMiwgNDddLCAxNTogWzIsIDQ3XSwgMTk6IFsyLCA0N10sIDI5OiBbMiwgNDddLCAzNDogWzIsIDQ3XSwgMzk6IFsyLCA0N10sIDQ0OiBbMiwgNDddLCA0NzogWzIsIDQ3XSwgNDg6IFsyLCA0N10sIDUxOiBbMiwgNDddLCA1NTogWzIsIDQ3XSwgNjA6IFsyLCA0N10gfSwgeyA1OiBbMiwgM10sIDE0OiBbMiwgM10sIDE1OiBbMiwgM10sIDE5OiBbMiwgM10sIDI5OiBbMiwgM10sIDM0OiBbMiwgM10sIDM5OiBbMiwgM10sIDQ0OiBbMiwgM10sIDQ3OiBbMiwgM10sIDQ4OiBbMiwgM10sIDUxOiBbMiwgM10sIDU1OiBbMiwgM10sIDYwOiBbMiwgM10gfSwgeyA1OiBbMiwgNF0sIDE0OiBbMiwgNF0sIDE1OiBbMiwgNF0sIDE5OiBbMiwgNF0sIDI5OiBbMiwgNF0sIDM0OiBbMiwgNF0sIDM5OiBbMiwgNF0sIDQ0OiBbMiwgNF0sIDQ3OiBbMiwgNF0sIDQ4OiBbMiwgNF0sIDUxOiBbMiwgNF0sIDU1OiBbMiwgNF0sIDYwOiBbMiwgNF0gfSwgeyA1OiBbMiwgNV0sIDE0OiBbMiwgNV0sIDE1OiBbMiwgNV0sIDE5OiBbMiwgNV0sIDI5OiBbMiwgNV0sIDM0OiBbMiwgNV0sIDM5OiBbMiwgNV0sIDQ0OiBbMiwgNV0sIDQ3OiBbMiwgNV0sIDQ4OiBbMiwgNV0sIDUxOiBbMiwgNV0sIDU1OiBbMiwgNV0sIDYwOiBbMiwgNV0gfSwgeyA1OiBbMiwgNl0sIDE0OiBbMiwgNl0sIDE1OiBbMiwgNl0sIDE5OiBbMiwgNl0sIDI5OiBbMiwgNl0sIDM0OiBbMiwgNl0sIDM5OiBbMiwgNl0sIDQ0OiBbMiwgNl0sIDQ3OiBbMiwgNl0sIDQ4OiBbMiwgNl0sIDUxOiBbMiwgNl0sIDU1OiBbMiwgNl0sIDYwOiBbMiwgNl0gfSwgeyA1OiBbMiwgN10sIDE0OiBbMiwgN10sIDE1OiBbMiwgN10sIDE5OiBbMiwgN10sIDI5OiBbMiwgN10sIDM0OiBbMiwgN10sIDM5OiBbMiwgN10sIDQ0OiBbMiwgN10sIDQ3OiBbMiwgN10sIDQ4OiBbMiwgN10sIDUxOiBbMiwgN10sIDU1OiBbMiwgN10sIDYwOiBbMiwgN10gfSwgeyA1OiBbMiwgOF0sIDE0OiBbMiwgOF0sIDE1OiBbMiwgOF0sIDE5OiBbMiwgOF0sIDI5OiBbMiwgOF0sIDM0OiBbMiwgOF0sIDM5OiBbMiwgOF0sIDQ0OiBbMiwgOF0sIDQ3OiBbMiwgOF0sIDQ4OiBbMiwgOF0sIDUxOiBbMiwgOF0sIDU1OiBbMiwgOF0sIDYwOiBbMiwgOF0gfSwgeyA1OiBbMiwgOV0sIDE0OiBbMiwgOV0sIDE1OiBbMiwgOV0sIDE5OiBbMiwgOV0sIDI5OiBbMiwgOV0sIDM0OiBbMiwgOV0sIDM5OiBbMiwgOV0sIDQ0OiBbMiwgOV0sIDQ3OiBbMiwgOV0sIDQ4OiBbMiwgOV0sIDUxOiBbMiwgOV0sIDU1OiBbMiwgOV0sIDYwOiBbMiwgOV0gfSwgeyAyMDogMjUsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDM2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDM3LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDM5OiBbMiwgNDZdLCA0NDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgNDogMzgsIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDEzOiA0MCwgMTU6IFsxLCAyMF0sIDE3OiAzOSB9LCB7IDIwOiA0MiwgNTY6IDQxLCA2NDogNDMsIDY1OiBbMSwgNDRdLCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDQ1LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDU6IFsyLCAxMF0sIDE0OiBbMiwgMTBdLCAxNTogWzIsIDEwXSwgMTg6IFsyLCAxMF0sIDE5OiBbMiwgMTBdLCAyOTogWzIsIDEwXSwgMzQ6IFsyLCAxMF0sIDM5OiBbMiwgMTBdLCA0NDogWzIsIDEwXSwgNDc6IFsyLCAxMF0sIDQ4OiBbMiwgMTBdLCA1MTogWzIsIDEwXSwgNTU6IFsyLCAxMF0sIDYwOiBbMiwgMTBdIH0sIHsgMjA6IDQ2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA0NywgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNDgsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDQyLCA1NjogNDksIDY0OiA0MywgNjU6IFsxLCA0NF0sIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMzM6IFsyLCA3OF0sIDQ5OiA1MCwgNjU6IFsyLCA3OF0sIDcyOiBbMiwgNzhdLCA4MDogWzIsIDc4XSwgODE6IFsyLCA3OF0sIDgyOiBbMiwgNzhdLCA4MzogWzIsIDc4XSwgODQ6IFsyLCA3OF0sIDg1OiBbMiwgNzhdIH0sIHsgMjM6IFsyLCAzM10sIDMzOiBbMiwgMzNdLCA1NDogWzIsIDMzXSwgNjU6IFsyLCAzM10sIDY4OiBbMiwgMzNdLCA3MjogWzIsIDMzXSwgNzU6IFsyLCAzM10sIDgwOiBbMiwgMzNdLCA4MTogWzIsIDMzXSwgODI6IFsyLCAzM10sIDgzOiBbMiwgMzNdLCA4NDogWzIsIDMzXSwgODU6IFsyLCAzM10gfSwgeyAyMzogWzIsIDM0XSwgMzM6IFsyLCAzNF0sIDU0OiBbMiwgMzRdLCA2NTogWzIsIDM0XSwgNjg6IFsyLCAzNF0sIDcyOiBbMiwgMzRdLCA3NTogWzIsIDM0XSwgODA6IFsyLCAzNF0sIDgxOiBbMiwgMzRdLCA4MjogWzIsIDM0XSwgODM6IFsyLCAzNF0sIDg0OiBbMiwgMzRdLCA4NTogWzIsIDM0XSB9LCB7IDIzOiBbMiwgMzVdLCAzMzogWzIsIDM1XSwgNTQ6IFsyLCAzNV0sIDY1OiBbMiwgMzVdLCA2ODogWzIsIDM1XSwgNzI6IFsyLCAzNV0sIDc1OiBbMiwgMzVdLCA4MDogWzIsIDM1XSwgODE6IFsyLCAzNV0sIDgyOiBbMiwgMzVdLCA4MzogWzIsIDM1XSwgODQ6IFsyLCAzNV0sIDg1OiBbMiwgMzVdIH0sIHsgMjM6IFsyLCAzNl0sIDMzOiBbMiwgMzZdLCA1NDogWzIsIDM2XSwgNjU6IFsyLCAzNl0sIDY4OiBbMiwgMzZdLCA3MjogWzIsIDM2XSwgNzU6IFsyLCAzNl0sIDgwOiBbMiwgMzZdLCA4MTogWzIsIDM2XSwgODI6IFsyLCAzNl0sIDgzOiBbMiwgMzZdLCA4NDogWzIsIDM2XSwgODU6IFsyLCAzNl0gfSwgeyAyMzogWzIsIDM3XSwgMzM6IFsyLCAzN10sIDU0OiBbMiwgMzddLCA2NTogWzIsIDM3XSwgNjg6IFsyLCAzN10sIDcyOiBbMiwgMzddLCA3NTogWzIsIDM3XSwgODA6IFsyLCAzN10sIDgxOiBbMiwgMzddLCA4MjogWzIsIDM3XSwgODM6IFsyLCAzN10sIDg0OiBbMiwgMzddLCA4NTogWzIsIDM3XSB9LCB7IDIzOiBbMiwgMzhdLCAzMzogWzIsIDM4XSwgNTQ6IFsyLCAzOF0sIDY1OiBbMiwgMzhdLCA2ODogWzIsIDM4XSwgNzI6IFsyLCAzOF0sIDc1OiBbMiwgMzhdLCA4MDogWzIsIDM4XSwgODE6IFsyLCAzOF0sIDgyOiBbMiwgMzhdLCA4MzogWzIsIDM4XSwgODQ6IFsyLCAzOF0sIDg1OiBbMiwgMzhdIH0sIHsgMjM6IFsyLCAzOV0sIDMzOiBbMiwgMzldLCA1NDogWzIsIDM5XSwgNjU6IFsyLCAzOV0sIDY4OiBbMiwgMzldLCA3MjogWzIsIDM5XSwgNzU6IFsyLCAzOV0sIDgwOiBbMiwgMzldLCA4MTogWzIsIDM5XSwgODI6IFsyLCAzOV0sIDgzOiBbMiwgMzldLCA4NDogWzIsIDM5XSwgODU6IFsyLCAzOV0gfSwgeyAyMzogWzIsIDQzXSwgMzM6IFsyLCA0M10sIDU0OiBbMiwgNDNdLCA2NTogWzIsIDQzXSwgNjg6IFsyLCA0M10sIDcyOiBbMiwgNDNdLCA3NTogWzIsIDQzXSwgODA6IFsyLCA0M10sIDgxOiBbMiwgNDNdLCA4MjogWzIsIDQzXSwgODM6IFsyLCA0M10sIDg0OiBbMiwgNDNdLCA4NTogWzIsIDQzXSwgODc6IFsxLCA1MV0gfSwgeyA3MjogWzEsIDM1XSwgODY6IDUyIH0sIHsgMjM6IFsyLCA0NV0sIDMzOiBbMiwgNDVdLCA1NDogWzIsIDQ1XSwgNjU6IFsyLCA0NV0sIDY4OiBbMiwgNDVdLCA3MjogWzIsIDQ1XSwgNzU6IFsyLCA0NV0sIDgwOiBbMiwgNDVdLCA4MTogWzIsIDQ1XSwgODI6IFsyLCA0NV0sIDgzOiBbMiwgNDVdLCA4NDogWzIsIDQ1XSwgODU6IFsyLCA0NV0sIDg3OiBbMiwgNDVdIH0sIHsgNTI6IDUzLCA1NDogWzIsIDgyXSwgNjU6IFsyLCA4Ml0sIDcyOiBbMiwgODJdLCA4MDogWzIsIDgyXSwgODE6IFsyLCA4Ml0sIDgyOiBbMiwgODJdLCA4MzogWzIsIDgyXSwgODQ6IFsyLCA4Ml0sIDg1OiBbMiwgODJdIH0sIHsgMjU6IDU0LCAzODogNTYsIDM5OiBbMSwgNThdLCA0MzogNTcsIDQ0OiBbMSwgNTldLCA0NTogNTUsIDQ3OiBbMiwgNTRdIH0sIHsgMjg6IDYwLCA0MzogNjEsIDQ0OiBbMSwgNTldLCA0NzogWzIsIDU2XSB9LCB7IDEzOiA2MywgMTU6IFsxLCAyMF0sIDE4OiBbMSwgNjJdIH0sIHsgMTU6IFsyLCA0OF0sIDE4OiBbMiwgNDhdIH0sIHsgMzM6IFsyLCA4Nl0sIDU3OiA2NCwgNjU6IFsyLCA4Nl0sIDcyOiBbMiwgODZdLCA4MDogWzIsIDg2XSwgODE6IFsyLCA4Nl0sIDgyOiBbMiwgODZdLCA4MzogWzIsIDg2XSwgODQ6IFsyLCA4Nl0sIDg1OiBbMiwgODZdIH0sIHsgMzM6IFsyLCA0MF0sIDY1OiBbMiwgNDBdLCA3MjogWzIsIDQwXSwgODA6IFsyLCA0MF0sIDgxOiBbMiwgNDBdLCA4MjogWzIsIDQwXSwgODM6IFsyLCA0MF0sIDg0OiBbMiwgNDBdLCA4NTogWzIsIDQwXSB9LCB7IDMzOiBbMiwgNDFdLCA2NTogWzIsIDQxXSwgNzI6IFsyLCA0MV0sIDgwOiBbMiwgNDFdLCA4MTogWzIsIDQxXSwgODI6IFsyLCA0MV0sIDgzOiBbMiwgNDFdLCA4NDogWzIsIDQxXSwgODU6IFsyLCA0MV0gfSwgeyAyMDogNjUsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjY6IDY2LCA0NzogWzEsIDY3XSB9LCB7IDMwOiA2OCwgMzM6IFsyLCA1OF0sIDY1OiBbMiwgNThdLCA3MjogWzIsIDU4XSwgNzU6IFsyLCA1OF0sIDgwOiBbMiwgNThdLCA4MTogWzIsIDU4XSwgODI6IFsyLCA1OF0sIDgzOiBbMiwgNThdLCA4NDogWzIsIDU4XSwgODU6IFsyLCA1OF0gfSwgeyAzMzogWzIsIDY0XSwgMzU6IDY5LCA2NTogWzIsIDY0XSwgNzI6IFsyLCA2NF0sIDc1OiBbMiwgNjRdLCA4MDogWzIsIDY0XSwgODE6IFsyLCA2NF0sIDgyOiBbMiwgNjRdLCA4MzogWzIsIDY0XSwgODQ6IFsyLCA2NF0sIDg1OiBbMiwgNjRdIH0sIHsgMjE6IDcwLCAyMzogWzIsIDUwXSwgNjU6IFsyLCA1MF0sIDcyOiBbMiwgNTBdLCA4MDogWzIsIDUwXSwgODE6IFsyLCA1MF0sIDgyOiBbMiwgNTBdLCA4MzogWzIsIDUwXSwgODQ6IFsyLCA1MF0sIDg1OiBbMiwgNTBdIH0sIHsgMzM6IFsyLCA5MF0sIDYxOiA3MSwgNjU6IFsyLCA5MF0sIDcyOiBbMiwgOTBdLCA4MDogWzIsIDkwXSwgODE6IFsyLCA5MF0sIDgyOiBbMiwgOTBdLCA4MzogWzIsIDkwXSwgODQ6IFsyLCA5MF0sIDg1OiBbMiwgOTBdIH0sIHsgMjA6IDc1LCAzMzogWzIsIDgwXSwgNTA6IDcyLCA2MzogNzMsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY5OiA3NCwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgNzI6IFsxLCA4MF0gfSwgeyAyMzogWzIsIDQyXSwgMzM6IFsyLCA0Ml0sIDU0OiBbMiwgNDJdLCA2NTogWzIsIDQyXSwgNjg6IFsyLCA0Ml0sIDcyOiBbMiwgNDJdLCA3NTogWzIsIDQyXSwgODA6IFsyLCA0Ml0sIDgxOiBbMiwgNDJdLCA4MjogWzIsIDQyXSwgODM6IFsyLCA0Ml0sIDg0OiBbMiwgNDJdLCA4NTogWzIsIDQyXSwgODc6IFsxLCA1MV0gfSwgeyAyMDogNzUsIDUzOiA4MSwgNTQ6IFsyLCA4NF0sIDYzOiA4MiwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDgzLCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyNjogODQsIDQ3OiBbMSwgNjddIH0sIHsgNDc6IFsyLCA1NV0gfSwgeyA0OiA4NSwgNjogMywgMTQ6IFsyLCA0Nl0sIDE1OiBbMiwgNDZdLCAxOTogWzIsIDQ2XSwgMjk6IFsyLCA0Nl0sIDM0OiBbMiwgNDZdLCAzOTogWzIsIDQ2XSwgNDQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDQ3OiBbMiwgMjBdIH0sIHsgMjA6IDg2LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDQ6IDg3LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDQ3OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDI2OiA4OCwgNDc6IFsxLCA2N10gfSwgeyA0NzogWzIsIDU3XSB9LCB7IDU6IFsyLCAxMV0sIDE0OiBbMiwgMTFdLCAxNTogWzIsIDExXSwgMTk6IFsyLCAxMV0sIDI5OiBbMiwgMTFdLCAzNDogWzIsIDExXSwgMzk6IFsyLCAxMV0sIDQ0OiBbMiwgMTFdLCA0NzogWzIsIDExXSwgNDg6IFsyLCAxMV0sIDUxOiBbMiwgMTFdLCA1NTogWzIsIDExXSwgNjA6IFsyLCAxMV0gfSwgeyAxNTogWzIsIDQ5XSwgMTg6IFsyLCA0OV0gfSwgeyAyMDogNzUsIDMzOiBbMiwgODhdLCA1ODogODksIDYzOiA5MCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDkxLCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA2NTogWzIsIDk0XSwgNjY6IDkyLCA2ODogWzIsIDk0XSwgNzI6IFsyLCA5NF0sIDgwOiBbMiwgOTRdLCA4MTogWzIsIDk0XSwgODI6IFsyLCA5NF0sIDgzOiBbMiwgOTRdLCA4NDogWzIsIDk0XSwgODU6IFsyLCA5NF0gfSwgeyA1OiBbMiwgMjVdLCAxNDogWzIsIDI1XSwgMTU6IFsyLCAyNV0sIDE5OiBbMiwgMjVdLCAyOTogWzIsIDI1XSwgMzQ6IFsyLCAyNV0sIDM5OiBbMiwgMjVdLCA0NDogWzIsIDI1XSwgNDc6IFsyLCAyNV0sIDQ4OiBbMiwgMjVdLCA1MTogWzIsIDI1XSwgNTU6IFsyLCAyNV0sIDYwOiBbMiwgMjVdIH0sIHsgMjA6IDkzLCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA3NSwgMzE6IDk0LCAzMzogWzIsIDYwXSwgNjM6IDk1LCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogOTYsIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzU6IFsyLCA2MF0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNzUsIDMzOiBbMiwgNjZdLCAzNjogOTcsIDYzOiA5OCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDk5LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc1OiBbMiwgNjZdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDc1LCAyMjogMTAwLCAyMzogWzIsIDUyXSwgNjM6IDEwMSwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDEwMiwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDc1LCAzMzogWzIsIDkyXSwgNjI6IDEwMywgNjM6IDEwNCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDEwNSwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMzM6IFsxLCAxMDZdIH0sIHsgMzM6IFsyLCA3OV0sIDY1OiBbMiwgNzldLCA3MjogWzIsIDc5XSwgODA6IFsyLCA3OV0sIDgxOiBbMiwgNzldLCA4MjogWzIsIDc5XSwgODM6IFsyLCA3OV0sIDg0OiBbMiwgNzldLCA4NTogWzIsIDc5XSB9LCB7IDMzOiBbMiwgODFdIH0sIHsgMjM6IFsyLCAyN10sIDMzOiBbMiwgMjddLCA1NDogWzIsIDI3XSwgNjU6IFsyLCAyN10sIDY4OiBbMiwgMjddLCA3MjogWzIsIDI3XSwgNzU6IFsyLCAyN10sIDgwOiBbMiwgMjddLCA4MTogWzIsIDI3XSwgODI6IFsyLCAyN10sIDgzOiBbMiwgMjddLCA4NDogWzIsIDI3XSwgODU6IFsyLCAyN10gfSwgeyAyMzogWzIsIDI4XSwgMzM6IFsyLCAyOF0sIDU0OiBbMiwgMjhdLCA2NTogWzIsIDI4XSwgNjg6IFsyLCAyOF0sIDcyOiBbMiwgMjhdLCA3NTogWzIsIDI4XSwgODA6IFsyLCAyOF0sIDgxOiBbMiwgMjhdLCA4MjogWzIsIDI4XSwgODM6IFsyLCAyOF0sIDg0OiBbMiwgMjhdLCA4NTogWzIsIDI4XSB9LCB7IDIzOiBbMiwgMzBdLCAzMzogWzIsIDMwXSwgNTQ6IFsyLCAzMF0sIDY4OiBbMiwgMzBdLCA3MTogMTA3LCA3MjogWzEsIDEwOF0sIDc1OiBbMiwgMzBdIH0sIHsgMjM6IFsyLCA5OF0sIDMzOiBbMiwgOThdLCA1NDogWzIsIDk4XSwgNjg6IFsyLCA5OF0sIDcyOiBbMiwgOThdLCA3NTogWzIsIDk4XSB9LCB7IDIzOiBbMiwgNDVdLCAzMzogWzIsIDQ1XSwgNTQ6IFsyLCA0NV0sIDY1OiBbMiwgNDVdLCA2ODogWzIsIDQ1XSwgNzI6IFsyLCA0NV0sIDczOiBbMSwgMTA5XSwgNzU6IFsyLCA0NV0sIDgwOiBbMiwgNDVdLCA4MTogWzIsIDQ1XSwgODI6IFsyLCA0NV0sIDgzOiBbMiwgNDVdLCA4NDogWzIsIDQ1XSwgODU6IFsyLCA0NV0sIDg3OiBbMiwgNDVdIH0sIHsgMjM6IFsyLCA0NF0sIDMzOiBbMiwgNDRdLCA1NDogWzIsIDQ0XSwgNjU6IFsyLCA0NF0sIDY4OiBbMiwgNDRdLCA3MjogWzIsIDQ0XSwgNzU6IFsyLCA0NF0sIDgwOiBbMiwgNDRdLCA4MTogWzIsIDQ0XSwgODI6IFsyLCA0NF0sIDgzOiBbMiwgNDRdLCA4NDogWzIsIDQ0XSwgODU6IFsyLCA0NF0sIDg3OiBbMiwgNDRdIH0sIHsgNTQ6IFsxLCAxMTBdIH0sIHsgNTQ6IFsyLCA4M10sIDY1OiBbMiwgODNdLCA3MjogWzIsIDgzXSwgODA6IFsyLCA4M10sIDgxOiBbMiwgODNdLCA4MjogWzIsIDgzXSwgODM6IFsyLCA4M10sIDg0OiBbMiwgODNdLCA4NTogWzIsIDgzXSB9LCB7IDU0OiBbMiwgODVdIH0sIHsgNTogWzIsIDEzXSwgMTQ6IFsyLCAxM10sIDE1OiBbMiwgMTNdLCAxOTogWzIsIDEzXSwgMjk6IFsyLCAxM10sIDM0OiBbMiwgMTNdLCAzOTogWzIsIDEzXSwgNDQ6IFsyLCAxM10sIDQ3OiBbMiwgMTNdLCA0ODogWzIsIDEzXSwgNTE6IFsyLCAxM10sIDU1OiBbMiwgMTNdLCA2MDogWzIsIDEzXSB9LCB7IDM4OiA1NiwgMzk6IFsxLCA1OF0sIDQzOiA1NywgNDQ6IFsxLCA1OV0sIDQ1OiAxMTIsIDQ2OiAxMTEsIDQ3OiBbMiwgNzZdIH0sIHsgMzM6IFsyLCA3MF0sIDQwOiAxMTMsIDY1OiBbMiwgNzBdLCA3MjogWzIsIDcwXSwgNzU6IFsyLCA3MF0sIDgwOiBbMiwgNzBdLCA4MTogWzIsIDcwXSwgODI6IFsyLCA3MF0sIDgzOiBbMiwgNzBdLCA4NDogWzIsIDcwXSwgODU6IFsyLCA3MF0gfSwgeyA0NzogWzIsIDE4XSB9LCB7IDU6IFsyLCAxNF0sIDE0OiBbMiwgMTRdLCAxNTogWzIsIDE0XSwgMTk6IFsyLCAxNF0sIDI5OiBbMiwgMTRdLCAzNDogWzIsIDE0XSwgMzk6IFsyLCAxNF0sIDQ0OiBbMiwgMTRdLCA0NzogWzIsIDE0XSwgNDg6IFsyLCAxNF0sIDUxOiBbMiwgMTRdLCA1NTogWzIsIDE0XSwgNjA6IFsyLCAxNF0gfSwgeyAzMzogWzEsIDExNF0gfSwgeyAzMzogWzIsIDg3XSwgNjU6IFsyLCA4N10sIDcyOiBbMiwgODddLCA4MDogWzIsIDg3XSwgODE6IFsyLCA4N10sIDgyOiBbMiwgODddLCA4MzogWzIsIDg3XSwgODQ6IFsyLCA4N10sIDg1OiBbMiwgODddIH0sIHsgMzM6IFsyLCA4OV0gfSwgeyAyMDogNzUsIDYzOiAxMTYsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY3OiAxMTUsIDY4OiBbMiwgOTZdLCA2OTogMTE3LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAzMzogWzEsIDExOF0gfSwgeyAzMjogMTE5LCAzMzogWzIsIDYyXSwgNzQ6IDEyMCwgNzU6IFsxLCAxMjFdIH0sIHsgMzM6IFsyLCA1OV0sIDY1OiBbMiwgNTldLCA3MjogWzIsIDU5XSwgNzU6IFsyLCA1OV0sIDgwOiBbMiwgNTldLCA4MTogWzIsIDU5XSwgODI6IFsyLCA1OV0sIDgzOiBbMiwgNTldLCA4NDogWzIsIDU5XSwgODU6IFsyLCA1OV0gfSwgeyAzMzogWzIsIDYxXSwgNzU6IFsyLCA2MV0gfSwgeyAzMzogWzIsIDY4XSwgMzc6IDEyMiwgNzQ6IDEyMywgNzU6IFsxLCAxMjFdIH0sIHsgMzM6IFsyLCA2NV0sIDY1OiBbMiwgNjVdLCA3MjogWzIsIDY1XSwgNzU6IFsyLCA2NV0sIDgwOiBbMiwgNjVdLCA4MTogWzIsIDY1XSwgODI6IFsyLCA2NV0sIDgzOiBbMiwgNjVdLCA4NDogWzIsIDY1XSwgODU6IFsyLCA2NV0gfSwgeyAzMzogWzIsIDY3XSwgNzU6IFsyLCA2N10gfSwgeyAyMzogWzEsIDEyNF0gfSwgeyAyMzogWzIsIDUxXSwgNjU6IFsyLCA1MV0sIDcyOiBbMiwgNTFdLCA4MDogWzIsIDUxXSwgODE6IFsyLCA1MV0sIDgyOiBbMiwgNTFdLCA4MzogWzIsIDUxXSwgODQ6IFsyLCA1MV0sIDg1OiBbMiwgNTFdIH0sIHsgMjM6IFsyLCA1M10gfSwgeyAzMzogWzEsIDEyNV0gfSwgeyAzMzogWzIsIDkxXSwgNjU6IFsyLCA5MV0sIDcyOiBbMiwgOTFdLCA4MDogWzIsIDkxXSwgODE6IFsyLCA5MV0sIDgyOiBbMiwgOTFdLCA4MzogWzIsIDkxXSwgODQ6IFsyLCA5MV0sIDg1OiBbMiwgOTFdIH0sIHsgMzM6IFsyLCA5M10gfSwgeyA1OiBbMiwgMjJdLCAxNDogWzIsIDIyXSwgMTU6IFsyLCAyMl0sIDE5OiBbMiwgMjJdLCAyOTogWzIsIDIyXSwgMzQ6IFsyLCAyMl0sIDM5OiBbMiwgMjJdLCA0NDogWzIsIDIyXSwgNDc6IFsyLCAyMl0sIDQ4OiBbMiwgMjJdLCA1MTogWzIsIDIyXSwgNTU6IFsyLCAyMl0sIDYwOiBbMiwgMjJdIH0sIHsgMjM6IFsyLCA5OV0sIDMzOiBbMiwgOTldLCA1NDogWzIsIDk5XSwgNjg6IFsyLCA5OV0sIDcyOiBbMiwgOTldLCA3NTogWzIsIDk5XSB9LCB7IDczOiBbMSwgMTA5XSB9LCB7IDIwOiA3NSwgNjM6IDEyNiwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA1OiBbMiwgMjNdLCAxNDogWzIsIDIzXSwgMTU6IFsyLCAyM10sIDE5OiBbMiwgMjNdLCAyOTogWzIsIDIzXSwgMzQ6IFsyLCAyM10sIDM5OiBbMiwgMjNdLCA0NDogWzIsIDIzXSwgNDc6IFsyLCAyM10sIDQ4OiBbMiwgMjNdLCA1MTogWzIsIDIzXSwgNTU6IFsyLCAyM10sIDYwOiBbMiwgMjNdIH0sIHsgNDc6IFsyLCAxOV0gfSwgeyA0NzogWzIsIDc3XSB9LCB7IDIwOiA3NSwgMzM6IFsyLCA3Ml0sIDQxOiAxMjcsIDYzOiAxMjgsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY5OiAxMjksIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzU6IFsyLCA3Ml0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA1OiBbMiwgMjRdLCAxNDogWzIsIDI0XSwgMTU6IFsyLCAyNF0sIDE5OiBbMiwgMjRdLCAyOTogWzIsIDI0XSwgMzQ6IFsyLCAyNF0sIDM5OiBbMiwgMjRdLCA0NDogWzIsIDI0XSwgNDc6IFsyLCAyNF0sIDQ4OiBbMiwgMjRdLCA1MTogWzIsIDI0XSwgNTU6IFsyLCAyNF0sIDYwOiBbMiwgMjRdIH0sIHsgNjg6IFsxLCAxMzBdIH0sIHsgNjU6IFsyLCA5NV0sIDY4OiBbMiwgOTVdLCA3MjogWzIsIDk1XSwgODA6IFsyLCA5NV0sIDgxOiBbMiwgOTVdLCA4MjogWzIsIDk1XSwgODM6IFsyLCA5NV0sIDg0OiBbMiwgOTVdLCA4NTogWzIsIDk1XSB9LCB7IDY4OiBbMiwgOTddIH0sIHsgNTogWzIsIDIxXSwgMTQ6IFsyLCAyMV0sIDE1OiBbMiwgMjFdLCAxOTogWzIsIDIxXSwgMjk6IFsyLCAyMV0sIDM0OiBbMiwgMjFdLCAzOTogWzIsIDIxXSwgNDQ6IFsyLCAyMV0sIDQ3OiBbMiwgMjFdLCA0ODogWzIsIDIxXSwgNTE6IFsyLCAyMV0sIDU1OiBbMiwgMjFdLCA2MDogWzIsIDIxXSB9LCB7IDMzOiBbMSwgMTMxXSB9LCB7IDMzOiBbMiwgNjNdIH0sIHsgNzI6IFsxLCAxMzNdLCA3NjogMTMyIH0sIHsgMzM6IFsxLCAxMzRdIH0sIHsgMzM6IFsyLCA2OV0gfSwgeyAxNTogWzIsIDEyXSB9LCB7IDE0OiBbMiwgMjZdLCAxNTogWzIsIDI2XSwgMTk6IFsyLCAyNl0sIDI5OiBbMiwgMjZdLCAzNDogWzIsIDI2XSwgNDc6IFsyLCAyNl0sIDQ4OiBbMiwgMjZdLCA1MTogWzIsIDI2XSwgNTU6IFsyLCAyNl0sIDYwOiBbMiwgMjZdIH0sIHsgMjM6IFsyLCAzMV0sIDMzOiBbMiwgMzFdLCA1NDogWzIsIDMxXSwgNjg6IFsyLCAzMV0sIDcyOiBbMiwgMzFdLCA3NTogWzIsIDMxXSB9LCB7IDMzOiBbMiwgNzRdLCA0MjogMTM1LCA3NDogMTM2LCA3NTogWzEsIDEyMV0gfSwgeyAzMzogWzIsIDcxXSwgNjU6IFsyLCA3MV0sIDcyOiBbMiwgNzFdLCA3NTogWzIsIDcxXSwgODA6IFsyLCA3MV0sIDgxOiBbMiwgNzFdLCA4MjogWzIsIDcxXSwgODM6IFsyLCA3MV0sIDg0OiBbMiwgNzFdLCA4NTogWzIsIDcxXSB9LCB7IDMzOiBbMiwgNzNdLCA3NTogWzIsIDczXSB9LCB7IDIzOiBbMiwgMjldLCAzMzogWzIsIDI5XSwgNTQ6IFsyLCAyOV0sIDY1OiBbMiwgMjldLCA2ODogWzIsIDI5XSwgNzI6IFsyLCAyOV0sIDc1OiBbMiwgMjldLCA4MDogWzIsIDI5XSwgODE6IFsyLCAyOV0sIDgyOiBbMiwgMjldLCA4MzogWzIsIDI5XSwgODQ6IFsyLCAyOV0sIDg1OiBbMiwgMjldIH0sIHsgMTQ6IFsyLCAxNV0sIDE1OiBbMiwgMTVdLCAxOTogWzIsIDE1XSwgMjk6IFsyLCAxNV0sIDM0OiBbMiwgMTVdLCAzOTogWzIsIDE1XSwgNDQ6IFsyLCAxNV0sIDQ3OiBbMiwgMTVdLCA0ODogWzIsIDE1XSwgNTE6IFsyLCAxNV0sIDU1OiBbMiwgMTVdLCA2MDogWzIsIDE1XSB9LCB7IDcyOiBbMSwgMTM4XSwgNzc6IFsxLCAxMzddIH0sIHsgNzI6IFsyLCAxMDBdLCA3NzogWzIsIDEwMF0gfSwgeyAxNDogWzIsIDE2XSwgMTU6IFsyLCAxNl0sIDE5OiBbMiwgMTZdLCAyOTogWzIsIDE2XSwgMzQ6IFsyLCAxNl0sIDQ0OiBbMiwgMTZdLCA0NzogWzIsIDE2XSwgNDg6IFsyLCAxNl0sIDUxOiBbMiwgMTZdLCA1NTogWzIsIDE2XSwgNjA6IFsyLCAxNl0gfSwgeyAzMzogWzEsIDEzOV0gfSwgeyAzMzogWzIsIDc1XSB9LCB7IDMzOiBbMiwgMzJdIH0sIHsgNzI6IFsyLCAxMDFdLCA3NzogWzIsIDEwMV0gfSwgeyAxNDogWzIsIDE3XSwgMTU6IFsyLCAxN10sIDE5OiBbMiwgMTddLCAyOTogWzIsIDE3XSwgMzQ6IFsyLCAxN10sIDM5OiBbMiwgMTddLCA0NDogWzIsIDE3XSwgNDc6IFsyLCAxN10sIDQ4OiBbMiwgMTddLCA1MTogWzIsIDE3XSwgNTU6IFsyLCAxN10sIDYwOiBbMiwgMTddIH1dLA0KCSAgICAgICAgZGVmYXVsdEFjdGlvbnM6IHsgNDogWzIsIDFdLCA1NTogWzIsIDU1XSwgNTc6IFsyLCAyMF0sIDYxOiBbMiwgNTddLCA3NDogWzIsIDgxXSwgODM6IFsyLCA4NV0sIDg3OiBbMiwgMThdLCA5MTogWzIsIDg5XSwgMTAyOiBbMiwgNTNdLCAxMDU6IFsyLCA5M10sIDExMTogWzIsIDE5XSwgMTEyOiBbMiwgNzddLCAxMTc6IFsyLCA5N10sIDEyMDogWzIsIDYzXSwgMTIzOiBbMiwgNjldLCAxMjQ6IFsyLCAxMl0sIDEzNjogWzIsIDc1XSwgMTM3OiBbMiwgMzJdIH0sDQoJICAgICAgICBwYXJzZUVycm9yOiBmdW5jdGlvbiBwYXJzZUVycm9yKHN0ciwgaGFzaCkgew0KCSAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihzdHIpOw0KCSAgICAgICAgfSwNCgkgICAgICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShpbnB1dCkgew0KCSAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcywNCgkgICAgICAgICAgICAgICAgc3RhY2sgPSBbMF0sDQoJICAgICAgICAgICAgICAgIHZzdGFjayA9IFtudWxsXSwNCgkgICAgICAgICAgICAgICAgbHN0YWNrID0gW10sDQoJICAgICAgICAgICAgICAgIHRhYmxlID0gdGhpcy50YWJsZSwNCgkgICAgICAgICAgICAgICAgeXl0ZXh0ID0gIiIsDQoJICAgICAgICAgICAgICAgIHl5bGluZW5vID0gMCwNCgkgICAgICAgICAgICAgICAgeXlsZW5nID0gMCwNCgkgICAgICAgICAgICAgICAgcmVjb3ZlcmluZyA9IDAsDQoJICAgICAgICAgICAgICAgIFRFUlJPUiA9IDIsDQoJICAgICAgICAgICAgICAgIEVPRiA9IDE7DQoJICAgICAgICAgICAgdGhpcy5sZXhlci5zZXRJbnB1dChpbnB1dCk7DQoJICAgICAgICAgICAgdGhpcy5sZXhlci55eSA9IHRoaXMueXk7DQoJICAgICAgICAgICAgdGhpcy55eS5sZXhlciA9IHRoaXMubGV4ZXI7DQoJICAgICAgICAgICAgdGhpcy55eS5wYXJzZXIgPSB0aGlzOw0KCSAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5sZXhlci55eWxsb2MgPT0gInVuZGVmaW5lZCIpIHRoaXMubGV4ZXIueXlsbG9jID0ge307DQoJICAgICAgICAgICAgdmFyIHl5bG9jID0gdGhpcy5sZXhlci55eWxsb2M7DQoJICAgICAgICAgICAgbHN0YWNrLnB1c2goeXlsb2MpOw0KCSAgICAgICAgICAgIHZhciByYW5nZXMgPSB0aGlzLmxleGVyLm9wdGlvbnMgJiYgdGhpcy5sZXhlci5vcHRpb25zLnJhbmdlczsNCgkgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMueXkucGFyc2VFcnJvciA9PT0gImZ1bmN0aW9uIikgdGhpcy5wYXJzZUVycm9yID0gdGhpcy55eS5wYXJzZUVycm9yOw0KCSAgICAgICAgICAgIGZ1bmN0aW9uIHBvcFN0YWNrKG4pIHsNCgkgICAgICAgICAgICAgICAgc3RhY2subGVuZ3RoID0gc3RhY2subGVuZ3RoIC0gMiAqIG47DQoJICAgICAgICAgICAgICAgIHZzdGFjay5sZW5ndGggPSB2c3RhY2subGVuZ3RoIC0gbjsNCgkgICAgICAgICAgICAgICAgbHN0YWNrLmxlbmd0aCA9IGxzdGFjay5sZW5ndGggLSBuOw0KCSAgICAgICAgICAgIH0NCgkgICAgICAgICAgICBmdW5jdGlvbiBsZXgoKSB7DQoJICAgICAgICAgICAgICAgIHZhciB0b2tlbjsNCgkgICAgICAgICAgICAgICAgdG9rZW4gPSBzZWxmLmxleGVyLmxleCgpIHx8IDE7DQoJICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdG9rZW4gIT09ICJudW1iZXIiKSB7DQoJICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYuc3ltYm9sc19bdG9rZW5dIHx8IHRva2VuOw0KCSAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjsNCgkgICAgICAgICAgICB9DQoJICAgICAgICAgICAgdmFyIHN5bWJvbCwNCgkgICAgICAgICAgICAgICAgcHJlRXJyb3JTeW1ib2wsDQoJICAgICAgICAgICAgICAgIHN0YXRlLA0KCSAgICAgICAgICAgICAgICBhY3Rpb24sDQoJICAgICAgICAgICAgICAgIGEsDQoJICAgICAgICAgICAgICAgIHIsDQoJICAgICAgICAgICAgICAgIHl5dmFsID0ge30sDQoJICAgICAgICAgICAgICAgIHAsDQoJICAgICAgICAgICAgICAgIGxlbiwNCgkgICAgICAgICAgICAgICAgbmV3U3RhdGUsDQoJICAgICAgICAgICAgICAgIGV4cGVjdGVkOw0KCSAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7DQoJICAgICAgICAgICAgICAgIHN0YXRlID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07DQoJICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlZmF1bHRBY3Rpb25zW3N0YXRlXSkgew0KCSAgICAgICAgICAgICAgICAgICAgYWN0aW9uID0gdGhpcy5kZWZhdWx0QWN0aW9uc1tzdGF0ZV07DQoJICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgICAgICAgICBpZiAoc3ltYm9sID09PSBudWxsIHx8IHR5cGVvZiBzeW1ib2wgPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2wgPSBsZXgoKTsNCgkgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IHRhYmxlW3N0YXRlXSAmJiB0YWJsZVtzdGF0ZV1bc3ltYm9sXTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gInVuZGVmaW5lZCIgfHwgIWFjdGlvbi5sZW5ndGggfHwgIWFjdGlvblswXSkgew0KCSAgICAgICAgICAgICAgICAgICAgdmFyIGVyclN0ciA9ICIiOw0KCSAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWNvdmVyaW5nKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQgPSBbXTsNCgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHAgaW4gdGFibGVbc3RhdGVdKSBpZiAodGhpcy50ZXJtaW5hbHNfW3BdICYmIHAgPiAyKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkLnB1c2goIiciICsgdGhpcy50ZXJtaW5hbHNfW3BdICsgIiciKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGV4ZXIuc2hvd1Bvc2l0aW9uKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICJQYXJzZSBlcnJvciBvbiBsaW5lICIgKyAoeXlsaW5lbm8gKyAxKSArICI6XG4iICsgdGhpcy5sZXhlci5zaG93UG9zaXRpb24oKSArICJcbkV4cGVjdGluZyAiICsgZXhwZWN0ZWQuam9pbigiLCAiKSArICIsIGdvdCAnIiArICh0aGlzLnRlcm1pbmFsc19bc3ltYm9sXSB8fCBzeW1ib2wpICsgIiciOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICJQYXJzZSBlcnJvciBvbiBsaW5lICIgKyAoeXlsaW5lbm8gKyAxKSArICI6IFVuZXhwZWN0ZWQgIiArIChzeW1ib2wgPT0gMSA/ICJlbmQgb2YgaW5wdXQiIDogIiciICsgKHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCkgKyAiJyIpOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlRXJyb3IoZXJyU3RyLCB7IHRleHQ6IHRoaXMubGV4ZXIubWF0Y2gsIHRva2VuOiB0aGlzLnRlcm1pbmFsc19bc3ltYm9sXSB8fCBzeW1ib2wsIGxpbmU6IHRoaXMubGV4ZXIueXlsaW5lbm8sIGxvYzogeXlsb2MsIGV4cGVjdGVkOiBleHBlY3RlZCB9KTsNCgkgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICBpZiAoYWN0aW9uWzBdIGluc3RhbmNlb2YgQXJyYXkgJiYgYWN0aW9uLmxlbmd0aCA+IDEpIHsNCgkgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUGFyc2UgRXJyb3I6IG11bHRpcGxlIGFjdGlvbnMgcG9zc2libGUgYXQgc3RhdGU6ICIgKyBzdGF0ZSArICIsIHRva2VuOiAiICsgc3ltYm9sKTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjdGlvblswXSkgew0KCSAgICAgICAgICAgICAgICAgICAgY2FzZSAxOg0KCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goc3ltYm9sKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB2c3RhY2sucHVzaCh0aGlzLmxleGVyLnl5dGV4dCk7DQoJICAgICAgICAgICAgICAgICAgICAgICAgbHN0YWNrLnB1c2godGhpcy5sZXhlci55eWxsb2MpOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goYWN0aW9uWzFdKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2wgPSBudWxsOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJlRXJyb3JTeW1ib2wpIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXlsZW5nID0gdGhpcy5sZXhlci55eWxlbmc7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl5dGV4dCA9IHRoaXMubGV4ZXIueXl0ZXh0Ow0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eWxpbmVubyA9IHRoaXMubGV4ZXIueXlsaW5lbm87DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl5bG9jID0gdGhpcy5sZXhlci55eWxsb2M7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWNvdmVyaW5nID4gMCkgcmVjb3ZlcmluZy0tOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IHByZUVycm9yU3ltYm9sOw0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVFcnJvclN5bWJvbCA9IG51bGw7DQoJICAgICAgICAgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICAgICAgY2FzZSAyOg0KCSAgICAgICAgICAgICAgICAgICAgICAgIGxlbiA9IHRoaXMucHJvZHVjdGlvbnNfW2FjdGlvblsxXV1bMV07DQoJICAgICAgICAgICAgICAgICAgICAgICAgeXl2YWwuJCA9IHZzdGFja1t2c3RhY2subGVuZ3RoIC0gbGVuXTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB5eXZhbC5fJCA9IHsgZmlyc3RfbGluZTogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5maXJzdF9saW5lLCBsYXN0X2xpbmU6IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gMV0ubGFzdF9saW5lLCBmaXJzdF9jb2x1bW46IGxzdGFja1tsc3RhY2subGVuZ3RoIC0gKGxlbiB8fCAxKV0uZmlyc3RfY29sdW1uLCBsYXN0X2NvbHVtbjogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAxXS5sYXN0X2NvbHVtbiB9Ow0KCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYW5nZXMpIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXl2YWwuXyQucmFuZ2UgPSBbbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5yYW5nZVswXSwgbHN0YWNrW2xzdGFjay5sZW5ndGggLSAxXS5yYW5nZVsxXV07DQoJICAgICAgICAgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB0aGlzLnBlcmZvcm1BY3Rpb24uY2FsbCh5eXZhbCwgeXl0ZXh0LCB5eWxlbmcsIHl5bGluZW5vLCB0aGlzLnl5LCBhY3Rpb25bMV0sIHZzdGFjaywgbHN0YWNrKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICJ1bmRlZmluZWQiKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGVuKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrID0gc3RhY2suc2xpY2UoMCwgLTEgKiBsZW4gKiAyKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnN0YWNrID0gdnN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbHN0YWNrID0gbHN0YWNrLnNsaWNlKDAsIC0xICogbGVuKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaCh0aGlzLnByb2R1Y3Rpb25zX1thY3Rpb25bMV1dWzBdKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB2c3RhY2sucHVzaCh5eXZhbC4kKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICBsc3RhY2sucHVzaCh5eXZhbC5fJCk7DQoJICAgICAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUgPSB0YWJsZVtzdGFja1tzdGFjay5sZW5ndGggLSAyXV1bc3RhY2tbc3RhY2subGVuZ3RoIC0gMV1dOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobmV3U3RhdGUpOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICAgICAgY2FzZSAzOg0KCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KCSAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgIHJldHVybiB0cnVlOw0KCSAgICAgICAgfQ0KCSAgICB9Ow0KCSAgICAvKiBKaXNvbiBnZW5lcmF0ZWQgbGV4ZXIgKi8NCgkgICAgdmFyIGxleGVyID0gKGZ1bmN0aW9uICgpIHsNCgkgICAgICAgIHZhciBsZXhlciA9IHsgRU9GOiAxLA0KCSAgICAgICAgICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoKSB7DQoJICAgICAgICAgICAgICAgIGlmICh0aGlzLnl5LnBhcnNlcikgew0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eS5wYXJzZXIucGFyc2VFcnJvcihzdHIsIGhhc2gpOw0KCSAgICAgICAgICAgICAgICB9IGVsc2Ugew0KCSAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHN0cik7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIHNldElucHV0OiBmdW5jdGlvbiBzZXRJbnB1dChpbnB1dCkgew0KCSAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dCA9IGlucHV0Ow0KCSAgICAgICAgICAgICAgICB0aGlzLl9tb3JlID0gdGhpcy5fbGVzcyA9IHRoaXMuZG9uZSA9IGZhbHNlOw0KCSAgICAgICAgICAgICAgICB0aGlzLnl5bGluZW5vID0gdGhpcy55eWxlbmcgPSAwOw0KCSAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMubWF0Y2hlZCA9IHRoaXMubWF0Y2ggPSAnJzsNCgkgICAgICAgICAgICAgICAgdGhpcy5jb25kaXRpb25TdGFjayA9IFsnSU5JVElBTCddOw0KCSAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYyA9IHsgZmlyc3RfbGluZTogMSwgZmlyc3RfY29sdW1uOiAwLCBsYXN0X2xpbmU6IDEsIGxhc3RfY29sdW1uOiAwIH07DQoJICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB0aGlzLnl5bGxvYy5yYW5nZSA9IFswLCAwXTsNCgkgICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSAwOw0KCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIGlucHV0OiBmdW5jdGlvbiBpbnB1dCgpIHsNCgkgICAgICAgICAgICAgICAgdmFyIGNoID0gdGhpcy5faW5wdXRbMF07DQoJICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ICs9IGNoOw0KCSAgICAgICAgICAgICAgICB0aGlzLnl5bGVuZysrOw0KCSAgICAgICAgICAgICAgICB0aGlzLm9mZnNldCsrOw0KCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoICs9IGNoOw0KCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoZWQgKz0gY2g7DQoJICAgICAgICAgICAgICAgIHZhciBsaW5lcyA9IGNoLm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTsNCgkgICAgICAgICAgICAgICAgaWYgKGxpbmVzKSB7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGluZW5vKys7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2xpbmUrKzsNCgkgICAgICAgICAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uKys7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHRoaXMueXlsbG9jLnJhbmdlWzFdKys7DQoNCgkgICAgICAgICAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9pbnB1dC5zbGljZSgxKTsNCgkgICAgICAgICAgICAgICAgcmV0dXJuIGNoOw0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgdW5wdXQ6IGZ1bmN0aW9uIHVucHV0KGNoKSB7DQoJICAgICAgICAgICAgICAgIHZhciBsZW4gPSBjaC5sZW5ndGg7DQoJICAgICAgICAgICAgICAgIHZhciBsaW5lcyA9IGNoLnNwbGl0KC8oPzpcclxuP3xcbikvZyk7DQoNCgkgICAgICAgICAgICAgICAgdGhpcy5faW5wdXQgPSBjaCArIHRoaXMuX2lucHV0Ow0KCSAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMueXl0ZXh0LnN1YnN0cigwLCB0aGlzLnl5dGV4dC5sZW5ndGggLSBsZW4gLSAxKTsNCgkgICAgICAgICAgICAgICAgLy90aGlzLnl5bGVuZyAtPSBsZW47DQoJICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0IC09IGxlbjsNCgkgICAgICAgICAgICAgICAgdmFyIG9sZExpbmVzID0gdGhpcy5tYXRjaC5zcGxpdCgvKD86XHJcbj98XG4pL2cpOw0KCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoID0gdGhpcy5tYXRjaC5zdWJzdHIoMCwgdGhpcy5tYXRjaC5sZW5ndGggLSAxKTsNCgkgICAgICAgICAgICAgICAgdGhpcy5tYXRjaGVkID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gMSk7DQoNCgkgICAgICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCAtIDEpIHRoaXMueXlsaW5lbm8gLT0gbGluZXMubGVuZ3RoIC0gMTsNCgkgICAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzLnl5bGxvYy5yYW5nZTsNCg0KCSAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYyA9IHsgZmlyc3RfbGluZTogdGhpcy55eWxsb2MuZmlyc3RfbGluZSwNCgkgICAgICAgICAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsDQoJICAgICAgICAgICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbiwNCgkgICAgICAgICAgICAgICAgICAgIGxhc3RfY29sdW1uOiBsaW5lcyA/IChsaW5lcy5sZW5ndGggPT09IG9sZExpbmVzLmxlbmd0aCA/IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbiA6IDApICsgb2xkTGluZXNbb2xkTGluZXMubGVuZ3RoIC0gbGluZXMubGVuZ3RoXS5sZW5ndGggLSBsaW5lc1swXS5sZW5ndGggOiB0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4gLSBsZW4NCgkgICAgICAgICAgICAgICAgfTsNCg0KCSAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykgew0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MucmFuZ2UgPSBbclswXSwgclswXSArIHRoaXMueXlsZW5nIC0gbGVuXTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIG1vcmU6IGZ1bmN0aW9uIG1vcmUoKSB7DQoJICAgICAgICAgICAgICAgIHRoaXMuX21vcmUgPSB0cnVlOw0KCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIGxlc3M6IGZ1bmN0aW9uIGxlc3Mobikgew0KCSAgICAgICAgICAgICAgICB0aGlzLnVucHV0KHRoaXMubWF0Y2guc2xpY2UobikpOw0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgcGFzdElucHV0OiBmdW5jdGlvbiBwYXN0SW5wdXQoKSB7DQoJICAgICAgICAgICAgICAgIHZhciBwYXN0ID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gdGhpcy5tYXRjaC5sZW5ndGgpOw0KCSAgICAgICAgICAgICAgICByZXR1cm4gKHBhc3QubGVuZ3RoID4gMjAgPyAnLi4uJyA6ICcnKSArIHBhc3Quc3Vic3RyKC0yMCkucmVwbGFjZSgvXG4vZywgIiIpOw0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgdXBjb21pbmdJbnB1dDogZnVuY3Rpb24gdXBjb21pbmdJbnB1dCgpIHsNCgkgICAgICAgICAgICAgICAgdmFyIG5leHQgPSB0aGlzLm1hdGNoOw0KCSAgICAgICAgICAgICAgICBpZiAobmV4dC5sZW5ndGggPCAyMCkgew0KCSAgICAgICAgICAgICAgICAgICAgbmV4dCArPSB0aGlzLl9pbnB1dC5zdWJzdHIoMCwgMjAgLSBuZXh0Lmxlbmd0aCk7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgcmV0dXJuIChuZXh0LnN1YnN0cigwLCAyMCkgKyAobmV4dC5sZW5ndGggPiAyMCA/ICcuLi4nIDogJycpKS5yZXBsYWNlKC9cbi9nLCAiIik7DQoJICAgICAgICAgICAgfSwNCgkgICAgICAgICAgICBzaG93UG9zaXRpb246IGZ1bmN0aW9uIHNob3dQb3NpdGlvbigpIHsNCgkgICAgICAgICAgICAgICAgdmFyIHByZSA9IHRoaXMucGFzdElucHV0KCk7DQoJICAgICAgICAgICAgICAgIHZhciBjID0gbmV3IEFycmF5KHByZS5sZW5ndGggKyAxKS5qb2luKCItIik7DQoJICAgICAgICAgICAgICAgIHJldHVybiBwcmUgKyB0aGlzLnVwY29taW5nSW5wdXQoKSArICJcbiIgKyBjICsgIl4iOw0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsNCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9uZSkgew0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GOw0KCSAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgIGlmICghdGhpcy5faW5wdXQpIHRoaXMuZG9uZSA9IHRydWU7DQoNCgkgICAgICAgICAgICAgICAgdmFyIHRva2VuLCBtYXRjaCwgdGVtcE1hdGNoLCBpbmRleCwgY29sLCBsaW5lczsNCgkgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9tb3JlKSB7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9ICcnOw0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRjaCA9ICcnOw0KCSAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgIHZhciBydWxlcyA9IHRoaXMuX2N1cnJlbnRSdWxlcygpOw0KCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7DQoJICAgICAgICAgICAgICAgICAgICB0ZW1wTWF0Y2ggPSB0aGlzLl9pbnB1dC5tYXRjaCh0aGlzLnJ1bGVzW3J1bGVzW2ldXSk7DQoJICAgICAgICAgICAgICAgICAgICBpZiAodGVtcE1hdGNoICYmICghbWF0Y2ggfHwgdGVtcE1hdGNoWzBdLmxlbmd0aCA+IG1hdGNoWzBdLmxlbmd0aCkpIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHRlbXBNYXRjaDsNCgkgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGk7DQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmxleCkgYnJlYWs7DQoJICAgICAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7DQoJICAgICAgICAgICAgICAgICAgICBsaW5lcyA9IG1hdGNoWzBdLm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTsNCgkgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lcykgdGhpcy55eWxpbmVubyArPSBsaW5lcy5sZW5ndGg7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGxvYyA9IHsgZmlyc3RfbGluZTogdGhpcy55eWxsb2MubGFzdF9saW5lLA0KCSAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsDQoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfY29sdW1uOiB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiwNCgkgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X2NvbHVtbjogbGluZXMgPyBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGggLSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5tYXRjaCgvXHI/XG4/LylbMF0ubGVuZ3RoIDogdGhpcy55eWxsb2MubGFzdF9jb2x1bW4gKyBtYXRjaFswXS5sZW5ndGggfTsNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ICs9IG1hdGNoWzBdOw0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRjaCArPSBtYXRjaFswXTsNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlcyA9IG1hdGNoOw0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxlbmcgPSB0aGlzLnl5dGV4dC5sZW5ndGg7DQoJICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykgew0KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlID0gW3RoaXMub2Zmc2V0LCB0aGlzLm9mZnNldCArPSB0aGlzLnl5bGVuZ107DQoJICAgICAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb3JlID0gZmFsc2U7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0LnNsaWNlKG1hdGNoWzBdLmxlbmd0aCk7DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdGNoZWQgKz0gbWF0Y2hbMF07DQoJICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHRoaXMsIHRoaXMueXksIHRoaXMsIHJ1bGVzW2luZGV4XSwgdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdKTsNCgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbmUgJiYgdGhpcy5faW5wdXQpIHRoaXMuZG9uZSA9IGZhbHNlOw0KCSAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuKSByZXR1cm4gdG9rZW47ZWxzZSByZXR1cm47DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lucHV0ID09PSAiIikgew0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GOw0KCSAgICAgICAgICAgICAgICB9IGVsc2Ugew0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VFcnJvcignTGV4aWNhbCBlcnJvciBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpICsgJy4gVW5yZWNvZ25pemVkIHRleHQuXG4nICsgdGhpcy5zaG93UG9zaXRpb24oKSwgeyB0ZXh0OiAiIiwgdG9rZW46IG51bGwsIGxpbmU6IHRoaXMueXlsaW5lbm8gfSk7DQoJICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIGxleDogZnVuY3Rpb24gbGV4KCkgew0KCSAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMubmV4dCgpOw0KCSAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjsNCgkgICAgICAgICAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxleCgpOw0KCSAgICAgICAgICAgICAgICB9DQoJICAgICAgICAgICAgfSwNCgkgICAgICAgICAgICBiZWdpbjogZnVuY3Rpb24gYmVnaW4oY29uZGl0aW9uKSB7DQoJICAgICAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uU3RhY2sucHVzaChjb25kaXRpb24pOw0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgcG9wU3RhdGU6IGZ1bmN0aW9uIHBvcFN0YXRlKCkgew0KCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFjay5wb3AoKTsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIF9jdXJyZW50UnVsZXM6IGZ1bmN0aW9uIF9jdXJyZW50UnVsZXMoKSB7DQoJICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvbnNbdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdXS5ydWxlczsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIHRvcFN0YXRlOiBmdW5jdGlvbiB0b3BTdGF0ZSgpIHsNCgkgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAyXTsNCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIHB1c2hTdGF0ZTogZnVuY3Rpb24gYmVnaW4oY29uZGl0aW9uKSB7DQoJICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oY29uZGl0aW9uKTsNCgkgICAgICAgICAgICB9IH07DQoJICAgICAgICBsZXhlci5vcHRpb25zID0ge307DQoJICAgICAgICBsZXhlci5wZXJmb3JtQWN0aW9uID0gZnVuY3Rpb24gYW5vbnltb3VzKHl5LCB5eV8sICRhdm9pZGluZ19uYW1lX2NvbGxpc2lvbnMsIFlZX1NUQVJUDQoJICAgICAgICAvKiovKSB7DQoNCgkgICAgICAgICAgICBmdW5jdGlvbiBzdHJpcChzdGFydCwgZW5kKSB7DQoJICAgICAgICAgICAgICAgIHJldHVybiB5eV8ueXl0ZXh0ID0geXlfLnl5dGV4dC5zdWJzdHIoc3RhcnQsIHl5Xy55eWxlbmcgLSBlbmQpOw0KCSAgICAgICAgICAgIH0NCg0KCSAgICAgICAgICAgIHZhciBZWVNUQVRFID0gWVlfU1RBUlQ7DQoJICAgICAgICAgICAgc3dpdGNoICgkYXZvaWRpbmdfbmFtZV9jb2xsaXNpb25zKSB7DQoJICAgICAgICAgICAgICAgIGNhc2UgMDoNCgkgICAgICAgICAgICAgICAgICAgIGlmICh5eV8ueXl0ZXh0LnNsaWNlKC0yKSA9PT0gIlxcXFwiKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXAoMCwgMSk7DQoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigibXUiKTsNCgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeXlfLnl5dGV4dC5zbGljZSgtMSkgPT09ICJcXCIpIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICBzdHJpcCgwLCAxKTsNCgkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZ2luKCJlbXUiKTsNCgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigibXUiKTsNCgkgICAgICAgICAgICAgICAgICAgIH0NCgkgICAgICAgICAgICAgICAgICAgIGlmICh5eV8ueXl0ZXh0KSByZXR1cm4gMTU7DQoNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOw0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE1Ow0KDQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigncmF3Jyk7cmV0dXJuIDE1Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsNCgkgICAgICAgICAgICAgICAgICAgIC8vIFNob3VsZCBiZSB1c2luZyBgdGhpcy50b3BTdGF0ZSgpYCBiZWxvdywgYnV0IGl0IGN1cnJlbnRseQ0KCSAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJucyB0aGUgc2Vjb25kIHRvcCBpbnN0ZWFkIG9mIHRoZSBmaXJzdCB0b3AuIE9wZW5lZCBhbg0KCSAgICAgICAgICAgICAgICAgICAgLy8gaXNzdWUgYWJvdXQgaXQgYXQgaHR0cHM6Ly9naXRodWIuY29tL3phYWNoL2ppc29uL2lzc3Vlcy8yOTENCgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV0gPT09ICdyYXcnKSB7DQoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE1Ow0KCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0geXlfLnl5dGV4dC5zdWJzdHIoNSwgeXlfLnl5bGVuZyAtIDkpOw0KCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnRU5EX1JBV19CTE9DSyc7DQoJICAgICAgICAgICAgICAgICAgICB9DQoNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDU6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA2Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOw0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE0Ow0KDQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA3Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDY1Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgODoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA2ODsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDk6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxMDoNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsNCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oJ3JhdycpOw0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDIzOw0KDQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxMToNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA1NTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDEyOg0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDYwOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTM6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxNDoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA0NzsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE1Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpO3JldHVybiA0NDsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE2Og0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpO3JldHVybiA0NDsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDE3Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDM0Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMTg6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMzk7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAxOToNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA1MTsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDIwOg0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDQ4Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjE6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnVucHV0KHl5Xy55eXRleHQpOw0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOw0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbignY29tJyk7DQoNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDIyOg0KCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOw0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE0Ow0KDQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyMzoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA0ODsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDI0Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDczOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjU6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzI7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAyNjoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3MjsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDI3Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDg3Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjg6DQoJICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgd2hpdGVzcGFjZQ0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMjk6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDU0Ow0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzA6DQoJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7cmV0dXJuIDMzOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzE6DQoJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0gc3RyaXAoMSwgMikucmVwbGFjZSgvXFwiL2csICciJyk7cmV0dXJuIDgwOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzI6DQoJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0gc3RyaXAoMSwgMikucmVwbGFjZSgvXFwnL2csICInIik7cmV0dXJuIDgwOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzM6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODU7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzNDoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4MjsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDM1Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDgyOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzY6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODM7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAzNzoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4NDsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDM4Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDgxOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgMzk6DQoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzU7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSA0MDoNCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3NzsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQxOg0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDcyOw0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoJICAgICAgICAgICAgICAgIGNhc2UgNDI6DQoJICAgICAgICAgICAgICAgICAgICB5eV8ueXl0ZXh0ID0geXlfLnl5dGV4dC5yZXBsYWNlKC9cXChbXFxcXV0pL2csICckMScpO3JldHVybiA3MjsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQzOg0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdJTlZBTElEJzsNCgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlIDQ0Og0KCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDU7DQoJICAgICAgICAgICAgICAgICAgICBicmVhazsNCgkgICAgICAgICAgICB9DQoJICAgICAgICB9Ow0KCSAgICAgICAgbGV4ZXIucnVsZXMgPSBbL14oPzpbXlx4MDBdKj8oPz0oXHtceykpKS8sIC9eKD86W15ceDAwXSspLywgL14oPzpbXlx4MDBdezIsfT8oPz0oXHtce3xcXFx7XHt8XFxcXFx7XHt8JCkpKS8sIC9eKD86XHtce1x7XHsoPz1bXlwvXSkpLywgL14oPzpce1x7XHtce1wvW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89Wz19XHNcLy5dKVx9XH1cfVx9KS8sIC9eKD86W15ceDAwXSo/KD89KFx7XHtce1x7KSkpLywgL14oPzpbXHNcU10qPy0tKH4pP1x9XH0pLywgL14oPzpcKCkvLCAvXig/OlwpKS8sIC9eKD86XHtce1x7XHspLywgL14oPzpcfVx9XH1cfSkvLCAvXig/Olx7XHsofik/PikvLCAvXig/Olx7XHsofik/Iz4pLywgL14oPzpce1x7KH4pPyNcKj8pLywgL14oPzpce1x7KH4pP1wvKS8sIC9eKD86XHtceyh+KT9cXlxzKih+KT9cfVx9KS8sIC9eKD86XHtceyh+KT9ccyplbHNlXHMqKH4pP1x9XH0pLywgL14oPzpce1x7KH4pP1xeKS8sIC9eKD86XHtceyh+KT9ccyplbHNlXGIpLywgL14oPzpce1x7KH4pP1x7KS8sIC9eKD86XHtceyh+KT8mKS8sIC9eKD86XHtceyh+KT8hLS0pLywgL14oPzpce1x7KH4pPyFbXHNcU10qP1x9XH0pLywgL14oPzpce1x7KH4pP1wqPykvLCAvXig/Oj0pLywgL14oPzpcLlwuKS8sIC9eKD86XC4oPz0oWz1+fVxzXC8uKXxdKSkpLywgL14oPzpbXC8uXSkvLCAvXig/OlxzKykvLCAvXig/Olx9KH4pP1x9XH0pLywgL14oPzoofik/XH1cfSkvLCAvXig/OiIoXFxbIl18W14iXSkqIikvLCAvXig/OicoXFxbJ118W14nXSkqJykvLCAvXig/OkApLywgL14oPzp0cnVlKD89KFt+fVxzKV0pKSkvLCAvXig/OmZhbHNlKD89KFt+fVxzKV0pKSkvLCAvXig/OnVuZGVmaW5lZCg/PShbfn1ccyldKSkpLywgL14oPzpudWxsKD89KFt+fVxzKV0pKSkvLCAvXig/Oi0/WzAtOV0rKD86XC5bMC05XSspPyg/PShbfn1ccyldKSkpLywgL14oPzphc1xzK1x8KS8sIC9eKD86XHwpLywgL14oPzooW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89KFs9fn1cc1wvLil8XSkpKSkvLCAvXig/OlxbKFxcXF18W15cXV0pKlxdKS8sIC9eKD86LikvLCAvXig/OiQpL107DQoJICAgICAgICBsZXhlci5jb25kaXRpb25zID0geyAibXUiOiB7ICJydWxlcyI6IFs3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMSwgMzIsIDMzLCAzNCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDEsIDQyLCA0MywgNDRdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgImVtdSI6IHsgInJ1bGVzIjogWzJdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgImNvbSI6IHsgInJ1bGVzIjogWzZdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgInJhdyI6IHsgInJ1bGVzIjogWzMsIDQsIDVdLCAiaW5jbHVzaXZlIjogZmFsc2UgfSwgIklOSVRJQUwiOiB7ICJydWxlcyI6IFswLCAxLCA0NF0sICJpbmNsdXNpdmUiOiB0cnVlIH0gfTsNCgkgICAgICAgIHJldHVybiBsZXhlcjsNCgkgICAgfSkoKTsNCgkgICAgcGFyc2VyLmxleGVyID0gbGV4ZXI7DQoJICAgIGZ1bmN0aW9uIFBhcnNlcigpIHsNCgkgICAgICAgIHRoaXMueXkgPSB7fTsNCgkgICAgfVBhcnNlci5wcm90b3R5cGUgPSBwYXJzZXI7cGFyc2VyLlBhcnNlciA9IFBhcnNlcjsNCgkgICAgcmV0dXJuIG5ldyBQYXJzZXIoKTsNCgl9KSgpO2V4cG9ydHNbImRlZmF1bHQiXSA9IGhhbmRsZWJhcnM7DQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWyJkZWZhdWx0Il07DQoNCi8qKiovIH0pLA0KLyogMzggKi8NCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsNCg0KCSd1c2Ugc3RyaWN0JzsNCg0KCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOw0KDQoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsNCg0KCXZhciBfdmlzaXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpOw0KDQoJdmFyIF92aXNpdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Zpc2l0b3IpOw0KDQoJZnVuY3Rpb24gV2hpdGVzcGFjZUNvbnRyb2woKSB7DQoJICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdOw0KDQoJICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOw0KCX0NCglXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUgPSBuZXcgX3Zpc2l0b3IyWydkZWZhdWx0J10oKTsNCg0KCVdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5Qcm9ncmFtID0gZnVuY3Rpb24gKHByb2dyYW0pIHsNCgkgIHZhciBkb1N0YW5kYWxvbmUgPSAhdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmU7DQoNCgkgIHZhciBpc1Jvb3QgPSAhdGhpcy5pc1Jvb3RTZWVuOw0KCSAgdGhpcy5pc1Jvb3RTZWVuID0gdHJ1ZTsNCg0KCSAgdmFyIGJvZHkgPSBwcm9ncmFtLmJvZHk7DQoJICBmb3IgKHZhciBpID0gMCwgbCA9IGJvZHkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7DQoJICAgIHZhciBjdXJyZW50ID0gYm9keVtpXSwNCgkgICAgICAgIHN0cmlwID0gdGhpcy5hY2NlcHQoY3VycmVudCk7DQoNCgkgICAgaWYgKCFzdHJpcCkgew0KCSAgICAgIGNvbnRpbnVlOw0KCSAgICB9DQoNCgkgICAgdmFyIF9pc1ByZXZXaGl0ZXNwYWNlID0gaXNQcmV2V2hpdGVzcGFjZShib2R5LCBpLCBpc1Jvb3QpLA0KCSAgICAgICAgX2lzTmV4dFdoaXRlc3BhY2UgPSBpc05leHRXaGl0ZXNwYWNlKGJvZHksIGksIGlzUm9vdCksDQoJICAgICAgICBvcGVuU3RhbmRhbG9uZSA9IHN0cmlwLm9wZW5TdGFuZGFsb25lICYmIF9pc1ByZXZXaGl0ZXNwYWNlLA0KCSAgICAgICAgY2xvc2VTdGFuZGFsb25lID0gc3RyaXAuY2xvc2VTdGFuZGFsb25lICYmIF9pc05leHRXaGl0ZXNwYWNlLA0KCSAgICAgICAgaW5saW5lU3RhbmRhbG9uZSA9IHN0cmlwLmlubGluZVN0YW5kYWxvbmUgJiYgX2lzUHJldldoaXRlc3BhY2UgJiYgX2lzTmV4dFdoaXRlc3BhY2U7DQoNCgkgICAgaWYgKHN0cmlwLmNsb3NlKSB7DQoJICAgICAgb21pdFJpZ2h0KGJvZHksIGksIHRydWUpOw0KCSAgICB9DQoJICAgIGlmIChzdHJpcC5vcGVuKSB7DQoJICAgICAgb21pdExlZnQoYm9keSwgaSwgdHJ1ZSk7DQoJICAgIH0NCg0KCSAgICBpZiAoZG9TdGFuZGFsb25lICYmIGlubGluZVN0YW5kYWxvbmUpIHsNCgkgICAgICBvbWl0UmlnaHQoYm9keSwgaSk7DQoNCgkgICAgICBpZiAob21pdExlZnQoYm9keSwgaSkpIHsNCgkgICAgICAgIC8vIElmIHdlIGFyZSBvbiBhIHN0YW5kYWxvbmUgbm9kZSwgc2F2ZSB0aGUgaW5kZW50IGluZm8gZm9yIHBhcnRpYWxzDQoJICAgICAgICBpZiAoY3VycmVudC50eXBlID09PSAnUGFydGlhbFN0YXRlbWVudCcpIHsNCgkgICAgICAgICAgLy8gUHVsbCBvdXQgdGhlIHdoaXRlc3BhY2UgZnJvbSB0aGUgZmluYWwgbGluZQ0KCSAgICAgICAgICBjdXJyZW50LmluZGVudCA9IC8oWyBcdF0rJCkvLmV4ZWMoYm9keVtpIC0gMV0ub3JpZ2luYWwpWzFdOw0KCSAgICAgICAgfQ0KCSAgICAgIH0NCgkgICAgfQ0KCSAgICBpZiAoZG9TdGFuZGFsb25lICYmIG9wZW5TdGFuZGFsb25lKSB7DQoJICAgICAgb21pdFJpZ2h0KChjdXJyZW50LnByb2dyYW0gfHwgY3VycmVudC5pbnZlcnNlKS5ib2R5KTsNCg0KCSAgICAgIC8vIFN0cmlwIG91dCB0aGUgcHJldmlvdXMgY29udGVudCBub2RlIGlmIGl0J3Mgd2hpdGVzcGFjZSBvbmx5DQoJICAgICAgb21pdExlZnQoYm9keSwgaSk7DQoJICAgIH0NCgkgICAgaWYgKGRvU3RhbmRhbG9uZSAmJiBjbG9zZVN0YW5kYWxvbmUpIHsNCgkgICAgICAvLyBBbHdheXMgc3RyaXAgdGhlIG5leHQgbm9kZQ0KCSAgICAgIG9taXRSaWdodChib2R5LCBpKTsNCg0KCSAgICAgIG9taXRMZWZ0KChjdXJyZW50LmludmVyc2UgfHwgY3VycmVudC5wcm9ncmFtKS5ib2R5KTsNCgkgICAgfQ0KCSAgfQ0KDQoJICByZXR1cm4gcHJvZ3JhbTsNCgl9Ow0KDQoJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLkJsb2NrU3RhdGVtZW50ID0gV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLkRlY29yYXRvckJsb2NrID0gV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLlBhcnRpYWxCbG9ja1N0YXRlbWVudCA9IGZ1bmN0aW9uIChibG9jaykgew0KCSAgdGhpcy5hY2NlcHQoYmxvY2sucHJvZ3JhbSk7DQoJICB0aGlzLmFjY2VwdChibG9jay5pbnZlcnNlKTsNCg0KCSAgLy8gRmluZCB0aGUgaW52ZXJzZSBwcm9ncmFtIHRoYXQgaXMgaW52b2xlZCB3aXRoIHdoaXRlc3BhY2Ugc3RyaXBwaW5nLg0KCSAgdmFyIHByb2dyYW0gPSBibG9jay5wcm9ncmFtIHx8IGJsb2NrLmludmVyc2UsDQoJICAgICAgaW52ZXJzZSA9IGJsb2NrLnByb2dyYW0gJiYgYmxvY2suaW52ZXJzZSwNCgkgICAgICBmaXJzdEludmVyc2UgPSBpbnZlcnNlLA0KCSAgICAgIGxhc3RJbnZlcnNlID0gaW52ZXJzZTsNCg0KCSAgaWYgKGludmVyc2UgJiYgaW52ZXJzZS5jaGFpbmVkKSB7DQoJICAgIGZpcnN0SW52ZXJzZSA9IGludmVyc2UuYm9keVswXS5wcm9ncmFtOw0KDQoJICAgIC8vIFdhbGsgdGhlIGludmVyc2UgY2hhaW4gdG8gZmluZCB0aGUgbGFzdCBpbnZlcnNlIHRoYXQgaXMgYWN0dWFsbHkgaW4gdGhlIGNoYWluLg0KCSAgICB3aGlsZSAobGFzdEludmVyc2UuY2hhaW5lZCkgew0KCSAgICAgIGxhc3RJbnZlcnNlID0gbGFzdEludmVyc2UuYm9keVtsYXN0SW52ZXJzZS5ib2R5Lmxlbmd0aCAtIDFdLnByb2dyYW07DQoJICAgIH0NCgkgIH0NCg0KCSAgdmFyIHN0cmlwID0gew0KCSAgICBvcGVuOiBibG9jay5vcGVuU3RyaXAub3BlbiwNCgkgICAgY2xvc2U6IGJsb2NrLmNsb3NlU3RyaXAuY2xvc2UsDQoNCgkgICAgLy8gRGV0ZXJtaW5lIHRoZSBzdGFuZGFsb25lIGNhbmRpYWN5LiBCYXNpY2FsbHkgZmxhZyBvdXIgY29udGVudCBhcyBiZWluZyBwb3NzaWJseSBzdGFuZGFsb25lDQoJICAgIC8vIHNvIG91ciBwYXJlbnQgY2FuIGRldGVybWluZSBpZiB3ZSBhY3R1YWxseSBhcmUgc3RhbmRhbG9uZQ0KCSAgICBvcGVuU3RhbmRhbG9uZTogaXNOZXh0V2hpdGVzcGFjZShwcm9ncmFtLmJvZHkpLA0KCSAgICBjbG9zZVN0YW5kYWxvbmU6IGlzUHJldldoaXRlc3BhY2UoKGZpcnN0SW52ZXJzZSB8fCBwcm9ncmFtKS5ib2R5KQ0KCSAgfTsNCg0KCSAgaWYgKGJsb2NrLm9wZW5TdHJpcC5jbG9zZSkgew0KCSAgICBvbWl0UmlnaHQocHJvZ3JhbS5ib2R5LCBudWxsLCB0cnVlKTsNCgkgIH0NCg0KCSAgaWYgKGludmVyc2UpIHsNCgkgICAgdmFyIGludmVyc2VTdHJpcCA9IGJsb2NrLmludmVyc2VTdHJpcDsNCg0KCSAgICBpZiAoaW52ZXJzZVN0cmlwLm9wZW4pIHsNCgkgICAgICBvbWl0TGVmdChwcm9ncmFtLmJvZHksIG51bGwsIHRydWUpOw0KCSAgICB9DQoNCgkgICAgaWYgKGludmVyc2VTdHJpcC5jbG9zZSkgew0KCSAgICAgIG9taXRSaWdodChmaXJzdEludmVyc2UuYm9keSwgbnVsbCwgdHJ1ZSk7DQoJICAgIH0NCgkgICAgaWYgKGJsb2NrLmNsb3NlU3RyaXAub3Blbikgew0KCSAgICAgIG9taXRMZWZ0KGxhc3RJbnZlcnNlLmJvZHksIG51bGwsIHRydWUpOw0KCSAgICB9DQoNCgkgICAgLy8gRmluZCBzdGFuZGFsb25lIGVsc2Ugc3RhdG1lbnRzDQoJICAgIGlmICghdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmUgJiYgaXNQcmV2V2hpdGVzcGFjZShwcm9ncmFtLmJvZHkpICYmIGlzTmV4dFdoaXRlc3BhY2UoZmlyc3RJbnZlcnNlLmJvZHkpKSB7DQoJICAgICAgb21pdExlZnQocHJvZ3JhbS5ib2R5KTsNCgkgICAgICBvbWl0UmlnaHQoZmlyc3RJbnZlcnNlLmJvZHkpOw0KCSAgICB9DQoJICB9IGVsc2UgaWYgKGJsb2NrLmNsb3NlU3RyaXAub3Blbikgew0KCSAgICBvbWl0TGVmdChwcm9ncmFtLmJvZHksIG51bGwsIHRydWUpOw0KCSAgfQ0KDQoJICByZXR1cm4gc3RyaXA7DQoJfTsNCg0KCVdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5EZWNvcmF0b3IgPSBXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuTXVzdGFjaGVTdGF0ZW1lbnQgPSBmdW5jdGlvbiAobXVzdGFjaGUpIHsNCgkgIHJldHVybiBtdXN0YWNoZS5zdHJpcDsNCgl9Ow0KDQoJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLlBhcnRpYWxTdGF0ZW1lbnQgPSBXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuQ29tbWVudFN0YXRlbWVudCA9IGZ1bmN0aW9uIChub2RlKSB7DQoJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLw0KCSAgdmFyIHN0cmlwID0gbm9kZS5zdHJpcCB8fCB7fTsNCgkgIHJldHVybiB7DQoJICAgIGlubGluZVN0YW5kYWxvbmU6IHRydWUsDQoJICAgIG9wZW46IHN0cmlwLm9wZW4sDQoJICAgIGNsb3NlOiBzdHJpcC5jbG9zZQ0KCSAgfTsNCgl9Ow0KDQoJZnVuY3Rpb24gaXNQcmV2V2hpdGVzcGFjZShib2R5LCBpLCBpc1Jvb3QpIHsNCgkgIGlmIChpID09PSB1bmRlZmluZWQpIHsNCgkgICAgaSA9IGJvZHkubGVuZ3RoOw0KCSAgfQ0KDQoJICAvLyBOb2RlcyB0aGF0IGVuZCB3aXRoIG5ld2xpbmVzIGFyZSBjb25zaWRlcmVkIHdoaXRlc3BhY2UgKGJ1dCBhcmUgc3BlY2lhbA0KCSAgLy8gY2FzZWQgZm9yIHN0cmlwIG9wZXJhdGlvbnMpDQoJICB2YXIgcHJldiA9IGJvZHlbaSAtIDFdLA0KCSAgICAgIHNpYmxpbmcgPSBib2R5W2kgLSAyXTsNCgkgIGlmICghcHJldikgew0KCSAgICByZXR1cm4gaXNSb290Ow0KCSAgfQ0KDQoJICBpZiAocHJldi50eXBlID09PSAnQ29udGVudFN0YXRlbWVudCcpIHsNCgkgICAgcmV0dXJuIChzaWJsaW5nIHx8ICFpc1Jvb3QgPyAvXHI/XG5ccyo/JC8gOiAvKF58XHI/XG4pXHMqPyQvKS50ZXN0KHByZXYub3JpZ2luYWwpOw0KCSAgfQ0KCX0NCglmdW5jdGlvbiBpc05leHRXaGl0ZXNwYWNlKGJvZHksIGksIGlzUm9vdCkgew0KCSAgaWYgKGkgPT09IHVuZGVmaW5lZCkgew0KCSAgICBpID0gLTE7DQoJICB9DQoNCgkgIHZhciBuZXh0ID0gYm9keVtpICsgMV0sDQoJICAgICAgc2libGluZyA9IGJvZHlbaSArIDJdOw0KCSAgaWYgKCFuZXh0KSB7DQoJICAgIHJldHVybiBpc1Jvb3Q7DQoJICB9DQoNCgkgIGlmIChuZXh0LnR5cGUgPT09ICdDb250ZW50U3RhdGVtZW50Jykgew0KCSAgICByZXR1cm4gKHNpYmxpbmcgfHwgIWlzUm9vdCA/IC9eXHMqP1xyP1xuLyA6IC9eXHMqPyhccj9cbnwkKS8pLnRlc3QobmV4dC5vcmlnaW5hbCk7DQoJICB9DQoJfQ0KDQoJLy8gTWFya3MgdGhlIG5vZGUgdG8gdGhlIHJpZ2h0IG9mIHRoZSBwb3NpdGlvbiBhcyBvbWl0dGVkLg0KCS8vIEkuZS4ge3tmb299fScgJyB3aWxsIG1hcmsgdGhlICcgJyBub2RlIGFzIG9taXR0ZWQuDQoJLy8NCgkvLyBJZiBpIGlzIHVuZGVmaW5lZCwgdGhlbiB0aGUgZmlyc3QgY2hpbGQgd2lsbCBiZSBtYXJrZWQgYXMgc3VjaC4NCgkvLw0KCS8vIElmIG11bGl0cGxlIGlzIHRydXRoeSB0aGVuIGFsbCB3aGl0ZXNwYWNlIHdpbGwgYmUgc3RyaXBwZWQgb3V0IHVudGlsIG5vbi13aGl0ZXNwYWNlDQoJLy8gY29udGVudCBpcyBtZXQuDQoJZnVuY3Rpb24gb21pdFJpZ2h0KGJvZHksIGksIG11bHRpcGxlKSB7DQoJICB2YXIgY3VycmVudCA9IGJvZHlbaSA9PSBudWxsID8gMCA6IGkgKyAxXTsNCgkgIGlmICghY3VycmVudCB8fCBjdXJyZW50LnR5cGUgIT09ICdDb250ZW50U3RhdGVtZW50JyB8fCAhbXVsdGlwbGUgJiYgY3VycmVudC5yaWdodFN0cmlwcGVkKSB7DQoJICAgIHJldHVybjsNCgkgIH0NCg0KCSAgdmFyIG9yaWdpbmFsID0gY3VycmVudC52YWx1ZTsNCgkgIGN1cnJlbnQudmFsdWUgPSBjdXJyZW50LnZhbHVlLnJlcGxhY2UobXVsdGlwbGUgPyAvXlxzKy8gOiAvXlsgXHRdKlxyP1xuPy8sICcnKTsNCgkgIGN1cnJlbnQucmlnaHRTdHJpcHBlZCA9IGN1cnJlbnQudmFsdWUgIT09IG9yaWdpbmFsOw0KCX0NCg0KCS8vIE1hcmtzIHRoZSBub2RlIHRvIHRoZSBsZWZ0IG9mIHRoZSBwb3NpdGlvbiBhcyBvbWl0dGVkLg0KCS8vIEkuZS4gJyAne3tmb299fSB3aWxsIG1hcmsgdGhlICcgJyBub2RlIGFzIG9taXR0ZWQuDQoJLy8NCgkvLyBJZiBpIGlzIHVuZGVmaW5lZCB0aGVuIHRoZSBsYXN0IGNoaWxkIHdpbGwgYmUgbWFya2VkIGFzIHN1Y2guDQoJLy8NCgkvLyBJZiBtdWxpdHBsZSBpcyB0cnV0aHkgdGhlbiBhbGwgd2hpdGVzcGFjZSB3aWxsIGJlIHN0cmlwcGVkIG91dCB1bnRpbCBub24td2hpdGVzcGFjZQ0KCS8vIGNvbnRlbnQgaXMgbWV0Lg0KCWZ1bmN0aW9uIG9taXRMZWZ0KGJvZHksIGksIG11bHRpcGxlKSB7DQoJICB2YXIgY3VycmVudCA9IGJvZHlbaSA9PSBudWxsID8gYm9keS5sZW5ndGggLSAxIDogaSAtIDFdOw0KCSAgaWYgKCFjdXJyZW50IHx8IGN1cnJlbnQudHlwZSAhPT0gJ0NvbnRlbnRTdGF0ZW1lbnQnIHx8ICFtdWx0aXBsZSAmJiBjdXJyZW50LmxlZnRTdHJpcHBlZCkgew0KCSAgICByZXR1cm47DQoJICB9DQoNCgkgIC8vIFdlIG9taXQgdGhlIGxhc3Qgbm9kZSBpZiBpdCdzIHdoaXRlc3BhY2Ugb25seSBhbmQgbm90IHByZWNlZWRlZCBieSBhIG5vbi1jb250ZW50IG5vZGUuDQoJICB2YXIgb3JpZ2luYWwgPSBjdXJyZW50LnZhbHVlOw0KCSAgY3VycmVudC52YWx1ZSA9IGN1cnJlbnQudmFsdWUucmVwbGFjZShtdWx0aXBsZSA/IC9ccyskLyA6IC9bIFx0XSskLywgJycpOw0KCSAgY3VycmVudC5sZWZ0U3RyaXBwZWQgPSBjdXJyZW50LnZhbHVlICE9PSBvcmlnaW5hbDsNCgkgIHJldHVybiBjdXJyZW50LmxlZnRTdHJpcHBlZDsNCgl9DQoNCglleHBvcnRzWydkZWZhdWx0J10gPSBXaGl0ZXNwYWNlQ29udHJvbDsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiAzOSAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KDQoJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOw0KDQoJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsNCg0KCWZ1bmN0aW9uIFZpc2l0b3IoKSB7DQoJICB0aGlzLnBhcmVudHMgPSBbXTsNCgl9DQoNCglWaXNpdG9yLnByb3RvdHlwZSA9IHsNCgkgIGNvbnN0cnVjdG9yOiBWaXNpdG9yLA0KCSAgbXV0YXRpbmc6IGZhbHNlLA0KDQoJICAvLyBWaXNpdHMgYSBnaXZlbiB2YWx1ZS4gSWYgbXV0YXRpbmcsIHdpbGwgcmVwbGFjZSB0aGUgdmFsdWUgaWYgbmVjZXNzYXJ5Lg0KCSAgYWNjZXB0S2V5OiBmdW5jdGlvbiBhY2NlcHRLZXkobm9kZSwgbmFtZSkgew0KCSAgICB2YXIgdmFsdWUgPSB0aGlzLmFjY2VwdChub2RlW25hbWVdKTsNCgkgICAgaWYgKHRoaXMubXV0YXRpbmcpIHsNCgkgICAgICAvLyBIYWNreSBzYW5pdHkgY2hlY2s6IFRoaXMgbWF5IGhhdmUgYSBmZXcgZmFsc2UgcG9zaXRpdmVzIGZvciB0eXBlIGZvciB0aGUgaGVscGVyDQoJICAgICAgLy8gbWV0aG9kcyBidXQgd2lsbCBnZW5lcmFsbHkgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGhvdXQgYSBsb3Qgb2Ygb3ZlcmhlYWQuDQoJICAgICAgaWYgKHZhbHVlICYmICFWaXNpdG9yLnByb3RvdHlwZVt2YWx1ZS50eXBlXSkgew0KCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1VuZXhwZWN0ZWQgbm9kZSB0eXBlICInICsgdmFsdWUudHlwZSArICciIGZvdW5kIHdoZW4gYWNjZXB0aW5nICcgKyBuYW1lICsgJyBvbiAnICsgbm9kZS50eXBlKTsNCgkgICAgICB9DQoJICAgICAgbm9kZVtuYW1lXSA9IHZhbHVlOw0KCSAgICB9DQoJICB9LA0KDQoJICAvLyBQZXJmb3JtcyBhbiBhY2NlcHQgb3BlcmF0aW9uIHdpdGggYWRkZWQgc2FuaXR5IGNoZWNrIHRvIGVuc3VyZQ0KCSAgLy8gcmVxdWlyZWQga2V5cyBhcmUgbm90IHJlbW92ZWQuDQoJICBhY2NlcHRSZXF1aXJlZDogZnVuY3Rpb24gYWNjZXB0UmVxdWlyZWQobm9kZSwgbmFtZSkgew0KCSAgICB0aGlzLmFjY2VwdEtleShub2RlLCBuYW1lKTsNCg0KCSAgICBpZiAoIW5vZGVbbmFtZV0pIHsNCgkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXShub2RlLnR5cGUgKyAnIHJlcXVpcmVzICcgKyBuYW1lKTsNCgkgICAgfQ0KCSAgfSwNCg0KCSAgLy8gVHJhdmVyc2VzIGEgZ2l2ZW4gYXJyYXkuIElmIG11dGF0aW5nLCBlbXB0eSByZXNwbnNlcyB3aWxsIGJlIHJlbW92ZWQNCgkgIC8vIGZvciBjaGlsZCBlbGVtZW50cy4NCgkgIGFjY2VwdEFycmF5OiBmdW5jdGlvbiBhY2NlcHRBcnJheShhcnJheSkgew0KCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgew0KCSAgICAgIHRoaXMuYWNjZXB0S2V5KGFycmF5LCBpKTsNCg0KCSAgICAgIGlmICghYXJyYXlbaV0pIHsNCgkgICAgICAgIGFycmF5LnNwbGljZShpLCAxKTsNCgkgICAgICAgIGktLTsNCgkgICAgICAgIGwtLTsNCgkgICAgICB9DQoJICAgIH0NCgkgIH0sDQoNCgkgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KG9iamVjdCkgew0KCSAgICBpZiAoIW9iamVjdCkgew0KCSAgICAgIHJldHVybjsNCgkgICAgfQ0KDQoJICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBTYW5pdHkgY29kZSAqLw0KCSAgICBpZiAoIXRoaXNbb2JqZWN0LnR5cGVdKSB7DQoJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1Vua25vd24gdHlwZTogJyArIG9iamVjdC50eXBlLCBvYmplY3QpOw0KCSAgICB9DQoNCgkgICAgaWYgKHRoaXMuY3VycmVudCkgew0KCSAgICAgIHRoaXMucGFyZW50cy51bnNoaWZ0KHRoaXMuY3VycmVudCk7DQoJICAgIH0NCgkgICAgdGhpcy5jdXJyZW50ID0gb2JqZWN0Ow0KDQoJICAgIHZhciByZXQgPSB0aGlzW29iamVjdC50eXBlXShvYmplY3QpOw0KDQoJICAgIHRoaXMuY3VycmVudCA9IHRoaXMucGFyZW50cy5zaGlmdCgpOw0KDQoJICAgIGlmICghdGhpcy5tdXRhdGluZyB8fCByZXQpIHsNCgkgICAgICByZXR1cm4gcmV0Ow0KCSAgICB9IGVsc2UgaWYgKHJldCAhPT0gZmFsc2UpIHsNCgkgICAgICByZXR1cm4gb2JqZWN0Ow0KCSAgICB9DQoJICB9LA0KDQoJICBQcm9ncmFtOiBmdW5jdGlvbiBQcm9ncmFtKHByb2dyYW0pIHsNCgkgICAgdGhpcy5hY2NlcHRBcnJheShwcm9ncmFtLmJvZHkpOw0KCSAgfSwNCg0KCSAgTXVzdGFjaGVTdGF0ZW1lbnQ6IHZpc2l0U3ViRXhwcmVzc2lvbiwNCgkgIERlY29yYXRvcjogdmlzaXRTdWJFeHByZXNzaW9uLA0KDQoJICBCbG9ja1N0YXRlbWVudDogdmlzaXRCbG9jaywNCgkgIERlY29yYXRvckJsb2NrOiB2aXNpdEJsb2NrLA0KDQoJICBQYXJ0aWFsU3RhdGVtZW50OiB2aXNpdFBhcnRpYWwsDQoJICBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQ6IGZ1bmN0aW9uIFBhcnRpYWxCbG9ja1N0YXRlbWVudChwYXJ0aWFsKSB7DQoJICAgIHZpc2l0UGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwpOw0KDQoJICAgIHRoaXMuYWNjZXB0S2V5KHBhcnRpYWwsICdwcm9ncmFtJyk7DQoJICB9LA0KDQoJICBDb250ZW50U3RhdGVtZW50OiBmdW5jdGlvbiBDb250ZW50U3RhdGVtZW50KCkgLyogY29udGVudCAqL3t9LA0KCSAgQ29tbWVudFN0YXRlbWVudDogZnVuY3Rpb24gQ29tbWVudFN0YXRlbWVudCgpIC8qIGNvbW1lbnQgKi97fSwNCg0KCSAgU3ViRXhwcmVzc2lvbjogdmlzaXRTdWJFeHByZXNzaW9uLA0KDQoJICBQYXRoRXhwcmVzc2lvbjogZnVuY3Rpb24gUGF0aEV4cHJlc3Npb24oKSAvKiBwYXRoICove30sDQoNCgkgIFN0cmluZ0xpdGVyYWw6IGZ1bmN0aW9uIFN0cmluZ0xpdGVyYWwoKSAvKiBzdHJpbmcgKi97fSwNCgkgIE51bWJlckxpdGVyYWw6IGZ1bmN0aW9uIE51bWJlckxpdGVyYWwoKSAvKiBudW1iZXIgKi97fSwNCgkgIEJvb2xlYW5MaXRlcmFsOiBmdW5jdGlvbiBCb29sZWFuTGl0ZXJhbCgpIC8qIGJvb2wgKi97fSwNCgkgIFVuZGVmaW5lZExpdGVyYWw6IGZ1bmN0aW9uIFVuZGVmaW5lZExpdGVyYWwoKSAvKiBsaXRlcmFsICove30sDQoJICBOdWxsTGl0ZXJhbDogZnVuY3Rpb24gTnVsbExpdGVyYWwoKSAvKiBsaXRlcmFsICove30sDQoNCgkgIEhhc2g6IGZ1bmN0aW9uIEhhc2goaGFzaCkgew0KCSAgICB0aGlzLmFjY2VwdEFycmF5KGhhc2gucGFpcnMpOw0KCSAgfSwNCgkgIEhhc2hQYWlyOiBmdW5jdGlvbiBIYXNoUGFpcihwYWlyKSB7DQoJICAgIHRoaXMuYWNjZXB0UmVxdWlyZWQocGFpciwgJ3ZhbHVlJyk7DQoJICB9DQoJfTsNCg0KCWZ1bmN0aW9uIHZpc2l0U3ViRXhwcmVzc2lvbihtdXN0YWNoZSkgew0KCSAgdGhpcy5hY2NlcHRSZXF1aXJlZChtdXN0YWNoZSwgJ3BhdGgnKTsNCgkgIHRoaXMuYWNjZXB0QXJyYXkobXVzdGFjaGUucGFyYW1zKTsNCgkgIHRoaXMuYWNjZXB0S2V5KG11c3RhY2hlLCAnaGFzaCcpOw0KCX0NCglmdW5jdGlvbiB2aXNpdEJsb2NrKGJsb2NrKSB7DQoJICB2aXNpdFN1YkV4cHJlc3Npb24uY2FsbCh0aGlzLCBibG9jayk7DQoNCgkgIHRoaXMuYWNjZXB0S2V5KGJsb2NrLCAncHJvZ3JhbScpOw0KCSAgdGhpcy5hY2NlcHRLZXkoYmxvY2ssICdpbnZlcnNlJyk7DQoJfQ0KCWZ1bmN0aW9uIHZpc2l0UGFydGlhbChwYXJ0aWFsKSB7DQoJICB0aGlzLmFjY2VwdFJlcXVpcmVkKHBhcnRpYWwsICduYW1lJyk7DQoJICB0aGlzLmFjY2VwdEFycmF5KHBhcnRpYWwucGFyYW1zKTsNCgkgIHRoaXMuYWNjZXB0S2V5KHBhcnRpYWwsICdoYXNoJyk7DQoJfQ0KDQoJZXhwb3J0c1snZGVmYXVsdCddID0gVmlzaXRvcjsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiA0MCAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJJ3VzZSBzdHJpY3QnOw0KDQoJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107DQoNCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOw0KCWV4cG9ydHMuU291cmNlTG9jYXRpb24gPSBTb3VyY2VMb2NhdGlvbjsNCglleHBvcnRzLmlkID0gaWQ7DQoJZXhwb3J0cy5zdHJpcEZsYWdzID0gc3RyaXBGbGFnczsNCglleHBvcnRzLnN0cmlwQ29tbWVudCA9IHN0cmlwQ29tbWVudDsNCglleHBvcnRzLnByZXBhcmVQYXRoID0gcHJlcGFyZVBhdGg7DQoJZXhwb3J0cy5wcmVwYXJlTXVzdGFjaGUgPSBwcmVwYXJlTXVzdGFjaGU7DQoJZXhwb3J0cy5wcmVwYXJlUmF3QmxvY2sgPSBwcmVwYXJlUmF3QmxvY2s7DQoJZXhwb3J0cy5wcmVwYXJlQmxvY2sgPSBwcmVwYXJlQmxvY2s7DQoJZXhwb3J0cy5wcmVwYXJlUHJvZ3JhbSA9IHByZXBhcmVQcm9ncmFtOw0KCWV4cG9ydHMucHJlcGFyZVBhcnRpYWxCbG9jayA9IHByZXBhcmVQYXJ0aWFsQmxvY2s7DQoNCgl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7DQoNCgl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOw0KDQoJZnVuY3Rpb24gdmFsaWRhdGVDbG9zZShvcGVuLCBjbG9zZSkgew0KCSAgY2xvc2UgPSBjbG9zZS5wYXRoID8gY2xvc2UucGF0aC5vcmlnaW5hbCA6IGNsb3NlOw0KDQoJICBpZiAob3Blbi5wYXRoLm9yaWdpbmFsICE9PSBjbG9zZSkgew0KCSAgICB2YXIgZXJyb3JOb2RlID0geyBsb2M6IG9wZW4ucGF0aC5sb2MgfTsNCg0KCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXShvcGVuLnBhdGgub3JpZ2luYWwgKyAiIGRvZXNuJ3QgbWF0Y2ggIiArIGNsb3NlLCBlcnJvck5vZGUpOw0KCSAgfQ0KCX0NCg0KCWZ1bmN0aW9uIFNvdXJjZUxvY2F0aW9uKHNvdXJjZSwgbG9jSW5mbykgew0KCSAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7DQoJICB0aGlzLnN0YXJ0ID0gew0KCSAgICBsaW5lOiBsb2NJbmZvLmZpcnN0X2xpbmUsDQoJICAgIGNvbHVtbjogbG9jSW5mby5maXJzdF9jb2x1bW4NCgkgIH07DQoJICB0aGlzLmVuZCA9IHsNCgkgICAgbGluZTogbG9jSW5mby5sYXN0X2xpbmUsDQoJICAgIGNvbHVtbjogbG9jSW5mby5sYXN0X2NvbHVtbg0KCSAgfTsNCgl9DQoNCglmdW5jdGlvbiBpZCh0b2tlbikgew0KCSAgaWYgKC9eXFsuKlxdJC8udGVzdCh0b2tlbikpIHsNCgkgICAgcmV0dXJuIHRva2VuLnN1YnN0cigxLCB0b2tlbi5sZW5ndGggLSAyKTsNCgkgIH0gZWxzZSB7DQoJICAgIHJldHVybiB0b2tlbjsNCgkgIH0NCgl9DQoNCglmdW5jdGlvbiBzdHJpcEZsYWdzKG9wZW4sIGNsb3NlKSB7DQoJICByZXR1cm4gew0KCSAgICBvcGVuOiBvcGVuLmNoYXJBdCgyKSA9PT0gJ34nLA0KCSAgICBjbG9zZTogY2xvc2UuY2hhckF0KGNsb3NlLmxlbmd0aCAtIDMpID09PSAnficNCgkgIH07DQoJfQ0KDQoJZnVuY3Rpb24gc3RyaXBDb21tZW50KGNvbW1lbnQpIHsNCgkgIHJldHVybiBjb21tZW50LnJlcGxhY2UoL15ce1x7fj9cIS0/LT8vLCAnJykucmVwbGFjZSgvLT8tP34/XH1cfSQvLCAnJyk7DQoJfQ0KDQoJZnVuY3Rpb24gcHJlcGFyZVBhdGgoZGF0YSwgcGFydHMsIGxvYykgew0KCSAgbG9jID0gdGhpcy5sb2NJbmZvKGxvYyk7DQoNCgkgIHZhciBvcmlnaW5hbCA9IGRhdGEgPyAnQCcgOiAnJywNCgkgICAgICBkaWcgPSBbXSwNCgkgICAgICBkZXB0aCA9IDAsDQoJICAgICAgZGVwdGhTdHJpbmcgPSAnJzsNCg0KCSAgZm9yICh2YXIgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsNCgkgICAgdmFyIHBhcnQgPSBwYXJ0c1tpXS5wYXJ0LA0KDQoJICAgIC8vIElmIHdlIGhhdmUgW10gc3ludGF4IHRoZW4gd2UgZG8gbm90IHRyZWF0IHBhdGggcmVmZXJlbmNlcyBhcyBvcGVyYXRvcnMsDQoJICAgIC8vIGkuZS4gZm9vLlt0aGlzXSByZXNvbHZlcyB0byBhcHByb3hpbWF0ZWx5IGNvbnRleHQuZm9vWyd0aGlzJ10NCgkgICAgaXNMaXRlcmFsID0gcGFydHNbaV0ub3JpZ2luYWwgIT09IHBhcnQ7DQoJICAgIG9yaWdpbmFsICs9IChwYXJ0c1tpXS5zZXBhcmF0b3IgfHwgJycpICsgcGFydDsNCg0KCSAgICBpZiAoIWlzTGl0ZXJhbCAmJiAocGFydCA9PT0gJy4uJyB8fCBwYXJ0ID09PSAnLicgfHwgcGFydCA9PT0gJ3RoaXMnKSkgew0KCSAgICAgIGlmIChkaWcubGVuZ3RoID4gMCkgew0KCSAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0ludmFsaWQgcGF0aDogJyArIG9yaWdpbmFsLCB7IGxvYzogbG9jIH0pOw0KCSAgICAgIH0gZWxzZSBpZiAocGFydCA9PT0gJy4uJykgew0KCSAgICAgICAgZGVwdGgrKzsNCgkgICAgICAgIGRlcHRoU3RyaW5nICs9ICcuLi8nOw0KCSAgICAgIH0NCgkgICAgfSBlbHNlIHsNCgkgICAgICBkaWcucHVzaChwYXJ0KTsNCgkgICAgfQ0KCSAgfQ0KDQoJICByZXR1cm4gew0KCSAgICB0eXBlOiAnUGF0aEV4cHJlc3Npb24nLA0KCSAgICBkYXRhOiBkYXRhLA0KCSAgICBkZXB0aDogZGVwdGgsDQoJICAgIHBhcnRzOiBkaWcsDQoJICAgIG9yaWdpbmFsOiBvcmlnaW5hbCwNCgkgICAgbG9jOiBsb2MNCgkgIH07DQoJfQ0KDQoJZnVuY3Rpb24gcHJlcGFyZU11c3RhY2hlKHBhdGgsIHBhcmFtcywgaGFzaCwgb3Blbiwgc3RyaXAsIGxvY0luZm8pIHsNCgkgIC8vIE11c3QgdXNlIGNoYXJBdCB0byBzdXBwb3J0IElFIHByZS0xMA0KCSAgdmFyIGVzY2FwZUZsYWcgPSBvcGVuLmNoYXJBdCgzKSB8fCBvcGVuLmNoYXJBdCgyKSwNCgkgICAgICBlc2NhcGVkID0gZXNjYXBlRmxhZyAhPT0gJ3snICYmIGVzY2FwZUZsYWcgIT09ICcmJzsNCg0KCSAgdmFyIGRlY29yYXRvciA9IC9cKi8udGVzdChvcGVuKTsNCgkgIHJldHVybiB7DQoJICAgIHR5cGU6IGRlY29yYXRvciA/ICdEZWNvcmF0b3InIDogJ011c3RhY2hlU3RhdGVtZW50JywNCgkgICAgcGF0aDogcGF0aCwNCgkgICAgcGFyYW1zOiBwYXJhbXMsDQoJICAgIGhhc2g6IGhhc2gsDQoJICAgIGVzY2FwZWQ6IGVzY2FwZWQsDQoJICAgIHN0cmlwOiBzdHJpcCwNCgkgICAgbG9jOiB0aGlzLmxvY0luZm8obG9jSW5mbykNCgkgIH07DQoJfQ0KDQoJZnVuY3Rpb24gcHJlcGFyZVJhd0Jsb2NrKG9wZW5SYXdCbG9jaywgY29udGVudHMsIGNsb3NlLCBsb2NJbmZvKSB7DQoJICB2YWxpZGF0ZUNsb3NlKG9wZW5SYXdCbG9jaywgY2xvc2UpOw0KDQoJICBsb2NJbmZvID0gdGhpcy5sb2NJbmZvKGxvY0luZm8pOw0KCSAgdmFyIHByb2dyYW0gPSB7DQoJICAgIHR5cGU6ICdQcm9ncmFtJywNCgkgICAgYm9keTogY29udGVudHMsDQoJICAgIHN0cmlwOiB7fSwNCgkgICAgbG9jOiBsb2NJbmZvDQoJICB9Ow0KDQoJICByZXR1cm4gew0KCSAgICB0eXBlOiAnQmxvY2tTdGF0ZW1lbnQnLA0KCSAgICBwYXRoOiBvcGVuUmF3QmxvY2sucGF0aCwNCgkgICAgcGFyYW1zOiBvcGVuUmF3QmxvY2sucGFyYW1zLA0KCSAgICBoYXNoOiBvcGVuUmF3QmxvY2suaGFzaCwNCgkgICAgcHJvZ3JhbTogcHJvZ3JhbSwNCgkgICAgb3BlblN0cmlwOiB7fSwNCgkgICAgaW52ZXJzZVN0cmlwOiB7fSwNCgkgICAgY2xvc2VTdHJpcDoge30sDQoJICAgIGxvYzogbG9jSW5mbw0KCSAgfTsNCgl9DQoNCglmdW5jdGlvbiBwcmVwYXJlQmxvY2sob3BlbkJsb2NrLCBwcm9ncmFtLCBpbnZlcnNlQW5kUHJvZ3JhbSwgY2xvc2UsIGludmVydGVkLCBsb2NJbmZvKSB7DQoJICBpZiAoY2xvc2UgJiYgY2xvc2UucGF0aCkgew0KCSAgICB2YWxpZGF0ZUNsb3NlKG9wZW5CbG9jaywgY2xvc2UpOw0KCSAgfQ0KDQoJICB2YXIgZGVjb3JhdG9yID0gL1wqLy50ZXN0KG9wZW5CbG9jay5vcGVuKTsNCg0KCSAgcHJvZ3JhbS5ibG9ja1BhcmFtcyA9IG9wZW5CbG9jay5ibG9ja1BhcmFtczsNCg0KCSAgdmFyIGludmVyc2UgPSB1bmRlZmluZWQsDQoJICAgICAgaW52ZXJzZVN0cmlwID0gdW5kZWZpbmVkOw0KDQoJICBpZiAoaW52ZXJzZUFuZFByb2dyYW0pIHsNCgkgICAgaWYgKGRlY29yYXRvcikgew0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbmV4cGVjdGVkIGludmVyc2UgYmxvY2sgb24gZGVjb3JhdG9yJywgaW52ZXJzZUFuZFByb2dyYW0pOw0KCSAgICB9DQoNCgkgICAgaWYgKGludmVyc2VBbmRQcm9ncmFtLmNoYWluKSB7DQoJICAgICAgaW52ZXJzZUFuZFByb2dyYW0ucHJvZ3JhbS5ib2R5WzBdLmNsb3NlU3RyaXAgPSBjbG9zZS5zdHJpcDsNCgkgICAgfQ0KDQoJICAgIGludmVyc2VTdHJpcCA9IGludmVyc2VBbmRQcm9ncmFtLnN0cmlwOw0KCSAgICBpbnZlcnNlID0gaW52ZXJzZUFuZFByb2dyYW0ucHJvZ3JhbTsNCgkgIH0NCg0KCSAgaWYgKGludmVydGVkKSB7DQoJICAgIGludmVydGVkID0gaW52ZXJzZTsNCgkgICAgaW52ZXJzZSA9IHByb2dyYW07DQoJICAgIHByb2dyYW0gPSBpbnZlcnRlZDsNCgkgIH0NCg0KCSAgcmV0dXJuIHsNCgkgICAgdHlwZTogZGVjb3JhdG9yID8gJ0RlY29yYXRvckJsb2NrJyA6ICdCbG9ja1N0YXRlbWVudCcsDQoJICAgIHBhdGg6IG9wZW5CbG9jay5wYXRoLA0KCSAgICBwYXJhbXM6IG9wZW5CbG9jay5wYXJhbXMsDQoJICAgIGhhc2g6IG9wZW5CbG9jay5oYXNoLA0KCSAgICBwcm9ncmFtOiBwcm9ncmFtLA0KCSAgICBpbnZlcnNlOiBpbnZlcnNlLA0KCSAgICBvcGVuU3RyaXA6IG9wZW5CbG9jay5zdHJpcCwNCgkgICAgaW52ZXJzZVN0cmlwOiBpbnZlcnNlU3RyaXAsDQoJICAgIGNsb3NlU3RyaXA6IGNsb3NlICYmIGNsb3NlLnN0cmlwLA0KCSAgICBsb2M6IHRoaXMubG9jSW5mbyhsb2NJbmZvKQ0KCSAgfTsNCgl9DQoNCglmdW5jdGlvbiBwcmVwYXJlUHJvZ3JhbShzdGF0ZW1lbnRzLCBsb2MpIHsNCgkgIGlmICghbG9jICYmIHN0YXRlbWVudHMubGVuZ3RoKSB7DQoJICAgIHZhciBmaXJzdExvYyA9IHN0YXRlbWVudHNbMF0ubG9jLA0KCSAgICAgICAgbGFzdExvYyA9IHN0YXRlbWVudHNbc3RhdGVtZW50cy5sZW5ndGggLSAxXS5sb2M7DQoNCgkgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8NCgkgICAgaWYgKGZpcnN0TG9jICYmIGxhc3RMb2MpIHsNCgkgICAgICBsb2MgPSB7DQoJICAgICAgICBzb3VyY2U6IGZpcnN0TG9jLnNvdXJjZSwNCgkgICAgICAgIHN0YXJ0OiB7DQoJICAgICAgICAgIGxpbmU6IGZpcnN0TG9jLnN0YXJ0LmxpbmUsDQoJICAgICAgICAgIGNvbHVtbjogZmlyc3RMb2Muc3RhcnQuY29sdW1uDQoJICAgICAgICB9LA0KCSAgICAgICAgZW5kOiB7DQoJICAgICAgICAgIGxpbmU6IGxhc3RMb2MuZW5kLmxpbmUsDQoJICAgICAgICAgIGNvbHVtbjogbGFzdExvYy5lbmQuY29sdW1uDQoJICAgICAgICB9DQoJICAgICAgfTsNCgkgICAgfQ0KCSAgfQ0KDQoJICByZXR1cm4gew0KCSAgICB0eXBlOiAnUHJvZ3JhbScsDQoJICAgIGJvZHk6IHN0YXRlbWVudHMsDQoJICAgIHN0cmlwOiB7fSwNCgkgICAgbG9jOiBsb2MNCgkgIH07DQoJfQ0KDQoJZnVuY3Rpb24gcHJlcGFyZVBhcnRpYWxCbG9jayhvcGVuLCBwcm9ncmFtLCBjbG9zZSwgbG9jSW5mbykgew0KCSAgdmFsaWRhdGVDbG9zZShvcGVuLCBjbG9zZSk7DQoNCgkgIHJldHVybiB7DQoJICAgIHR5cGU6ICdQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQnLA0KCSAgICBuYW1lOiBvcGVuLnBhdGgsDQoJICAgIHBhcmFtczogb3Blbi5wYXJhbXMsDQoJICAgIGhhc2g6IG9wZW4uaGFzaCwNCgkgICAgcHJvZ3JhbTogcHJvZ3JhbSwNCgkgICAgb3BlblN0cmlwOiBvcGVuLnN0cmlwLA0KCSAgICBjbG9zZVN0cmlwOiBjbG9zZSAmJiBjbG9zZS5zdHJpcCwNCgkgICAgbG9jOiB0aGlzLmxvY0luZm8obG9jSW5mbykNCgkgIH07DQoJfQ0KDQovKioqLyB9KSwNCi8qIDQxICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkvKiBlc2xpbnQtZGlzYWJsZSBuZXctY2FwICovDQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoJZXhwb3J0cy5Db21waWxlciA9IENvbXBpbGVyOw0KCWV4cG9ydHMucHJlY29tcGlsZSA9IHByZWNvbXBpbGU7DQoJZXhwb3J0cy5jb21waWxlID0gY29tcGlsZTsNCg0KCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsNCg0KCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7DQoNCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsNCg0KCXZhciBfYXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7DQoNCgl2YXIgX2FzdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3QpOw0KDQoJdmFyIHNsaWNlID0gW10uc2xpY2U7DQoNCglmdW5jdGlvbiBDb21waWxlcigpIHt9DQoNCgkvLyB0aGUgZm91bmRIZWxwZXIgcmVnaXN0ZXIgd2lsbCBkaXNhbWJpZ3VhdGUgaGVscGVyIGxvb2t1cCBmcm9tIGZpbmRpbmcgYQ0KCS8vIGZ1bmN0aW9uIGluIGEgY29udGV4dC4gVGhpcyBpcyBuZWNlc3NhcnkgZm9yIG11c3RhY2hlIGNvbXBhdGliaWxpdHksIHdoaWNoDQoJLy8gcmVxdWlyZXMgdGhhdCBjb250ZXh0IGZ1bmN0aW9ucyBpbiBibG9ja3MgYXJlIGV2YWx1YXRlZCBieSBibG9ja0hlbHBlck1pc3NpbmcsDQoJLy8gYW5kIHRoZW4gcHJvY2VlZCBhcyBpZiB0aGUgcmVzdWx0aW5nIHZhbHVlIHdhcyBwcm92aWRlZCB0byBibG9ja0hlbHBlck1pc3NpbmcuDQoNCglDb21waWxlci5wcm90b3R5cGUgPSB7DQoJICBjb21waWxlcjogQ29tcGlsZXIsDQoNCgkgIGVxdWFsczogZnVuY3Rpb24gZXF1YWxzKG90aGVyKSB7DQoJICAgIHZhciBsZW4gPSB0aGlzLm9wY29kZXMubGVuZ3RoOw0KCSAgICBpZiAob3RoZXIub3Bjb2Rlcy5sZW5ndGggIT09IGxlbikgew0KCSAgICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KDQoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsNCgkgICAgICB2YXIgb3Bjb2RlID0gdGhpcy5vcGNvZGVzW2ldLA0KCSAgICAgICAgICBvdGhlck9wY29kZSA9IG90aGVyLm9wY29kZXNbaV07DQoJICAgICAgaWYgKG9wY29kZS5vcGNvZGUgIT09IG90aGVyT3Bjb2RlLm9wY29kZSB8fCAhYXJnRXF1YWxzKG9wY29kZS5hcmdzLCBvdGhlck9wY29kZS5hcmdzKSkgew0KCSAgICAgICAgcmV0dXJuIGZhbHNlOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIC8vIFdlIGtub3cgdGhhdCBsZW5ndGggaXMgdGhlIHNhbWUgYmV0d2VlbiB0aGUgdHdvIGFycmF5cyBiZWNhdXNlIHRoZXkgYXJlIGRpcmVjdGx5IHRpZWQNCgkgICAgLy8gdG8gdGhlIG9wY29kZSBiZWhhdmlvciBhYm92ZS4NCgkgICAgbGVuID0gdGhpcy5jaGlsZHJlbi5sZW5ndGg7DQoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsNCgkgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uZXF1YWxzKG90aGVyLmNoaWxkcmVuW2ldKSkgew0KCSAgICAgICAgcmV0dXJuIGZhbHNlOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIHJldHVybiB0cnVlOw0KCSAgfSwNCg0KCSAgZ3VpZDogMCwNCg0KCSAgY29tcGlsZTogZnVuY3Rpb24gY29tcGlsZShwcm9ncmFtLCBvcHRpb25zKSB7DQoJICAgIHRoaXMuc291cmNlTm9kZSA9IFtdOw0KCSAgICB0aGlzLm9wY29kZXMgPSBbXTsNCgkgICAgdGhpcy5jaGlsZHJlbiA9IFtdOw0KCSAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOw0KCSAgICB0aGlzLnN0cmluZ1BhcmFtcyA9IG9wdGlvbnMuc3RyaW5nUGFyYW1zOw0KCSAgICB0aGlzLnRyYWNrSWRzID0gb3B0aW9ucy50cmFja0lkczsNCg0KCSAgICBvcHRpb25zLmJsb2NrUGFyYW1zID0gb3B0aW9ucy5ibG9ja1BhcmFtcyB8fCBbXTsNCg0KCSAgICAvLyBUaGVzZSBjaGFuZ2VzIHdpbGwgcHJvcGFnYXRlIHRvIHRoZSBvdGhlciBjb21waWxlciBjb21wb25lbnRzDQoJICAgIHZhciBrbm93bkhlbHBlcnMgPSBvcHRpb25zLmtub3duSGVscGVyczsNCgkgICAgb3B0aW9ucy5rbm93bkhlbHBlcnMgPSB7DQoJICAgICAgJ2hlbHBlck1pc3NpbmcnOiB0cnVlLA0KCSAgICAgICdibG9ja0hlbHBlck1pc3NpbmcnOiB0cnVlLA0KCSAgICAgICdlYWNoJzogdHJ1ZSwNCgkgICAgICAnaWYnOiB0cnVlLA0KCSAgICAgICd1bmxlc3MnOiB0cnVlLA0KCSAgICAgICd3aXRoJzogdHJ1ZSwNCgkgICAgICAnbG9nJzogdHJ1ZSwNCgkgICAgICAnbG9va3VwJzogdHJ1ZQ0KCSAgICB9Ow0KCSAgICBpZiAoa25vd25IZWxwZXJzKSB7DQoJICAgICAgZm9yICh2YXIgX25hbWUgaW4ga25vd25IZWxwZXJzKSB7DQoJICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLw0KCSAgICAgICAgaWYgKF9uYW1lIGluIGtub3duSGVscGVycykgew0KCSAgICAgICAgICB0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzW19uYW1lXSA9IGtub3duSGVscGVyc1tfbmFtZV07DQoJICAgICAgICB9DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgcmV0dXJuIHRoaXMuYWNjZXB0KHByb2dyYW0pOw0KCSAgfSwNCg0KCSAgY29tcGlsZVByb2dyYW06IGZ1bmN0aW9uIGNvbXBpbGVQcm9ncmFtKHByb2dyYW0pIHsNCgkgICAgdmFyIGNoaWxkQ29tcGlsZXIgPSBuZXcgdGhpcy5jb21waWxlcigpLA0KCSAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuZXctY2FwDQoJICAgIHJlc3VsdCA9IGNoaWxkQ29tcGlsZXIuY29tcGlsZShwcm9ncmFtLCB0aGlzLm9wdGlvbnMpLA0KCSAgICAgICAgZ3VpZCA9IHRoaXMuZ3VpZCsrOw0KDQoJICAgIHRoaXMudXNlUGFydGlhbCA9IHRoaXMudXNlUGFydGlhbCB8fCByZXN1bHQudXNlUGFydGlhbDsNCg0KCSAgICB0aGlzLmNoaWxkcmVuW2d1aWRdID0gcmVzdWx0Ow0KCSAgICB0aGlzLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzIHx8IHJlc3VsdC51c2VEZXB0aHM7DQoNCgkgICAgcmV0dXJuIGd1aWQ7DQoJICB9LA0KDQoJICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdChub2RlKSB7DQoJICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBTYW5pdHkgY29kZSAqLw0KCSAgICBpZiAoIXRoaXNbbm9kZS50eXBlXSkgew0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbmtub3duIHR5cGU6ICcgKyBub2RlLnR5cGUsIG5vZGUpOw0KCSAgICB9DQoNCgkgICAgdGhpcy5zb3VyY2VOb2RlLnVuc2hpZnQobm9kZSk7DQoJICAgIHZhciByZXQgPSB0aGlzW25vZGUudHlwZV0obm9kZSk7DQoJICAgIHRoaXMuc291cmNlTm9kZS5zaGlmdCgpOw0KCSAgICByZXR1cm4gcmV0Ow0KCSAgfSwNCg0KCSAgUHJvZ3JhbTogZnVuY3Rpb24gUHJvZ3JhbShwcm9ncmFtKSB7DQoJICAgIHRoaXMub3B0aW9ucy5ibG9ja1BhcmFtcy51bnNoaWZ0KHByb2dyYW0uYmxvY2tQYXJhbXMpOw0KDQoJICAgIHZhciBib2R5ID0gcHJvZ3JhbS5ib2R5LA0KCSAgICAgICAgYm9keUxlbmd0aCA9IGJvZHkubGVuZ3RoOw0KCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvZHlMZW5ndGg7IGkrKykgew0KCSAgICAgIHRoaXMuYWNjZXB0KGJvZHlbaV0pOw0KCSAgICB9DQoNCgkgICAgdGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLnNoaWZ0KCk7DQoNCgkgICAgdGhpcy5pc1NpbXBsZSA9IGJvZHlMZW5ndGggPT09IDE7DQoJICAgIHRoaXMuYmxvY2tQYXJhbXMgPSBwcm9ncmFtLmJsb2NrUGFyYW1zID8gcHJvZ3JhbS5ibG9ja1BhcmFtcy5sZW5ndGggOiAwOw0KDQoJICAgIHJldHVybiB0aGlzOw0KCSAgfSwNCg0KCSAgQmxvY2tTdGF0ZW1lbnQ6IGZ1bmN0aW9uIEJsb2NrU3RhdGVtZW50KGJsb2NrKSB7DQoJICAgIHRyYW5zZm9ybUxpdGVyYWxUb1BhdGgoYmxvY2spOw0KDQoJICAgIHZhciBwcm9ncmFtID0gYmxvY2sucHJvZ3JhbSwNCgkgICAgICAgIGludmVyc2UgPSBibG9jay5pbnZlcnNlOw0KDQoJICAgIHByb2dyYW0gPSBwcm9ncmFtICYmIHRoaXMuY29tcGlsZVByb2dyYW0ocHJvZ3JhbSk7DQoJICAgIGludmVyc2UgPSBpbnZlcnNlICYmIHRoaXMuY29tcGlsZVByb2dyYW0oaW52ZXJzZSk7DQoNCgkgICAgdmFyIHR5cGUgPSB0aGlzLmNsYXNzaWZ5U2V4cHIoYmxvY2spOw0KDQoJICAgIGlmICh0eXBlID09PSAnaGVscGVyJykgew0KCSAgICAgIHRoaXMuaGVscGVyU2V4cHIoYmxvY2ssIHByb2dyYW0sIGludmVyc2UpOw0KCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzaW1wbGUnKSB7DQoJICAgICAgdGhpcy5zaW1wbGVTZXhwcihibG9jayk7DQoNCgkgICAgICAvLyBub3cgdGhhdCB0aGUgc2ltcGxlIG11c3RhY2hlIGlzIHJlc29sdmVkLCB3ZSBuZWVkIHRvDQoJICAgICAgLy8gZXZhbHVhdGUgaXQgYnkgZXhlY3V0aW5nIGBibG9ja0hlbHBlck1pc3NpbmdgDQoJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgcHJvZ3JhbSk7DQoJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2VtcHR5SGFzaCcpOw0KCSAgICAgIHRoaXMub3Bjb2RlKCdibG9ja1ZhbHVlJywgYmxvY2sucGF0aC5vcmlnaW5hbCk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5hbWJpZ3VvdXNTZXhwcihibG9jaywgcHJvZ3JhbSwgaW52ZXJzZSk7DQoNCgkgICAgICAvLyBub3cgdGhhdCB0aGUgc2ltcGxlIG11c3RhY2hlIGlzIHJlc29sdmVkLCB3ZSBuZWVkIHRvDQoJICAgICAgLy8gZXZhbHVhdGUgaXQgYnkgZXhlY3V0aW5nIGBibG9ja0hlbHBlck1pc3NpbmdgDQoJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgcHJvZ3JhbSk7DQoJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2VtcHR5SGFzaCcpOw0KCSAgICAgIHRoaXMub3Bjb2RlKCdhbWJpZ3VvdXNCbG9ja1ZhbHVlJyk7DQoJICAgIH0NCg0KCSAgICB0aGlzLm9wY29kZSgnYXBwZW5kJyk7DQoJICB9LA0KDQoJICBEZWNvcmF0b3JCbG9jazogZnVuY3Rpb24gRGVjb3JhdG9yQmxvY2soZGVjb3JhdG9yKSB7DQoJICAgIHZhciBwcm9ncmFtID0gZGVjb3JhdG9yLnByb2dyYW0gJiYgdGhpcy5jb21waWxlUHJvZ3JhbShkZWNvcmF0b3IucHJvZ3JhbSk7DQoJICAgIHZhciBwYXJhbXMgPSB0aGlzLnNldHVwRnVsbE11c3RhY2hlUGFyYW1zKGRlY29yYXRvciwgcHJvZ3JhbSwgdW5kZWZpbmVkKSwNCgkgICAgICAgIHBhdGggPSBkZWNvcmF0b3IucGF0aDsNCg0KCSAgICB0aGlzLnVzZURlY29yYXRvcnMgPSB0cnVlOw0KCSAgICB0aGlzLm9wY29kZSgncmVnaXN0ZXJEZWNvcmF0b3InLCBwYXJhbXMubGVuZ3RoLCBwYXRoLm9yaWdpbmFsKTsNCgkgIH0sDQoNCgkgIFBhcnRpYWxTdGF0ZW1lbnQ6IGZ1bmN0aW9uIFBhcnRpYWxTdGF0ZW1lbnQocGFydGlhbCkgew0KCSAgICB0aGlzLnVzZVBhcnRpYWwgPSB0cnVlOw0KDQoJICAgIHZhciBwcm9ncmFtID0gcGFydGlhbC5wcm9ncmFtOw0KCSAgICBpZiAocHJvZ3JhbSkgew0KCSAgICAgIHByb2dyYW0gPSB0aGlzLmNvbXBpbGVQcm9ncmFtKHBhcnRpYWwucHJvZ3JhbSk7DQoJICAgIH0NCg0KCSAgICB2YXIgcGFyYW1zID0gcGFydGlhbC5wYXJhbXM7DQoJICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkgew0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbnN1cHBvcnRlZCBudW1iZXIgb2YgcGFydGlhbCBhcmd1bWVudHM6ICcgKyBwYXJhbXMubGVuZ3RoLCBwYXJ0aWFsKTsNCgkgICAgfSBlbHNlIGlmICghcGFyYW1zLmxlbmd0aCkgew0KCSAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwbGljaXRQYXJ0aWFsQ29udGV4dCkgew0KCSAgICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hMaXRlcmFsJywgJ3VuZGVmaW5lZCcpOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICBwYXJhbXMucHVzaCh7IHR5cGU6ICdQYXRoRXhwcmVzc2lvbicsIHBhcnRzOiBbXSwgZGVwdGg6IDAgfSk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgdmFyIHBhcnRpYWxOYW1lID0gcGFydGlhbC5uYW1lLm9yaWdpbmFsLA0KCSAgICAgICAgaXNEeW5hbWljID0gcGFydGlhbC5uYW1lLnR5cGUgPT09ICdTdWJFeHByZXNzaW9uJzsNCgkgICAgaWYgKGlzRHluYW1pYykgew0KCSAgICAgIHRoaXMuYWNjZXB0KHBhcnRpYWwubmFtZSk7DQoJICAgIH0NCg0KCSAgICB0aGlzLnNldHVwRnVsbE11c3RhY2hlUGFyYW1zKHBhcnRpYWwsIHByb2dyYW0sIHVuZGVmaW5lZCwgdHJ1ZSk7DQoNCgkgICAgdmFyIGluZGVudCA9IHBhcnRpYWwuaW5kZW50IHx8ICcnOw0KCSAgICBpZiAodGhpcy5vcHRpb25zLnByZXZlbnRJbmRlbnQgJiYgaW5kZW50KSB7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2FwcGVuZENvbnRlbnQnLCBpbmRlbnQpOw0KCSAgICAgIGluZGVudCA9ICcnOw0KCSAgICB9DQoNCgkgICAgdGhpcy5vcGNvZGUoJ2ludm9rZVBhcnRpYWwnLCBpc0R5bmFtaWMsIHBhcnRpYWxOYW1lLCBpbmRlbnQpOw0KCSAgICB0aGlzLm9wY29kZSgnYXBwZW5kJyk7DQoJICB9LA0KCSAgUGFydGlhbEJsb2NrU3RhdGVtZW50OiBmdW5jdGlvbiBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQocGFydGlhbEJsb2NrKSB7DQoJICAgIHRoaXMuUGFydGlhbFN0YXRlbWVudChwYXJ0aWFsQmxvY2spOw0KCSAgfSwNCg0KCSAgTXVzdGFjaGVTdGF0ZW1lbnQ6IGZ1bmN0aW9uIE11c3RhY2hlU3RhdGVtZW50KG11c3RhY2hlKSB7DQoJICAgIHRoaXMuU3ViRXhwcmVzc2lvbihtdXN0YWNoZSk7DQoNCgkgICAgaWYgKG11c3RhY2hlLmVzY2FwZWQgJiYgIXRoaXMub3B0aW9ucy5ub0VzY2FwZSkgew0KCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmRFc2NhcGVkJyk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2FwcGVuZCcpOw0KCSAgICB9DQoJICB9LA0KCSAgRGVjb3JhdG9yOiBmdW5jdGlvbiBEZWNvcmF0b3IoZGVjb3JhdG9yKSB7DQoJICAgIHRoaXMuRGVjb3JhdG9yQmxvY2soZGVjb3JhdG9yKTsNCgkgIH0sDQoNCgkgIENvbnRlbnRTdGF0ZW1lbnQ6IGZ1bmN0aW9uIENvbnRlbnRTdGF0ZW1lbnQoY29udGVudCkgew0KCSAgICBpZiAoY29udGVudC52YWx1ZSkgew0KCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmRDb250ZW50JywgY29udGVudC52YWx1ZSk7DQoJICAgIH0NCgkgIH0sDQoNCgkgIENvbW1lbnRTdGF0ZW1lbnQ6IGZ1bmN0aW9uIENvbW1lbnRTdGF0ZW1lbnQoKSB7fSwNCg0KCSAgU3ViRXhwcmVzc2lvbjogZnVuY3Rpb24gU3ViRXhwcmVzc2lvbihzZXhwcikgew0KCSAgICB0cmFuc2Zvcm1MaXRlcmFsVG9QYXRoKHNleHByKTsNCgkgICAgdmFyIHR5cGUgPSB0aGlzLmNsYXNzaWZ5U2V4cHIoc2V4cHIpOw0KDQoJICAgIGlmICh0eXBlID09PSAnc2ltcGxlJykgew0KCSAgICAgIHRoaXMuc2ltcGxlU2V4cHIoc2V4cHIpOw0KCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdoZWxwZXInKSB7DQoJICAgICAgdGhpcy5oZWxwZXJTZXhwcihzZXhwcik7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5hbWJpZ3VvdXNTZXhwcihzZXhwcik7DQoJICAgIH0NCgkgIH0sDQoJICBhbWJpZ3VvdXNTZXhwcjogZnVuY3Rpb24gYW1iaWd1b3VzU2V4cHIoc2V4cHIsIHByb2dyYW0sIGludmVyc2UpIHsNCgkgICAgdmFyIHBhdGggPSBzZXhwci5wYXRoLA0KCSAgICAgICAgbmFtZSA9IHBhdGgucGFydHNbMF0sDQoJICAgICAgICBpc0Jsb2NrID0gcHJvZ3JhbSAhPSBudWxsIHx8IGludmVyc2UgIT0gbnVsbDsNCg0KCSAgICB0aGlzLm9wY29kZSgnZ2V0Q29udGV4dCcsIHBhdGguZGVwdGgpOw0KDQoJICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIHByb2dyYW0pOw0KCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBpbnZlcnNlKTsNCg0KCSAgICBwYXRoLnN0cmljdCA9IHRydWU7DQoJICAgIHRoaXMuYWNjZXB0KHBhdGgpOw0KDQoJICAgIHRoaXMub3Bjb2RlKCdpbnZva2VBbWJpZ3VvdXMnLCBuYW1lLCBpc0Jsb2NrKTsNCgkgIH0sDQoNCgkgIHNpbXBsZVNleHByOiBmdW5jdGlvbiBzaW1wbGVTZXhwcihzZXhwcikgew0KCSAgICB2YXIgcGF0aCA9IHNleHByLnBhdGg7DQoJICAgIHBhdGguc3RyaWN0ID0gdHJ1ZTsNCgkgICAgdGhpcy5hY2NlcHQocGF0aCk7DQoJICAgIHRoaXMub3Bjb2RlKCdyZXNvbHZlUG9zc2libGVMYW1iZGEnKTsNCgkgIH0sDQoNCgkgIGhlbHBlclNleHByOiBmdW5jdGlvbiBoZWxwZXJTZXhwcihzZXhwciwgcHJvZ3JhbSwgaW52ZXJzZSkgew0KCSAgICB2YXIgcGFyYW1zID0gdGhpcy5zZXR1cEZ1bGxNdXN0YWNoZVBhcmFtcyhzZXhwciwgcHJvZ3JhbSwgaW52ZXJzZSksDQoJICAgICAgICBwYXRoID0gc2V4cHIucGF0aCwNCgkgICAgICAgIG5hbWUgPSBwYXRoLnBhcnRzWzBdOw0KDQoJICAgIGlmICh0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzW25hbWVdKSB7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2ludm9rZUtub3duSGVscGVyJywgcGFyYW1zLmxlbmd0aCwgbmFtZSk7DQoJICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLmtub3duSGVscGVyc09ubHkpIHsNCgkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnWW91IHNwZWNpZmllZCBrbm93bkhlbHBlcnNPbmx5LCBidXQgdXNlZCB0aGUgdW5rbm93biBoZWxwZXIgJyArIG5hbWUsIHNleHByKTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICBwYXRoLnN0cmljdCA9IHRydWU7DQoJICAgICAgcGF0aC5mYWxzeSA9IHRydWU7DQoNCgkgICAgICB0aGlzLmFjY2VwdChwYXRoKTsNCgkgICAgICB0aGlzLm9wY29kZSgnaW52b2tlSGVscGVyJywgcGFyYW1zLmxlbmd0aCwgcGF0aC5vcmlnaW5hbCwgX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLnNpbXBsZUlkKHBhdGgpKTsNCgkgICAgfQ0KCSAgfSwNCg0KCSAgUGF0aEV4cHJlc3Npb246IGZ1bmN0aW9uIFBhdGhFeHByZXNzaW9uKHBhdGgpIHsNCgkgICAgdGhpcy5hZGREZXB0aChwYXRoLmRlcHRoKTsNCgkgICAgdGhpcy5vcGNvZGUoJ2dldENvbnRleHQnLCBwYXRoLmRlcHRoKTsNCg0KCSAgICB2YXIgbmFtZSA9IHBhdGgucGFydHNbMF0sDQoJICAgICAgICBzY29wZWQgPSBfYXN0MlsnZGVmYXVsdCddLmhlbHBlcnMuc2NvcGVkSWQocGF0aCksDQoJICAgICAgICBibG9ja1BhcmFtSWQgPSAhcGF0aC5kZXB0aCAmJiAhc2NvcGVkICYmIHRoaXMuYmxvY2tQYXJhbUluZGV4KG5hbWUpOw0KDQoJICAgIGlmIChibG9ja1BhcmFtSWQpIHsNCgkgICAgICB0aGlzLm9wY29kZSgnbG9va3VwQmxvY2tQYXJhbScsIGJsb2NrUGFyYW1JZCwgcGF0aC5wYXJ0cyk7DQoJICAgIH0gZWxzZSBpZiAoIW5hbWUpIHsNCgkgICAgICAvLyBDb250ZXh0IHJlZmVyZW5jZSwgaS5lLiBge3tmb28gLn19YCBvciBge3tmb28gLi59fWANCgkgICAgICB0aGlzLm9wY29kZSgncHVzaENvbnRleHQnKTsNCgkgICAgfSBlbHNlIGlmIChwYXRoLmRhdGEpIHsNCgkgICAgICB0aGlzLm9wdGlvbnMuZGF0YSA9IHRydWU7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2xvb2t1cERhdGEnLCBwYXRoLmRlcHRoLCBwYXRoLnBhcnRzLCBwYXRoLnN0cmljdCk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2xvb2t1cE9uQ29udGV4dCcsIHBhdGgucGFydHMsIHBhdGguZmFsc3ksIHBhdGguc3RyaWN0LCBzY29wZWQpOw0KCSAgICB9DQoJICB9LA0KDQoJICBTdHJpbmdMaXRlcmFsOiBmdW5jdGlvbiBTdHJpbmdMaXRlcmFsKHN0cmluZykgew0KCSAgICB0aGlzLm9wY29kZSgncHVzaFN0cmluZycsIHN0cmluZy52YWx1ZSk7DQoJICB9LA0KDQoJICBOdW1iZXJMaXRlcmFsOiBmdW5jdGlvbiBOdW1iZXJMaXRlcmFsKG51bWJlcikgew0KCSAgICB0aGlzLm9wY29kZSgncHVzaExpdGVyYWwnLCBudW1iZXIudmFsdWUpOw0KCSAgfSwNCg0KCSAgQm9vbGVhbkxpdGVyYWw6IGZ1bmN0aW9uIEJvb2xlYW5MaXRlcmFsKGJvb2wpIHsNCgkgICAgdGhpcy5vcGNvZGUoJ3B1c2hMaXRlcmFsJywgYm9vbC52YWx1ZSk7DQoJICB9LA0KDQoJICBVbmRlZmluZWRMaXRlcmFsOiBmdW5jdGlvbiBVbmRlZmluZWRMaXRlcmFsKCkgew0KCSAgICB0aGlzLm9wY29kZSgncHVzaExpdGVyYWwnLCAndW5kZWZpbmVkJyk7DQoJICB9LA0KDQoJICBOdWxsTGl0ZXJhbDogZnVuY3Rpb24gTnVsbExpdGVyYWwoKSB7DQoJICAgIHRoaXMub3Bjb2RlKCdwdXNoTGl0ZXJhbCcsICdudWxsJyk7DQoJICB9LA0KDQoJICBIYXNoOiBmdW5jdGlvbiBIYXNoKGhhc2gpIHsNCgkgICAgdmFyIHBhaXJzID0gaGFzaC5wYWlycywNCgkgICAgICAgIGkgPSAwLA0KCSAgICAgICAgbCA9IHBhaXJzLmxlbmd0aDsNCg0KCSAgICB0aGlzLm9wY29kZSgncHVzaEhhc2gnKTsNCg0KCSAgICBmb3IgKDsgaSA8IGw7IGkrKykgew0KCSAgICAgIHRoaXMucHVzaFBhcmFtKHBhaXJzW2ldLnZhbHVlKTsNCgkgICAgfQ0KCSAgICB3aGlsZSAoaS0tKSB7DQoJICAgICAgdGhpcy5vcGNvZGUoJ2Fzc2lnblRvSGFzaCcsIHBhaXJzW2ldLmtleSk7DQoJICAgIH0NCgkgICAgdGhpcy5vcGNvZGUoJ3BvcEhhc2gnKTsNCgkgIH0sDQoNCgkgIC8vIEhFTFBFUlMNCgkgIG9wY29kZTogZnVuY3Rpb24gb3Bjb2RlKG5hbWUpIHsNCgkgICAgdGhpcy5vcGNvZGVzLnB1c2goeyBvcGNvZGU6IG5hbWUsIGFyZ3M6IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgbG9jOiB0aGlzLnNvdXJjZU5vZGVbMF0ubG9jIH0pOw0KCSAgfSwNCg0KCSAgYWRkRGVwdGg6IGZ1bmN0aW9uIGFkZERlcHRoKGRlcHRoKSB7DQoJICAgIGlmICghZGVwdGgpIHsNCgkgICAgICByZXR1cm47DQoJICAgIH0NCg0KCSAgICB0aGlzLnVzZURlcHRocyA9IHRydWU7DQoJICB9LA0KDQoJICBjbGFzc2lmeVNleHByOiBmdW5jdGlvbiBjbGFzc2lmeVNleHByKHNleHByKSB7DQoJICAgIHZhciBpc1NpbXBsZSA9IF9hc3QyWydkZWZhdWx0J10uaGVscGVycy5zaW1wbGVJZChzZXhwci5wYXRoKTsNCg0KCSAgICB2YXIgaXNCbG9ja1BhcmFtID0gaXNTaW1wbGUgJiYgISF0aGlzLmJsb2NrUGFyYW1JbmRleChzZXhwci5wYXRoLnBhcnRzWzBdKTsNCg0KCSAgICAvLyBhIG11c3RhY2hlIGlzIGFuIGVsaWdpYmxlIGhlbHBlciBpZjoNCgkgICAgLy8gKiBpdHMgaWQgaXMgc2ltcGxlIChhIHNpbmdsZSBwYXJ0LCBub3QgYHRoaXNgIG9yIGAuLmApDQoJICAgIHZhciBpc0hlbHBlciA9ICFpc0Jsb2NrUGFyYW0gJiYgX2FzdDJbJ2RlZmF1bHQnXS5oZWxwZXJzLmhlbHBlckV4cHJlc3Npb24oc2V4cHIpOw0KDQoJICAgIC8vIGlmIGEgbXVzdGFjaGUgaXMgYW4gZWxpZ2libGUgaGVscGVyIGJ1dCBub3QgYSBkZWZpbml0ZQ0KCSAgICAvLyBoZWxwZXIsIGl0IGlzIGFtYmlndW91cywgYW5kIHdpbGwgYmUgcmVzb2x2ZWQgaW4gYSBsYXRlcg0KCSAgICAvLyBwYXNzIG9yIGF0IHJ1bnRpbWUuDQoJICAgIHZhciBpc0VsaWdpYmxlID0gIWlzQmxvY2tQYXJhbSAmJiAoaXNIZWxwZXIgfHwgaXNTaW1wbGUpOw0KDQoJICAgIC8vIGlmIGFtYmlndW91cywgd2UgY2FuIHBvc3NpYmx5IHJlc29sdmUgdGhlIGFtYmlndWl0eSBub3cNCgkgICAgLy8gQW4gZWxpZ2libGUgaGVscGVyIGlzIG9uZSB0aGF0IGRvZXMgbm90IGhhdmUgYSBjb21wbGV4IHBhdGgsIGkuZS4gYHRoaXMuZm9vYCwgYC4uL2Zvb2AgZXRjLg0KCSAgICBpZiAoaXNFbGlnaWJsZSAmJiAhaXNIZWxwZXIpIHsNCgkgICAgICB2YXIgX25hbWUyID0gc2V4cHIucGF0aC5wYXJ0c1swXSwNCgkgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsNCg0KCSAgICAgIGlmIChvcHRpb25zLmtub3duSGVscGVyc1tfbmFtZTJdKSB7DQoJICAgICAgICBpc0hlbHBlciA9IHRydWU7DQoJICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmtub3duSGVscGVyc09ubHkpIHsNCgkgICAgICAgIGlzRWxpZ2libGUgPSBmYWxzZTsNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICBpZiAoaXNIZWxwZXIpIHsNCgkgICAgICByZXR1cm4gJ2hlbHBlcic7DQoJICAgIH0gZWxzZSBpZiAoaXNFbGlnaWJsZSkgew0KCSAgICAgIHJldHVybiAnYW1iaWd1b3VzJzsNCgkgICAgfSBlbHNlIHsNCgkgICAgICByZXR1cm4gJ3NpbXBsZSc7DQoJICAgIH0NCgkgIH0sDQoNCgkgIHB1c2hQYXJhbXM6IGZ1bmN0aW9uIHB1c2hQYXJhbXMocGFyYW1zKSB7DQoJICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGFyYW1zLmxlbmd0aDsgaSA8IGw7IGkrKykgew0KCSAgICAgIHRoaXMucHVzaFBhcmFtKHBhcmFtc1tpXSk7DQoJICAgIH0NCgkgIH0sDQoNCgkgIHB1c2hQYXJhbTogZnVuY3Rpb24gcHVzaFBhcmFtKHZhbCkgew0KCSAgICB2YXIgdmFsdWUgPSB2YWwudmFsdWUgIT0gbnVsbCA/IHZhbC52YWx1ZSA6IHZhbC5vcmlnaW5hbCB8fCAnJzsNCg0KCSAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsNCgkgICAgICBpZiAodmFsdWUucmVwbGFjZSkgew0KCSAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9eKFwuP1wuXC8pKi9nLCAnJykucmVwbGFjZSgvXC8vZywgJy4nKTsNCgkgICAgICB9DQoNCgkgICAgICBpZiAodmFsLmRlcHRoKSB7DQoJICAgICAgICB0aGlzLmFkZERlcHRoKHZhbC5kZXB0aCk7DQoJICAgICAgfQ0KCSAgICAgIHRoaXMub3Bjb2RlKCdnZXRDb250ZXh0JywgdmFsLmRlcHRoIHx8IDApOw0KCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoU3RyaW5nUGFyYW0nLCB2YWx1ZSwgdmFsLnR5cGUpOw0KDQoJICAgICAgaWYgKHZhbC50eXBlID09PSAnU3ViRXhwcmVzc2lvbicpIHsNCgkgICAgICAgIC8vIFN1YkV4cHJlc3Npb25zIGdldCBldmFsdWF0ZWQgYW5kIHBhc3NlZCBpbg0KCSAgICAgICAgLy8gaW4gc3RyaW5nIHBhcmFtcyBtb2RlLg0KCSAgICAgICAgdGhpcy5hY2NlcHQodmFsKTsNCgkgICAgICB9DQoJICAgIH0gZWxzZSB7DQoJICAgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsNCgkgICAgICAgIHZhciBibG9ja1BhcmFtSW5kZXggPSB1bmRlZmluZWQ7DQoJICAgICAgICBpZiAodmFsLnBhcnRzICYmICFfYXN0MlsnZGVmYXVsdCddLmhlbHBlcnMuc2NvcGVkSWQodmFsKSAmJiAhdmFsLmRlcHRoKSB7DQoJICAgICAgICAgIGJsb2NrUGFyYW1JbmRleCA9IHRoaXMuYmxvY2tQYXJhbUluZGV4KHZhbC5wYXJ0c1swXSk7DQoJICAgICAgICB9DQoJICAgICAgICBpZiAoYmxvY2tQYXJhbUluZGV4KSB7DQoJICAgICAgICAgIHZhciBibG9ja1BhcmFtQ2hpbGQgPSB2YWwucGFydHMuc2xpY2UoMSkuam9pbignLicpOw0KCSAgICAgICAgICB0aGlzLm9wY29kZSgncHVzaElkJywgJ0Jsb2NrUGFyYW0nLCBibG9ja1BhcmFtSW5kZXgsIGJsb2NrUGFyYW1DaGlsZCk7DQoJICAgICAgICB9IGVsc2Ugew0KCSAgICAgICAgICB2YWx1ZSA9IHZhbC5vcmlnaW5hbCB8fCB2YWx1ZTsNCgkgICAgICAgICAgaWYgKHZhbHVlLnJlcGxhY2UpIHsNCgkgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoL150aGlzKD86XC58JCkvLCAnJykucmVwbGFjZSgvXlwuXC8vLCAnJykucmVwbGFjZSgvXlwuJC8sICcnKTsNCgkgICAgICAgICAgfQ0KDQoJICAgICAgICAgIHRoaXMub3Bjb2RlKCdwdXNoSWQnLCB2YWwudHlwZSwgdmFsdWUpOw0KCSAgICAgICAgfQ0KCSAgICAgIH0NCgkgICAgICB0aGlzLmFjY2VwdCh2YWwpOw0KCSAgICB9DQoJICB9LA0KDQoJICBzZXR1cEZ1bGxNdXN0YWNoZVBhcmFtczogZnVuY3Rpb24gc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXMoc2V4cHIsIHByb2dyYW0sIGludmVyc2UsIG9taXRFbXB0eSkgew0KCSAgICB2YXIgcGFyYW1zID0gc2V4cHIucGFyYW1zOw0KCSAgICB0aGlzLnB1c2hQYXJhbXMocGFyYW1zKTsNCg0KCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBwcm9ncmFtKTsNCgkgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7DQoNCgkgICAgaWYgKHNleHByLmhhc2gpIHsNCgkgICAgICB0aGlzLmFjY2VwdChzZXhwci5oYXNoKTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICB0aGlzLm9wY29kZSgnZW1wdHlIYXNoJywgb21pdEVtcHR5KTsNCgkgICAgfQ0KDQoJICAgIHJldHVybiBwYXJhbXM7DQoJICB9LA0KDQoJICBibG9ja1BhcmFtSW5kZXg6IGZ1bmN0aW9uIGJsb2NrUGFyYW1JbmRleChuYW1lKSB7DQoJICAgIGZvciAodmFyIGRlcHRoID0gMCwgbGVuID0gdGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLmxlbmd0aDsgZGVwdGggPCBsZW47IGRlcHRoKyspIHsNCgkgICAgICB2YXIgYmxvY2tQYXJhbXMgPSB0aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXNbZGVwdGhdLA0KCSAgICAgICAgICBwYXJhbSA9IGJsb2NrUGFyYW1zICYmIF91dGlscy5pbmRleE9mKGJsb2NrUGFyYW1zLCBuYW1lKTsNCgkgICAgICBpZiAoYmxvY2tQYXJhbXMgJiYgcGFyYW0gPj0gMCkgew0KCSAgICAgICAgcmV0dXJuIFtkZXB0aCwgcGFyYW1dOw0KCSAgICAgIH0NCgkgICAgfQ0KCSAgfQ0KCX07DQoNCglmdW5jdGlvbiBwcmVjb21waWxlKGlucHV0LCBvcHRpb25zLCBlbnYpIHsNCgkgIGlmIChpbnB1dCA9PSBudWxsIHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycgJiYgaW5wdXQudHlwZSAhPT0gJ1Byb2dyYW0nKSB7DQoJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdZb3UgbXVzdCBwYXNzIGEgc3RyaW5nIG9yIEhhbmRsZWJhcnMgQVNUIHRvIEhhbmRsZWJhcnMucHJlY29tcGlsZS4gWW91IHBhc3NlZCAnICsgaW5wdXQpOw0KCSAgfQ0KDQoJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsNCgkgIGlmICghKCdkYXRhJyBpbiBvcHRpb25zKSkgew0KCSAgICBvcHRpb25zLmRhdGEgPSB0cnVlOw0KCSAgfQ0KCSAgaWYgKG9wdGlvbnMuY29tcGF0KSB7DQoJICAgIG9wdGlvbnMudXNlRGVwdGhzID0gdHJ1ZTsNCgkgIH0NCg0KCSAgdmFyIGFzdCA9IGVudi5wYXJzZShpbnB1dCwgb3B0aW9ucyksDQoJICAgICAgZW52aXJvbm1lbnQgPSBuZXcgZW52LkNvbXBpbGVyKCkuY29tcGlsZShhc3QsIG9wdGlvbnMpOw0KCSAgcmV0dXJuIG5ldyBlbnYuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVudCwgb3B0aW9ucyk7DQoJfQ0KDQoJZnVuY3Rpb24gY29tcGlsZShpbnB1dCwgb3B0aW9ucywgZW52KSB7DQoJICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkKSBvcHRpb25zID0ge307DQoNCgkgIGlmIChpbnB1dCA9PSBudWxsIHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycgJiYgaW5wdXQudHlwZSAhPT0gJ1Byb2dyYW0nKSB7DQoJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdZb3UgbXVzdCBwYXNzIGEgc3RyaW5nIG9yIEhhbmRsZWJhcnMgQVNUIHRvIEhhbmRsZWJhcnMuY29tcGlsZS4gWW91IHBhc3NlZCAnICsgaW5wdXQpOw0KCSAgfQ0KDQoJICBvcHRpb25zID0gX3V0aWxzLmV4dGVuZCh7fSwgb3B0aW9ucyk7DQoJICBpZiAoISgnZGF0YScgaW4gb3B0aW9ucykpIHsNCgkgICAgb3B0aW9ucy5kYXRhID0gdHJ1ZTsNCgkgIH0NCgkgIGlmIChvcHRpb25zLmNvbXBhdCkgew0KCSAgICBvcHRpb25zLnVzZURlcHRocyA9IHRydWU7DQoJICB9DQoNCgkgIHZhciBjb21waWxlZCA9IHVuZGVmaW5lZDsNCg0KCSAgZnVuY3Rpb24gY29tcGlsZUlucHV0KCkgew0KCSAgICB2YXIgYXN0ID0gZW52LnBhcnNlKGlucHV0LCBvcHRpb25zKSwNCgkgICAgICAgIGVudmlyb25tZW50ID0gbmV3IGVudi5Db21waWxlcigpLmNvbXBpbGUoYXN0LCBvcHRpb25zKSwNCgkgICAgICAgIHRlbXBsYXRlU3BlYyA9IG5ldyBlbnYuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVudCwgb3B0aW9ucywgdW5kZWZpbmVkLCB0cnVlKTsNCgkgICAgcmV0dXJuIGVudi50ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMpOw0KCSAgfQ0KDQoJICAvLyBUZW1wbGF0ZSBpcyBvbmx5IGNvbXBpbGVkIG9uIGZpcnN0IHVzZSBhbmQgY2FjaGVkIGFmdGVyIHRoYXQgcG9pbnQuDQoJICBmdW5jdGlvbiByZXQoY29udGV4dCwgZXhlY09wdGlvbnMpIHsNCgkgICAgaWYgKCFjb21waWxlZCkgew0KCSAgICAgIGNvbXBpbGVkID0gY29tcGlsZUlucHV0KCk7DQoJICAgIH0NCgkgICAgcmV0dXJuIGNvbXBpbGVkLmNhbGwodGhpcywgY29udGV4dCwgZXhlY09wdGlvbnMpOw0KCSAgfQ0KCSAgcmV0Ll9zZXR1cCA9IGZ1bmN0aW9uIChzZXR1cE9wdGlvbnMpIHsNCgkgICAgaWYgKCFjb21waWxlZCkgew0KCSAgICAgIGNvbXBpbGVkID0gY29tcGlsZUlucHV0KCk7DQoJICAgIH0NCgkgICAgcmV0dXJuIGNvbXBpbGVkLl9zZXR1cChzZXR1cE9wdGlvbnMpOw0KCSAgfTsNCgkgIHJldC5fY2hpbGQgPSBmdW5jdGlvbiAoaSwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocykgew0KCSAgICBpZiAoIWNvbXBpbGVkKSB7DQoJICAgICAgY29tcGlsZWQgPSBjb21waWxlSW5wdXQoKTsNCgkgICAgfQ0KCSAgICByZXR1cm4gY29tcGlsZWQuX2NoaWxkKGksIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOw0KCSAgfTsNCgkgIHJldHVybiByZXQ7DQoJfQ0KDQoJZnVuY3Rpb24gYXJnRXF1YWxzKGEsIGIpIHsNCgkgIGlmIChhID09PSBiKSB7DQoJICAgIHJldHVybiB0cnVlOw0KCSAgfQ0KDQoJICBpZiAoX3V0aWxzLmlzQXJyYXkoYSkgJiYgX3V0aWxzLmlzQXJyYXkoYikgJiYgYS5sZW5ndGggPT09IGIubGVuZ3RoKSB7DQoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgew0KCSAgICAgIGlmICghYXJnRXF1YWxzKGFbaV0sIGJbaV0pKSB7DQoJICAgICAgICByZXR1cm4gZmFsc2U7DQoJICAgICAgfQ0KCSAgICB9DQoJICAgIHJldHVybiB0cnVlOw0KCSAgfQ0KCX0NCg0KCWZ1bmN0aW9uIHRyYW5zZm9ybUxpdGVyYWxUb1BhdGgoc2V4cHIpIHsNCgkgIGlmICghc2V4cHIucGF0aC5wYXJ0cykgew0KCSAgICB2YXIgbGl0ZXJhbCA9IHNleHByLnBhdGg7DQoJICAgIC8vIENhc3RpbmcgdG8gc3RyaW5nIGhlcmUgdG8gbWFrZSBmYWxzZSBhbmQgMCBsaXRlcmFsIHZhbHVlcyBwbGF5IG5pY2VseSB3aXRoIHRoZSByZXN0DQoJICAgIC8vIG9mIHRoZSBzeXN0ZW0uDQoJICAgIHNleHByLnBhdGggPSB7DQoJICAgICAgdHlwZTogJ1BhdGhFeHByZXNzaW9uJywNCgkgICAgICBkYXRhOiBmYWxzZSwNCgkgICAgICBkZXB0aDogMCwNCgkgICAgICBwYXJ0czogW2xpdGVyYWwub3JpZ2luYWwgKyAnJ10sDQoJICAgICAgb3JpZ2luYWw6IGxpdGVyYWwub3JpZ2luYWwgKyAnJywNCgkgICAgICBsb2M6IGxpdGVyYWwubG9jDQoJICAgIH07DQoJICB9DQoJfQ0KDQovKioqLyB9KSwNCi8qIDQyICovDQovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7DQoNCgkndXNlIHN0cmljdCc7DQoNCgl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoNCgl2YXIgX2Jhc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOw0KDQoJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOw0KDQoJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsNCg0KCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOw0KDQoJdmFyIF9jb2RlR2VuID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7DQoNCgl2YXIgX2NvZGVHZW4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29kZUdlbik7DQoNCglmdW5jdGlvbiBMaXRlcmFsKHZhbHVlKSB7DQoJICB0aGlzLnZhbHVlID0gdmFsdWU7DQoJfQ0KDQoJZnVuY3Rpb24gSmF2YVNjcmlwdENvbXBpbGVyKCkge30NCg0KCUphdmFTY3JpcHRDb21waWxlci5wcm90b3R5cGUgPSB7DQoJICAvLyBQVUJMSUMgQVBJOiBZb3UgY2FuIG92ZXJyaWRlIHRoZXNlIG1ldGhvZHMgaW4gYSBzdWJjbGFzcyB0byBwcm92aWRlDQoJICAvLyBhbHRlcm5hdGl2ZSBjb21waWxlZCBmb3JtcyBmb3IgbmFtZSBsb29rdXAgYW5kIGJ1ZmZlcmluZyBzZW1hbnRpY3MNCgkgIG5hbWVMb29rdXA6IGZ1bmN0aW9uIG5hbWVMb29rdXAocGFyZW50LCBuYW1lIC8qICwgdHlwZSovKSB7DQoJICAgIGlmIChKYXZhU2NyaXB0Q29tcGlsZXIuaXNWYWxpZEphdmFTY3JpcHRWYXJpYWJsZU5hbWUobmFtZSkpIHsNCgkgICAgICByZXR1cm4gW3BhcmVudCwgJy4nLCBuYW1lXTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICByZXR1cm4gW3BhcmVudCwgJ1snLCBKU09OLnN0cmluZ2lmeShuYW1lKSwgJ10nXTsNCgkgICAgfQ0KCSAgfSwNCgkgIGRlcHRoZWRMb29rdXA6IGZ1bmN0aW9uIGRlcHRoZWRMb29rdXAobmFtZSkgew0KCSAgICByZXR1cm4gW3RoaXMuYWxpYXNhYmxlKCdjb250YWluZXIubG9va3VwJyksICcoZGVwdGhzLCAiJywgbmFtZSwgJyIpJ107DQoJICB9LA0KDQoJICBjb21waWxlckluZm86IGZ1bmN0aW9uIGNvbXBpbGVySW5mbygpIHsNCgkgICAgdmFyIHJldmlzaW9uID0gX2Jhc2UuQ09NUElMRVJfUkVWSVNJT04sDQoJICAgICAgICB2ZXJzaW9ucyA9IF9iYXNlLlJFVklTSU9OX0NIQU5HRVNbcmV2aXNpb25dOw0KCSAgICByZXR1cm4gW3JldmlzaW9uLCB2ZXJzaW9uc107DQoJICB9LA0KDQoJICBhcHBlbmRUb0J1ZmZlcjogZnVuY3Rpb24gYXBwZW5kVG9CdWZmZXIoc291cmNlLCBsb2NhdGlvbiwgZXhwbGljaXQpIHsNCgkgICAgLy8gRm9yY2UgYSBzb3VyY2UgYXMgdGhpcyBzaW1wbGlmaWVzIHRoZSBtZXJnZSBsb2dpYy4NCgkgICAgaWYgKCFfdXRpbHMuaXNBcnJheShzb3VyY2UpKSB7DQoJICAgICAgc291cmNlID0gW3NvdXJjZV07DQoJICAgIH0NCgkgICAgc291cmNlID0gdGhpcy5zb3VyY2Uud3JhcChzb3VyY2UsIGxvY2F0aW9uKTsNCg0KCSAgICBpZiAodGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSkgew0KCSAgICAgIHJldHVybiBbJ3JldHVybiAnLCBzb3VyY2UsICc7J107DQoJICAgIH0gZWxzZSBpZiAoZXhwbGljaXQpIHsNCgkgICAgICAvLyBUaGlzIGlzIGEgY2FzZSB3aGVyZSB0aGUgYnVmZmVyIG9wZXJhdGlvbiBvY2N1cnMgYXMgYSBjaGlsZCBvZiBhbm90aGVyDQoJICAgICAgLy8gY29uc3RydWN0LCBnZW5lcmFsbHkgYnJhY2VzLiBXZSBoYXZlIHRvIGV4cGxpY2l0bHkgb3V0cHV0IHRoZXNlIGJ1ZmZlcg0KCSAgICAgIC8vIG9wZXJhdGlvbnMgdG8gZW5zdXJlIHRoYXQgdGhlIGVtaXR0ZWQgY29kZSBnb2VzIGluIHRoZSBjb3JyZWN0IGxvY2F0aW9uLg0KCSAgICAgIHJldHVybiBbJ2J1ZmZlciArPSAnLCBzb3VyY2UsICc7J107DQoJICAgIH0gZWxzZSB7DQoJICAgICAgc291cmNlLmFwcGVuZFRvQnVmZmVyID0gdHJ1ZTsNCgkgICAgICByZXR1cm4gc291cmNlOw0KCSAgICB9DQoJICB9LA0KDQoJICBpbml0aWFsaXplQnVmZmVyOiBmdW5jdGlvbiBpbml0aWFsaXplQnVmZmVyKCkgew0KCSAgICByZXR1cm4gdGhpcy5xdW90ZWRTdHJpbmcoJycpOw0KCSAgfSwNCgkgIC8vIEVORCBQVUJMSUMgQVBJDQoNCgkgIGNvbXBpbGU6IGZ1bmN0aW9uIGNvbXBpbGUoZW52aXJvbm1lbnQsIG9wdGlvbnMsIGNvbnRleHQsIGFzT2JqZWN0KSB7DQoJICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDsNCgkgICAgdGhpcy5vcHRpb25zID0gb3B0aW9uczsNCgkgICAgdGhpcy5zdHJpbmdQYXJhbXMgPSB0aGlzLm9wdGlvbnMuc3RyaW5nUGFyYW1zOw0KCSAgICB0aGlzLnRyYWNrSWRzID0gdGhpcy5vcHRpb25zLnRyYWNrSWRzOw0KCSAgICB0aGlzLnByZWNvbXBpbGUgPSAhYXNPYmplY3Q7DQoNCgkgICAgdGhpcy5uYW1lID0gdGhpcy5lbnZpcm9ubWVudC5uYW1lOw0KCSAgICB0aGlzLmlzQ2hpbGQgPSAhIWNvbnRleHQ7DQoJICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQgfHwgew0KCSAgICAgIGRlY29yYXRvcnM6IFtdLA0KCSAgICAgIHByb2dyYW1zOiBbXSwNCgkgICAgICBlbnZpcm9ubWVudHM6IFtdDQoJICAgIH07DQoNCgkgICAgdGhpcy5wcmVhbWJsZSgpOw0KDQoJICAgIHRoaXMuc3RhY2tTbG90ID0gMDsNCgkgICAgdGhpcy5zdGFja1ZhcnMgPSBbXTsNCgkgICAgdGhpcy5hbGlhc2VzID0ge307DQoJICAgIHRoaXMucmVnaXN0ZXJzID0geyBsaXN0OiBbXSB9Ow0KCSAgICB0aGlzLmhhc2hlcyA9IFtdOw0KCSAgICB0aGlzLmNvbXBpbGVTdGFjayA9IFtdOw0KCSAgICB0aGlzLmlubGluZVN0YWNrID0gW107DQoJICAgIHRoaXMuYmxvY2tQYXJhbXMgPSBbXTsNCg0KCSAgICB0aGlzLmNvbXBpbGVDaGlsZHJlbihlbnZpcm9ubWVudCwgb3B0aW9ucyk7DQoNCgkgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCBlbnZpcm9ubWVudC51c2VEZXB0aHMgfHwgZW52aXJvbm1lbnQudXNlRGVjb3JhdG9ycyB8fCB0aGlzLm9wdGlvbnMuY29tcGF0Ow0KCSAgICB0aGlzLnVzZUJsb2NrUGFyYW1zID0gdGhpcy51c2VCbG9ja1BhcmFtcyB8fCBlbnZpcm9ubWVudC51c2VCbG9ja1BhcmFtczsNCg0KCSAgICB2YXIgb3Bjb2RlcyA9IGVudmlyb25tZW50Lm9wY29kZXMsDQoJICAgICAgICBvcGNvZGUgPSB1bmRlZmluZWQsDQoJICAgICAgICBmaXJzdExvYyA9IHVuZGVmaW5lZCwNCgkgICAgICAgIGkgPSB1bmRlZmluZWQsDQoJICAgICAgICBsID0gdW5kZWZpbmVkOw0KDQoJICAgIGZvciAoaSA9IDAsIGwgPSBvcGNvZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgew0KCSAgICAgIG9wY29kZSA9IG9wY29kZXNbaV07DQoNCgkgICAgICB0aGlzLnNvdXJjZS5jdXJyZW50TG9jYXRpb24gPSBvcGNvZGUubG9jOw0KCSAgICAgIGZpcnN0TG9jID0gZmlyc3RMb2MgfHwgb3Bjb2RlLmxvYzsNCgkgICAgICB0aGlzW29wY29kZS5vcGNvZGVdLmFwcGx5KHRoaXMsIG9wY29kZS5hcmdzKTsNCgkgICAgfQ0KDQoJICAgIC8vIEZsdXNoIGFueSB0cmFpbGluZyBjb250ZW50IHRoYXQgbWlnaHQgYmUgcGVuZGluZy4NCgkgICAgdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uID0gZmlyc3RMb2M7DQoJICAgIHRoaXMucHVzaFNvdXJjZSgnJyk7DQoNCgkgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8NCgkgICAgaWYgKHRoaXMuc3RhY2tTbG90IHx8IHRoaXMuaW5saW5lU3RhY2subGVuZ3RoIHx8IHRoaXMuY29tcGlsZVN0YWNrLmxlbmd0aCkgew0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdDb21waWxlIGNvbXBsZXRlZCB3aXRoIGNvbnRlbnQgbGVmdCBvbiBzdGFjaycpOw0KCSAgICB9DQoNCgkgICAgaWYgKCF0aGlzLmRlY29yYXRvcnMuaXNFbXB0eSgpKSB7DQoJICAgICAgdGhpcy51c2VEZWNvcmF0b3JzID0gdHJ1ZTsNCg0KCSAgICAgIHRoaXMuZGVjb3JhdG9ycy5wcmVwZW5kKCd2YXIgZGVjb3JhdG9ycyA9IGNvbnRhaW5lci5kZWNvcmF0b3JzO1xuJyk7DQoJICAgICAgdGhpcy5kZWNvcmF0b3JzLnB1c2goJ3JldHVybiBmbjsnKTsNCg0KCSAgICAgIGlmIChhc09iamVjdCkgew0KCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzID0gRnVuY3Rpb24uYXBwbHkodGhpcywgWydmbicsICdwcm9wcycsICdjb250YWluZXInLCAnZGVwdGgwJywgJ2RhdGEnLCAnYmxvY2tQYXJhbXMnLCAnZGVwdGhzJywgdGhpcy5kZWNvcmF0b3JzLm1lcmdlKCldKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzLnByZXBlbmQoJ2Z1bmN0aW9uKGZuLCBwcm9wcywgY29udGFpbmVyLCBkZXB0aDAsIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcbicpOw0KCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzLnB1c2goJ31cbicpOw0KCSAgICAgICAgdGhpcy5kZWNvcmF0b3JzID0gdGhpcy5kZWNvcmF0b3JzLm1lcmdlKCk7DQoJICAgICAgfQ0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHRoaXMuZGVjb3JhdG9ycyA9IHVuZGVmaW5lZDsNCgkgICAgfQ0KDQoJICAgIHZhciBmbiA9IHRoaXMuY3JlYXRlRnVuY3Rpb25Db250ZXh0KGFzT2JqZWN0KTsNCgkgICAgaWYgKCF0aGlzLmlzQ2hpbGQpIHsNCgkgICAgICB2YXIgcmV0ID0gew0KCSAgICAgICAgY29tcGlsZXI6IHRoaXMuY29tcGlsZXJJbmZvKCksDQoJICAgICAgICBtYWluOiBmbg0KCSAgICAgIH07DQoNCgkgICAgICBpZiAodGhpcy5kZWNvcmF0b3JzKSB7DQoJICAgICAgICByZXQubWFpbl9kID0gdGhpcy5kZWNvcmF0b3JzOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZQ0KCSAgICAgICAgcmV0LnVzZURlY29yYXRvcnMgPSB0cnVlOw0KCSAgICAgIH0NCg0KCSAgICAgIHZhciBfY29udGV4dCA9IHRoaXMuY29udGV4dDsNCgkgICAgICB2YXIgcHJvZ3JhbXMgPSBfY29udGV4dC5wcm9ncmFtczsNCgkgICAgICB2YXIgZGVjb3JhdG9ycyA9IF9jb250ZXh0LmRlY29yYXRvcnM7DQoNCgkgICAgICBmb3IgKGkgPSAwLCBsID0gcHJvZ3JhbXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7DQoJICAgICAgICBpZiAocHJvZ3JhbXNbaV0pIHsNCgkgICAgICAgICAgcmV0W2ldID0gcHJvZ3JhbXNbaV07DQoJICAgICAgICAgIGlmIChkZWNvcmF0b3JzW2ldKSB7DQoJICAgICAgICAgICAgcmV0W2kgKyAnX2QnXSA9IGRlY29yYXRvcnNbaV07DQoJICAgICAgICAgICAgcmV0LnVzZURlY29yYXRvcnMgPSB0cnVlOw0KCSAgICAgICAgICB9DQoJICAgICAgICB9DQoJICAgICAgfQ0KDQoJICAgICAgaWYgKHRoaXMuZW52aXJvbm1lbnQudXNlUGFydGlhbCkgew0KCSAgICAgICAgcmV0LnVzZVBhcnRpYWwgPSB0cnVlOw0KCSAgICAgIH0NCgkgICAgICBpZiAodGhpcy5vcHRpb25zLmRhdGEpIHsNCgkgICAgICAgIHJldC51c2VEYXRhID0gdHJ1ZTsNCgkgICAgICB9DQoJICAgICAgaWYgKHRoaXMudXNlRGVwdGhzKSB7DQoJICAgICAgICByZXQudXNlRGVwdGhzID0gdHJ1ZTsNCgkgICAgICB9DQoJICAgICAgaWYgKHRoaXMudXNlQmxvY2tQYXJhbXMpIHsNCgkgICAgICAgIHJldC51c2VCbG9ja1BhcmFtcyA9IHRydWU7DQoJICAgICAgfQ0KCSAgICAgIGlmICh0aGlzLm9wdGlvbnMuY29tcGF0KSB7DQoJICAgICAgICByZXQuY29tcGF0ID0gdHJ1ZTsNCgkgICAgICB9DQoNCgkgICAgICBpZiAoIWFzT2JqZWN0KSB7DQoJICAgICAgICByZXQuY29tcGlsZXIgPSBKU09OLnN0cmluZ2lmeShyZXQuY29tcGlsZXIpOw0KDQoJICAgICAgICB0aGlzLnNvdXJjZS5jdXJyZW50TG9jYXRpb24gPSB7IHN0YXJ0OiB7IGxpbmU6IDEsIGNvbHVtbjogMCB9IH07DQoJICAgICAgICByZXQgPSB0aGlzLm9iamVjdExpdGVyYWwocmV0KTsNCg0KCSAgICAgICAgaWYgKG9wdGlvbnMuc3JjTmFtZSkgew0KCSAgICAgICAgICByZXQgPSByZXQudG9TdHJpbmdXaXRoU291cmNlTWFwKHsgZmlsZTogb3B0aW9ucy5kZXN0TmFtZSB9KTsNCgkgICAgICAgICAgcmV0Lm1hcCA9IHJldC5tYXAgJiYgcmV0Lm1hcC50b1N0cmluZygpOw0KCSAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgcmV0ID0gcmV0LnRvU3RyaW5nKCk7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHJldC5jb21waWxlck9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7DQoJICAgICAgfQ0KDQoJICAgICAgcmV0dXJuIHJldDsNCgkgICAgfSBlbHNlIHsNCgkgICAgICByZXR1cm4gZm47DQoJICAgIH0NCgkgIH0sDQoNCgkgIHByZWFtYmxlOiBmdW5jdGlvbiBwcmVhbWJsZSgpIHsNCgkgICAgLy8gdHJhY2sgdGhlIGxhc3QgY29udGV4dCBwdXNoZWQgaW50byBwbGFjZSB0byBhbGxvdyBza2lwcGluZyB0aGUNCgkgICAgLy8gZ2V0Q29udGV4dCBvcGNvZGUgd2hlbiBpdCB3b3VsZCBiZSBhIG5vb3ANCgkgICAgdGhpcy5sYXN0Q29udGV4dCA9IDA7DQoJICAgIHRoaXMuc291cmNlID0gbmV3IF9jb2RlR2VuMlsnZGVmYXVsdCddKHRoaXMub3B0aW9ucy5zcmNOYW1lKTsNCgkgICAgdGhpcy5kZWNvcmF0b3JzID0gbmV3IF9jb2RlR2VuMlsnZGVmYXVsdCddKHRoaXMub3B0aW9ucy5zcmNOYW1lKTsNCgkgIH0sDQoNCgkgIGNyZWF0ZUZ1bmN0aW9uQ29udGV4dDogZnVuY3Rpb24gY3JlYXRlRnVuY3Rpb25Db250ZXh0KGFzT2JqZWN0KSB7DQoJICAgIHZhciB2YXJEZWNsYXJhdGlvbnMgPSAnJzsNCg0KCSAgICB2YXIgbG9jYWxzID0gdGhpcy5zdGFja1ZhcnMuY29uY2F0KHRoaXMucmVnaXN0ZXJzLmxpc3QpOw0KCSAgICBpZiAobG9jYWxzLmxlbmd0aCA+IDApIHsNCgkgICAgICB2YXJEZWNsYXJhdGlvbnMgKz0gJywgJyArIGxvY2Fscy5qb2luKCcsICcpOw0KCSAgICB9DQoNCgkgICAgLy8gR2VuZXJhdGUgbWluaW1pemVyIGFsaWFzIG1hcHBpbmdzDQoJICAgIC8vDQoJICAgIC8vIFdoZW4gdXNpbmcgdHJ1ZSBTb3VyY2VOb2RlcywgdGhpcyB3aWxsIHVwZGF0ZSBhbGwgcmVmZXJlbmNlcyB0byB0aGUgZ2l2ZW4gYWxpYXMNCgkgICAgLy8gYXMgdGhlIHNvdXJjZSBub2RlcyBhcmUgcmV1c2VkIGluIHNpdHUuIEZvciB0aGUgbm9uLXNvdXJjZSBub2RlIGNvbXBpbGF0aW9uIG1vZGUsDQoJICAgIC8vIGFsaWFzZXMgd2lsbCBub3QgYmUgdXNlZCwgYnV0IHRoaXMgY2FzZSBpcyBhbHJlYWR5IGJlaW5nIHJ1biBvbiB0aGUgY2xpZW50IGFuZA0KCSAgICAvLyB3ZSBhcmVuJ3QgY29uY2VybiBhYm91dCBtaW5pbWl6aW5nIHRoZSB0ZW1wbGF0ZSBzaXplLg0KCSAgICB2YXIgYWxpYXNDb3VudCA9IDA7DQoJICAgIGZvciAodmFyIGFsaWFzIGluIHRoaXMuYWxpYXNlcykgew0KCSAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZ3VhcmQtZm9yLWluDQoJICAgICAgdmFyIG5vZGUgPSB0aGlzLmFsaWFzZXNbYWxpYXNdOw0KDQoJICAgICAgaWYgKHRoaXMuYWxpYXNlcy5oYXNPd25Qcm9wZXJ0eShhbGlhcykgJiYgbm9kZS5jaGlsZHJlbiAmJiBub2RlLnJlZmVyZW5jZUNvdW50ID4gMSkgew0KCSAgICAgICAgdmFyRGVjbGFyYXRpb25zICs9ICcsIGFsaWFzJyArICsrYWxpYXNDb3VudCArICc9JyArIGFsaWFzOw0KCSAgICAgICAgbm9kZS5jaGlsZHJlblswXSA9ICdhbGlhcycgKyBhbGlhc0NvdW50Ow0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIHZhciBwYXJhbXMgPSBbJ2NvbnRhaW5lcicsICdkZXB0aDAnLCAnaGVscGVycycsICdwYXJ0aWFscycsICdkYXRhJ107DQoNCgkgICAgaWYgKHRoaXMudXNlQmxvY2tQYXJhbXMgfHwgdGhpcy51c2VEZXB0aHMpIHsNCgkgICAgICBwYXJhbXMucHVzaCgnYmxvY2tQYXJhbXMnKTsNCgkgICAgfQ0KCSAgICBpZiAodGhpcy51c2VEZXB0aHMpIHsNCgkgICAgICBwYXJhbXMucHVzaCgnZGVwdGhzJyk7DQoJICAgIH0NCg0KCSAgICAvLyBQZXJmb3JtIGEgc2Vjb25kIHBhc3Mgb3ZlciB0aGUgb3V0cHV0IHRvIG1lcmdlIGNvbnRlbnQgd2hlbiBwb3NzaWJsZQ0KCSAgICB2YXIgc291cmNlID0gdGhpcy5tZXJnZVNvdXJjZSh2YXJEZWNsYXJhdGlvbnMpOw0KDQoJICAgIGlmIChhc09iamVjdCkgew0KCSAgICAgIHBhcmFtcy5wdXNoKHNvdXJjZSk7DQoNCgkgICAgICByZXR1cm4gRnVuY3Rpb24uYXBwbHkodGhpcywgcGFyYW1zKTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uud3JhcChbJ2Z1bmN0aW9uKCcsIHBhcmFtcy5qb2luKCcsJyksICcpIHtcbiAgJywgc291cmNlLCAnfSddKTsNCgkgICAgfQ0KCSAgfSwNCgkgIG1lcmdlU291cmNlOiBmdW5jdGlvbiBtZXJnZVNvdXJjZSh2YXJEZWNsYXJhdGlvbnMpIHsNCgkgICAgdmFyIGlzU2ltcGxlID0gdGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSwNCgkgICAgICAgIGFwcGVuZE9ubHkgPSAhdGhpcy5mb3JjZUJ1ZmZlciwNCgkgICAgICAgIGFwcGVuZEZpcnN0ID0gdW5kZWZpbmVkLA0KCSAgICAgICAgc291cmNlU2VlbiA9IHVuZGVmaW5lZCwNCgkgICAgICAgIGJ1ZmZlclN0YXJ0ID0gdW5kZWZpbmVkLA0KCSAgICAgICAgYnVmZmVyRW5kID0gdW5kZWZpbmVkOw0KCSAgICB0aGlzLnNvdXJjZS5lYWNoKGZ1bmN0aW9uIChsaW5lKSB7DQoJICAgICAgaWYgKGxpbmUuYXBwZW5kVG9CdWZmZXIpIHsNCgkgICAgICAgIGlmIChidWZmZXJTdGFydCkgew0KCSAgICAgICAgICBsaW5lLnByZXBlbmQoJyAgKyAnKTsNCgkgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgIGJ1ZmZlclN0YXJ0ID0gbGluZTsNCgkgICAgICAgIH0NCgkgICAgICAgIGJ1ZmZlckVuZCA9IGxpbmU7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIGlmIChidWZmZXJTdGFydCkgew0KCSAgICAgICAgICBpZiAoIXNvdXJjZVNlZW4pIHsNCgkgICAgICAgICAgICBhcHBlbmRGaXJzdCA9IHRydWU7DQoJICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgnYnVmZmVyICs9ICcpOw0KCSAgICAgICAgICB9DQoJICAgICAgICAgIGJ1ZmZlckVuZC5hZGQoJzsnKTsNCgkgICAgICAgICAgYnVmZmVyU3RhcnQgPSBidWZmZXJFbmQgPSB1bmRlZmluZWQ7DQoJICAgICAgICB9DQoNCgkgICAgICAgIHNvdXJjZVNlZW4gPSB0cnVlOw0KCSAgICAgICAgaWYgKCFpc1NpbXBsZSkgew0KCSAgICAgICAgICBhcHBlbmRPbmx5ID0gZmFsc2U7DQoJICAgICAgICB9DQoJICAgICAgfQ0KCSAgICB9KTsNCg0KCSAgICBpZiAoYXBwZW5kT25seSkgew0KCSAgICAgIGlmIChidWZmZXJTdGFydCkgew0KCSAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgncmV0dXJuICcpOw0KCSAgICAgICAgYnVmZmVyRW5kLmFkZCgnOycpOw0KCSAgICAgIH0gZWxzZSBpZiAoIXNvdXJjZVNlZW4pIHsNCgkgICAgICAgIHRoaXMuc291cmNlLnB1c2goJ3JldHVybiAiIjsnKTsNCgkgICAgICB9DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdmFyRGVjbGFyYXRpb25zICs9ICcsIGJ1ZmZlciA9ICcgKyAoYXBwZW5kRmlyc3QgPyAnJyA6IHRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcigpKTsNCg0KCSAgICAgIGlmIChidWZmZXJTdGFydCkgew0KCSAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgncmV0dXJuIGJ1ZmZlciArICcpOw0KCSAgICAgICAgYnVmZmVyRW5kLmFkZCgnOycpOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICB0aGlzLnNvdXJjZS5wdXNoKCdyZXR1cm4gYnVmZmVyOycpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGlmICh2YXJEZWNsYXJhdGlvbnMpIHsNCgkgICAgICB0aGlzLnNvdXJjZS5wcmVwZW5kKCd2YXIgJyArIHZhckRlY2xhcmF0aW9ucy5zdWJzdHJpbmcoMikgKyAoYXBwZW5kRmlyc3QgPyAnJyA6ICc7XG4nKSk7DQoJICAgIH0NCg0KCSAgICByZXR1cm4gdGhpcy5zb3VyY2UubWVyZ2UoKTsNCgkgIH0sDQoNCgkgIC8vIFtibG9ja1ZhbHVlXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHZhbHVlDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJldHVybiB2YWx1ZSBvZiBibG9ja0hlbHBlck1pc3NpbmcNCgkgIC8vDQoJICAvLyBUaGUgcHVycG9zZSBvZiB0aGlzIG9wY29kZSBpcyB0byB0YWtlIGEgYmxvY2sgb2YgdGhlIGZvcm0NCgkgIC8vIGB7eyN0aGlzLmZvb319Li4ue3svdGhpcy5mb299fWAsIHJlc29sdmUgdGhlIHZhbHVlIG9mIGBmb29gLCBhbmQNCgkgIC8vIHJlcGxhY2UgaXQgb24gdGhlIHN0YWNrIHdpdGggdGhlIHJlc3VsdCBvZiBwcm9wZXJseQ0KCSAgLy8gaW52b2tpbmcgYmxvY2tIZWxwZXJNaXNzaW5nLg0KCSAgYmxvY2tWYWx1ZTogZnVuY3Rpb24gYmxvY2tWYWx1ZShuYW1lKSB7DQoJICAgIHZhciBibG9ja0hlbHBlck1pc3NpbmcgPSB0aGlzLmFsaWFzYWJsZSgnaGVscGVycy5ibG9ja0hlbHBlck1pc3NpbmcnKSwNCgkgICAgICAgIHBhcmFtcyA9IFt0aGlzLmNvbnRleHROYW1lKDApXTsNCgkgICAgdGhpcy5zZXR1cEhlbHBlckFyZ3MobmFtZSwgMCwgcGFyYW1zKTsNCg0KCSAgICB2YXIgYmxvY2tOYW1lID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICBwYXJhbXMuc3BsaWNlKDEsIDAsIGJsb2NrTmFtZSk7DQoNCgkgICAgdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChibG9ja0hlbHBlck1pc3NpbmcsICdjYWxsJywgcGFyYW1zKSk7DQoJICB9LA0KDQoJICAvLyBbYW1iaWd1b3VzQmxvY2tWYWx1ZV0NCgkgIC8vDQoJICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCB2YWx1ZQ0KCSAgLy8gQ29tcGlsZXIgdmFsdWUsIGJlZm9yZTogbGFzdEhlbHBlcj12YWx1ZSBvZiBsYXN0IGZvdW5kIGhlbHBlciwgaWYgYW55DQoJICAvLyBPbiBzdGFjaywgYWZ0ZXIsIGlmIG5vIGxhc3RIZWxwZXI6IHNhbWUgYXMgW2Jsb2NrVmFsdWVdDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXIsIGlmIGxhc3RIZWxwZXI6IHZhbHVlDQoJICBhbWJpZ3VvdXNCbG9ja1ZhbHVlOiBmdW5jdGlvbiBhbWJpZ3VvdXNCbG9ja1ZhbHVlKCkgew0KCSAgICAvLyBXZSdyZSBiZWluZyBhIGJpdCBjaGVla3kgYW5kIHJldXNpbmcgdGhlIG9wdGlvbnMgdmFsdWUgZnJvbSB0aGUgcHJpb3IgZXhlYw0KCSAgICB2YXIgYmxvY2tIZWxwZXJNaXNzaW5nID0gdGhpcy5hbGlhc2FibGUoJ2hlbHBlcnMuYmxvY2tIZWxwZXJNaXNzaW5nJyksDQoJICAgICAgICBwYXJhbXMgPSBbdGhpcy5jb250ZXh0TmFtZSgwKV07DQoJICAgIHRoaXMuc2V0dXBIZWxwZXJBcmdzKCcnLCAwLCBwYXJhbXMsIHRydWUpOw0KDQoJICAgIHRoaXMuZmx1c2hJbmxpbmUoKTsNCg0KCSAgICB2YXIgY3VycmVudCA9IHRoaXMudG9wU3RhY2soKTsNCgkgICAgcGFyYW1zLnNwbGljZSgxLCAwLCBjdXJyZW50KTsNCg0KCSAgICB0aGlzLnB1c2hTb3VyY2UoWydpZiAoIScsIHRoaXMubGFzdEhlbHBlciwgJykgeyAnLCBjdXJyZW50LCAnID0gJywgdGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKGJsb2NrSGVscGVyTWlzc2luZywgJ2NhbGwnLCBwYXJhbXMpLCAnfSddKTsNCgkgIH0sDQoNCgkgIC8vIFthcHBlbmRDb250ZW50XQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLg0KCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4NCgkgIC8vDQoJICAvLyBBcHBlbmRzIHRoZSBzdHJpbmcgdmFsdWUgb2YgYGNvbnRlbnRgIHRvIHRoZSBjdXJyZW50IGJ1ZmZlcg0KCSAgYXBwZW5kQ29udGVudDogZnVuY3Rpb24gYXBwZW5kQ29udGVudChjb250ZW50KSB7DQoJICAgIGlmICh0aGlzLnBlbmRpbmdDb250ZW50KSB7DQoJICAgICAgY29udGVudCA9IHRoaXMucGVuZGluZ0NvbnRlbnQgKyBjb250ZW50Ow0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHRoaXMucGVuZGluZ0xvY2F0aW9uID0gdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uOw0KCSAgICB9DQoNCgkgICAgdGhpcy5wZW5kaW5nQ29udGVudCA9IGNvbnRlbnQ7DQoJICB9LA0KDQoJICAvLyBbYXBwZW5kXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IHZhbHVlLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uDQoJICAvLw0KCSAgLy8gQ29lcmNlcyBgdmFsdWVgIHRvIGEgU3RyaW5nIGFuZCBhcHBlbmRzIGl0IHRvIHRoZSBjdXJyZW50IGJ1ZmZlci4NCgkgIC8vDQoJICAvLyBJZiBgdmFsdWVgIGlzIHRydXRoeSwgb3IgMCwgaXQgaXMgY29lcmNlZCBpbnRvIGEgc3RyaW5nIGFuZCBhcHBlbmRlZA0KCSAgLy8gT3RoZXJ3aXNlLCB0aGUgZW1wdHkgc3RyaW5nIGlzIGFwcGVuZGVkDQoJICBhcHBlbmQ6IGZ1bmN0aW9uIGFwcGVuZCgpIHsNCgkgICAgaWYgKHRoaXMuaXNJbmxpbmUoKSkgew0KCSAgICAgIHRoaXMucmVwbGFjZVN0YWNrKGZ1bmN0aW9uIChjdXJyZW50KSB7DQoJICAgICAgICByZXR1cm4gWycgIT0gbnVsbCA/ICcsIGN1cnJlbnQsICcgOiAiIiddOw0KCSAgICAgIH0pOw0KDQoJICAgICAgdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5wb3BTdGFjaygpKSk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdmFyIGxvY2FsID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICAgIHRoaXMucHVzaFNvdXJjZShbJ2lmICgnLCBsb2NhbCwgJyAhPSBudWxsKSB7ICcsIHRoaXMuYXBwZW5kVG9CdWZmZXIobG9jYWwsIHVuZGVmaW5lZCwgdHJ1ZSksICcgfSddKTsNCgkgICAgICBpZiAodGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSkgew0KCSAgICAgICAgdGhpcy5wdXNoU291cmNlKFsnZWxzZSB7ICcsIHRoaXMuYXBwZW5kVG9CdWZmZXIoIicnIiwgdW5kZWZpbmVkLCB0cnVlKSwgJyB9J10pOw0KCSAgICAgIH0NCgkgICAgfQ0KCSAgfSwNCg0KCSAgLy8gW2FwcGVuZEVzY2FwZWRdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLg0KCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4NCgkgIC8vDQoJICAvLyBFc2NhcGUgYHZhbHVlYCBhbmQgYXBwZW5kIGl0IHRvIHRoZSBidWZmZXINCgkgIGFwcGVuZEVzY2FwZWQ6IGZ1bmN0aW9uIGFwcGVuZEVzY2FwZWQoKSB7DQoJICAgIHRoaXMucHVzaFNvdXJjZSh0aGlzLmFwcGVuZFRvQnVmZmVyKFt0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24nKSwgJygnLCB0aGlzLnBvcFN0YWNrKCksICcpJ10pKTsNCgkgIH0sDQoNCgkgIC8vIFtnZXRDb250ZXh0XQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLg0KCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4NCgkgIC8vIENvbXBpbGVyIHZhbHVlLCBhZnRlcjogbGFzdENvbnRleHQ9ZGVwdGgNCgkgIC8vDQoJICAvLyBTZXQgdGhlIHZhbHVlIG9mIHRoZSBgbGFzdENvbnRleHRgIGNvbXBpbGVyIHZhbHVlIHRvIHRoZSBkZXB0aA0KCSAgZ2V0Q29udGV4dDogZnVuY3Rpb24gZ2V0Q29udGV4dChkZXB0aCkgew0KCSAgICB0aGlzLmxhc3RDb250ZXh0ID0gZGVwdGg7DQoJICB9LA0KDQoJICAvLyBbcHVzaENvbnRleHRdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IGN1cnJlbnRDb250ZXh0LCAuLi4NCgkgIC8vDQoJICAvLyBQdXNoZXMgdGhlIHZhbHVlIG9mIHRoZSBjdXJyZW50IGNvbnRleHQgb250byB0aGUgc3RhY2suDQoJICBwdXNoQ29udGV4dDogZnVuY3Rpb24gcHVzaENvbnRleHQoKSB7DQoJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLmNvbnRleHROYW1lKHRoaXMubGFzdENvbnRleHQpKTsNCgkgIH0sDQoNCgkgIC8vIFtsb29rdXBPbkNvbnRleHRdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IGN1cnJlbnRDb250ZXh0W25hbWVdLCAuLi4NCgkgIC8vDQoJICAvLyBMb29rcyB1cCB0aGUgdmFsdWUgb2YgYG5hbWVgIG9uIHRoZSBjdXJyZW50IGNvbnRleHQgYW5kIHB1c2hlcw0KCSAgLy8gaXQgb250byB0aGUgc3RhY2suDQoJICBsb29rdXBPbkNvbnRleHQ6IGZ1bmN0aW9uIGxvb2t1cE9uQ29udGV4dChwYXJ0cywgZmFsc3ksIHN0cmljdCwgc2NvcGVkKSB7DQoJICAgIHZhciBpID0gMDsNCg0KCSAgICBpZiAoIXNjb3BlZCAmJiB0aGlzLm9wdGlvbnMuY29tcGF0ICYmICF0aGlzLmxhc3RDb250ZXh0KSB7DQoJICAgICAgLy8gVGhlIGRlcHRoZWQgcXVlcnkgaXMgZXhwZWN0ZWQgdG8gaGFuZGxlIHRoZSB1bmRlZmluZWQgbG9naWMgZm9yIHRoZSByb290IGxldmVsIHRoYXQNCgkgICAgICAvLyBpcyBpbXBsZW1lbnRlZCBiZWxvdywgc28gd2UgZXZhbHVhdGUgdGhhdCBkaXJlY3RseSBpbiBjb21wYXQgbW9kZQ0KCSAgICAgIHRoaXMucHVzaCh0aGlzLmRlcHRoZWRMb29rdXAocGFydHNbaSsrXSkpOw0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHRoaXMucHVzaENvbnRleHQoKTsNCgkgICAgfQ0KDQoJICAgIHRoaXMucmVzb2x2ZVBhdGgoJ2NvbnRleHQnLCBwYXJ0cywgaSwgZmFsc3ksIHN0cmljdCk7DQoJICB9LA0KDQoJICAvLyBbbG9va3VwQmxvY2tQYXJhbV0NCgkgIC8vDQoJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogYmxvY2tQYXJhbVtuYW1lXSwgLi4uDQoJICAvLw0KCSAgLy8gTG9va3MgdXAgdGhlIHZhbHVlIG9mIGBwYXJ0c2Agb24gdGhlIGdpdmVuIGJsb2NrIHBhcmFtIGFuZCBwdXNoZXMNCgkgIC8vIGl0IG9udG8gdGhlIHN0YWNrLg0KCSAgbG9va3VwQmxvY2tQYXJhbTogZnVuY3Rpb24gbG9va3VwQmxvY2tQYXJhbShibG9ja1BhcmFtSWQsIHBhcnRzKSB7DQoJICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0cnVlOw0KDQoJICAgIHRoaXMucHVzaChbJ2Jsb2NrUGFyYW1zWycsIGJsb2NrUGFyYW1JZFswXSwgJ11bJywgYmxvY2tQYXJhbUlkWzFdLCAnXSddKTsNCgkgICAgdGhpcy5yZXNvbHZlUGF0aCgnY29udGV4dCcsIHBhcnRzLCAxKTsNCgkgIH0sDQoNCgkgIC8vIFtsb29rdXBEYXRhXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLg0KCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBkYXRhLCAuLi4NCgkgIC8vDQoJICAvLyBQdXNoIHRoZSBkYXRhIGxvb2t1cCBvcGVyYXRvcg0KCSAgbG9va3VwRGF0YTogZnVuY3Rpb24gbG9va3VwRGF0YShkZXB0aCwgcGFydHMsIHN0cmljdCkgew0KCSAgICBpZiAoIWRlcHRoKSB7DQoJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdkYXRhJyk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdjb250YWluZXIuZGF0YShkYXRhLCAnICsgZGVwdGggKyAnKScpOw0KCSAgICB9DQoNCgkgICAgdGhpcy5yZXNvbHZlUGF0aCgnZGF0YScsIHBhcnRzLCAwLCB0cnVlLCBzdHJpY3QpOw0KCSAgfSwNCg0KCSAgcmVzb2x2ZVBhdGg6IGZ1bmN0aW9uIHJlc29sdmVQYXRoKHR5cGUsIHBhcnRzLCBpLCBmYWxzeSwgc3RyaWN0KSB7DQoJICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0DQoNCgkgICAgdmFyIF90aGlzID0gdGhpczsNCg0KCSAgICBpZiAodGhpcy5vcHRpb25zLnN0cmljdCB8fCB0aGlzLm9wdGlvbnMuYXNzdW1lT2JqZWN0cykgew0KCSAgICAgIHRoaXMucHVzaChzdHJpY3RMb29rdXAodGhpcy5vcHRpb25zLnN0cmljdCAmJiBzdHJpY3QsIHRoaXMsIHBhcnRzLCB0eXBlKSk7DQoJICAgICAgcmV0dXJuOw0KCSAgICB9DQoNCgkgICAgdmFyIGxlbiA9IHBhcnRzLmxlbmd0aDsNCgkgICAgZm9yICg7IGkgPCBsZW47IGkrKykgew0KCSAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWxvb3AtZnVuYyAqLw0KCSAgICAgIHRoaXMucmVwbGFjZVN0YWNrKGZ1bmN0aW9uIChjdXJyZW50KSB7DQoJICAgICAgICB2YXIgbG9va3VwID0gX3RoaXMubmFtZUxvb2t1cChjdXJyZW50LCBwYXJ0c1tpXSwgdHlwZSk7DQoJICAgICAgICAvLyBXZSB3YW50IHRvIGVuc3VyZSB0aGF0IHplcm8gYW5kIGZhbHNlIGFyZSBoYW5kbGVkIHByb3Blcmx5IGlmIHRoZSBjb250ZXh0IChmYWxzeSBmbGFnKQ0KCSAgICAgICAgLy8gbmVlZHMgdG8gaGF2ZSB0aGUgc3BlY2lhbCBoYW5kbGluZyBmb3IgdGhlc2UgdmFsdWVzLg0KCSAgICAgICAgaWYgKCFmYWxzeSkgew0KCSAgICAgICAgICByZXR1cm4gWycgIT0gbnVsbCA/ICcsIGxvb2t1cCwgJyA6ICcsIGN1cnJlbnRdOw0KCSAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIGNhbiB1c2UgZ2VuZXJpYyBmYWxzeSBoYW5kbGluZw0KCSAgICAgICAgICByZXR1cm4gWycgJiYgJywgbG9va3VwXTsNCgkgICAgICAgIH0NCgkgICAgICB9KTsNCgkgICAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWxvb3AtZnVuYyAqLw0KCSAgICB9DQoJICB9LA0KDQoJICAvLyBbcmVzb2x2ZVBvc3NpYmxlTGFtYmRhXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IHZhbHVlLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzb2x2ZWQgdmFsdWUsIC4uLg0KCSAgLy8NCgkgIC8vIElmIHRoZSBgdmFsdWVgIGlzIGEgbGFtYmRhLCByZXBsYWNlIGl0IG9uIHRoZSBzdGFjayBieQ0KCSAgLy8gdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgbGFtYmRhDQoJICByZXNvbHZlUG9zc2libGVMYW1iZGE6IGZ1bmN0aW9uIHJlc29sdmVQb3NzaWJsZUxhbWJkYSgpIHsNCgkgICAgdGhpcy5wdXNoKFt0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmxhbWJkYScpLCAnKCcsIHRoaXMucG9wU3RhY2soKSwgJywgJywgdGhpcy5jb250ZXh0TmFtZSgwKSwgJyknXSk7DQoJICB9LA0KDQoJICAvLyBbcHVzaFN0cmluZ1BhcmFtXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLg0KCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBzdHJpbmcsIGN1cnJlbnRDb250ZXh0LCAuLi4NCgkgIC8vDQoJICAvLyBUaGlzIG9wY29kZSBpcyBkZXNpZ25lZCBmb3IgdXNlIGluIHN0cmluZyBtb2RlLCB3aGljaA0KCSAgLy8gcHJvdmlkZXMgdGhlIHN0cmluZyB2YWx1ZSBvZiBhIHBhcmFtZXRlciBhbG9uZyB3aXRoIGl0cw0KCSAgLy8gZGVwdGggcmF0aGVyIHRoYW4gcmVzb2x2aW5nIGl0IGltbWVkaWF0ZWx5Lg0KCSAgcHVzaFN0cmluZ1BhcmFtOiBmdW5jdGlvbiBwdXNoU3RyaW5nUGFyYW0oc3RyaW5nLCB0eXBlKSB7DQoJICAgIHRoaXMucHVzaENvbnRleHQoKTsNCgkgICAgdGhpcy5wdXNoU3RyaW5nKHR5cGUpOw0KDQoJICAgIC8vIElmIGl0J3MgYSBzdWJleHByZXNzaW9uLCB0aGUgc3RyaW5nIHJlc3VsdA0KCSAgICAvLyB3aWxsIGJlIHB1c2hlZCBhZnRlciB0aGlzIG9wY29kZS4NCgkgICAgaWYgKHR5cGUgIT09ICdTdWJFeHByZXNzaW9uJykgew0KCSAgICAgIGlmICh0eXBlb2Ygc3RyaW5nID09PSAnc3RyaW5nJykgew0KCSAgICAgICAgdGhpcy5wdXNoU3RyaW5nKHN0cmluZyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChzdHJpbmcpOw0KCSAgICAgIH0NCgkgICAgfQ0KCSAgfSwNCg0KCSAgZW1wdHlIYXNoOiBmdW5jdGlvbiBlbXB0eUhhc2gob21pdEVtcHR5KSB7DQoJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7DQoJICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoSWRzDQoJICAgIH0NCgkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7DQoJICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoQ29udGV4dHMNCgkgICAgICB0aGlzLnB1c2goJ3t9Jyk7IC8vIGhhc2hUeXBlcw0KCSAgICB9DQoJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChvbWl0RW1wdHkgPyAndW5kZWZpbmVkJyA6ICd7fScpOw0KCSAgfSwNCgkgIHB1c2hIYXNoOiBmdW5jdGlvbiBwdXNoSGFzaCgpIHsNCgkgICAgaWYgKHRoaXMuaGFzaCkgew0KCSAgICAgIHRoaXMuaGFzaGVzLnB1c2godGhpcy5oYXNoKTsNCgkgICAgfQ0KCSAgICB0aGlzLmhhc2ggPSB7IHZhbHVlczogW10sIHR5cGVzOiBbXSwgY29udGV4dHM6IFtdLCBpZHM6IFtdIH07DQoJICB9LA0KCSAgcG9wSGFzaDogZnVuY3Rpb24gcG9wSGFzaCgpIHsNCgkgICAgdmFyIGhhc2ggPSB0aGlzLmhhc2g7DQoJICAgIHRoaXMuaGFzaCA9IHRoaXMuaGFzaGVzLnBvcCgpOw0KDQoJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7DQoJICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLmlkcykpOw0KCSAgICB9DQoJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgew0KCSAgICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC5jb250ZXh0cykpOw0KCSAgICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC50eXBlcykpOw0KCSAgICB9DQoNCgkgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLnZhbHVlcykpOw0KCSAgfSwNCg0KCSAgLy8gW3B1c2hTdHJpbmddDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHF1b3RlZFN0cmluZyhzdHJpbmcpLCAuLi4NCgkgIC8vDQoJICAvLyBQdXNoIGEgcXVvdGVkIHZlcnNpb24gb2YgYHN0cmluZ2Agb250byB0aGUgc3RhY2sNCgkgIHB1c2hTdHJpbmc6IGZ1bmN0aW9uIHB1c2hTdHJpbmcoc3RyaW5nKSB7DQoJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLnF1b3RlZFN0cmluZyhzdHJpbmcpKTsNCgkgIH0sDQoNCgkgIC8vIFtwdXNoTGl0ZXJhbF0NCgkgIC8vDQoJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogdmFsdWUsIC4uLg0KCSAgLy8NCgkgIC8vIFB1c2hlcyBhIHZhbHVlIG9udG8gdGhlIHN0YWNrLiBUaGlzIG9wZXJhdGlvbiBwcmV2ZW50cw0KCSAgLy8gdGhlIGNvbXBpbGVyIGZyb20gY3JlYXRpbmcgYSB0ZW1wb3JhcnkgdmFyaWFibGUgdG8gaG9sZA0KCSAgLy8gaXQuDQoJICBwdXNoTGl0ZXJhbDogZnVuY3Rpb24gcHVzaExpdGVyYWwodmFsdWUpIHsNCgkgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHZhbHVlKTsNCgkgIH0sDQoNCgkgIC8vIFtwdXNoUHJvZ3JhbV0NCgkgIC8vDQoJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcHJvZ3JhbShndWlkKSwgLi4uDQoJICAvLw0KCSAgLy8gUHVzaCBhIHByb2dyYW0gZXhwcmVzc2lvbiBvbnRvIHRoZSBzdGFjay4gVGhpcyB0YWtlcw0KCSAgLy8gYSBjb21waWxlLXRpbWUgZ3VpZCBhbmQgY29udmVydHMgaXQgaW50byBhIHJ1bnRpbWUtYWNjZXNzaWJsZQ0KCSAgLy8gZXhwcmVzc2lvbi4NCgkgIHB1c2hQcm9ncmFtOiBmdW5jdGlvbiBwdXNoUHJvZ3JhbShndWlkKSB7DQoJICAgIGlmIChndWlkICE9IG51bGwpIHsNCgkgICAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5wcm9ncmFtRXhwcmVzc2lvbihndWlkKSk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKG51bGwpOw0KCSAgICB9DQoJICB9LA0KDQoJICAvLyBbcmVnaXN0ZXJEZWNvcmF0b3JdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uDQoJICAvLw0KCSAgLy8gUG9wcyBvZmYgdGhlIGRlY29yYXRvcidzIHBhcmFtZXRlcnMsIGludm9rZXMgdGhlIGRlY29yYXRvciwNCgkgIC8vIGFuZCBpbnNlcnRzIHRoZSBkZWNvcmF0b3IgaW50byB0aGUgZGVjb3JhdG9ycyBsaXN0Lg0KCSAgcmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uIHJlZ2lzdGVyRGVjb3JhdG9yKHBhcmFtU2l6ZSwgbmFtZSkgew0KCSAgICB2YXIgZm91bmREZWNvcmF0b3IgPSB0aGlzLm5hbWVMb29rdXAoJ2RlY29yYXRvcnMnLCBuYW1lLCAnZGVjb3JhdG9yJyksDQoJICAgICAgICBvcHRpb25zID0gdGhpcy5zZXR1cEhlbHBlckFyZ3MobmFtZSwgcGFyYW1TaXplKTsNCg0KCSAgICB0aGlzLmRlY29yYXRvcnMucHVzaChbJ2ZuID0gJywgdGhpcy5kZWNvcmF0b3JzLmZ1bmN0aW9uQ2FsbChmb3VuZERlY29yYXRvciwgJycsIFsnZm4nLCAncHJvcHMnLCAnY29udGFpbmVyJywgb3B0aW9uc10pLCAnIHx8IGZuOyddKTsNCgkgIH0sDQoNCgkgIC8vIFtpbnZva2VIZWxwZXJdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzdWx0IG9mIGhlbHBlciBpbnZvY2F0aW9uDQoJICAvLw0KCSAgLy8gUG9wcyBvZmYgdGhlIGhlbHBlcidzIHBhcmFtZXRlcnMsIGludm9rZXMgdGhlIGhlbHBlciwNCgkgIC8vIGFuZCBwdXNoZXMgdGhlIGhlbHBlcidzIHJldHVybiB2YWx1ZSBvbnRvIHRoZSBzdGFjay4NCgkgIC8vDQoJICAvLyBJZiB0aGUgaGVscGVyIGlzIG5vdCBmb3VuZCwgYGhlbHBlck1pc3NpbmdgIGlzIGNhbGxlZC4NCgkgIGludm9rZUhlbHBlcjogZnVuY3Rpb24gaW52b2tlSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSwgaXNTaW1wbGUpIHsNCgkgICAgdmFyIG5vbkhlbHBlciA9IHRoaXMucG9wU3RhY2soKSwNCgkgICAgICAgIGhlbHBlciA9IHRoaXMuc2V0dXBIZWxwZXIocGFyYW1TaXplLCBuYW1lKSwNCgkgICAgICAgIHNpbXBsZSA9IGlzU2ltcGxlID8gW2hlbHBlci5uYW1lLCAnIHx8ICddIDogJyc7DQoNCgkgICAgdmFyIGxvb2t1cCA9IFsnKCddLmNvbmNhdChzaW1wbGUsIG5vbkhlbHBlcik7DQoJICAgIGlmICghdGhpcy5vcHRpb25zLnN0cmljdCkgew0KCSAgICAgIGxvb2t1cC5wdXNoKCcgfHwgJywgdGhpcy5hbGlhc2FibGUoJ2hlbHBlcnMuaGVscGVyTWlzc2luZycpKTsNCgkgICAgfQ0KCSAgICBsb29rdXAucHVzaCgnKScpOw0KDQoJICAgIHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwobG9va3VwLCAnY2FsbCcsIGhlbHBlci5jYWxsUGFyYW1zKSk7DQoJICB9LA0KDQoJICAvLyBbaW52b2tlS25vd25IZWxwZXJdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzdWx0IG9mIGhlbHBlciBpbnZvY2F0aW9uDQoJICAvLw0KCSAgLy8gVGhpcyBvcGVyYXRpb24gaXMgdXNlZCB3aGVuIHRoZSBoZWxwZXIgaXMga25vd24gdG8gZXhpc3QsDQoJICAvLyBzbyBhIGBoZWxwZXJNaXNzaW5nYCBmYWxsYmFjayBpcyBub3QgcmVxdWlyZWQuDQoJICBpbnZva2VLbm93bkhlbHBlcjogZnVuY3Rpb24gaW52b2tlS25vd25IZWxwZXIocGFyYW1TaXplLCBuYW1lKSB7DQoJICAgIHZhciBoZWxwZXIgPSB0aGlzLnNldHVwSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSk7DQoJICAgIHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoaGVscGVyLm5hbWUsICdjYWxsJywgaGVscGVyLmNhbGxQYXJhbXMpKTsNCgkgIH0sDQoNCgkgIC8vIFtpbnZva2VBbWJpZ3VvdXNdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4NCgkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzdWx0IG9mIGRpc2FtYmlndWF0aW9uDQoJICAvLw0KCSAgLy8gVGhpcyBvcGVyYXRpb24gaXMgdXNlZCB3aGVuIGFuIGV4cHJlc3Npb24gbGlrZSBge3tmb299fWANCgkgIC8vIGlzIHByb3ZpZGVkLCBidXQgd2UgZG9uJ3Qga25vdyBhdCBjb21waWxlLXRpbWUgd2hldGhlciBpdA0KCSAgLy8gaXMgYSBoZWxwZXIgb3IgYSBwYXRoLg0KCSAgLy8NCgkgIC8vIFRoaXMgb3BlcmF0aW9uIGVtaXRzIG1vcmUgY29kZSB0aGFuIHRoZSBvdGhlciBvcHRpb25zLA0KCSAgLy8gYW5kIGNhbiBiZSBhdm9pZGVkIGJ5IHBhc3NpbmcgdGhlIGBrbm93bkhlbHBlcnNgIGFuZA0KCSAgLy8gYGtub3duSGVscGVyc09ubHlgIGZsYWdzIGF0IGNvbXBpbGUtdGltZS4NCgkgIGludm9rZUFtYmlndW91czogZnVuY3Rpb24gaW52b2tlQW1iaWd1b3VzKG5hbWUsIGhlbHBlckNhbGwpIHsNCgkgICAgdGhpcy51c2VSZWdpc3RlcignaGVscGVyJyk7DQoNCgkgICAgdmFyIG5vbkhlbHBlciA9IHRoaXMucG9wU3RhY2soKTsNCg0KCSAgICB0aGlzLmVtcHR5SGFzaCgpOw0KCSAgICB2YXIgaGVscGVyID0gdGhpcy5zZXR1cEhlbHBlcigwLCBuYW1lLCBoZWxwZXJDYWxsKTsNCg0KCSAgICB2YXIgaGVscGVyTmFtZSA9IHRoaXMubGFzdEhlbHBlciA9IHRoaXMubmFtZUxvb2t1cCgnaGVscGVycycsIG5hbWUsICdoZWxwZXInKTsNCg0KCSAgICB2YXIgbG9va3VwID0gWycoJywgJyhoZWxwZXIgPSAnLCBoZWxwZXJOYW1lLCAnIHx8ICcsIG5vbkhlbHBlciwgJyknXTsNCgkgICAgaWYgKCF0aGlzLm9wdGlvbnMuc3RyaWN0KSB7DQoJICAgICAgbG9va3VwWzBdID0gJyhoZWxwZXIgPSAnOw0KCSAgICAgIGxvb2t1cC5wdXNoKCcgIT0gbnVsbCA/IGhlbHBlciA6ICcsIHRoaXMuYWxpYXNhYmxlKCdoZWxwZXJzLmhlbHBlck1pc3NpbmcnKSk7DQoJICAgIH0NCg0KCSAgICB0aGlzLnB1c2goWycoJywgbG9va3VwLCBoZWxwZXIucGFyYW1zSW5pdCA/IFsnKSwoJywgaGVscGVyLnBhcmFtc0luaXRdIDogW10sICcpLCcsICcodHlwZW9mIGhlbHBlciA9PT0gJywgdGhpcy5hbGlhc2FibGUoJyJmdW5jdGlvbiInKSwgJyA/ICcsIHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgnaGVscGVyJywgJ2NhbGwnLCBoZWxwZXIuY2FsbFBhcmFtcyksICcgOiBoZWxwZXIpKSddKTsNCgkgIH0sDQoNCgkgIC8vIFtpbnZva2VQYXJ0aWFsXQ0KCSAgLy8NCgkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGNvbnRleHQsIC4uLg0KCSAgLy8gT24gc3RhY2sgYWZ0ZXI6IHJlc3VsdCBvZiBwYXJ0aWFsIGludm9jYXRpb24NCgkgIC8vDQoJICAvLyBUaGlzIG9wZXJhdGlvbiBwb3BzIG9mZiBhIGNvbnRleHQsIGludm9rZXMgYSBwYXJ0aWFsIHdpdGggdGhhdCBjb250ZXh0LA0KCSAgLy8gYW5kIHB1c2hlcyB0aGUgcmVzdWx0IG9mIHRoZSBpbnZvY2F0aW9uIGJhY2suDQoJICBpbnZva2VQYXJ0aWFsOiBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsKGlzRHluYW1pYywgbmFtZSwgaW5kZW50KSB7DQoJICAgIHZhciBwYXJhbXMgPSBbXSwNCgkgICAgICAgIG9wdGlvbnMgPSB0aGlzLnNldHVwUGFyYW1zKG5hbWUsIDEsIHBhcmFtcyk7DQoNCgkgICAgaWYgKGlzRHluYW1pYykgew0KCSAgICAgIG5hbWUgPSB0aGlzLnBvcFN0YWNrKCk7DQoJICAgICAgZGVsZXRlIG9wdGlvbnMubmFtZTsNCgkgICAgfQ0KDQoJICAgIGlmIChpbmRlbnQpIHsNCgkgICAgICBvcHRpb25zLmluZGVudCA9IEpTT04uc3RyaW5naWZ5KGluZGVudCk7DQoJICAgIH0NCgkgICAgb3B0aW9ucy5oZWxwZXJzID0gJ2hlbHBlcnMnOw0KCSAgICBvcHRpb25zLnBhcnRpYWxzID0gJ3BhcnRpYWxzJzsNCgkgICAgb3B0aW9ucy5kZWNvcmF0b3JzID0gJ2NvbnRhaW5lci5kZWNvcmF0b3JzJzsNCg0KCSAgICBpZiAoIWlzRHluYW1pYykgew0KCSAgICAgIHBhcmFtcy51bnNoaWZ0KHRoaXMubmFtZUxvb2t1cCgncGFydGlhbHMnLCBuYW1lLCAncGFydGlhbCcpKTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICBwYXJhbXMudW5zaGlmdChuYW1lKTsNCgkgICAgfQ0KDQoJICAgIGlmICh0aGlzLm9wdGlvbnMuY29tcGF0KSB7DQoJICAgICAgb3B0aW9ucy5kZXB0aHMgPSAnZGVwdGhzJzsNCgkgICAgfQ0KCSAgICBvcHRpb25zID0gdGhpcy5vYmplY3RMaXRlcmFsKG9wdGlvbnMpOw0KCSAgICBwYXJhbXMucHVzaChvcHRpb25zKTsNCg0KCSAgICB0aGlzLnB1c2godGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKCdjb250YWluZXIuaW52b2tlUGFydGlhbCcsICcnLCBwYXJhbXMpKTsNCgkgIH0sDQoNCgkgIC8vIFthc3NpZ25Ub0hhc2hdDQoJICAvLw0KCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLiwgaGFzaCwgLi4uDQoJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLiwgaGFzaCwgLi4uDQoJICAvLw0KCSAgLy8gUG9wcyBhIHZhbHVlIG9mZiB0aGUgc3RhY2sgYW5kIGFzc2lnbnMgaXQgdG8gdGhlIGN1cnJlbnQgaGFzaA0KCSAgYXNzaWduVG9IYXNoOiBmdW5jdGlvbiBhc3NpZ25Ub0hhc2goa2V5KSB7DQoJICAgIHZhciB2YWx1ZSA9IHRoaXMucG9wU3RhY2soKSwNCgkgICAgICAgIGNvbnRleHQgPSB1bmRlZmluZWQsDQoJICAgICAgICB0eXBlID0gdW5kZWZpbmVkLA0KCSAgICAgICAgaWQgPSB1bmRlZmluZWQ7DQoNCgkgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsNCgkgICAgICBpZCA9IHRoaXMucG9wU3RhY2soKTsNCgkgICAgfQ0KCSAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsNCgkgICAgICB0eXBlID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICAgIGNvbnRleHQgPSB0aGlzLnBvcFN0YWNrKCk7DQoJICAgIH0NCg0KCSAgICB2YXIgaGFzaCA9IHRoaXMuaGFzaDsNCgkgICAgaWYgKGNvbnRleHQpIHsNCgkgICAgICBoYXNoLmNvbnRleHRzW2tleV0gPSBjb250ZXh0Ow0KCSAgICB9DQoJICAgIGlmICh0eXBlKSB7DQoJICAgICAgaGFzaC50eXBlc1trZXldID0gdHlwZTsNCgkgICAgfQ0KCSAgICBpZiAoaWQpIHsNCgkgICAgICBoYXNoLmlkc1trZXldID0gaWQ7DQoJICAgIH0NCgkgICAgaGFzaC52YWx1ZXNba2V5XSA9IHZhbHVlOw0KCSAgfSwNCg0KCSAgcHVzaElkOiBmdW5jdGlvbiBwdXNoSWQodHlwZSwgbmFtZSwgY2hpbGQpIHsNCgkgICAgaWYgKHR5cGUgPT09ICdCbG9ja1BhcmFtJykgew0KCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnYmxvY2tQYXJhbXNbJyArIG5hbWVbMF0gKyAnXS5wYXRoWycgKyBuYW1lWzFdICsgJ10nICsgKGNoaWxkID8gJyArICcgKyBKU09OLnN0cmluZ2lmeSgnLicgKyBjaGlsZCkgOiAnJykpOw0KCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdQYXRoRXhwcmVzc2lvbicpIHsNCgkgICAgICB0aGlzLnB1c2hTdHJpbmcobmFtZSk7DQoJICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1N1YkV4cHJlc3Npb24nKSB7DQoJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCd0cnVlJyk7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdudWxsJyk7DQoJICAgIH0NCgkgIH0sDQoNCgkgIC8vIEhFTFBFUlMNCg0KCSAgY29tcGlsZXI6IEphdmFTY3JpcHRDb21waWxlciwNCg0KCSAgY29tcGlsZUNoaWxkcmVuOiBmdW5jdGlvbiBjb21waWxlQ2hpbGRyZW4oZW52aXJvbm1lbnQsIG9wdGlvbnMpIHsNCgkgICAgdmFyIGNoaWxkcmVuID0gZW52aXJvbm1lbnQuY2hpbGRyZW4sDQoJICAgICAgICBjaGlsZCA9IHVuZGVmaW5lZCwNCgkgICAgICAgIGNvbXBpbGVyID0gdW5kZWZpbmVkOw0KDQoJICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7DQoJICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTsNCgkgICAgICBjb21waWxlciA9IG5ldyB0aGlzLmNvbXBpbGVyKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbmV3LWNhcA0KDQoJICAgICAgdmFyIGV4aXN0aW5nID0gdGhpcy5tYXRjaEV4aXN0aW5nUHJvZ3JhbShjaGlsZCk7DQoNCgkgICAgICBpZiAoZXhpc3RpbmcgPT0gbnVsbCkgew0KCSAgICAgICAgdGhpcy5jb250ZXh0LnByb2dyYW1zLnB1c2goJycpOyAvLyBQbGFjZWhvbGRlciB0byBwcmV2ZW50IG5hbWUgY29uZmxpY3RzIGZvciBuZXN0ZWQgY2hpbGRyZW4NCgkgICAgICAgIHZhciBpbmRleCA9IHRoaXMuY29udGV4dC5wcm9ncmFtcy5sZW5ndGg7DQoJICAgICAgICBjaGlsZC5pbmRleCA9IGluZGV4Ow0KCSAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGluZGV4Ow0KCSAgICAgICAgdGhpcy5jb250ZXh0LnByb2dyYW1zW2luZGV4XSA9IGNvbXBpbGVyLmNvbXBpbGUoY2hpbGQsIG9wdGlvbnMsIHRoaXMuY29udGV4dCwgIXRoaXMucHJlY29tcGlsZSk7DQoJICAgICAgICB0aGlzLmNvbnRleHQuZGVjb3JhdG9yc1tpbmRleF0gPSBjb21waWxlci5kZWNvcmF0b3JzOw0KCSAgICAgICAgdGhpcy5jb250ZXh0LmVudmlyb25tZW50c1tpbmRleF0gPSBjaGlsZDsNCg0KCSAgICAgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCBjb21waWxlci51c2VEZXB0aHM7DQoJICAgICAgICB0aGlzLnVzZUJsb2NrUGFyYW1zID0gdGhpcy51c2VCbG9ja1BhcmFtcyB8fCBjb21waWxlci51c2VCbG9ja1BhcmFtczsNCgkgICAgICAgIGNoaWxkLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzOw0KCSAgICAgICAgY2hpbGQudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICBjaGlsZC5pbmRleCA9IGV4aXN0aW5nLmluZGV4Ow0KCSAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGV4aXN0aW5nLmluZGV4Ow0KDQoJICAgICAgICB0aGlzLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzIHx8IGV4aXN0aW5nLnVzZURlcHRoczsNCgkgICAgICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IGV4aXN0aW5nLnVzZUJsb2NrUGFyYW1zOw0KCSAgICAgIH0NCgkgICAgfQ0KCSAgfSwNCgkgIG1hdGNoRXhpc3RpbmdQcm9ncmFtOiBmdW5jdGlvbiBtYXRjaEV4aXN0aW5nUHJvZ3JhbShjaGlsZCkgew0KCSAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5jb250ZXh0LmVudmlyb25tZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgew0KCSAgICAgIHZhciBlbnZpcm9ubWVudCA9IHRoaXMuY29udGV4dC5lbnZpcm9ubWVudHNbaV07DQoJICAgICAgaWYgKGVudmlyb25tZW50ICYmIGVudmlyb25tZW50LmVxdWFscyhjaGlsZCkpIHsNCgkgICAgICAgIHJldHVybiBlbnZpcm9ubWVudDsNCgkgICAgICB9DQoJICAgIH0NCgkgIH0sDQoNCgkgIHByb2dyYW1FeHByZXNzaW9uOiBmdW5jdGlvbiBwcm9ncmFtRXhwcmVzc2lvbihndWlkKSB7DQoJICAgIHZhciBjaGlsZCA9IHRoaXMuZW52aXJvbm1lbnQuY2hpbGRyZW5bZ3VpZF0sDQoJICAgICAgICBwcm9ncmFtUGFyYW1zID0gW2NoaWxkLmluZGV4LCAnZGF0YScsIGNoaWxkLmJsb2NrUGFyYW1zXTsNCg0KCSAgICBpZiAodGhpcy51c2VCbG9ja1BhcmFtcyB8fCB0aGlzLnVzZURlcHRocykgew0KCSAgICAgIHByb2dyYW1QYXJhbXMucHVzaCgnYmxvY2tQYXJhbXMnKTsNCgkgICAgfQ0KCSAgICBpZiAodGhpcy51c2VEZXB0aHMpIHsNCgkgICAgICBwcm9ncmFtUGFyYW1zLnB1c2goJ2RlcHRocycpOw0KCSAgICB9DQoNCgkgICAgcmV0dXJuICdjb250YWluZXIucHJvZ3JhbSgnICsgcHJvZ3JhbVBhcmFtcy5qb2luKCcsICcpICsgJyknOw0KCSAgfSwNCg0KCSAgdXNlUmVnaXN0ZXI6IGZ1bmN0aW9uIHVzZVJlZ2lzdGVyKG5hbWUpIHsNCgkgICAgaWYgKCF0aGlzLnJlZ2lzdGVyc1tuYW1lXSkgew0KCSAgICAgIHRoaXMucmVnaXN0ZXJzW25hbWVdID0gdHJ1ZTsNCgkgICAgICB0aGlzLnJlZ2lzdGVycy5saXN0LnB1c2gobmFtZSk7DQoJICAgIH0NCgkgIH0sDQoNCgkgIHB1c2g6IGZ1bmN0aW9uIHB1c2goZXhwcikgew0KCSAgICBpZiAoIShleHByIGluc3RhbmNlb2YgTGl0ZXJhbCkpIHsNCgkgICAgICBleHByID0gdGhpcy5zb3VyY2Uud3JhcChleHByKTsNCgkgICAgfQ0KDQoJICAgIHRoaXMuaW5saW5lU3RhY2sucHVzaChleHByKTsNCgkgICAgcmV0dXJuIGV4cHI7DQoJICB9LA0KDQoJICBwdXNoU3RhY2tMaXRlcmFsOiBmdW5jdGlvbiBwdXNoU3RhY2tMaXRlcmFsKGl0ZW0pIHsNCgkgICAgdGhpcy5wdXNoKG5ldyBMaXRlcmFsKGl0ZW0pKTsNCgkgIH0sDQoNCgkgIHB1c2hTb3VyY2U6IGZ1bmN0aW9uIHB1c2hTb3VyY2Uoc291cmNlKSB7DQoJICAgIGlmICh0aGlzLnBlbmRpbmdDb250ZW50KSB7DQoJICAgICAgdGhpcy5zb3VyY2UucHVzaCh0aGlzLmFwcGVuZFRvQnVmZmVyKHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0aGlzLnBlbmRpbmdDb250ZW50KSwgdGhpcy5wZW5kaW5nTG9jYXRpb24pKTsNCgkgICAgICB0aGlzLnBlbmRpbmdDb250ZW50ID0gdW5kZWZpbmVkOw0KCSAgICB9DQoNCgkgICAgaWYgKHNvdXJjZSkgew0KCSAgICAgIHRoaXMuc291cmNlLnB1c2goc291cmNlKTsNCgkgICAgfQ0KCSAgfSwNCg0KCSAgcmVwbGFjZVN0YWNrOiBmdW5jdGlvbiByZXBsYWNlU3RhY2soY2FsbGJhY2spIHsNCgkgICAgdmFyIHByZWZpeCA9IFsnKCddLA0KCSAgICAgICAgc3RhY2sgPSB1bmRlZmluZWQsDQoJICAgICAgICBjcmVhdGVkU3RhY2sgPSB1bmRlZmluZWQsDQoJICAgICAgICB1c2VkTGl0ZXJhbCA9IHVuZGVmaW5lZDsNCg0KCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLw0KCSAgICBpZiAoIXRoaXMuaXNJbmxpbmUoKSkgew0KCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdyZXBsYWNlU3RhY2sgb24gbm9uLWlubGluZScpOw0KCSAgICB9DQoNCgkgICAgLy8gV2Ugd2FudCB0byBtZXJnZSB0aGUgaW5saW5lIHN0YXRlbWVudCBpbnRvIHRoZSByZXBsYWNlbWVudCBzdGF0ZW1lbnQgdmlhICcsJw0KCSAgICB2YXIgdG9wID0gdGhpcy5wb3BTdGFjayh0cnVlKTsNCg0KCSAgICBpZiAodG9wIGluc3RhbmNlb2YgTGl0ZXJhbCkgew0KCSAgICAgIC8vIExpdGVyYWxzIGRvIG5vdCBuZWVkIHRvIGJlIGlubGluZWQNCgkgICAgICBzdGFjayA9IFt0b3AudmFsdWVdOw0KCSAgICAgIHByZWZpeCA9IFsnKCcsIHN0YWNrXTsNCgkgICAgICB1c2VkTGl0ZXJhbCA9IHRydWU7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgLy8gR2V0IG9yIGNyZWF0ZSB0aGUgY3VycmVudCBzdGFjayBuYW1lIGZvciB1c2UgYnkgdGhlIGlubGluZQ0KCSAgICAgIGNyZWF0ZWRTdGFjayA9IHRydWU7DQoJICAgICAgdmFyIF9uYW1lID0gdGhpcy5pbmNyU3RhY2soKTsNCg0KCSAgICAgIHByZWZpeCA9IFsnKCgnLCB0aGlzLnB1c2goX25hbWUpLCAnID0gJywgdG9wLCAnKSddOw0KCSAgICAgIHN0YWNrID0gdGhpcy50b3BTdGFjaygpOw0KCSAgICB9DQoNCgkgICAgdmFyIGl0ZW0gPSBjYWxsYmFjay5jYWxsKHRoaXMsIHN0YWNrKTsNCg0KCSAgICBpZiAoIXVzZWRMaXRlcmFsKSB7DQoJICAgICAgdGhpcy5wb3BTdGFjaygpOw0KCSAgICB9DQoJICAgIGlmIChjcmVhdGVkU3RhY2spIHsNCgkgICAgICB0aGlzLnN0YWNrU2xvdC0tOw0KCSAgICB9DQoJICAgIHRoaXMucHVzaChwcmVmaXguY29uY2F0KGl0ZW0sICcpJykpOw0KCSAgfSwNCg0KCSAgaW5jclN0YWNrOiBmdW5jdGlvbiBpbmNyU3RhY2soKSB7DQoJICAgIHRoaXMuc3RhY2tTbG90Kys7DQoJICAgIGlmICh0aGlzLnN0YWNrU2xvdCA+IHRoaXMuc3RhY2tWYXJzLmxlbmd0aCkgew0KCSAgICAgIHRoaXMuc3RhY2tWYXJzLnB1c2goJ3N0YWNrJyArIHRoaXMuc3RhY2tTbG90KTsNCgkgICAgfQ0KCSAgICByZXR1cm4gdGhpcy50b3BTdGFja05hbWUoKTsNCgkgIH0sDQoJICB0b3BTdGFja05hbWU6IGZ1bmN0aW9uIHRvcFN0YWNrTmFtZSgpIHsNCgkgICAgcmV0dXJuICdzdGFjaycgKyB0aGlzLnN0YWNrU2xvdDsNCgkgIH0sDQoJICBmbHVzaElubGluZTogZnVuY3Rpb24gZmx1c2hJbmxpbmUoKSB7DQoJICAgIHZhciBpbmxpbmVTdGFjayA9IHRoaXMuaW5saW5lU3RhY2s7DQoJICAgIHRoaXMuaW5saW5lU3RhY2sgPSBbXTsNCgkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGlubGluZVN0YWNrLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7DQoJICAgICAgdmFyIGVudHJ5ID0gaW5saW5lU3RhY2tbaV07DQoJICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovDQoJICAgICAgaWYgKGVudHJ5IGluc3RhbmNlb2YgTGl0ZXJhbCkgew0KCSAgICAgICAgdGhpcy5jb21waWxlU3RhY2sucHVzaChlbnRyeSk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHZhciBzdGFjayA9IHRoaXMuaW5jclN0YWNrKCk7DQoJICAgICAgICB0aGlzLnB1c2hTb3VyY2UoW3N0YWNrLCAnID0gJywgZW50cnksICc7J10pOw0KCSAgICAgICAgdGhpcy5jb21waWxlU3RhY2sucHVzaChzdGFjayk7DQoJICAgICAgfQ0KCSAgICB9DQoJICB9LA0KCSAgaXNJbmxpbmU6IGZ1bmN0aW9uIGlzSW5saW5lKCkgew0KCSAgICByZXR1cm4gdGhpcy5pbmxpbmVTdGFjay5sZW5ndGg7DQoJICB9LA0KDQoJICBwb3BTdGFjazogZnVuY3Rpb24gcG9wU3RhY2sod3JhcHBlZCkgew0KCSAgICB2YXIgaW5saW5lID0gdGhpcy5pc0lubGluZSgpLA0KCSAgICAgICAgaXRlbSA9IChpbmxpbmUgPyB0aGlzLmlubGluZVN0YWNrIDogdGhpcy5jb21waWxlU3RhY2spLnBvcCgpOw0KDQoJICAgIGlmICghd3JhcHBlZCAmJiBpdGVtIGluc3RhbmNlb2YgTGl0ZXJhbCkgew0KCSAgICAgIHJldHVybiBpdGVtLnZhbHVlOw0KCSAgICB9IGVsc2Ugew0KCSAgICAgIGlmICghaW5saW5lKSB7DQoJICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLw0KCSAgICAgICAgaWYgKCF0aGlzLnN0YWNrU2xvdCkgew0KCSAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnSW52YWxpZCBzdGFjayBwb3AnKTsNCgkgICAgICAgIH0NCgkgICAgICAgIHRoaXMuc3RhY2tTbG90LS07DQoJICAgICAgfQ0KCSAgICAgIHJldHVybiBpdGVtOw0KCSAgICB9DQoJICB9LA0KDQoJICB0b3BTdGFjazogZnVuY3Rpb24gdG9wU3RhY2soKSB7DQoJICAgIHZhciBzdGFjayA9IHRoaXMuaXNJbmxpbmUoKSA/IHRoaXMuaW5saW5lU3RhY2sgOiB0aGlzLmNvbXBpbGVTdGFjaywNCgkgICAgICAgIGl0ZW0gPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTsNCg0KCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8NCgkgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBMaXRlcmFsKSB7DQoJICAgICAgcmV0dXJuIGl0ZW0udmFsdWU7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcmV0dXJuIGl0ZW07DQoJICAgIH0NCgkgIH0sDQoNCgkgIGNvbnRleHROYW1lOiBmdW5jdGlvbiBjb250ZXh0TmFtZShjb250ZXh0KSB7DQoJICAgIGlmICh0aGlzLnVzZURlcHRocyAmJiBjb250ZXh0KSB7DQoJICAgICAgcmV0dXJuICdkZXB0aHNbJyArIGNvbnRleHQgKyAnXSc7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcmV0dXJuICdkZXB0aCcgKyBjb250ZXh0Ow0KCSAgICB9DQoJICB9LA0KDQoJICBxdW90ZWRTdHJpbmc6IGZ1bmN0aW9uIHF1b3RlZFN0cmluZyhzdHIpIHsNCgkgICAgcmV0dXJuIHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyhzdHIpOw0KCSAgfSwNCg0KCSAgb2JqZWN0TGl0ZXJhbDogZnVuY3Rpb24gb2JqZWN0TGl0ZXJhbChvYmopIHsNCgkgICAgcmV0dXJuIHRoaXMuc291cmNlLm9iamVjdExpdGVyYWwob2JqKTsNCgkgIH0sDQoNCgkgIGFsaWFzYWJsZTogZnVuY3Rpb24gYWxpYXNhYmxlKG5hbWUpIHsNCgkgICAgdmFyIHJldCA9IHRoaXMuYWxpYXNlc1tuYW1lXTsNCgkgICAgaWYgKHJldCkgew0KCSAgICAgIHJldC5yZWZlcmVuY2VDb3VudCsrOw0KCSAgICAgIHJldHVybiByZXQ7DQoJICAgIH0NCg0KCSAgICByZXQgPSB0aGlzLmFsaWFzZXNbbmFtZV0gPSB0aGlzLnNvdXJjZS53cmFwKG5hbWUpOw0KCSAgICByZXQuYWxpYXNhYmxlID0gdHJ1ZTsNCgkgICAgcmV0LnJlZmVyZW5jZUNvdW50ID0gMTsNCg0KCSAgICByZXR1cm4gcmV0Ow0KCSAgfSwNCg0KCSAgc2V0dXBIZWxwZXI6IGZ1bmN0aW9uIHNldHVwSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSwgYmxvY2tIZWxwZXIpIHsNCgkgICAgdmFyIHBhcmFtcyA9IFtdLA0KCSAgICAgICAgcGFyYW1zSW5pdCA9IHRoaXMuc2V0dXBIZWxwZXJBcmdzKG5hbWUsIHBhcmFtU2l6ZSwgcGFyYW1zLCBibG9ja0hlbHBlcik7DQoJICAgIHZhciBmb3VuZEhlbHBlciA9IHRoaXMubmFtZUxvb2t1cCgnaGVscGVycycsIG5hbWUsICdoZWxwZXInKSwNCgkgICAgICAgIGNhbGxDb250ZXh0ID0gdGhpcy5hbGlhc2FibGUodGhpcy5jb250ZXh0TmFtZSgwKSArICcgIT0gbnVsbCA/ICcgKyB0aGlzLmNvbnRleHROYW1lKDApICsgJyA6IChjb250YWluZXIubnVsbENvbnRleHQgfHwge30pJyk7DQoNCgkgICAgcmV0dXJuIHsNCgkgICAgICBwYXJhbXM6IHBhcmFtcywNCgkgICAgICBwYXJhbXNJbml0OiBwYXJhbXNJbml0LA0KCSAgICAgIG5hbWU6IGZvdW5kSGVscGVyLA0KCSAgICAgIGNhbGxQYXJhbXM6IFtjYWxsQ29udGV4dF0uY29uY2F0KHBhcmFtcykNCgkgICAgfTsNCgkgIH0sDQoNCgkgIHNldHVwUGFyYW1zOiBmdW5jdGlvbiBzZXR1cFBhcmFtcyhoZWxwZXIsIHBhcmFtU2l6ZSwgcGFyYW1zKSB7DQoJICAgIHZhciBvcHRpb25zID0ge30sDQoJICAgICAgICBjb250ZXh0cyA9IFtdLA0KCSAgICAgICAgdHlwZXMgPSBbXSwNCgkgICAgICAgIGlkcyA9IFtdLA0KCSAgICAgICAgb2JqZWN0QXJncyA9ICFwYXJhbXMsDQoJICAgICAgICBwYXJhbSA9IHVuZGVmaW5lZDsNCg0KCSAgICBpZiAob2JqZWN0QXJncykgew0KCSAgICAgIHBhcmFtcyA9IFtdOw0KCSAgICB9DQoNCgkgICAgb3B0aW9ucy5uYW1lID0gdGhpcy5xdW90ZWRTdHJpbmcoaGVscGVyKTsNCgkgICAgb3B0aW9ucy5oYXNoID0gdGhpcy5wb3BTdGFjaygpOw0KDQoJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7DQoJICAgICAgb3B0aW9ucy5oYXNoSWRzID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICB9DQoJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgew0KCSAgICAgIG9wdGlvbnMuaGFzaFR5cGVzID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICAgIG9wdGlvbnMuaGFzaENvbnRleHRzID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICB9DQoNCgkgICAgdmFyIGludmVyc2UgPSB0aGlzLnBvcFN0YWNrKCksDQoJICAgICAgICBwcm9ncmFtID0gdGhpcy5wb3BTdGFjaygpOw0KDQoJICAgIC8vIEF2b2lkIHNldHRpbmcgZm4gYW5kIGludmVyc2UgaWYgbmVpdGhlciBhcmUgc2V0LiBUaGlzIGFsbG93cw0KCSAgICAvLyBoZWxwZXJzIHRvIGRvIGEgY2hlY2sgZm9yIGBpZiAob3B0aW9ucy5mbilgDQoJICAgIGlmIChwcm9ncmFtIHx8IGludmVyc2UpIHsNCgkgICAgICBvcHRpb25zLmZuID0gcHJvZ3JhbSB8fCAnY29udGFpbmVyLm5vb3AnOw0KCSAgICAgIG9wdGlvbnMuaW52ZXJzZSA9IGludmVyc2UgfHwgJ2NvbnRhaW5lci5ub29wJzsNCgkgICAgfQ0KDQoJICAgIC8vIFRoZSBwYXJhbWV0ZXJzIGdvIG9uIHRvIHRoZSBzdGFjayBpbiBvcmRlciAobWFraW5nIHN1cmUgdGhhdCB0aGV5IGFyZSBldmFsdWF0ZWQgaW4gb3JkZXIpDQoJICAgIC8vIHNvIHdlIG5lZWQgdG8gcG9wIHRoZW0gb2ZmIHRoZSBzdGFjayBpbiByZXZlcnNlIG9yZGVyDQoJICAgIHZhciBpID0gcGFyYW1TaXplOw0KCSAgICB3aGlsZSAoaS0tKSB7DQoJICAgICAgcGFyYW0gPSB0aGlzLnBvcFN0YWNrKCk7DQoJICAgICAgcGFyYW1zW2ldID0gcGFyYW07DQoNCgkgICAgICBpZiAodGhpcy50cmFja0lkcykgew0KCSAgICAgICAgaWRzW2ldID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICAgIH0NCgkgICAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsNCgkgICAgICAgIHR5cGVzW2ldID0gdGhpcy5wb3BTdGFjaygpOw0KCSAgICAgICAgY29udGV4dHNbaV0gPSB0aGlzLnBvcFN0YWNrKCk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgaWYgKG9iamVjdEFyZ3MpIHsNCgkgICAgICBvcHRpb25zLmFyZ3MgPSB0aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KHBhcmFtcyk7DQoJICAgIH0NCg0KCSAgICBpZiAodGhpcy50cmFja0lkcykgew0KCSAgICAgIG9wdGlvbnMuaWRzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShpZHMpOw0KCSAgICB9DQoJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgew0KCSAgICAgIG9wdGlvbnMudHlwZXMgPSB0aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KHR5cGVzKTsNCgkgICAgICBvcHRpb25zLmNvbnRleHRzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShjb250ZXh0cyk7DQoJICAgIH0NCg0KCSAgICBpZiAodGhpcy5vcHRpb25zLmRhdGEpIHsNCgkgICAgICBvcHRpb25zLmRhdGEgPSAnZGF0YSc7DQoJICAgIH0NCgkgICAgaWYgKHRoaXMudXNlQmxvY2tQYXJhbXMpIHsNCgkgICAgICBvcHRpb25zLmJsb2NrUGFyYW1zID0gJ2Jsb2NrUGFyYW1zJzsNCgkgICAgfQ0KCSAgICByZXR1cm4gb3B0aW9uczsNCgkgIH0sDQoNCgkgIHNldHVwSGVscGVyQXJnczogZnVuY3Rpb24gc2V0dXBIZWxwZXJBcmdzKGhlbHBlciwgcGFyYW1TaXplLCBwYXJhbXMsIHVzZVJlZ2lzdGVyKSB7DQoJICAgIHZhciBvcHRpb25zID0gdGhpcy5zZXR1cFBhcmFtcyhoZWxwZXIsIHBhcmFtU2l6ZSwgcGFyYW1zKTsNCgkgICAgb3B0aW9ucyA9IHRoaXMub2JqZWN0TGl0ZXJhbChvcHRpb25zKTsNCgkgICAgaWYgKHVzZVJlZ2lzdGVyKSB7DQoJICAgICAgdGhpcy51c2VSZWdpc3Rlcignb3B0aW9ucycpOw0KCSAgICAgIHBhcmFtcy5wdXNoKCdvcHRpb25zJyk7DQoJICAgICAgcmV0dXJuIFsnb3B0aW9ucz0nLCBvcHRpb25zXTsNCgkgICAgfSBlbHNlIGlmIChwYXJhbXMpIHsNCgkgICAgICBwYXJhbXMucHVzaChvcHRpb25zKTsNCgkgICAgICByZXR1cm4gJyc7DQoJICAgIH0gZWxzZSB7DQoJICAgICAgcmV0dXJuIG9wdGlvbnM7DQoJICAgIH0NCgkgIH0NCgl9Ow0KDQoJKGZ1bmN0aW9uICgpIHsNCgkgIHZhciByZXNlcnZlZFdvcmRzID0gKCdicmVhayBlbHNlIG5ldyB2YXInICsgJyBjYXNlIGZpbmFsbHkgcmV0dXJuIHZvaWQnICsgJyBjYXRjaCBmb3Igc3dpdGNoIHdoaWxlJyArICcgY29udGludWUgZnVuY3Rpb24gdGhpcyB3aXRoJyArICcgZGVmYXVsdCBpZiB0aHJvdycgKyAnIGRlbGV0ZSBpbiB0cnknICsgJyBkbyBpbnN0YW5jZW9mIHR5cGVvZicgKyAnIGFic3RyYWN0IGVudW0gaW50IHNob3J0JyArICcgYm9vbGVhbiBleHBvcnQgaW50ZXJmYWNlIHN0YXRpYycgKyAnIGJ5dGUgZXh0ZW5kcyBsb25nIHN1cGVyJyArICcgY2hhciBmaW5hbCBuYXRpdmUgc3luY2hyb25pemVkJyArICcgY2xhc3MgZmxvYXQgcGFja2FnZSB0aHJvd3MnICsgJyBjb25zdCBnb3RvIHByaXZhdGUgdHJhbnNpZW50JyArICcgZGVidWdnZXIgaW1wbGVtZW50cyBwcm90ZWN0ZWQgdm9sYXRpbGUnICsgJyBkb3VibGUgaW1wb3J0IHB1YmxpYyBsZXQgeWllbGQgYXdhaXQnICsgJyBudWxsIHRydWUgZmFsc2UnKS5zcGxpdCgnICcpOw0KDQoJICB2YXIgY29tcGlsZXJXb3JkcyA9IEphdmFTY3JpcHRDb21waWxlci5SRVNFUlZFRF9XT1JEUyA9IHt9Ow0KDQoJICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc2VydmVkV29yZHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7DQoJICAgIGNvbXBpbGVyV29yZHNbcmVzZXJ2ZWRXb3Jkc1tpXV0gPSB0cnVlOw0KCSAgfQ0KCX0pKCk7DQoNCglKYXZhU2NyaXB0Q29tcGlsZXIuaXNWYWxpZEphdmFTY3JpcHRWYXJpYWJsZU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgew0KCSAgcmV0dXJuICFKYXZhU2NyaXB0Q29tcGlsZXIuUkVTRVJWRURfV09SRFNbbmFtZV0gJiYgL15bYS16QS1aXyRdWzAtOWEtekEtWl8kXSokLy50ZXN0KG5hbWUpOw0KCX07DQoNCglmdW5jdGlvbiBzdHJpY3RMb29rdXAocmVxdWlyZVRlcm1pbmFsLCBjb21waWxlciwgcGFydHMsIHR5cGUpIHsNCgkgIHZhciBzdGFjayA9IGNvbXBpbGVyLnBvcFN0YWNrKCksDQoJICAgICAgaSA9IDAsDQoJICAgICAgbGVuID0gcGFydHMubGVuZ3RoOw0KCSAgaWYgKHJlcXVpcmVUZXJtaW5hbCkgew0KCSAgICBsZW4tLTsNCgkgIH0NCg0KCSAgZm9yICg7IGkgPCBsZW47IGkrKykgew0KCSAgICBzdGFjayA9IGNvbXBpbGVyLm5hbWVMb29rdXAoc3RhY2ssIHBhcnRzW2ldLCB0eXBlKTsNCgkgIH0NCg0KCSAgaWYgKHJlcXVpcmVUZXJtaW5hbCkgew0KCSAgICByZXR1cm4gW2NvbXBpbGVyLmFsaWFzYWJsZSgnY29udGFpbmVyLnN0cmljdCcpLCAnKCcsIHN0YWNrLCAnLCAnLCBjb21waWxlci5xdW90ZWRTdHJpbmcocGFydHNbaV0pLCAnKSddOw0KCSAgfSBlbHNlIHsNCgkgICAgcmV0dXJuIHN0YWNrOw0KCSAgfQ0KCX0NCg0KCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IEphdmFTY3JpcHRDb21waWxlcjsNCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsNCg0KLyoqKi8gfSksDQovKiA0MyAqLw0KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgew0KDQoJLyogZ2xvYmFsIGRlZmluZSAqLw0KCSd1c2Ugc3RyaWN0JzsNCg0KCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7DQoNCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsNCg0KCXZhciBTb3VyY2VOb2RlID0gdW5kZWZpbmVkOw0KDQoJdHJ5IHsNCgkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovDQoJICBpZiAoZmFsc2UpIHsNCgkgICAgLy8gV2UgZG9uJ3Qgc3VwcG9ydCB0aGlzIGluIEFNRCBlbnZpcm9ubWVudHMuIEZvciB0aGVzZSBlbnZpcm9ubWVudHMsIHdlIGFzdXNtZSB0aGF0DQoJICAgIC8vIHRoZXkgYXJlIHJ1bm5pbmcgb24gdGhlIGJyb3dzZXIgYW5kIHRodXMgaGF2ZSBubyBuZWVkIGZvciB0aGUgc291cmNlLW1hcCBsaWJyYXJ5Lg0KCSAgICB2YXIgU291cmNlTWFwID0gcmVxdWlyZSgnc291cmNlLW1hcCcpOw0KCSAgICBTb3VyY2VOb2RlID0gU291cmNlTWFwLlNvdXJjZU5vZGU7DQoJICB9DQoJfSBjYXRjaCAoZXJyKSB7fQ0KCS8qIE5PUCAqLw0KDQoJLyogaXN0YW5idWwgaWdub3JlIGlmOiB0ZXN0ZWQgYnV0IG5vdCBjb3ZlcmVkIGluIGlzdGFuYnVsIGR1ZSB0byBkaXN0IGJ1aWxkICAqLw0KCWlmICghU291cmNlTm9kZSkgew0KCSAgU291cmNlTm9kZSA9IGZ1bmN0aW9uIChsaW5lLCBjb2x1bW4sIHNyY0ZpbGUsIGNodW5rcykgew0KCSAgICB0aGlzLnNyYyA9ICcnOw0KCSAgICBpZiAoY2h1bmtzKSB7DQoJICAgICAgdGhpcy5hZGQoY2h1bmtzKTsNCgkgICAgfQ0KCSAgfTsNCgkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovDQoJICBTb3VyY2VOb2RlLnByb3RvdHlwZSA9IHsNCgkgICAgYWRkOiBmdW5jdGlvbiBhZGQoY2h1bmtzKSB7DQoJICAgICAgaWYgKF91dGlscy5pc0FycmF5KGNodW5rcykpIHsNCgkgICAgICAgIGNodW5rcyA9IGNodW5rcy5qb2luKCcnKTsNCgkgICAgICB9DQoJICAgICAgdGhpcy5zcmMgKz0gY2h1bmtzOw0KCSAgICB9LA0KCSAgICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKGNodW5rcykgew0KCSAgICAgIGlmIChfdXRpbHMuaXNBcnJheShjaHVua3MpKSB7DQoJICAgICAgICBjaHVua3MgPSBjaHVua3Muam9pbignJyk7DQoJICAgICAgfQ0KCSAgICAgIHRoaXMuc3JjID0gY2h1bmtzICsgdGhpcy5zcmM7DQoJICAgIH0sDQoJICAgIHRvU3RyaW5nV2l0aFNvdXJjZU1hcDogZnVuY3Rpb24gdG9TdHJpbmdXaXRoU291cmNlTWFwKCkgew0KCSAgICAgIHJldHVybiB7IGNvZGU6IHRoaXMudG9TdHJpbmcoKSB9Ow0KCSAgICB9LA0KCSAgICB0b1N0cmluZzogZnVuY3Rpb24gdG9TdHJpbmcoKSB7DQoJICAgICAgcmV0dXJuIHRoaXMuc3JjOw0KCSAgICB9DQoJICB9Ow0KCX0NCg0KCWZ1bmN0aW9uIGNhc3RDaHVuayhjaHVuaywgY29kZUdlbiwgbG9jKSB7DQoJICBpZiAoX3V0aWxzLmlzQXJyYXkoY2h1bmspKSB7DQoJICAgIHZhciByZXQgPSBbXTsNCg0KCSAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY2h1bmsubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsNCgkgICAgICByZXQucHVzaChjb2RlR2VuLndyYXAoY2h1bmtbaV0sIGxvYykpOw0KCSAgICB9DQoJICAgIHJldHVybiByZXQ7DQoJICB9IGVsc2UgaWYgKHR5cGVvZiBjaHVuayA9PT0gJ2Jvb2xlYW4nIHx8IHR5cGVvZiBjaHVuayA9PT0gJ251bWJlcicpIHsNCgkgICAgLy8gSGFuZGxlIHByaW1pdGl2ZXMgdGhhdCB0aGUgU291cmNlTm9kZSB3aWxsIHRocm93IHVwIG9uDQoJICAgIHJldHVybiBjaHVuayArICcnOw0KCSAgfQ0KCSAgcmV0dXJuIGNodW5rOw0KCX0NCg0KCWZ1bmN0aW9uIENvZGVHZW4oc3JjRmlsZSkgew0KCSAgdGhpcy5zcmNGaWxlID0gc3JjRmlsZTsNCgkgIHRoaXMuc291cmNlID0gW107DQoJfQ0KDQoJQ29kZUdlbi5wcm90b3R5cGUgPSB7DQoJICBpc0VtcHR5OiBmdW5jdGlvbiBpc0VtcHR5KCkgew0KCSAgICByZXR1cm4gIXRoaXMuc291cmNlLmxlbmd0aDsNCgkgIH0sDQoJICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKHNvdXJjZSwgbG9jKSB7DQoJICAgIHRoaXMuc291cmNlLnVuc2hpZnQodGhpcy53cmFwKHNvdXJjZSwgbG9jKSk7DQoJICB9LA0KCSAgcHVzaDogZnVuY3Rpb24gcHVzaChzb3VyY2UsIGxvYykgew0KCSAgICB0aGlzLnNvdXJjZS5wdXNoKHRoaXMud3JhcChzb3VyY2UsIGxvYykpOw0KCSAgfSwNCg0KCSAgbWVyZ2U6IGZ1bmN0aW9uIG1lcmdlKCkgew0KCSAgICB2YXIgc291cmNlID0gdGhpcy5lbXB0eSgpOw0KCSAgICB0aGlzLmVhY2goZnVuY3Rpb24gKGxpbmUpIHsNCgkgICAgICBzb3VyY2UuYWRkKFsnICAnLCBsaW5lLCAnXG4nXSk7DQoJICAgIH0pOw0KCSAgICByZXR1cm4gc291cmNlOw0KCSAgfSwNCg0KCSAgZWFjaDogZnVuY3Rpb24gZWFjaChpdGVyKSB7DQoJICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnNvdXJjZS5sZW5ndGg7IGkgPCBsZW47IGkrKykgew0KCSAgICAgIGl0ZXIodGhpcy5zb3VyY2VbaV0pOw0KCSAgICB9DQoJICB9LA0KDQoJICBlbXB0eTogZnVuY3Rpb24gZW1wdHkoKSB7DQoJICAgIHZhciBsb2MgPSB0aGlzLmN1cnJlbnRMb2NhdGlvbiB8fCB7IHN0YXJ0OiB7fSB9Ow0KCSAgICByZXR1cm4gbmV3IFNvdXJjZU5vZGUobG9jLnN0YXJ0LmxpbmUsIGxvYy5zdGFydC5jb2x1bW4sIHRoaXMuc3JjRmlsZSk7DQoJICB9LA0KCSAgd3JhcDogZnVuY3Rpb24gd3JhcChjaHVuaykgew0KCSAgICB2YXIgbG9jID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5jdXJyZW50TG9jYXRpb24gfHwgeyBzdGFydDoge30gfSA6IGFyZ3VtZW50c1sxXTsNCg0KCSAgICBpZiAoY2h1bmsgaW5zdGFuY2VvZiBTb3VyY2VOb2RlKSB7DQoJICAgICAgcmV0dXJuIGNodW5rOw0KCSAgICB9DQoNCgkgICAgY2h1bmsgPSBjYXN0Q2h1bmsoY2h1bmssIHRoaXMsIGxvYyk7DQoNCgkgICAgcmV0dXJuIG5ldyBTb3VyY2VOb2RlKGxvYy5zdGFydC5saW5lLCBsb2Muc3RhcnQuY29sdW1uLCB0aGlzLnNyY0ZpbGUsIGNodW5rKTsNCgkgIH0sDQoNCgkgIGZ1bmN0aW9uQ2FsbDogZnVuY3Rpb24gZnVuY3Rpb25DYWxsKGZuLCB0eXBlLCBwYXJhbXMpIHsNCgkgICAgcGFyYW1zID0gdGhpcy5nZW5lcmF0ZUxpc3QocGFyYW1zKTsNCgkgICAgcmV0dXJuIHRoaXMud3JhcChbZm4sIHR5cGUgPyAnLicgKyB0eXBlICsgJygnIDogJygnLCBwYXJhbXMsICcpJ10pOw0KCSAgfSwNCg0KCSAgcXVvdGVkU3RyaW5nOiBmdW5jdGlvbiBxdW90ZWRTdHJpbmcoc3RyKSB7DQoJICAgIHJldHVybiAnIicgKyAoc3RyICsgJycpLnJlcGxhY2UoL1xcL2csICdcXFxcJykucmVwbGFjZSgvIi9nLCAnXFwiJykucmVwbGFjZSgvXG4vZywgJ1xcbicpLnJlcGxhY2UoL1xyL2csICdcXHInKS5yZXBsYWNlKC9cdTIwMjgvZywgJ1xcdTIwMjgnKSAvLyBQZXIgRWNtYS0yNjIgNy4zICsgNy44LjQNCgkgICAgLnJlcGxhY2UoL1x1MjAyOS9nLCAnXFx1MjAyOScpICsgJyInOw0KCSAgfSwNCg0KCSAgb2JqZWN0TGl0ZXJhbDogZnVuY3Rpb24gb2JqZWN0TGl0ZXJhbChvYmopIHsNCgkgICAgdmFyIHBhaXJzID0gW107DQoNCgkgICAgZm9yICh2YXIga2V5IGluIG9iaikgew0KCSAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgew0KCSAgICAgICAgdmFyIHZhbHVlID0gY2FzdENodW5rKG9ialtrZXldLCB0aGlzKTsNCgkgICAgICAgIGlmICh2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgICAgcGFpcnMucHVzaChbdGhpcy5xdW90ZWRTdHJpbmcoa2V5KSwgJzonLCB2YWx1ZV0pOw0KCSAgICAgICAgfQ0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIHZhciByZXQgPSB0aGlzLmdlbmVyYXRlTGlzdChwYWlycyk7DQoJICAgIHJldC5wcmVwZW5kKCd7Jyk7DQoJICAgIHJldC5hZGQoJ30nKTsNCgkgICAgcmV0dXJuIHJldDsNCgkgIH0sDQoNCgkgIGdlbmVyYXRlTGlzdDogZnVuY3Rpb24gZ2VuZXJhdGVMaXN0KGVudHJpZXMpIHsNCgkgICAgdmFyIHJldCA9IHRoaXMuZW1wdHkoKTsNCg0KCSAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZW50cmllcy5sZW5ndGg7IGkgPCBsZW47IGkrKykgew0KCSAgICAgIGlmIChpKSB7DQoJICAgICAgICByZXQuYWRkKCcsJyk7DQoJICAgICAgfQ0KDQoJICAgICAgcmV0LmFkZChjYXN0Q2h1bmsoZW50cmllc1tpXSwgdGhpcykpOw0KCSAgICB9DQoNCgkgICAgcmV0dXJuIHJldDsNCgkgIH0sDQoNCgkgIGdlbmVyYXRlQXJyYXk6IGZ1bmN0aW9uIGdlbmVyYXRlQXJyYXkoZW50cmllcykgew0KCSAgICB2YXIgcmV0ID0gdGhpcy5nZW5lcmF0ZUxpc3QoZW50cmllcyk7DQoJICAgIHJldC5wcmVwZW5kKCdbJyk7DQoJICAgIHJldC5hZGQoJ10nKTsNCg0KCSAgICByZXR1cm4gcmV0Ow0KCSAgfQ0KCX07DQoNCglleHBvcnRzWydkZWZhdWx0J10gPSBDb2RlR2VuOw0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw0KDQovKioqLyB9KQ0KLyoqKioqKi8gXSkNCn0pOw0KOw==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>